/*! For license information please see main.d20280f3.js.LICENSE.txt */
!function(){var e={1694:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var a=i.apply(null,n);a&&e.push(a)}}else if("object"===o){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},6724:function(e,t,n){"use strict";var r=n(9218),i=n(1772),o=TypeError;e.exports=function(e){if(r(e))return e;throw o(i(e)+" is not a function")}},5715:function(e,t,n){"use strict";var r=n(5028),i=n(4385),o=n(1592).f,a=r("unscopables"),s=Array.prototype;void 0===s[a]&&o(s,a,{configurable:!0,value:i(null)}),e.exports=function(e){s[a][e]=!0}},5466:function(e,t,n){"use strict";var r=n(8424).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},5884:function(e,t,n){"use strict";var r=n(3931),i=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw o(i(e)+" is not an object")}},488:function(e,t,n){"use strict";var r=n(5770),i=n(1823),o=n(3385),a=function(e){return function(t,n,a){var s,u=r(t),l=o(u),c=i(a,l);if(e&&n!==n){for(;l>c;)if((s=u[c++])!==s)return!0}else for(;l>c;c++)if((e||c in u)&&u[c]===n)return e||c||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},9026:function(e,t,n){"use strict";var r=n(1941),i=n(1219),o=n(3931),a=n(5028)("species"),s=Array;e.exports=function(e){var t;return r(e)&&(t=e.constructor,(i(t)&&(t===s||r(t.prototype))||o(t)&&null===(t=t[a]))&&(t=void 0)),void 0===t?s:t}},5491:function(e,t,n){"use strict";var r=n(9026);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},2933:function(e,t,n){"use strict";var r=n(4932),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},7205:function(e,t,n){"use strict";var r=n(6042),i=n(9218),o=n(2933),a=n(5028)("toStringTag"),s=Object,u="Arguments"===o(function(){return arguments}());e.exports=r?o:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(n){}}(t=s(e),a))?n:u?o(t):"Object"===(r=o(t))&&i(t.callee)?"Arguments":r}},189:function(e,t,n){"use strict";var r=n(3013),i=n(7273),o=n(2573),a=n(1592);e.exports=function(e,t,n){for(var s=i(t),u=a.f,l=o.f,c=0;c<s.length;c++){var d=s[c];r(e,d)||n&&r(n,d)||u(e,d,l(t,d))}}},3873:function(e,t,n){"use strict";var r=n(1196),i=n(1592),o=n(2037);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},2037:function(e){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},7543:function(e,t,n){"use strict";var r=n(9218),i=n(1592),o=n(2557),a=n(9131);e.exports=function(e,t,n,s){s||(s={});var u=s.enumerable,l=void 0!==s.name?s.name:t;if(r(n)&&o(n,l,s),s.global)u?e[t]=n:a(t,n);else{try{s.unsafe?e[t]&&(u=!0):delete e[t]}catch(c){}u?e[t]=n:i.f(e,t,{value:n,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e}},9131:function(e,t,n){"use strict";var r=n(6840),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},1196:function(e,t,n){"use strict";var r=n(2837);e.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4363:function(e){"use strict";var t="object"==typeof document&&document.all,n="undefined"==typeof t&&void 0!==t;e.exports={all:t,IS_HTMLDDA:n}},937:function(e,t,n){"use strict";var r=n(6840),i=n(3931),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},6117:function(e){"use strict";var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},4839:function(e){"use strict";e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},5372:function(e,t,n){"use strict";var r,i,o=n(6840),a=n(4839),s=o.process,u=o.Deno,l=s&&s.versions||u&&u.version,c=l&&l.v8;c&&(i=(r=c.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},2080:function(e){"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},7768:function(e,t,n){"use strict";var r=n(6840),i=n(2573).f,o=n(3873),a=n(7543),s=n(9131),u=n(189),l=n(6673);e.exports=function(e,t){var n,c,d,f,p,h=e.target,v=e.global,g=e.stat;if(n=v?r:g?r[h]||s(h,{}):(r[h]||{}).prototype)for(c in t){if(f=t[c],d=e.dontCallGetSet?(p=i(n,c))&&p.value:n[c],!l(v?c:h+(g?".":"#")+c,e.forced)&&void 0!==d){if(typeof f==typeof d)continue;u(f,d)}(e.sham||d&&d.sham)&&o(f,"sham",!0),a(n,c,f,e)}}},2837:function(e){"use strict";e.exports=function(e){try{return!!e()}catch(t){return!0}}},8093:function(e,t,n){"use strict";n(447);var r=n(7926),i=n(7543),o=n(4087),a=n(2837),s=n(5028),u=n(3873),l=s("species"),c=RegExp.prototype;e.exports=function(e,t,n,d){var f=s(e),p=!a((function(){var t={};return t[f]=function(){return 7},7!==""[e](t)})),h=p&&!a((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[l]=function(){return n},n.flags="",n[f]=/./[f]),n.exec=function(){return t=!0,null},n[f](""),!t}));if(!p||!h||n){var v=r(/./[f]),g=t(f,""[e],(function(e,t,n,i,a){var s=r(e),u=t.exec;return u===o||u===c.exec?p&&!a?{done:!0,value:v(t,n,i)}:{done:!0,value:s(n,t,i)}:{done:!1}}));i(String.prototype,e,g[0]),i(c,f,g[1])}d&&u(c[f],"sham",!0)}},8264:function(e,t,n){"use strict";var r=n(1941),i=n(3385),o=n(6117),a=n(5851);e.exports=function e(t,n,s,u,l,c,d,f){for(var p,h=l,v=0,g=!!d&&a(d,f);v<u;)v in s&&(p=g?g(s[v],v,n):s[v],c>0&&r(p)?h=e(t,n,p,i(p),h,c-1)-1:(o(h+1),t[h]=p),h++),v++;return h}},6339:function(e,t,n){"use strict";var r=n(4138),i=Function.prototype,o=i.apply,a=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(o):function(){return a.apply(o,arguments)})},5851:function(e,t,n){"use strict";var r=n(7926),i=n(6724),o=n(4138),a=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?a(e,t):function(){return e.apply(t,arguments)}}},4138:function(e,t,n){"use strict";var r=n(2837);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},8513:function(e,t,n){"use strict";var r=n(4138),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},3211:function(e,t,n){"use strict";var r=n(1196),i=n(3013),o=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=i(o,"name"),u=s&&"something"===function(){}.name,l=s&&(!r||r&&a(o,"name").configurable);e.exports={EXISTS:s,PROPER:u,CONFIGURABLE:l}},7926:function(e,t,n){"use strict";var r=n(2933),i=n(4932);e.exports=function(e){if("Function"===r(e))return i(e)}},4932:function(e,t,n){"use strict";var r=n(4138),i=Function.prototype,o=i.call,a=r&&i.bind.bind(o,o);e.exports=r?a:function(e){return function(){return o.apply(e,arguments)}}},1240:function(e,t,n){"use strict";var r=n(6840),i=n(9218);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},3863:function(e,t,n){"use strict";var r=n(6724),i=n(9055);e.exports=function(e,t){var n=e[t];return i(n)?void 0:r(n)}},7794:function(e,t,n){"use strict";var r=n(4932),i=n(8385),o=Math.floor,a=r("".charAt),s=r("".replace),u=r("".slice),l=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,c=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,d,f){var p=n+e.length,h=r.length,v=c;return void 0!==d&&(d=i(d),v=l),s(f,v,(function(i,s){var l;switch(a(s,0)){case"$":return"$";case"&":return e;case"`":return u(t,0,n);case"'":return u(t,p);case"<":l=d[u(s,1,-1)];break;default:var c=+s;if(0===c)return i;if(c>h){var f=o(c/10);return 0===f?i:f<=h?void 0===r[f-1]?a(s,1):r[f-1]+a(s,1):i}l=r[c-1]}return void 0===l?"":l}))}},6840:function(e,t,n){"use strict";var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||this||Function("return this")()},3013:function(e,t,n){"use strict";var r=n(4932),i=n(8385),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},6196:function(e){"use strict";e.exports={}},2012:function(e,t,n){"use strict";var r=n(1240);e.exports=r("document","documentElement")},6707:function(e,t,n){"use strict";var r=n(1196),i=n(2837),o=n(937);e.exports=!r&&!i((function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},1036:function(e,t,n){"use strict";var r=n(4932),i=n(2837),o=n(2933),a=Object,s=r("".split);e.exports=i((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"===o(e)?s(e,""):a(e)}:a},8589:function(e,t,n){"use strict";var r=n(4932),i=n(9218),o=n(4460),a=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return a(e)}),e.exports=o.inspectSource},9671:function(e,t,n){"use strict";var r,i,o,a=n(1615),s=n(6840),u=n(3931),l=n(3873),c=n(3013),d=n(4460),f=n(9378),p=n(6196),h="Object already initialized",v=s.TypeError,g=s.WeakMap;if(a||d.state){var m=d.state||(d.state=new g);m.get=m.get,m.has=m.has,m.set=m.set,r=function(e,t){if(m.has(e))throw v(h);return t.facade=e,m.set(e,t),t},i=function(e){return m.get(e)||{}},o=function(e){return m.has(e)}}else{var y=f("state");p[y]=!0,r=function(e,t){if(c(e,y))throw v(h);return t.facade=e,l(e,y,t),t},i=function(e){return c(e,y)?e[y]:{}},o=function(e){return c(e,y)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!u(t)||(n=i(t)).type!==e)throw v("Incompatible receiver, "+e+" required");return n}}}},1941:function(e,t,n){"use strict";var r=n(2933);e.exports=Array.isArray||function(e){return"Array"===r(e)}},9218:function(e,t,n){"use strict";var r=n(4363),i=r.all;e.exports=r.IS_HTMLDDA?function(e){return"function"==typeof e||e===i}:function(e){return"function"==typeof e}},1219:function(e,t,n){"use strict";var r=n(4932),i=n(2837),o=n(9218),a=n(7205),s=n(1240),u=n(8589),l=function(){},c=[],d=s("Reflect","construct"),f=/^\s*(?:class|function)\b/,p=r(f.exec),h=!f.exec(l),v=function(e){if(!o(e))return!1;try{return d(l,c,e),!0}catch(t){return!1}},g=function(e){if(!o(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return h||!!p(f,u(e))}catch(t){return!0}};g.sham=!0,e.exports=!d||i((function(){var e;return v(v.call)||!v(Object)||!v((function(){e=!0}))||e}))?g:v},6673:function(e,t,n){"use strict";var r=n(2837),i=n(9218),o=/#|\.prototype\./,a=function(e,t){var n=u[s(e)];return n===c||n!==l&&(i(t)?r(t):!!t)},s=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},u=a.data={},l=a.NATIVE="N",c=a.POLYFILL="P";e.exports=a},9055:function(e){"use strict";e.exports=function(e){return null===e||void 0===e}},3931:function(e,t,n){"use strict";var r=n(9218),i=n(4363),o=i.all;e.exports=i.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===o}:function(e){return"object"==typeof e?null!==e:r(e)}},3608:function(e){"use strict";e.exports=!1},8287:function(e,t,n){"use strict";var r=n(1240),i=n(9218),o=n(8946),a=n(7611),s=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&o(t.prototype,s(e))}},3385:function(e,t,n){"use strict";var r=n(2347);e.exports=function(e){return r(e.length)}},2557:function(e,t,n){"use strict";var r=n(4932),i=n(2837),o=n(9218),a=n(3013),s=n(1196),u=n(3211).CONFIGURABLE,l=n(8589),c=n(9671),d=c.enforce,f=c.get,p=String,h=Object.defineProperty,v=r("".slice),g=r("".replace),m=r([].join),y=s&&!i((function(){return 8!==h((function(){}),"length",{value:8}).length})),b=String(String).split("String"),w=e.exports=function(e,t,n){"Symbol("===v(p(t),0,7)&&(t="["+g(p(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!a(e,"name")||u&&e.name!==t)&&(s?h(e,"name",{value:t,configurable:!0}):e.name=t),y&&n&&a(n,"arity")&&e.length!==n.arity&&h(e,"length",{value:n.arity});try{n&&a(n,"constructor")&&n.constructor?s&&h(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(i){}var r=d(e);return a(r,"source")||(r.source=m(b,"string"==typeof t?t:"")),e};Function.prototype.toString=w((function(){return o(this)&&f(this).source||l(this)}),"toString")},1246:function(e){"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},4385:function(e,t,n){"use strict";var r,i=n(5884),o=n(1697),a=n(2080),s=n(6196),u=n(2012),l=n(937),c=n(9378),d="prototype",f="script",p=c("IE_PROTO"),h=function(){},v=function(e){return"<"+f+">"+e+"</"+f+">"},g=function(e){e.write(v("")),e.close();var t=e.parentWindow.Object;return e=null,t},m=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}m="undefined"!=typeof document?document.domain&&r?g(r):function(){var e,t=l("iframe"),n="java"+f+":";return t.style.display="none",u.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(v("document.F=Object")),e.close(),e.F}():g(r);for(var e=a.length;e--;)delete m[d][a[e]];return m()};s[p]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(h[d]=i(e),n=new h,h[d]=null,n[p]=e):n=m(),void 0===t?n:o.f(n,t)}},1697:function(e,t,n){"use strict";var r=n(1196),i=n(6056),o=n(1592),a=n(5884),s=n(5770),u=n(8084);t.f=r&&!i?Object.defineProperties:function(e,t){a(e);for(var n,r=s(t),i=u(t),l=i.length,c=0;l>c;)o.f(e,n=i[c++],r[n]);return e}},1592:function(e,t,n){"use strict";var r=n(1196),i=n(6707),o=n(6056),a=n(5884),s=n(4655),u=TypeError,l=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d="enumerable",f="configurable",p="writable";t.f=r?o?function(e,t,n){if(a(e),t=s(t),a(n),"function"===typeof e&&"prototype"===t&&"value"in n&&p in n&&!n[p]){var r=c(e,t);r&&r[p]&&(e[t]=n.value,n={configurable:f in n?n[f]:r[f],enumerable:d in n?n[d]:r[d],writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(a(e),t=s(t),a(n),i)try{return l(e,t,n)}catch(r){}if("get"in n||"set"in n)throw u("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},2573:function(e,t,n){"use strict";var r=n(1196),i=n(8513),o=n(8306),a=n(2037),s=n(5770),u=n(4655),l=n(3013),c=n(6707),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=s(e),t=u(t),c)try{return d(e,t)}catch(n){}if(l(e,t))return a(!i(o.f,e,t),e[t])}},3772:function(e,t,n){"use strict";var r=n(3080),i=n(2080).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},400:function(e,t){"use strict";t.f=Object.getOwnPropertySymbols},8946:function(e,t,n){"use strict";var r=n(4932);e.exports=r({}.isPrototypeOf)},3080:function(e,t,n){"use strict";var r=n(4932),i=n(3013),o=n(5770),a=n(488).indexOf,s=n(6196),u=r([].push);e.exports=function(e,t){var n,r=o(e),l=0,c=[];for(n in r)!i(s,n)&&i(r,n)&&u(c,n);for(;t.length>l;)i(r,n=t[l++])&&(~a(c,n)||u(c,n));return c}},8084:function(e,t,n){"use strict";var r=n(3080),i=n(2080);e.exports=Object.keys||function(e){return r(e,i)}},8306:function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},7772:function(e,t,n){"use strict";var r=n(8513),i=n(9218),o=n(3931),a=TypeError;e.exports=function(e,t){var n,s;if("string"===t&&i(n=e.toString)&&!o(s=r(n,e)))return s;if(i(n=e.valueOf)&&!o(s=r(n,e)))return s;if("string"!==t&&i(n=e.toString)&&!o(s=r(n,e)))return s;throw a("Can't convert object to primitive value")}},7273:function(e,t,n){"use strict";var r=n(1240),i=n(4932),o=n(3772),a=n(400),s=n(5884),u=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(s(e)),n=a.f;return n?u(t,n(e)):t}},2781:function(e,t,n){"use strict";var r=n(8513),i=n(5884),o=n(9218),a=n(2933),s=n(4087),u=TypeError;e.exports=function(e,t){var n=e.exec;if(o(n)){var l=r(n,e,t);return null!==l&&i(l),l}if("RegExp"===a(e))return r(s,e,t);throw u("RegExp#exec called on incompatible receiver")}},4087:function(e,t,n){"use strict";var r=n(8513),i=n(4932),o=n(6124),a=n(7687),s=n(8596),u=n(1778),l=n(4385),c=n(9671).get,d=n(2047),f=n(2063),p=u("native-string-replace",String.prototype.replace),h=RegExp.prototype.exec,v=h,g=i("".charAt),m=i("".indexOf),y=i("".replace),b=i("".slice),w=function(){var e=/a/,t=/b*/g;return r(h,e,"a"),r(h,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),x=s.BROKEN_CARET,k=void 0!==/()??/.exec("")[1];(w||k||x||d||f)&&(v=function(e){var t,n,i,s,u,d,f,S=this,_=c(S),P=o(e),E=_.raw;if(E)return E.lastIndex=S.lastIndex,t=r(v,E,P),S.lastIndex=E.lastIndex,t;var C=_.groups,I=x&&S.sticky,T=r(a,S),M=S.source,j=0,A=P;if(I&&(T=y(T,"y",""),-1===m(T,"g")&&(T+="g"),A=b(P,S.lastIndex),S.lastIndex>0&&(!S.multiline||S.multiline&&"\n"!==g(P,S.lastIndex-1))&&(M="(?: "+M+")",A=" "+A,j++),n=new RegExp("^(?:"+M+")",T)),k&&(n=new RegExp("^"+M+"$(?!\\s)",T)),w&&(i=S.lastIndex),s=r(h,I?n:S,A),I?s?(s.input=b(s.input,j),s[0]=b(s[0],j),s.index=S.lastIndex,S.lastIndex+=s[0].length):S.lastIndex=0:w&&s&&(S.lastIndex=S.global?s.index+s[0].length:i),k&&s&&s.length>1&&r(p,s[0],n,(function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(s[u]=void 0)})),s&&C)for(s.groups=d=l(null),u=0;u<C.length;u++)d[(f=C[u])[0]]=s[f[1]];return s}),e.exports=v},7687:function(e,t,n){"use strict";var r=n(5884);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},8596:function(e,t,n){"use strict";var r=n(2837),i=n(6840).RegExp,o=r((function(){var e=i("a","y");return e.lastIndex=2,null!==e.exec("abcd")})),a=o||r((function(){return!i("a","y").sticky})),s=o||r((function(){var e=i("^r","gy");return e.lastIndex=2,null!==e.exec("str")}));e.exports={BROKEN_CARET:s,MISSED_STICKY:a,UNSUPPORTED_Y:o}},2047:function(e,t,n){"use strict";var r=n(2837),i=n(6840).RegExp;e.exports=r((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},2063:function(e,t,n){"use strict";var r=n(2837),i=n(6840).RegExp;e.exports=r((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},2244:function(e,t,n){"use strict";var r=n(9055),i=TypeError;e.exports=function(e){if(r(e))throw i("Can't call method on "+e);return e}},9378:function(e,t,n){"use strict";var r=n(1778),i=n(6520),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},4460:function(e,t,n){"use strict";var r=n(6840),i=n(9131),o="__core-js_shared__",a=r[o]||i(o,{});e.exports=a},1778:function(e,t,n){"use strict";var r=n(3608),i=n(4460);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.32.2",mode:r?"pure":"global",copyright:"\xa9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.2/LICENSE",source:"https://github.com/zloirock/core-js"})},8424:function(e,t,n){"use strict";var r=n(4932),i=n(2128),o=n(6124),a=n(2244),s=r("".charAt),u=r("".charCodeAt),l=r("".slice),c=function(e){return function(t,n){var r,c,d=o(a(t)),f=i(n),p=d.length;return f<0||f>=p?e?"":void 0:(r=u(d,f))<55296||r>56319||f+1===p||(c=u(d,f+1))<56320||c>57343?e?s(d,f):r:e?l(d,f,f+2):c-56320+(r-55296<<10)+65536}};e.exports={codeAt:c(!1),charAt:c(!0)}},166:function(e,t,n){"use strict";var r=n(5372),i=n(2837),o=n(6840).String;e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol("symbol detection");return!o(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},1823:function(e,t,n){"use strict";var r=n(2128),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},5770:function(e,t,n){"use strict";var r=n(1036),i=n(2244);e.exports=function(e){return r(i(e))}},2128:function(e,t,n){"use strict";var r=n(1246);e.exports=function(e){var t=+e;return t!==t||0===t?0:r(t)}},2347:function(e,t,n){"use strict";var r=n(2128),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},8385:function(e,t,n){"use strict";var r=n(2244),i=Object;e.exports=function(e){return i(r(e))}},6740:function(e,t,n){"use strict";var r=n(8513),i=n(3931),o=n(8287),a=n(3863),s=n(7772),u=n(5028),l=TypeError,c=u("toPrimitive");e.exports=function(e,t){if(!i(e)||o(e))return e;var n,u=a(e,c);if(u){if(void 0===t&&(t="default"),n=r(u,e,t),!i(n)||o(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),s(e,t)}},4655:function(e,t,n){"use strict";var r=n(6740),i=n(8287);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},6042:function(e,t,n){"use strict";var r={};r[n(5028)("toStringTag")]="z",e.exports="[object z]"===String(r)},6124:function(e,t,n){"use strict";var r=n(7205),i=String;e.exports=function(e){if("Symbol"===r(e))throw TypeError("Cannot convert a Symbol value to a string");return i(e)}},1772:function(e){"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(n){return"Object"}}},6520:function(e,t,n){"use strict";var r=n(4932),i=0,o=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+o,36)}},7611:function(e,t,n){"use strict";var r=n(166);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},6056:function(e,t,n){"use strict";var r=n(1196),i=n(2837);e.exports=r&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},1615:function(e,t,n){"use strict";var r=n(6840),i=n(9218),o=r.WeakMap;e.exports=i(o)&&/native code/.test(String(o))},5028:function(e,t,n){"use strict";var r=n(6840),i=n(1778),o=n(3013),a=n(6520),s=n(166),u=n(7611),l=r.Symbol,c=i("wks"),d=u?l.for||l:l&&l.withoutSetter||a;e.exports=function(e){return o(c,e)||(c[e]=s&&o(l,e)?l[e]:d("Symbol."+e)),c[e]}},5470:function(e,t,n){"use strict";var r=n(7768),i=n(8264),o=n(6724),a=n(8385),s=n(3385),u=n(5491);r({target:"Array",proto:!0},{flatMap:function(e){var t,n=a(this),r=s(n);return o(e),(t=u(n,0)).length=i(t,n,n,r,0,1,e,arguments.length>1?arguments[1]:void 0),t}})},8624:function(e,t,n){"use strict";var r=n(7768),i=n(8264),o=n(8385),a=n(3385),s=n(2128),u=n(5491);r({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=o(this),n=a(t),r=u(t,0);return r.length=i(r,t,t,n,0,void 0===e?1:s(e)),r}})},2330:function(e,t,n){"use strict";n(5715)("flatMap")},9743:function(e,t,n){"use strict";n(5715)("flat")},447:function(e,t,n){"use strict";var r=n(7768),i=n(4087);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},4178:function(e,t,n){"use strict";var r=n(6339),i=n(8513),o=n(4932),a=n(8093),s=n(2837),u=n(5884),l=n(9218),c=n(9055),d=n(2128),f=n(2347),p=n(6124),h=n(2244),v=n(5466),g=n(3863),m=n(7794),y=n(2781),b=n(5028)("replace"),w=Math.max,x=Math.min,k=o([].concat),S=o([].push),_=o("".indexOf),P=o("".slice),E="$0"==="a".replace(/./,"$0"),C=!!/./[b]&&""===/./[b]("a","$0");a("replace",(function(e,t,n){var o=C?"$":"$0";return[function(e,n){var r=h(this),o=c(e)?void 0:g(e,b);return o?i(o,e,r,n):i(t,p(r),e,n)},function(e,i){var a=u(this),s=p(e);if("string"==typeof i&&-1===_(i,o)&&-1===_(i,"$<")){var c=n(t,a,s,i);if(c.done)return c.value}var h=l(i);h||(i=p(i));var g,b=a.global;b&&(g=a.unicode,a.lastIndex=0);for(var E,C=[];null!==(E=y(a,s))&&(S(C,E),b);){""===p(E[0])&&(a.lastIndex=v(s,f(a.lastIndex),g))}for(var I,T="",M=0,j=0;j<C.length;j++){for(var A,O=p((E=C[j])[0]),L=w(x(d(E.index),s.length),0),z=[],D=1;D<E.length;D++)S(z,void 0===(I=E[D])?I:String(I));var R=E.groups;if(h){var N=k([O],z,L,s);void 0!==R&&S(N,R),A=p(r(i,void 0,N))}else A=m(O,s,L,z,R,i);L>=M&&(T+=P(s,M,L)+A,M=L+O.length)}return T+P(s,M)}]}),!!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!E||C)},7143:function(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!==typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var u,l,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,o),!0;case 6:return c.fn.call(c.context,t,r,i,o,a),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var f,p=c.length;for(l=0;l<p;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),d){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,r);break;case 4:c[l].fn.call(c[l].context,t,r,i);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];c[l].fn.apply(c[l].context,u)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var u=0,l=[],c=s.length;u<c;u++)(s[u].fn!==t||i&&!s[u].once||r&&s[u].context!==r)&&l.push(s[u]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},2467:function(e,t,n){e=n.nmd(e);var r="__lodash_hash_undefined__",i=1,o=2,a=9007199254740991,s="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",c="[object Boolean]",d="[object Date]",f="[object Error]",p="[object Function]",h="[object GeneratorFunction]",v="[object Map]",g="[object Number]",m="[object Null]",y="[object Object]",b="[object Promise]",w="[object Proxy]",x="[object RegExp]",k="[object Set]",S="[object String]",_="[object Symbol]",P="[object Undefined]",E="[object WeakMap]",C="[object ArrayBuffer]",I="[object DataView]",T=/^\[object .+?Constructor\]$/,M=/^(?:0|[1-9]\d*)$/,j={};j["[object Float32Array]"]=j["[object Float64Array]"]=j["[object Int8Array]"]=j["[object Int16Array]"]=j["[object Int32Array]"]=j["[object Uint8Array]"]=j["[object Uint8ClampedArray]"]=j["[object Uint16Array]"]=j["[object Uint32Array]"]=!0,j[s]=j[u]=j[C]=j[c]=j[I]=j[d]=j[f]=j[p]=j[v]=j[g]=j[y]=j[x]=j[k]=j[S]=j[E]=!1;var A="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,O="object"==typeof self&&self&&self.Object===Object&&self,L=A||O||Function("return this")(),z=t&&!t.nodeType&&t,D=z&&e&&!e.nodeType&&e,R=D&&D.exports===z,N=R&&A.process,B=function(){try{return N&&N.binding&&N.binding("util")}catch(e){}}(),F=B&&B.isTypedArray;function U(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function K(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function V(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var W,H,Y=Array.prototype,X=Function.prototype,q=Object.prototype,$=L["__core-js_shared__"],G=X.toString,Q=q.hasOwnProperty,Z=function(){var e=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),J=q.toString,ee=RegExp("^"+G.call(Q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=R?L.Buffer:void 0,ne=L.Symbol,re=L.Uint8Array,ie=q.propertyIsEnumerable,oe=Y.splice,ae=ne?ne.toStringTag:void 0,se=Object.getOwnPropertySymbols,ue=te?te.isBuffer:void 0,le=(W=Object.keys,H=Object,function(e){return W(H(e))}),ce=Ne(L,"DataView"),de=Ne(L,"Map"),fe=Ne(L,"Promise"),pe=Ne(L,"Set"),he=Ne(L,"WeakMap"),ve=Ne(Object,"create"),ge=Ke(ce),me=Ke(de),ye=Ke(fe),be=Ke(pe),we=Ke(he),xe=ne?ne.prototype:void 0,ke=xe?xe.valueOf:void 0;function Se(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function _e(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Pe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ee(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Pe;++t<n;)this.add(e[t])}function Ce(e){var t=this.__data__=new _e(e);this.size=t.size}function Ie(e,t){var n=He(e),r=!n&&We(e),i=!n&&!r&&Ye(e),o=!n&&!r&&!i&&Qe(e),a=n||r||i||o,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],u=s.length;for(var l in e)!t&&!Q.call(e,l)||a&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Ue(l,u))||s.push(l);return s}function Te(e,t){for(var n=e.length;n--;)if(Ve(e[n][0],t))return n;return-1}function Me(e){return null==e?void 0===e?P:m:ae&&ae in Object(e)?function(e){var t=Q.call(e,ae),n=e[ae];try{e[ae]=void 0;var r=!0}catch(o){}var i=J.call(e);r&&(t?e[ae]=n:delete e[ae]);return i}(e):function(e){return J.call(e)}(e)}function je(e){return Ge(e)&&Me(e)==s}function Ae(e,t,n,r,a){return e===t||(null==e||null==t||!Ge(e)&&!Ge(t)?e!==e&&t!==t:function(e,t,n,r,a,l){var p=He(e),h=He(t),m=p?u:Fe(e),b=h?u:Fe(t),w=(m=m==s?y:m)==y,P=(b=b==s?y:b)==y,E=m==b;if(E&&Ye(e)){if(!Ye(t))return!1;p=!0,w=!1}if(E&&!w)return l||(l=new Ce),p||Qe(e)?ze(e,t,n,r,a,l):function(e,t,n,r,a,s,u){switch(n){case I:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case C:return!(e.byteLength!=t.byteLength||!s(new re(e),new re(t)));case c:case d:case g:return Ve(+e,+t);case f:return e.name==t.name&&e.message==t.message;case x:case S:return e==t+"";case v:var l=K;case k:var p=r&i;if(l||(l=V),e.size!=t.size&&!p)return!1;var h=u.get(e);if(h)return h==t;r|=o,u.set(e,t);var m=ze(l(e),l(t),r,a,s,u);return u.delete(e),m;case _:if(ke)return ke.call(e)==ke.call(t)}return!1}(e,t,m,n,r,a,l);if(!(n&i)){var T=w&&Q.call(e,"__wrapped__"),M=P&&Q.call(t,"__wrapped__");if(T||M){var j=T?e.value():e,A=M?t.value():t;return l||(l=new Ce),a(j,A,n,r,l)}}if(!E)return!1;return l||(l=new Ce),function(e,t,n,r,o,a){var s=n&i,u=De(e),l=u.length,c=De(t),d=c.length;if(l!=d&&!s)return!1;var f=l;for(;f--;){var p=u[f];if(!(s?p in t:Q.call(t,p)))return!1}var h=a.get(e);if(h&&a.get(t))return h==t;var v=!0;a.set(e,t),a.set(t,e);var g=s;for(;++f<l;){var m=e[p=u[f]],y=t[p];if(r)var b=s?r(y,m,p,t,e,a):r(m,y,p,e,t,a);if(!(void 0===b?m===y||o(m,y,n,r,a):b)){v=!1;break}g||(g="constructor"==p)}if(v&&!g){var w=e.constructor,x=t.constructor;w==x||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof x&&x instanceof x||(v=!1)}return a.delete(e),a.delete(t),v}(e,t,n,r,a,l)}(e,t,n,r,Ae,a))}function Oe(e){return!(!$e(e)||function(e){return!!Z&&Z in e}(e))&&(Xe(e)?ee:T).test(Ke(e))}function Le(e){if(!function(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||q;return e===n}(e))return le(e);var t=[];for(var n in Object(e))Q.call(e,n)&&"constructor"!=n&&t.push(n);return t}function ze(e,t,n,r,a,s){var u=n&i,l=e.length,c=t.length;if(l!=c&&!(u&&c>l))return!1;var d=s.get(e);if(d&&s.get(t))return d==t;var f=-1,p=!0,h=n&o?new Ee:void 0;for(s.set(e,t),s.set(t,e);++f<l;){var v=e[f],g=t[f];if(r)var m=u?r(g,v,f,t,e,s):r(v,g,f,e,t,s);if(void 0!==m){if(m)continue;p=!1;break}if(h){if(!U(t,(function(e,t){if(i=t,!h.has(i)&&(v===e||a(v,e,n,r,s)))return h.push(t);var i}))){p=!1;break}}else if(v!==g&&!a(v,g,n,r,s)){p=!1;break}}return s.delete(e),s.delete(t),p}function De(e){return function(e,t,n){var r=t(e);return He(e)?r:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(r,n(e))}(e,Ze,Be)}function Re(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function Ne(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Oe(n)?n:void 0}Se.prototype.clear=function(){this.__data__=ve?ve(null):{},this.size=0},Se.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Se.prototype.get=function(e){var t=this.__data__;if(ve){var n=t[e];return n===r?void 0:n}return Q.call(t,e)?t[e]:void 0},Se.prototype.has=function(e){var t=this.__data__;return ve?void 0!==t[e]:Q.call(t,e)},Se.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ve&&void 0===t?r:t,this},_e.prototype.clear=function(){this.__data__=[],this.size=0},_e.prototype.delete=function(e){var t=this.__data__,n=Te(t,e);return!(n<0)&&(n==t.length-1?t.pop():oe.call(t,n,1),--this.size,!0)},_e.prototype.get=function(e){var t=this.__data__,n=Te(t,e);return n<0?void 0:t[n][1]},_e.prototype.has=function(e){return Te(this.__data__,e)>-1},_e.prototype.set=function(e,t){var n=this.__data__,r=Te(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Pe.prototype.clear=function(){this.size=0,this.__data__={hash:new Se,map:new(de||_e),string:new Se}},Pe.prototype.delete=function(e){var t=Re(this,e).delete(e);return this.size-=t?1:0,t},Pe.prototype.get=function(e){return Re(this,e).get(e)},Pe.prototype.has=function(e){return Re(this,e).has(e)},Pe.prototype.set=function(e,t){var n=Re(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Ee.prototype.add=Ee.prototype.push=function(e){return this.__data__.set(e,r),this},Ee.prototype.has=function(e){return this.__data__.has(e)},Ce.prototype.clear=function(){this.__data__=new _e,this.size=0},Ce.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Ce.prototype.get=function(e){return this.__data__.get(e)},Ce.prototype.has=function(e){return this.__data__.has(e)},Ce.prototype.set=function(e,t){var n=this.__data__;if(n instanceof _e){var r=n.__data__;if(!de||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Pe(r)}return n.set(e,t),this.size=n.size,this};var Be=se?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}(se(e),(function(t){return ie.call(e,t)})))}:function(){return[]},Fe=Me;function Ue(e,t){return!!(t=null==t?a:t)&&("number"==typeof e||M.test(e))&&e>-1&&e%1==0&&e<t}function Ke(e){if(null!=e){try{return G.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Ve(e,t){return e===t||e!==e&&t!==t}(ce&&Fe(new ce(new ArrayBuffer(1)))!=I||de&&Fe(new de)!=v||fe&&Fe(fe.resolve())!=b||pe&&Fe(new pe)!=k||he&&Fe(new he)!=E)&&(Fe=function(e){var t=Me(e),n=t==y?e.constructor:void 0,r=n?Ke(n):"";if(r)switch(r){case ge:return I;case me:return v;case ye:return b;case be:return k;case we:return E}return t});var We=je(function(){return arguments}())?je:function(e){return Ge(e)&&Q.call(e,"callee")&&!ie.call(e,"callee")},He=Array.isArray;var Ye=ue||function(){return!1};function Xe(e){if(!$e(e))return!1;var t=Me(e);return t==p||t==h||t==l||t==w}function qe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}function $e(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ge(e){return null!=e&&"object"==typeof e}var Qe=F?function(e){return function(t){return e(t)}}(F):function(e){return Ge(e)&&qe(e.length)&&!!j[Me(e)]};function Ze(e){return null!=(t=e)&&qe(t.length)&&!Xe(t)?Ie(e):Le(e);var t}e.exports=function(e,t){return Ae(e,t)}},3881:function(e,t,n){var r="Expected a function",i=NaN,o="[object Symbol]",a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt,d="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,f="object"==typeof self&&self&&self.Object===Object&&self,p=d||f||Function("return this")(),h=Object.prototype.toString,v=Math.max,g=Math.min,m=function(){return p.Date.now()};function y(e,t,n){var i,o,a,s,u,l,c=0,d=!1,f=!1,p=!0;if("function"!=typeof e)throw new TypeError(r);function h(t){var n=i,r=o;return i=o=void 0,c=t,s=e.apply(r,n)}function y(e){var n=e-l;return void 0===l||n>=t||n<0||f&&e-c>=a}function x(){var e=m();if(y(e))return k(e);u=setTimeout(x,function(e){var n=t-(e-l);return f?g(n,a-(e-c)):n}(e))}function k(e){return u=void 0,p&&i?h(e):(i=o=void 0,s)}function S(){var e=m(),n=y(e);if(i=arguments,o=this,l=e,n){if(void 0===u)return function(e){return c=e,u=setTimeout(x,t),d?h(e):s}(l);if(f)return u=setTimeout(x,t),h(l)}return void 0===u&&(u=setTimeout(x,t)),s}return t=w(t)||0,b(n)&&(d=!!n.leading,a=(f="maxWait"in n)?v(w(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),S.cancel=function(){void 0!==u&&clearTimeout(u),c=0,i=l=o=u=void 0},S.flush=function(){return void 0===u?s:k(m())},S}function b(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function w(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&h.call(e)==o}(e))return i;if(b(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=b(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=u.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):s.test(e)?i:+e}e.exports=function(e,t,n){var i=!0,o=!0;if("function"!=typeof e)throw new TypeError(r);return b(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),y(e,t,{leading:i,maxWait:t,trailing:o})}},9409:function(e,t,n){var r=200,i="__lodash_hash_undefined__",o="[object Function]",a="[object GeneratorFunction]",s=/^\[object .+?Constructor\]$/,u="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,c=u||l||Function("return this")();function d(e,t){return!!(e?e.length:0)&&function(e,t,n){if(t!==t)return function(e,t,n,r){var i=e.length,o=n+(r?1:-1);for(;r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,p,n);var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,0)>-1}function f(e,t,n){for(var r=-1,i=e?e.length:0;++r<i;)if(n(t,e[r]))return!0;return!1}function p(e){return e!==e}function h(e,t){return e.has(t)}function v(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var g=Array.prototype,m=Function.prototype,y=Object.prototype,b=c["__core-js_shared__"],w=function(){var e=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),x=m.toString,k=y.hasOwnProperty,S=y.toString,_=RegExp("^"+x.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),P=g.splice,E=R(c,"Map"),C=R(c,"Set"),I=R(Object,"create");function T(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function M(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function j(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function A(e){var t=-1,n=e?e.length:0;for(this.__data__=new j;++t<n;)this.add(e[t])}function O(e,t){for(var n,r,i=e.length;i--;)if((n=e[i][0])===(r=t)||n!==n&&r!==r)return i;return-1}function L(e){if(!N(e)||(t=e,w&&w in t))return!1;var t,n=function(e){var t=N(e)?S.call(e):"";return t==o||t==a}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}(e)?_:s;return n.test(function(e){if(null!=e){try{return x.call(e)}catch(t){}try{return e+""}catch(t){}}return""}(e))}T.prototype.clear=function(){this.__data__=I?I(null):{}},T.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},T.prototype.get=function(e){var t=this.__data__;if(I){var n=t[e];return n===i?void 0:n}return k.call(t,e)?t[e]:void 0},T.prototype.has=function(e){var t=this.__data__;return I?void 0!==t[e]:k.call(t,e)},T.prototype.set=function(e,t){return this.__data__[e]=I&&void 0===t?i:t,this},M.prototype.clear=function(){this.__data__=[]},M.prototype.delete=function(e){var t=this.__data__,n=O(t,e);return!(n<0)&&(n==t.length-1?t.pop():P.call(t,n,1),!0)},M.prototype.get=function(e){var t=this.__data__,n=O(t,e);return n<0?void 0:t[n][1]},M.prototype.has=function(e){return O(this.__data__,e)>-1},M.prototype.set=function(e,t){var n=this.__data__,r=O(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},j.prototype.clear=function(){this.__data__={hash:new T,map:new(E||M),string:new T}},j.prototype.delete=function(e){return D(this,e).delete(e)},j.prototype.get=function(e){return D(this,e).get(e)},j.prototype.has=function(e){return D(this,e).has(e)},j.prototype.set=function(e,t){return D(this,e).set(e,t),this},A.prototype.add=A.prototype.push=function(e){return this.__data__.set(e,i),this},A.prototype.has=function(e){return this.__data__.has(e)};var z=C&&1/v(new C([,-0]))[1]==1/0?function(e){return new C(e)}:function(){};function D(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function R(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return L(n)?n:void 0}function N(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return e&&e.length?function(e,t,n){var i=-1,o=d,a=e.length,s=!0,u=[],l=u;if(n)s=!1,o=f;else if(a>=r){var c=t?null:z(e);if(c)return v(c);s=!1,o=h,l=new A}else l=t?[]:u;e:for(;++i<a;){var p=e[i],g=t?t(p):p;if(p=n||0!==p?p:0,s&&g===g){for(var m=l.length;m--;)if(l[m]===g)continue e;t&&l.push(g),u.push(p)}else o(l,g,n)||(l!==u&&l.push(g),u.push(p))}return u}(e):[]}},4235:function(e,t,n){var r,i=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function i(e,t){if(!r[e]){r[e]={};for(var n=0;n<e.length;n++)r[e][e.charAt(n)]=n}return r[e][t]}var o={compressToBase64:function(e){if(null==e)return"";var n=o._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,(function(n){return i(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":o._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:o._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=o.compress(e),n=new Uint8Array(2*t.length),r=0,i=t.length;r<i;r++){var a=t.charCodeAt(r);n[2*r]=a>>>8,n[2*r+1]=a%256}return n},decompressFromUint8Array:function(t){if(null===t||void 0===t)return o.decompress(t);for(var n=new Array(t.length/2),r=0,i=n.length;r<i;r++)n[r]=256*t[2*r]+t[2*r+1];var a=[];return n.forEach((function(t){a.push(e(t))})),o.decompress(a.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":o._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,(function(t){return i(n,e.charAt(t))})))},compress:function(t){return o._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var r,i,o,a={},s={},u="",l="",c="",d=2,f=3,p=2,h=[],v=0,g=0;for(o=0;o<e.length;o+=1)if(u=e.charAt(o),Object.prototype.hasOwnProperty.call(a,u)||(a[u]=f++,s[u]=!0),l=c+u,Object.prototype.hasOwnProperty.call(a,l))c=l;else{if(Object.prototype.hasOwnProperty.call(s,c)){if(c.charCodeAt(0)<256){for(r=0;r<p;r++)v<<=1,g==t-1?(g=0,h.push(n(v)),v=0):g++;for(i=c.charCodeAt(0),r=0;r<8;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1}else{for(i=1,r=0;r<p;r++)v=v<<1|i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i=0;for(i=c.charCodeAt(0),r=0;r<16;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1}0==--d&&(d=Math.pow(2,p),p++),delete s[c]}else for(i=a[c],r=0;r<p;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1;0==--d&&(d=Math.pow(2,p),p++),a[l]=f++,c=String(u)}if(""!==c){if(Object.prototype.hasOwnProperty.call(s,c)){if(c.charCodeAt(0)<256){for(r=0;r<p;r++)v<<=1,g==t-1?(g=0,h.push(n(v)),v=0):g++;for(i=c.charCodeAt(0),r=0;r<8;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1}else{for(i=1,r=0;r<p;r++)v=v<<1|i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i=0;for(i=c.charCodeAt(0),r=0;r<16;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1}0==--d&&(d=Math.pow(2,p),p++),delete s[c]}else for(i=a[c],r=0;r<p;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1;0==--d&&(d=Math.pow(2,p),p++)}for(i=2,r=0;r<p;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1;for(;;){if(v<<=1,g==t-1){h.push(n(v));break}g++}return h.join("")},decompress:function(e){return null==e?"":""==e?null:o._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,r){var i,o,a,s,u,l,c,d=[],f=4,p=4,h=3,v="",g=[],m={val:r(0),position:n,index:1};for(i=0;i<3;i+=1)d[i]=i;for(a=0,u=Math.pow(2,2),l=1;l!=u;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),a|=(s>0?1:0)*l,l<<=1;switch(a){case 0:for(a=0,u=Math.pow(2,8),l=1;l!=u;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),a|=(s>0?1:0)*l,l<<=1;c=e(a);break;case 1:for(a=0,u=Math.pow(2,16),l=1;l!=u;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),a|=(s>0?1:0)*l,l<<=1;c=e(a);break;case 2:return""}for(d[3]=c,o=c,g.push(c);;){if(m.index>t)return"";for(a=0,u=Math.pow(2,h),l=1;l!=u;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),a|=(s>0?1:0)*l,l<<=1;switch(c=a){case 0:for(a=0,u=Math.pow(2,8),l=1;l!=u;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),a|=(s>0?1:0)*l,l<<=1;d[p++]=e(a),c=p-1,f--;break;case 1:for(a=0,u=Math.pow(2,16),l=1;l!=u;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),a|=(s>0?1:0)*l,l<<=1;d[p++]=e(a),c=p-1,f--;break;case 2:return g.join("")}if(0==f&&(f=Math.pow(2,h),h++),d[c])v=d[c];else{if(c!==p)return null;v=o+o.charAt(0)}g.push(v),d[p++]=o+v.charAt(0),o=v,0==--f&&(f=Math.pow(2,h),h++)}}};return o}();void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)},4463:function(e,t,n){"use strict";var r=n(2791),i=n(5296);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function u(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},h={};function v(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(h,e)||!d.call(p,e)&&(f.test(e)?h[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),k=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),C=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function z(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var D,R=Object.assign;function N(e){if(void 0===D)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var B=!1;function F(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var i=l.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var u="\n"+i[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=a&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?N(e):""}function U(e){switch(e.tag){case 5:return N(e.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return e=F(e.type,!1);case 11:return e=F(e.type.render,!1);case 1:return e=F(e.type,!0);default:return""}}function K(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case k:return"Portal";case P:return"Profiler";case _:return"StrictMode";case T:return"Suspense";case M:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case j:return null!==(t=e.displayName||null)?t:K(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return K(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K(t);case 8:return t===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Y(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return R({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function G(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Z(e,t){Q(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return R({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function oe(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ce,de=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function fe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var me=R({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Se=null,_e=null;function Pe(e){if(e=bi(e)){if("function"!==typeof ke)throw Error(o(280));var t=e.stateNode;t&&(t=xi(t),ke(e.stateNode,e.type,t))}}function Ee(e){Se?_e?_e.push(e):_e=[e]:Se=e}function Ce(){if(Se){var e=Se,t=_e;if(_e=Se=null,Pe(e),t)for(e=0;e<t.length;e++)Pe(t[e])}}function Ie(e,t){return e(t)}function Te(){}var Me=!1;function je(e,t,n){if(Me)return e(t,n);Me=!0;try{return Ie(e,t,n)}finally{Me=!1,(null!==Se||null!==_e)&&(Te(),Ce())}}function Ae(e,t){var n=e.stateNode;if(null===n)return null;var r=xi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Oe=!1;if(c)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ce){Oe=!1}function ze(e,t,n,r,i,o,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var De=!1,Re=null,Ne=!1,Be=null,Fe={onError:function(e){De=!0,Re=e}};function Ue(e,t,n,r,i,o,a,s,u){De=!1,Re=null,ze.apply(Fe,arguments)}function Ke(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ke(e)!==e)throw Error(o(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ke(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return We(i),e;if(a===r)return We(i),t;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=a;break}if(u===r){s=!0,r=i,n=a;break}u=u.sibling}if(!s){for(u=a.child;u;){if(u===n){s=!0,n=a,r=i;break}if(u===r){s=!0,r=a,n=i;break}u=u.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?Ye(e):null}function Ye(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ye(e);if(null!==t)return t;e=e.sibling}return null}var Xe=i.unstable_scheduleCallback,qe=i.unstable_cancelCallback,$e=i.unstable_shouldYield,Ge=i.unstable_requestPaint,Qe=i.unstable_now,Ze=i.unstable_getCurrentPriorityLevel,Je=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var lt=64,ct=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~i;0!==s?r=dt(s):0!==(o&=a)&&(r=dt(o))}else 0!==(a=n&~i)?r=dt(a):0!==o&&(r=dt(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,kt,St,_t,Pt,Et=!1,Ct=[],It=null,Tt=null,Mt=null,jt=new Map,At=new Map,Ot=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Mt=null;break;case"pointerover":case"pointerout":jt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":At.delete(t.pointerId)}}function Dt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Rt(e){var t=yi(e.target);if(null!==t){var n=Ke(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Pt(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Nt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Bt(e,t,n){Nt(e)&&n.delete(t)}function Ft(){Et=!1,null!==It&&Nt(It)&&(It=null),null!==Tt&&Nt(Tt)&&(Tt=null),null!==Mt&&Nt(Mt)&&(Mt=null),jt.forEach(Bt),At.forEach(Bt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ft)))}function Kt(e){function t(t){return Ut(t,e)}if(0<Ct.length){Ut(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==It&&Ut(It,e),null!==Tt&&Ut(Tt,e),null!==Mt&&Ut(Mt,e),jt.forEach(t),At.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Rt(n),null===n.blockedOn&&Ot.shift()}var Vt=w.ReactCurrentBatchConfig,Wt=!0;function Ht(e,t,n,r){var i=bt,o=Vt.transition;Vt.transition=null;try{bt=1,Xt(e,t,n,r)}finally{bt=i,Vt.transition=o}}function Yt(e,t,n,r){var i=bt,o=Vt.transition;Vt.transition=null;try{bt=4,Xt(e,t,n,r)}finally{bt=i,Vt.transition=o}}function Xt(e,t,n,r){if(Wt){var i=$t(e,t,n,r);if(null===i)Wr(e,t,r,qt,n),zt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return It=Dt(It,e,t,n,r,i),!0;case"dragenter":return Tt=Dt(Tt,e,t,n,r,i),!0;case"mouseover":return Mt=Dt(Mt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return jt.set(o,Dt(jt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,At.set(o,Dt(At.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(zt(e,r),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var o=bi(i);if(null!==o&&xt(o),null===(o=$t(e,t,n,r))&&Wr(e,t,r,qt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var qt=null;function $t(e,t,n,r){if(qt=null,null!==(e=yi(e=xe(r))))if(null===(t=Ke(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qt=e,null}function Gt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Zt=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=Zt,r=n.length,i="value"in Qt?Qt.value:Qt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return Jt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return R(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,un,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=on(ln),dn=R({},ln,{view:0,detail:0}),fn=on(dn),pn=R({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(an=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=an=0,un=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),hn=on(pn),vn=on(R({},pn,{dataTransfer:0})),gn=on(R({},dn,{relatedTarget:0})),mn=on(R({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=R({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(yn),wn=on(R({},ln,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _n(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function Pn(){return _n}var En=R({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=on(En),In=on(R({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=on(R({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pn})),Mn=on(R({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),jn=R({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),An=on(jn),On=[9,13,27,32],Ln=c&&"CompositionEvent"in window,zn=null;c&&"documentMode"in document&&(zn=document.documentMode);var Dn=c&&"TextEvent"in window&&!zn,Rn=c&&(!Ln||zn&&8<zn&&11>=zn),Nn=String.fromCharCode(32),Bn=!1;function Fn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Kn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Hn(e,t,n,r){Ee(r),0<(t=Yr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Yn=null,Xn=null;function qn(e){Nr(e,0)}function $n(e){if(X(wi(e)))return e}function Gn(e,t){if("change"===e)return t}var Qn=!1;if(c){var Zn;if(c){var Jn="oninput"in document;if(!Jn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Jn="function"===typeof er.oninput}Zn=Jn}else Zn=!1;Qn=Zn&&(!document.documentMode||9<document.documentMode)}function tr(){Yn&&(Yn.detachEvent("onpropertychange",nr),Xn=Yn=null)}function nr(e){if("value"===e.propertyName&&$n(Xn)){var t=[];Hn(t,Xn,e,xe(e)),je(qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Xn=n,(Yn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Xn)}function or(e,t){if("click"===e)return $n(t)}function ar(e,t){if("input"===e||"change"===e)return $n(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=q((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hr(e){var t=fr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=cr(n,o);var a=cr(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,mr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==q(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=Yr(mr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},Sr={},_r={};function Pr(e){if(Sr[e])return Sr[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in _r)return Sr[e]=n[t];return e}c&&(_r=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Er=Pr("animationend"),Cr=Pr("animationiteration"),Ir=Pr("animationstart"),Tr=Pr("transitionend"),Mr=new Map,jr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ar(e,t){Mr.set(e,t),u(t,[e])}for(var Or=0;Or<jr.length;Or++){var Lr=jr[Or];Ar(Lr.toLowerCase(),"on"+(Lr[0].toUpperCase()+Lr.slice(1)))}Ar(Er,"onAnimationEnd"),Ar(Cr,"onAnimationIteration"),Ar(Ir,"onAnimationStart"),Ar("dblclick","onDoubleClick"),Ar("focusin","onFocus"),Ar("focusout","onBlur"),Ar(Tr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dr=new Set("cancel close invalid load scroll toggle".split(" ").concat(zr));function Rr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,s,u,l){if(Ue.apply(this,arguments),De){if(!De)throw Error(o(198));var c=Re;De=!1,Re=null,Ne||(Ne=!0,Be=c)}}(r,t,void 0,e),e.currentTarget=null}function Nr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==o&&i.isPropagationStopped())break e;Rr(i,s,l),o=u}else for(a=0;a<r.length;a++){if(u=(s=r[a]).instance,l=s.currentTarget,s=s.listener,u!==o&&i.isPropagationStopped())break e;Rr(i,s,l),o=u}}}if(Ne)throw e=Be,Ne=!1,Be=null,e}function Br(e,t){var n=t[vi];void 0===n&&(n=t[vi]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function Fr(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Kr(e){if(!e[Ur]){e[Ur]=!0,a.forEach((function(t){"selectionchange"!==t&&(Dr.has(t)||Fr(t,!1,e),Fr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,Fr("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(Gt(t)){case 1:var i=Ht;break;case 4:i=Yt;break;default:i=Xt}n=i.bind(null,t,n,e),i=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var u=a.tag;if((3===u||4===u)&&((u=a.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=yi(s)))return;if(5===(u=a.tag)||6===u){r=o=a;continue e}s=s.parentNode}}r=r.return}je((function(){var r=o,i=xe(n),a=[];e:{var s=Mr.get(e);if(void 0!==s){var u=cn,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=Cn;break;case"focusin":l="focus",u=gn;break;case"focusout":l="blur",u=gn;break;case"beforeblur":case"afterblur":u=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Tn;break;case Er:case Cr:case Ir:u=mn;break;case Tr:u=Mn;break;case"scroll":u=fn;break;case"wheel":u=An;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=In}var c=0!==(4&t),d=!c&&"scroll"===e,f=c?null!==s?s+"Capture":null:s;c=[];for(var p,h=r;null!==h;){var v=(p=h).stateNode;if(5===p.tag&&null!==v&&(p=v,null!==f&&(null!=(v=Ae(h,f))&&c.push(Hr(h,v,p)))),d)break;h=h.return}0<c.length&&(s=new u(s,l,null,n,i),a.push({event:s,listeners:c}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===we||!(l=n.relatedTarget||n.fromElement)||!yi(l)&&!l[hi])&&(u||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(l=(l=n.relatedTarget||n.toElement)?yi(l):null)&&(l!==(d=Ke(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=r),u!==l)){if(c=hn,v="onMouseLeave",f="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(c=In,v="onPointerLeave",f="onPointerEnter",h="pointer"),d=null==u?s:wi(u),p=null==l?s:wi(l),(s=new c(v,h+"leave",u,n,i)).target=d,s.relatedTarget=p,v=null,yi(i)===r&&((c=new c(f,h+"enter",l,n,i)).target=p,c.relatedTarget=d,v=c),d=v,u&&l)e:{for(f=l,h=0,p=c=u;p;p=Xr(p))h++;for(p=0,v=f;v;v=Xr(v))p++;for(;0<h-p;)c=Xr(c),h--;for(;0<p-h;)f=Xr(f),p--;for(;h--;){if(c===f||null!==f&&c===f.alternate)break e;c=Xr(c),f=Xr(f)}c=null}else c=null;null!==u&&qr(a,s,u,c,!1),null!==l&&null!==d&&qr(a,d,l,c,!0)}if("select"===(u=(s=r?wi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var g=Gn;else if(Wn(s))if(Qn)g=ar;else{g=ir;var m=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(e,r))?Hn(a,g,n,i):(m&&m(e,s,r),"focusout"===e&&(m=s._wrapperState)&&m.controlled&&"number"===s.type&&ee(s,"number",s.value)),m=r?wi(r):window,e){case"focusin":(Wn(m)||"true"===m.contentEditable)&&(gr=m,mr=r,yr=null);break;case"focusout":yr=mr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(a,n,i);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":wr(a,n,i)}var y;if(Ln)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Kn?Fn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Rn&&"ko"!==n.locale&&(Kn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Kn&&(y=en()):(Zt="value"in(Qt=i)?Qt.value:Qt.textContent,Kn=!0)),0<(m=Yr(r,b)).length&&(b=new wn(b,e,null,n,i),a.push({event:b,listeners:m}),y?b.data=y:null!==(y=Un(n))&&(b.data=y))),(y=Dn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Bn=!0,Nn);case"textInput":return(e=t.data)===Nn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Kn)return"compositionend"===e||!Ln&&Fn(e,t)?(e=en(),Jt=Zt=Qt=null,Kn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Rn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Yr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=y))}Nr(a,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Yr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Ae(e,n))&&r.unshift(Hr(e,o,i)),null!=(o=Ae(e,t))&&r.push(Hr(e,o,i))),e=e.return}return r}function Xr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function qr(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==l&&(s=l,i?null!=(u=Ae(n,o))&&a.unshift(Hr(n,u,s)):i||null!=(u=Ae(n,o))&&a.push(Hr(n,u,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var $r=/\r\n?/g,Gr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace($r,"\n").replace(Gr,"")}function Zr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(o(425))}function Jr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout((function(){throw e}))}function ui(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Kt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Kt(t)}function li(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ci(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),fi="__reactFiber$"+di,pi="__reactProps$"+di,hi="__reactContainer$"+di,vi="__reactEvents$"+di,gi="__reactListeners$"+di,mi="__reactHandles$"+di;function yi(e){var t=e[fi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[hi]||n[fi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ci(e);null!==e;){if(n=e[fi])return n;e=ci(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[fi]||e[hi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function xi(e){return e[pi]||null}var ki=[],Si=-1;function _i(e){return{current:e}}function Pi(e){0>Si||(e.current=ki[Si],ki[Si]=null,Si--)}function Ei(e,t){Si++,ki[Si]=e.current,e.current=t}var Ci={},Ii=_i(Ci),Ti=_i(!1),Mi=Ci;function ji(e,t){var n=e.type.contextTypes;if(!n)return Ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ai(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oi(){Pi(Ti),Pi(Ii)}function Li(e,t,n){if(Ii.current!==Ci)throw Error(o(168));Ei(Ii,t),Ei(Ti,n)}function zi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,V(e)||"Unknown",i));return R({},n,r)}function Di(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ci,Mi=Ii.current,Ei(Ii,e),Ei(Ti,Ti.current),!0}function Ri(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=zi(e,t,Mi),r.__reactInternalMemoizedMergedChildContext=e,Pi(Ti),Pi(Ii),Ei(Ii,e)):Pi(Ti),Ei(Ti,n)}var Ni=null,Bi=!1,Fi=!1;function Ui(e){null===Ni?Ni=[e]:Ni.push(e)}function Ki(){if(!Fi&&null!==Ni){Fi=!0;var e=0,t=bt;try{var n=Ni;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ni=null,Bi=!1}catch(i){throw null!==Ni&&(Ni=Ni.slice(e+1)),Xe(Je,Ki),i}finally{bt=t,Fi=!1}}return null}var Vi=[],Wi=0,Hi=null,Yi=0,Xi=[],qi=0,$i=null,Gi=1,Qi="";function Zi(e,t){Vi[Wi++]=Yi,Vi[Wi++]=Hi,Hi=e,Yi=t}function Ji(e,t,n){Xi[qi++]=Gi,Xi[qi++]=Qi,Xi[qi++]=$i,$i=e;var r=Gi;e=Qi;var i=32-at(r)-1;r&=~(1<<i),n+=1;var o=32-at(t)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Gi=1<<32-at(t)+i|n<<i|r,Qi=o+e}else Gi=1<<o|n<<i|r,Qi=e}function eo(e){null!==e.return&&(Zi(e,1),Ji(e,1,0))}function to(e){for(;e===Hi;)Hi=Vi[--Wi],Vi[Wi]=null,Yi=Vi[--Wi],Vi[Wi]=null;for(;e===$i;)$i=Xi[--qi],Xi[qi]=null,Qi=Xi[--qi],Xi[qi]=null,Gi=Xi[--qi],Xi[qi]=null}var no=null,ro=null,io=!1,oo=null;function ao(e,t){var n=Al(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function so(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=li(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$i?{id:Gi,overflow:Qi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Al(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function uo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function lo(e){if(io){var t=ro;if(t){var n=t;if(!so(e,t)){if(uo(e))throw Error(o(418));t=li(n.nextSibling);var r=no;t&&so(e,t)?ao(r,n):(e.flags=-4097&e.flags|2,io=!1,no=e)}}else{if(uo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,no=e}}}function co(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function fo(e){if(e!==no)return!1;if(!io)return co(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ro)){if(uo(e))throw po(),Error(o(418));for(;t;)ao(e,t),t=li(t.nextSibling)}if(co(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=li(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?li(e.stateNode.nextSibling):null;return!0}function po(){for(var e=ro;e;)e=li(e.nextSibling)}function ho(){ro=no=null,io=!1}function vo(e){null===oo?oo=[e]:oo.push(e)}var go=w.ReactCurrentBatchConfig;function mo(e,t){if(e&&e.defaultProps){for(var n in t=R({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var yo=_i(null),bo=null,wo=null,xo=null;function ko(){xo=wo=bo=null}function So(e){var t=yo.current;Pi(yo),e._currentValue=t}function _o(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Po(e,t){bo=e,xo=wo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ws=!0),e.firstContext=null)}function Eo(e){var t=e._currentValue;if(xo!==e)if(e={context:e,memoizedValue:t,next:null},null===wo){if(null===bo)throw Error(o(308));wo=e,bo.dependencies={lanes:0,firstContext:e}}else wo=wo.next=e;return t}var Co=null;function Io(e){null===Co?Co=[e]:Co.push(e)}function To(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Io(t)):(n.next=i.next,i.next=n),t.interleaved=n,Mo(e,r)}function Mo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var jo=!1;function Ao(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Lo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Tu)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Mo(e,n)}return null===(i=r.interleaved)?(t.next=t,Io(r)):(t.next=i.next,i.next=t),r.interleaved=t,Mo(e,n)}function Do(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Ro(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function No(e,t,n,r){var i=e.updateQueue;jo=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var u=s,l=u.next;u.next=null,null===a?o=l:a.next=l,a=u;var c=e.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==a&&(null===s?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(null!==o){var d=i.baseState;for(a=0,c=l=u=null,s=o;;){var f=s.lane,p=s.eventTime;if((r&f)===f){null!==c&&(c=c.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=e,v=s;switch(f=t,p=n,v.tag){case 1:if("function"===typeof(h=v.payload)){d=h.call(p,d,f);break e}d=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(f="function"===typeof(h=v.payload)?h.call(p,d,f):h)||void 0===f)break e;d=R({},d,f);break e;case 2:jo=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(f=i.effects)?i.effects=[s]:f.push(s))}else p={eventTime:p,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(l=c=p,u=d):c=c.next=p,a|=f;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(f=s).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}if(null===c&&(u=d),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Ru|=a,e.lanes=a,e.memoizedState=d}}function Bo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var Fo=(new r.Component).refs;function Uo(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:R({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Ko={isMounted:function(e){return!!(e=e._reactInternals)&&Ke(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tl(),i=nl(e),o=Lo(r,i);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,i))&&(rl(t,e,i,r),Do(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tl(),i=nl(e),o=Lo(r,i);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,i))&&(rl(t,e,i,r),Do(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tl(),r=nl(e),i=Lo(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=zo(e,i,r))&&(rl(t,e,r,n),Do(t,e,r))}};function Vo(e,t,n,r,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(i,o))}function Wo(e,t,n){var r=!1,i=Ci,o=t.contextType;return"object"===typeof o&&null!==o?o=Eo(o):(i=Ai(t)?Mi:Ii.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?ji(e,i):Ci),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ko,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Ho(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ko.enqueueReplaceState(t,t.state,null)}function Yo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Fo,Ao(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=Eo(o):(o=Ai(t)?Mi:Ii.current,i.context=ji(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(Uo(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Ko.enqueueReplaceState(i,i.state,null),No(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Xo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;t===Fo&&(t=i.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function qo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function $o(e){return(0,e._init)(e._payload)}function Go(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Ll(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Nl(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){var o=n.type;return o===S?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===A&&$o(o)===t.type)?((r=i(t,n.props)).ref=Xo(e,t,n),r.return=e,r):((r=zl(n.type,n.key,n.props,null,e.mode,r)).ref=Xo(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Dl(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Nl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=zl(t.type,t.key,t.props,null,e.mode,n)).ref=Xo(e,null,t),n.return=e,n;case k:return(t=Bl(t,e.mode,n)).return=e,t;case A:return f(e,(0,t._init)(t._payload),n)}if(te(t)||z(t))return(t=Dl(t,e.mode,n,null)).return=e,t;qo(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===i?l(e,t,n,r):null;case k:return n.key===i?c(e,t,n,r):null;case A:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||z(n))return null!==i?null:d(e,t,n,r,null);qo(e,n)}return null}function h(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case k:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case A:return h(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||z(r))return d(t,e=e.get(n)||null,r,i,null);qo(t,r)}return null}function v(i,o,s,u){for(var l=null,c=null,d=o,v=o=0,g=null;null!==d&&v<s.length;v++){d.index>v?(g=d,d=null):g=d.sibling;var m=p(i,d,s[v],u);if(null===m){null===d&&(d=g);break}e&&d&&null===m.alternate&&t(i,d),o=a(m,o,v),null===c?l=m:c.sibling=m,c=m,d=g}if(v===s.length)return n(i,d),io&&Zi(i,v),l;if(null===d){for(;v<s.length;v++)null!==(d=f(i,s[v],u))&&(o=a(d,o,v),null===c?l=d:c.sibling=d,c=d);return io&&Zi(i,v),l}for(d=r(i,d);v<s.length;v++)null!==(g=h(d,i,v,s[v],u))&&(e&&null!==g.alternate&&d.delete(null===g.key?v:g.key),o=a(g,o,v),null===c?l=g:c.sibling=g,c=g);return e&&d.forEach((function(e){return t(i,e)})),io&&Zi(i,v),l}function g(i,s,u,l){var c=z(u);if("function"!==typeof c)throw Error(o(150));if(null==(u=c.call(u)))throw Error(o(151));for(var d=c=null,v=s,g=s=0,m=null,y=u.next();null!==v&&!y.done;g++,y=u.next()){v.index>g?(m=v,v=null):m=v.sibling;var b=p(i,v,y.value,l);if(null===b){null===v&&(v=m);break}e&&v&&null===b.alternate&&t(i,v),s=a(b,s,g),null===d?c=b:d.sibling=b,d=b,v=m}if(y.done)return n(i,v),io&&Zi(i,g),c;if(null===v){for(;!y.done;g++,y=u.next())null!==(y=f(i,y.value,l))&&(s=a(y,s,g),null===d?c=y:d.sibling=y,d=y);return io&&Zi(i,g),c}for(v=r(i,v);!y.done;g++,y=u.next())null!==(y=h(v,i,g,y.value,l))&&(e&&null!==y.alternate&&v.delete(null===y.key?g:y.key),s=a(y,s,g),null===d?c=y:d.sibling=y,d=y);return e&&v.forEach((function(e){return t(i,e)})),io&&Zi(i,g),c}return function e(r,o,a,u){if("object"===typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case x:e:{for(var l=a.key,c=o;null!==c;){if(c.key===l){if((l=a.type)===S){if(7===c.tag){n(r,c.sibling),(o=i(c,a.props.children)).return=r,r=o;break e}}else if(c.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===A&&$o(l)===c.type){n(r,c.sibling),(o=i(c,a.props)).ref=Xo(r,c,a),o.return=r,r=o;break e}n(r,c);break}t(r,c),c=c.sibling}a.type===S?((o=Dl(a.props.children,r.mode,u,a.key)).return=r,r=o):((u=zl(a.type,a.key,a.props,null,r.mode,u)).ref=Xo(r,o,a),u.return=r,r=u)}return s(r);case k:e:{for(c=a.key;null!==o;){if(o.key===c){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(r,o.sibling),(o=i(o,a.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Bl(a,r.mode,u)).return=r,r=o}return s(r);case A:return e(r,o,(c=a._init)(a._payload),u)}if(te(a))return v(r,o,a,u);if(z(a))return g(r,o,a,u);qo(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,a)).return=r,r=o):(n(r,o),(o=Nl(a,r.mode,u)).return=r,r=o),s(r)):n(r,o)}}var Qo=Go(!0),Zo=Go(!1),Jo={},ea=_i(Jo),ta=_i(Jo),na=_i(Jo);function ra(e){if(e===Jo)throw Error(o(174));return e}function ia(e,t){switch(Ei(na,t),Ei(ta,e),Ei(ea,Jo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Pi(ea),Ei(ea,t)}function oa(){Pi(ea),Pi(ta),Pi(na)}function aa(e){ra(na.current);var t=ra(ea.current),n=ue(t,e.type);t!==n&&(Ei(ta,e),Ei(ea,n))}function sa(e){ta.current===e&&(Pi(ea),Pi(ta))}var ua=_i(0);function la(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ca=[];function da(){for(var e=0;e<ca.length;e++)ca[e]._workInProgressVersionPrimary=null;ca.length=0}var fa=w.ReactCurrentDispatcher,pa=w.ReactCurrentBatchConfig,ha=0,va=null,ga=null,ma=null,ya=!1,ba=!1,wa=0,xa=0;function ka(){throw Error(o(321))}function Sa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function _a(e,t,n,r,i,a){if(ha=a,va=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fa.current=null===e||null===e.memoizedState?ss:us,e=n(r,i),ba){a=0;do{if(ba=!1,wa=0,25<=a)throw Error(o(301));a+=1,ma=ga=null,t.updateQueue=null,fa.current=ls,e=n(r,i)}while(ba)}if(fa.current=as,t=null!==ga&&null!==ga.next,ha=0,ma=ga=va=null,ya=!1,t)throw Error(o(300));return e}function Pa(){var e=0!==wa;return wa=0,e}function Ea(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ma?va.memoizedState=ma=e:ma=ma.next=e,ma}function Ca(){if(null===ga){var e=va.alternate;e=null!==e?e.memoizedState:null}else e=ga.next;var t=null===ma?va.memoizedState:ma.next;if(null!==t)ma=t,ga=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ga=e).memoizedState,baseState:ga.baseState,baseQueue:ga.baseQueue,queue:ga.queue,next:null},null===ma?va.memoizedState=ma=e:ma=ma.next=e}return ma}function Ia(e,t){return"function"===typeof t?t(e):t}function Ta(e){var t=Ca(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=ga,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var u=s=null,l=null,c=a;do{var d=c.lane;if((ha&d)===d)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(u=l=f,s=r):l=l.next=f,va.lanes|=d,Ru|=d}c=c.next}while(null!==c&&c!==a);null===l?s=r:l.next=u,sr(r,t.memoizedState)||(ws=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,va.lanes|=a,Ru|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ma(e){var t=Ca(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);sr(a,t.memoizedState)||(ws=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function ja(){}function Aa(e,t){var n=va,r=Ca(),i=t(),a=!sr(r.memoizedState,i);if(a&&(r.memoizedState=i,ws=!0),r=r.queue,Wa(za.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ma&&1&ma.memoizedState.tag){if(n.flags|=2048,Ba(9,La.bind(null,n,r,i,t),void 0,null),null===Mu)throw Error(o(349));0!==(30&ha)||Oa(n,t,i)}return i}function Oa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=va.updateQueue)?(t={lastEffect:null,stores:null},va.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function La(e,t,n,r){t.value=n,t.getSnapshot=r,Da(t)&&Ra(e)}function za(e,t,n){return n((function(){Da(t)&&Ra(e)}))}function Da(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Ra(e){var t=Mo(e,1);null!==t&&rl(t,e,1,-1)}function Na(e){var t=Ea();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,va,e),[t.memoizedState,e]}function Ba(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=va.updateQueue)?(t={lastEffect:null,stores:null},va.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fa(){return Ca().memoizedState}function Ua(e,t,n,r){var i=Ea();va.flags|=e,i.memoizedState=Ba(1|t,n,void 0,void 0===r?null:r)}function Ka(e,t,n,r){var i=Ca();r=void 0===r?null:r;var o=void 0;if(null!==ga){var a=ga.memoizedState;if(o=a.destroy,null!==r&&Sa(r,a.deps))return void(i.memoizedState=Ba(t,n,o,r))}va.flags|=e,i.memoizedState=Ba(1|t,n,o,r)}function Va(e,t){return Ua(8390656,8,e,t)}function Wa(e,t){return Ka(2048,8,e,t)}function Ha(e,t){return Ka(4,2,e,t)}function Ya(e,t){return Ka(4,4,e,t)}function Xa(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qa(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ka(4,4,Xa.bind(null,t,e),n)}function $a(){}function Ga(e,t){var n=Ca();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Sa(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Qa(e,t){var n=Ca();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Sa(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Za(e,t,n){return 0===(21&ha)?(e.baseState&&(e.baseState=!1,ws=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),va.lanes|=n,Ru|=n,e.baseState=!0),t)}function Ja(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=pa.transition;pa.transition={};try{e(!1),t()}finally{bt=n,pa.transition=r}}function es(){return Ca().memoizedState}function ts(e,t,n){var r=nl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))is(t,n);else if(null!==(n=To(e,t,n,r))){rl(n,e,r,tl()),os(n,t,r)}}function ns(e,t,n){var r=nl(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))is(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,a)){var u=t.interleaved;return null===u?(i.next=i,Io(t)):(i.next=u.next,u.next=i),void(t.interleaved=i)}}catch(l){}null!==(n=To(e,t,i,r))&&(rl(n,e,r,i=tl()),os(n,t,r))}}function rs(e){var t=e.alternate;return e===va||null!==t&&t===va}function is(e,t){ba=ya=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function os(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var as={readContext:Eo,useCallback:ka,useContext:ka,useEffect:ka,useImperativeHandle:ka,useInsertionEffect:ka,useLayoutEffect:ka,useMemo:ka,useReducer:ka,useRef:ka,useState:ka,useDebugValue:ka,useDeferredValue:ka,useTransition:ka,useMutableSource:ka,useSyncExternalStore:ka,useId:ka,unstable_isNewReconciler:!1},ss={readContext:Eo,useCallback:function(e,t){return Ea().memoizedState=[e,void 0===t?null:t],e},useContext:Eo,useEffect:Va,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ua(4194308,4,Xa.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ua(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ua(4,2,e,t)},useMemo:function(e,t){var n=Ea();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ea();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,va,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ea().memoizedState=e},useState:Na,useDebugValue:$a,useDeferredValue:function(e){return Ea().memoizedState=e},useTransition:function(){var e=Na(!1),t=e[0];return e=Ja.bind(null,e[1]),Ea().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=va,i=Ea();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Mu)throw Error(o(349));0!==(30&ha)||Oa(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Va(za.bind(null,r,a,e),[e]),r.flags|=2048,Ba(9,La.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=Ea(),t=Mu.identifierPrefix;if(io){var n=Qi;t=":"+t+"R"+(n=(Gi&~(1<<32-at(Gi)-1)).toString(32)+n),0<(n=wa++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=xa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:Eo,useCallback:Ga,useContext:Eo,useEffect:Wa,useImperativeHandle:qa,useInsertionEffect:Ha,useLayoutEffect:Ya,useMemo:Qa,useReducer:Ta,useRef:Fa,useState:function(){return Ta(Ia)},useDebugValue:$a,useDeferredValue:function(e){return Za(Ca(),ga.memoizedState,e)},useTransition:function(){return[Ta(Ia)[0],Ca().memoizedState]},useMutableSource:ja,useSyncExternalStore:Aa,useId:es,unstable_isNewReconciler:!1},ls={readContext:Eo,useCallback:Ga,useContext:Eo,useEffect:Wa,useImperativeHandle:qa,useInsertionEffect:Ha,useLayoutEffect:Ya,useMemo:Qa,useReducer:Ma,useRef:Fa,useState:function(){return Ma(Ia)},useDebugValue:$a,useDeferredValue:function(e){var t=Ca();return null===ga?t.memoizedState=e:Za(t,ga.memoizedState,e)},useTransition:function(){return[Ma(Ia)[0],Ca().memoizedState]},useMutableSource:ja,useSyncExternalStore:Aa,useId:es,unstable_isNewReconciler:!1};function cs(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function ds(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function fs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ps="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,n){(n=Lo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hu||(Hu=!0,Yu=r),fs(0,t)},n}function vs(e,t,n){(n=Lo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){fs(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){fs(0,t),"function"!==typeof r&&(null===Xu?Xu=new Set([this]):Xu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function gs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ps;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=El.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Lo(-1,1)).tag=2,zo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var bs=w.ReactCurrentOwner,ws=!1;function xs(e,t,n,r){t.child=null===e?Zo(t,null,n,r):Qo(t,e.child,n,r)}function ks(e,t,n,r,i){n=n.render;var o=t.ref;return Po(t,i),r=_a(e,t,n,r,o,i),n=Pa(),null===e||ws?(io&&n&&eo(t),t.flags|=1,xs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hs(e,t,i))}function Ss(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Ol(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=zl(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,_s(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(a,r)&&e.ref===t.ref)return Hs(e,t,i)}return t.flags|=1,(e=Ll(o,r)).ref=t.ref,e.return=t,t.child=e}function _s(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(ur(o,r)&&e.ref===t.ref){if(ws=!1,t.pendingProps=r=o,0===(e.lanes&i))return t.lanes=e.lanes,Hs(e,t,i);0!==(131072&e.flags)&&(ws=!0)}}return Cs(e,t,n,r,i)}function Ps(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ei(Lu,Ou),Ou|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ei(Lu,Ou),Ou|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Ei(Lu,Ou),Ou|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ei(Lu,Ou),Ou|=r;return xs(e,t,i,n),t.child}function Es(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cs(e,t,n,r,i){var o=Ai(n)?Mi:Ii.current;return o=ji(t,o),Po(t,i),n=_a(e,t,n,r,o,i),r=Pa(),null===e||ws?(io&&r&&eo(t),t.flags|=1,xs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hs(e,t,i))}function Is(e,t,n,r,i){if(Ai(n)){var o=!0;Di(t)}else o=!1;if(Po(t,i),null===t.stateNode)Ws(e,t),Wo(t,n,r),Yo(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,l=n.contextType;"object"===typeof l&&null!==l?l=Eo(l):l=ji(t,l=Ai(n)?Mi:Ii.current);var c=n.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||u!==l)&&Ho(t,a,r,l),jo=!1;var f=t.memoizedState;a.state=f,No(t,r,a,i),u=t.memoizedState,s!==r||f!==u||Ti.current||jo?("function"===typeof c&&(Uo(t,n,c,r),u=t.memoizedState),(s=jo||Vo(t,n,s,r,f,u,l))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Oo(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:mo(t.type,s),a.props=l,d=t.pendingProps,f=a.context,"object"===typeof(u=n.contextType)&&null!==u?u=Eo(u):u=ji(t,u=Ai(n)?Mi:Ii.current);var p=n.getDerivedStateFromProps;(c="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==d||f!==u)&&Ho(t,a,r,u),jo=!1,f=t.memoizedState,a.state=f,No(t,r,a,i);var h=t.memoizedState;s!==d||f!==h||Ti.current||jo?("function"===typeof p&&(Uo(t,n,p,r),h=t.memoizedState),(l=jo||Vo(t,n,l,r,f,h,u)||!1)?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,h,u),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,h,u)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=h),a.props=r,a.state=h,a.context=u,r=l):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Ts(e,t,n,r,o,i)}function Ts(e,t,n,r,i,o){Es(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&Ri(t,n,!1),Hs(e,t,o);r=t.stateNode,bs.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=Qo(t,e.child,null,o),t.child=Qo(t,null,s,o)):xs(e,t,s,o),t.memoizedState=r.state,i&&Ri(t,n,!0),t.child}function Ms(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),ia(e,t.containerInfo)}function js(e,t,n,r,i){return ho(),vo(i),t.flags|=256,xs(e,t,n,r),t.child}var As,Os,Ls,zs,Ds={dehydrated:null,treeContext:null,retryLane:0};function Rs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ns(e,t,n){var r,i=t.pendingProps,a=ua.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ei(ua,1&a),null===e)return lo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=i.children,e=i.fallback,s?(i=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Rl(u,i,0,null),e=Dl(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Rs(n),t.memoizedState=Ds,e):Bs(t,u));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,s){if(n)return 256&t.flags?(t.flags&=-257,Fs(e,t,s,r=ds(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Rl({mode:"visible",children:r.children},i,0,null),(a=Dl(a,i,s,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&Qo(t,e.child,null,s),t.child.memoizedState=Rs(s),t.memoizedState=Ds,a);if(0===(1&t.mode))return Fs(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var u=r.dgst;return r=u,Fs(e,t,s,r=ds(a=Error(o(419)),r,void 0))}if(u=0!==(s&e.childLanes),ws||u){if(null!==(r=Mu)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Mo(e,i),rl(r,e,i,-1))}return gl(),Fs(e,t,s,r=ds(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Il.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,ro=li(i.nextSibling),no=t,io=!0,oo=null,null!==e&&(Xi[qi++]=Gi,Xi[qi++]=Qi,Xi[qi++]=$i,Gi=e.id,Qi=e.overflow,$i=t),t=Bs(t,r.children),t.flags|=4096,t)}(e,t,u,i,r,a,n);if(s){s=i.fallback,u=t.mode,r=(a=e.child).sibling;var l={mode:"hidden",children:i.children};return 0===(1&u)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=l,t.deletions=null):(i=Ll(a,l)).subtreeFlags=14680064&a.subtreeFlags,null!==r?s=Ll(r,s):(s=Dl(s,u,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,u=null===(u=e.child.memoizedState)?Rs(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Ds,i}return e=(s=e.child).sibling,i=Ll(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Bs(e,t){return(t=Rl({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Fs(e,t,n,r){return null!==r&&vo(r),Qo(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Us(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),_o(e.return,t,n)}function Ks(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Vs(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(xs(e,t,r.children,n),0!==(2&(r=ua.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Us(e,n,t);else if(19===e.tag)Us(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ei(ua,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===la(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ks(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===la(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ks(t,!0,n,null,o);break;case"together":Ks(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ws(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ru|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Ll(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ll(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ys(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Xs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function qs(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xs(t),null;case 1:case 17:return Ai(t.type)&&Oi(),Xs(t),null;case 3:return r=t.stateNode,oa(),Pi(Ti),Pi(Ii),da(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(fo(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(sl(oo),oo=null))),Os(e,t),Xs(t),null;case 5:sa(t);var i=ra(na.current);if(n=t.type,null!==e&&null!=t.stateNode)Ls(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Xs(t),null}if(e=ra(ea.current),fo(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[fi]=t,r[pi]=a,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(i=0;i<zr.length;i++)Br(zr[i],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":G(r,a),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Br("invalid",r);break;case"textarea":ie(r,a),Br("invalid",r)}for(var u in ye(n,a),i=null,a)if(a.hasOwnProperty(u)){var l=a[u];"children"===u?"string"===typeof l?r.textContent!==l&&(!0!==a.suppressHydrationWarning&&Zr(r.textContent,l,e),i=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==a.suppressHydrationWarning&&Zr(r.textContent,l,e),i=["children",""+l]):s.hasOwnProperty(u)&&null!=l&&"onScroll"===u&&Br("scroll",r)}switch(n){case"input":Y(r),J(r,a,!0);break;case"textarea":Y(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Jr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[fi]=t,e[pi]=r,As(e,t,!1,!1),t.stateNode=e;e:{switch(u=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),i=r;break;case"iframe":case"object":case"embed":Br("load",e),i=r;break;case"video":case"audio":for(i=0;i<zr.length;i++)Br(zr[i],e);i=r;break;case"source":Br("error",e),i=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),i=r;break;case"details":Br("toggle",e),i=r;break;case"input":G(e,r),i=$(e,r),Br("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=R({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Br("invalid",e)}for(a in ye(n,i),l=i)if(l.hasOwnProperty(a)){var c=l[a];"style"===a?ge(e,c):"dangerouslySetInnerHTML"===a?null!=(c=c?c.__html:void 0)&&de(e,c):"children"===a?"string"===typeof c?("textarea"!==n||""!==c)&&fe(e,c):"number"===typeof c&&fe(e,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=c&&"onScroll"===a&&Br("scroll",e):null!=c&&b(e,a,c,u))}switch(n){case"input":Y(e),J(e,r,!1);break;case"textarea":Y(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Xs(t),null;case 6:if(e&&null!=t.stateNode)zs(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=ra(na.current),ra(ea.current),fo(t)){if(r=t.stateNode,n=t.memoizedProps,r[fi]=t,(a=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Zr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fi]=t,t.stateNode=r}return Xs(t),null;case 13:if(Pi(ua),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))po(),ho(),t.flags|=98560,a=!1;else if(a=fo(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[fi]=t}else ho(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Xs(t),a=!1}else null!==oo&&(sl(oo),oo=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ua.current)?0===zu&&(zu=3):gl())),null!==t.updateQueue&&(t.flags|=4),Xs(t),null);case 4:return oa(),Os(e,t),null===e&&Kr(t.stateNode.containerInfo),Xs(t),null;case 10:return So(t.type._context),Xs(t),null;case 19:if(Pi(ua),null===(a=t.memoizedState))return Xs(t),null;if(r=0!==(128&t.flags),null===(u=a.rendering))if(r)Ys(a,!1);else{if(0!==zu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=la(e))){for(t.flags|=128,Ys(a,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(u=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,e=u.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ei(ua,1&ua.current|2),t.child}e=e.sibling}null!==a.tail&&Qe()>Vu&&(t.flags|=128,r=!0,Ys(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=la(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ys(a,!0),null===a.tail&&"hidden"===a.tailMode&&!u.alternate&&!io)return Xs(t),null}else 2*Qe()-a.renderingStartTime>Vu&&1073741824!==n&&(t.flags|=128,r=!0,Ys(a,!1),t.lanes=4194304);a.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=a.last)?n.sibling=u:t.child=u,a.last=u)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Qe(),t.sibling=null,n=ua.current,Ei(ua,r?1&n|2:1&n),t):(Xs(t),null);case 22:case 23:return fl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ou)&&(Xs(t),6&t.subtreeFlags&&(t.flags|=8192)):Xs(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function $s(e,t){switch(to(t),t.tag){case 1:return Ai(t.type)&&Oi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return oa(),Pi(Ti),Pi(Ii),da(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return sa(t),null;case 13:if(Pi(ua),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));ho()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Pi(ua),null;case 4:return oa(),null;case 10:return So(t.type._context),null;case 22:case 23:return fl(),null;default:return null}}As=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Os=function(){},Ls=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,ra(ea.current);var o,a=null;switch(n){case"input":i=$(e,i),r=$(e,r),a=[];break;case"select":i=R({},i,{value:void 0}),r=R({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Jr)}for(c in ye(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var u=i[c];for(o in u)u.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in r){var l=r[c];if(u=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&l!==u&&(null!=l||null!=u))if("style"===c)if(u){for(o in u)!u.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&u[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(a||(a=[]),a.push(c,n)),n=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,u=u?u.__html:void 0,null!=l&&u!==l&&(a=a||[]).push(c,l)):"children"===c?"string"!==typeof l&&"number"!==typeof l||(a=a||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&Br("scroll",e),a||u===l||(a=[])):(a=a||[]).push(c,l))}n&&(a=a||[]).push("style",n);var c=a;(t.updateQueue=c)&&(t.flags|=4)}},zs=function(e,t,n,r){n!==r&&(t.flags|=4)};var Gs=!1,Qs=!1,Zs="function"===typeof WeakSet?WeakSet:Set,Js=null;function eu(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Pl(e,t,r)}else n.current=null}function tu(e,t,n){try{n()}catch(r){Pl(e,t,r)}}var nu=!1;function ru(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&tu(t,n,o)}i=i.next}while(i!==r)}}function iu(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ou(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function au(e){var t=e.alternate;null!==t&&(e.alternate=null,au(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fi],delete t[pi],delete t[vi],delete t[gi],delete t[mi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function su(e){return 5===e.tag||3===e.tag||4===e.tag}function uu(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||su(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(lu(e,t,n),e=e.sibling;null!==e;)lu(e,t,n),e=e.sibling}function cu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cu(e,t,n),e=e.sibling;null!==e;)cu(e,t,n),e=e.sibling}var du=null,fu=!1;function pu(e,t,n){for(n=n.child;null!==n;)hu(e,t,n),n=n.sibling}function hu(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:Qs||eu(n,t);case 6:var r=du,i=fu;du=null,pu(e,t,n),fu=i,null!==(du=r)&&(fu?(e=du,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):du.removeChild(n.stateNode));break;case 18:null!==du&&(fu?(e=du,n=n.stateNode,8===e.nodeType?ui(e.parentNode,n):1===e.nodeType&&ui(e,n),Kt(e)):ui(du,n.stateNode));break;case 4:r=du,i=fu,du=n.stateNode.containerInfo,fu=!0,pu(e,t,n),du=r,fu=i;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&tu(n,t,a),i=i.next}while(i!==r)}pu(e,t,n);break;case 1:if(!Qs&&(eu(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Pl(n,t,s)}pu(e,t,n);break;case 21:pu(e,t,n);break;case 22:1&n.mode?(Qs=(r=Qs)||null!==n.memoizedState,pu(e,t,n),Qs=r):pu(e,t,n);break;default:pu(e,t,n)}}function vu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Zs),t.forEach((function(t){var r=Tl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:du=u.stateNode,fu=!1;break e;case 3:case 4:du=u.stateNode.containerInfo,fu=!0;break e}u=u.return}if(null===du)throw Error(o(160));hu(a,s,i),du=null,fu=!1;var l=i.alternate;null!==l&&(l.return=null),i.return=null}catch(c){Pl(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mu(t,e),t=t.sibling}function mu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gu(t,e),yu(e),4&r){try{ru(3,e,e.return),iu(3,e)}catch(g){Pl(e,e.return,g)}try{ru(5,e,e.return)}catch(g){Pl(e,e.return,g)}}break;case 1:gu(t,e),yu(e),512&r&&null!==n&&eu(n,n.return);break;case 5:if(gu(t,e),yu(e),512&r&&null!==n&&eu(n,n.return),32&e.flags){var i=e.stateNode;try{fe(i,"")}catch(g){Pl(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,u=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===u&&"radio"===a.type&&null!=a.name&&Q(i,a),be(u,s);var c=be(u,a);for(s=0;s<l.length;s+=2){var d=l[s],f=l[s+1];"style"===d?ge(i,f):"dangerouslySetInnerHTML"===d?de(i,f):"children"===d?fe(i,f):b(i,d,f,c)}switch(u){case"input":Z(i,a);break;case"textarea":oe(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var h=a.value;null!=h?ne(i,!!a.multiple,h,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[pi]=a}catch(g){Pl(e,e.return,g)}}break;case 6:if(gu(t,e),yu(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){Pl(e,e.return,g)}}break;case 3:if(gu(t,e),yu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Kt(t.containerInfo)}catch(g){Pl(e,e.return,g)}break;case 4:default:gu(t,e),yu(e);break;case 13:gu(t,e),yu(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Ku=Qe())),4&r&&vu(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Qs=(c=Qs)||d,gu(t,e),Qs=c):gu(t,e),yu(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&0!==(1&e.mode))for(Js=e,d=e.child;null!==d;){for(f=Js=d;null!==Js;){switch(h=(p=Js).child,p.tag){case 0:case 11:case 14:case 15:ru(4,p,p.return);break;case 1:eu(p,p.return);var v=p.stateNode;if("function"===typeof v.componentWillUnmount){r=p,n=p.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){Pl(r,n,g)}}break;case 5:eu(p,p.return);break;case 22:if(null!==p.memoizedState){ku(f);continue}}null!==h?(h.return=p,Js=h):ku(f)}d=d.sibling}e:for(d=null,f=e;;){if(5===f.tag){if(null===d){d=f;try{i=f.stateNode,c?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(u=f.stateNode,s=void 0!==(l=f.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,u.style.display=ve("display",s))}catch(g){Pl(e,e.return,g)}}}else if(6===f.tag){if(null===d)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(g){Pl(e,e.return,g)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:gu(t,e),yu(e),4&r&&vu(e);case 21:}}function yu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(su(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(fe(i,""),r.flags&=-33),cu(e,uu(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;lu(e,uu(e),a);break;default:throw Error(o(161))}}catch(s){Pl(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bu(e,t,n){Js=e,wu(e,t,n)}function wu(e,t,n){for(var r=0!==(1&e.mode);null!==Js;){var i=Js,o=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Gs;if(!a){var s=i.alternate,u=null!==s&&null!==s.memoizedState||Qs;s=Gs;var l=Qs;if(Gs=a,(Qs=u)&&!l)for(Js=i;null!==Js;)u=(a=Js).child,22===a.tag&&null!==a.memoizedState?Su(i):null!==u?(u.return=a,Js=u):Su(i);for(;null!==o;)Js=o,wu(o,t,n),o=o.sibling;Js=i,Gs=s,Qs=l}xu(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Js=o):xu(e)}}function xu(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qs||iu(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qs)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:mo(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Bo(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Bo(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var f=d.dehydrated;null!==f&&Kt(f)}}}break;default:throw Error(o(163))}Qs||512&t.flags&&ou(t)}catch(p){Pl(t,t.return,p)}}if(t===e){Js=null;break}if(null!==(n=t.sibling)){n.return=t.return,Js=n;break}Js=t.return}}function ku(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Js=n;break}Js=t.return}}function Su(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{iu(4,t)}catch(u){Pl(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(u){Pl(t,i,u)}}var o=t.return;try{ou(t)}catch(u){Pl(t,o,u)}break;case 5:var a=t.return;try{ou(t)}catch(u){Pl(t,a,u)}}}catch(u){Pl(t,t.return,u)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var _u,Pu=Math.ceil,Eu=w.ReactCurrentDispatcher,Cu=w.ReactCurrentOwner,Iu=w.ReactCurrentBatchConfig,Tu=0,Mu=null,ju=null,Au=0,Ou=0,Lu=_i(0),zu=0,Du=null,Ru=0,Nu=0,Bu=0,Fu=null,Uu=null,Ku=0,Vu=1/0,Wu=null,Hu=!1,Yu=null,Xu=null,qu=!1,$u=null,Gu=0,Qu=0,Zu=null,Ju=-1,el=0;function tl(){return 0!==(6&Tu)?Qe():-1!==Ju?Ju:Ju=Qe()}function nl(e){return 0===(1&e.mode)?1:0!==(2&Tu)&&0!==Au?Au&-Au:null!==go.transition?(0===el&&(el=vt()),el):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Gt(e.type)}function rl(e,t,n,r){if(50<Qu)throw Qu=0,Zu=null,Error(o(185));mt(e,n,r),0!==(2&Tu)&&e===Mu||(e===Mu&&(0===(2&Tu)&&(Nu|=n),4===zu&&ul(e,Au)),il(e,r),1===n&&0===Tu&&0===(1&t.mode)&&(Vu=Qe()+500,Bi&&Ki()))}function il(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-at(o),s=1<<a,u=i[a];-1===u?0!==(s&n)&&0===(s&r)||(i[a]=pt(s,t)):u<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var r=ft(e,e===Mu?Au:0);if(0===r)null!==n&&qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&qe(n),1===t)0===e.tag?function(e){Bi=!0,Ui(e)}(ll.bind(null,e)):Ui(ll.bind(null,e)),ai((function(){0===(6&Tu)&&Ki()})),n=null;else{switch(wt(r)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ml(n,ol.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ol(e,t){if(Ju=-1,el=0,0!==(6&Tu))throw Error(o(327));var n=e.callbackNode;if(Sl()&&e.callbackNode!==n)return null;var r=ft(e,e===Mu?Au:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=ml(e,r);else{t=r;var i=Tu;Tu|=2;var a=vl();for(Mu===e&&Au===t||(Wu=null,Vu=Qe()+500,pl(e,t));;)try{bl();break}catch(u){hl(e,u)}ko(),Eu.current=a,Tu=i,null!==ju?t=0:(Mu=null,Au=0,t=zu)}if(0!==t){if(2===t&&(0!==(i=ht(e))&&(r=i,t=al(e,i))),1===t)throw n=Du,pl(e,0),ul(e,r),il(e,Qe()),n;if(6===t)ul(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!sr(o(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=ml(e,r))&&(0!==(a=ht(e))&&(r=a,t=al(e,a))),1===t))throw n=Du,pl(e,0),ul(e,r),il(e,Qe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:kl(e,Uu,Wu);break;case 3:if(ul(e,r),(130023424&r)===r&&10<(t=Ku+500-Qe())){if(0!==ft(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tl(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(kl.bind(null,e,Uu,Wu),t);break}kl(e,Uu,Wu);break;case 4:if(ul(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-at(r);a=1<<s,(s=t[s])>i&&(i=s),r&=~a}if(r=i,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Pu(r/1960))-r)){e.timeoutHandle=ri(kl.bind(null,e,Uu,Wu),r);break}kl(e,Uu,Wu);break;default:throw Error(o(329))}}}return il(e,Qe()),e.callbackNode===n?ol.bind(null,e):null}function al(e,t){var n=Fu;return e.current.memoizedState.isDehydrated&&(pl(e,t).flags|=256),2!==(e=ml(e,t))&&(t=Uu,Uu=n,null!==t&&sl(t)),e}function sl(e){null===Uu?Uu=e:Uu.push.apply(Uu,e)}function ul(e,t){for(t&=~Bu,t&=~Nu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function ll(e){if(0!==(6&Tu))throw Error(o(327));Sl();var t=ft(e,0);if(0===(1&t))return il(e,Qe()),null;var n=ml(e,t);if(0!==e.tag&&2===n){var r=ht(e);0!==r&&(t=r,n=al(e,r))}if(1===n)throw n=Du,pl(e,0),ul(e,t),il(e,Qe()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kl(e,Uu,Wu),il(e,Qe()),null}function cl(e,t){var n=Tu;Tu|=1;try{return e(t)}finally{0===(Tu=n)&&(Vu=Qe()+500,Bi&&Ki())}}function dl(e){null!==$u&&0===$u.tag&&0===(6&Tu)&&Sl();var t=Tu;Tu|=1;var n=Iu.transition,r=bt;try{if(Iu.transition=null,bt=1,e)return e()}finally{bt=r,Iu.transition=n,0===(6&(Tu=t))&&Ki()}}function fl(){Ou=Lu.current,Pi(Lu)}function pl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==ju)for(n=ju.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oi();break;case 3:oa(),Pi(Ti),Pi(Ii),da();break;case 5:sa(r);break;case 4:oa();break;case 13:case 19:Pi(ua);break;case 10:So(r.type._context);break;case 22:case 23:fl()}n=n.return}if(Mu=e,ju=e=Ll(e.current,null),Au=Ou=t,zu=0,Du=null,Bu=Nu=Ru=0,Uu=Fu=null,null!==Co){for(t=0;t<Co.length;t++)if(null!==(r=(n=Co[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var a=o.next;o.next=i,r.next=a}n.pending=r}Co=null}return e}function hl(e,t){for(;;){var n=ju;try{if(ko(),fa.current=as,ya){for(var r=va.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ya=!1}if(ha=0,ma=ga=va=null,ba=!1,wa=0,Cu.current=null,null===n||null===n.return){zu=1,Du=t,ju=null;break}e:{var a=e,s=n.return,u=n,l=t;if(t=Au,u.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var c=l,d=u,f=d.tag;if(0===(1&d.mode)&&(0===f||11===f||15===f)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=ms(s);if(null!==h){h.flags&=-257,ys(h,s,u,0,t),1&h.mode&&gs(a,c,t),l=c;var v=(t=h).updateQueue;if(null===v){var g=new Set;g.add(l),t.updateQueue=g}else v.add(l);break e}if(0===(1&t)){gs(a,c,t),gl();break e}l=Error(o(426))}else if(io&&1&u.mode){var m=ms(s);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),ys(m,s,u,0,t),vo(cs(l,u));break e}}a=l=cs(l,u),4!==zu&&(zu=2),null===Fu?Fu=[a]:Fu.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Ro(a,hs(0,l,t));break e;case 1:u=l;var y=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Xu||!Xu.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,Ro(a,vs(a,u,t));break e}}a=a.return}while(null!==a)}xl(n)}catch(w){t=w,ju===n&&null!==n&&(ju=n=n.return);continue}break}}function vl(){var e=Eu.current;return Eu.current=as,null===e?as:e}function gl(){0!==zu&&3!==zu&&2!==zu||(zu=4),null===Mu||0===(268435455&Ru)&&0===(268435455&Nu)||ul(Mu,Au)}function ml(e,t){var n=Tu;Tu|=2;var r=vl();for(Mu===e&&Au===t||(Wu=null,pl(e,t));;)try{yl();break}catch(i){hl(e,i)}if(ko(),Tu=n,Eu.current=r,null!==ju)throw Error(o(261));return Mu=null,Au=0,zu}function yl(){for(;null!==ju;)wl(ju)}function bl(){for(;null!==ju&&!$e();)wl(ju)}function wl(e){var t=_u(e.alternate,e,Ou);e.memoizedProps=e.pendingProps,null===t?xl(e):ju=t,Cu.current=null}function xl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=qs(n,t,Ou)))return void(ju=n)}else{if(null!==(n=$s(n,t)))return n.flags&=32767,void(ju=n);if(null===e)return zu=6,void(ju=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(ju=t);ju=t=e}while(null!==t);0===zu&&(zu=5)}function kl(e,t,n){var r=bt,i=Iu.transition;try{Iu.transition=null,bt=1,function(e,t,n,r){do{Sl()}while(null!==$u);if(0!==(6&Tu))throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,a),e===Mu&&(ju=Mu=null,Au=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||qu||(qu=!0,Ml(tt,(function(){return Sl(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Iu.transition,Iu.transition=null;var s=bt;bt=1;var u=Tu;Tu|=4,Cu.current=null,function(e,t){if(ei=Wt,pr(e=fr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(x){n=null;break e}var s=0,u=-1,l=-1,c=0,d=0,f=e,p=null;t:for(;;){for(var h;f!==n||0!==i&&3!==f.nodeType||(u=s+i),f!==a||0!==r&&3!==f.nodeType||(l=s+r),3===f.nodeType&&(s+=f.nodeValue.length),null!==(h=f.firstChild);)p=f,f=h;for(;;){if(f===e)break t;if(p===n&&++c===i&&(u=s),p===a&&++d===r&&(l=s),null!==(h=f.nextSibling))break;p=(f=p).parentNode}f=h}n=-1===u||-1===l?null:{start:u,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Wt=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var g=v.memoizedProps,m=v.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:mo(t.type,g),m);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(o(163))}}catch(x){Pl(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}v=nu,nu=!1}(e,n),mu(n,e),hr(ti),Wt=!!ei,ti=ei=null,e.current=n,bu(n,e,i),Ge(),Tu=u,bt=s,Iu.transition=a}else e.current=n;if(qu&&(qu=!1,$u=e,Gu=i),a=e.pendingLanes,0===a&&(Xu=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),il(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hu)throw Hu=!1,e=Yu,Yu=null,e;0!==(1&Gu)&&0!==e.tag&&Sl(),a=e.pendingLanes,0!==(1&a)?e===Zu?Qu++:(Qu=0,Zu=e):Qu=0,Ki()}(e,t,n,r)}finally{Iu.transition=i,bt=r}return null}function Sl(){if(null!==$u){var e=wt(Gu),t=Iu.transition,n=bt;try{if(Iu.transition=null,bt=16>e?16:e,null===$u)var r=!1;else{if(e=$u,$u=null,Gu=0,0!==(6&Tu))throw Error(o(331));var i=Tu;for(Tu|=4,Js=e.current;null!==Js;){var a=Js,s=a.child;if(0!==(16&Js.flags)){var u=a.deletions;if(null!==u){for(var l=0;l<u.length;l++){var c=u[l];for(Js=c;null!==Js;){var d=Js;switch(d.tag){case 0:case 11:case 15:ru(8,d,a)}var f=d.child;if(null!==f)f.return=d,Js=f;else for(;null!==Js;){var p=(d=Js).sibling,h=d.return;if(au(d),d===c){Js=null;break}if(null!==p){p.return=h,Js=p;break}Js=h}}}var v=a.alternate;if(null!==v){var g=v.child;if(null!==g){v.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(null!==g)}}Js=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Js=s;else e:for(;null!==Js;){if(0!==(2048&(a=Js).flags))switch(a.tag){case 0:case 11:case 15:ru(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Js=y;break e}Js=a.return}}var b=e.current;for(Js=b;null!==Js;){var w=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==w)w.return=s,Js=w;else e:for(s=b;null!==Js;){if(0!==(2048&(u=Js).flags))try{switch(u.tag){case 0:case 11:case 15:iu(9,u)}}catch(k){Pl(u,u.return,k)}if(u===s){Js=null;break e}var x=u.sibling;if(null!==x){x.return=u.return,Js=x;break e}Js=u.return}}if(Tu=i,Ki(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(k){}r=!0}return r}finally{bt=n,Iu.transition=t}}return!1}function _l(e,t,n){e=zo(e,t=hs(0,t=cs(n,t),1),1),t=tl(),null!==e&&(mt(e,1,t),il(e,t))}function Pl(e,t,n){if(3===e.tag)_l(e,e,n);else for(;null!==t;){if(3===t.tag){_l(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Xu||!Xu.has(r))){t=zo(t,e=vs(t,e=cs(n,e),1),1),e=tl(),null!==t&&(mt(t,1,e),il(t,e));break}}t=t.return}}function El(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tl(),e.pingedLanes|=e.suspendedLanes&n,Mu===e&&(Au&n)===n&&(4===zu||3===zu&&(130023424&Au)===Au&&500>Qe()-Ku?pl(e,0):Bu|=n),il(e,t)}function Cl(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=tl();null!==(e=Mo(e,t))&&(mt(e,t,n),il(e,n))}function Il(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cl(e,n)}function Tl(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Cl(e,n)}function Ml(e,t){return Xe(e,t)}function jl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Al(e,t,n,r){return new jl(e,t,n,r)}function Ol(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ll(e,t){var n=e.alternate;return null===n?((n=Al(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function zl(e,t,n,r,i,a){var s=2;if(r=e,"function"===typeof e)Ol(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Dl(n.children,i,a,t);case _:s=8,i|=8;break;case P:return(e=Al(12,n,t,2|i)).elementType=P,e.lanes=a,e;case T:return(e=Al(13,n,t,i)).elementType=T,e.lanes=a,e;case M:return(e=Al(19,n,t,i)).elementType=M,e.lanes=a,e;case O:return Rl(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:s=10;break e;case C:s=9;break e;case I:s=11;break e;case j:s=14;break e;case A:s=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Al(s,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Dl(e,t,n,r){return(e=Al(7,e,r,t)).lanes=n,e}function Rl(e,t,n,r){return(e=Al(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Nl(e,t,n){return(e=Al(6,e,null,t)).lanes=n,e}function Bl(e,t,n){return(t=Al(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Fl(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ul(e,t,n,r,i,o,a,s,u){return e=new Fl(e,t,n,s,u),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Al(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ao(o),e}function Kl(e){if(!e)return Ci;e:{if(Ke(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ai(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Ai(n))return zi(e,n,t)}return t}function Vl(e,t,n,r,i,o,a,s,u){return(e=Ul(n,r,!0,e,0,o,0,s,u)).context=Kl(null),n=e.current,(o=Lo(r=tl(),i=nl(n))).callback=void 0!==t&&null!==t?t:null,zo(n,o,i),e.current.lanes=i,mt(e,i,r),il(e,r),e}function Wl(e,t,n,r){var i=t.current,o=tl(),a=nl(i);return n=Kl(n),null===t.context?t.context=n:t.pendingContext=n,(t=Lo(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=zo(i,t,a))&&(rl(e,i,a,o),Do(e,i,a)),a}function Hl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Yl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Xl(e,t){Yl(e,t),(e=e.alternate)&&Yl(e,t)}_u=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ti.current)ws=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ws=!1,function(e,t,n){switch(t.tag){case 3:Ms(t),ho();break;case 5:aa(t);break;case 1:Ai(t.type)&&Di(t);break;case 4:ia(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ei(yo,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ei(ua,1&ua.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ns(e,t,n):(Ei(ua,1&ua.current),null!==(e=Hs(e,t,n))?e.sibling:null);Ei(ua,1&ua.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Vs(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ei(ua,ua.current),r)break;return null;case 22:case 23:return t.lanes=0,Ps(e,t,n)}return Hs(e,t,n)}(e,t,n);ws=0!==(131072&e.flags)}else ws=!1,io&&0!==(1048576&t.flags)&&Ji(t,Yi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ws(e,t),e=t.pendingProps;var i=ji(t,Ii.current);Po(t,n),i=_a(null,t,r,e,i,n);var a=Pa();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ai(r)?(a=!0,Di(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ao(t),i.updater=Ko,t.stateNode=i,i._reactInternals=t,Yo(t,r,e,n),t=Ts(null,t,r,!0,a,n)):(t.tag=0,io&&a&&eo(t),xs(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ws(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Ol(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===j)return 14}return 2}(r),e=mo(r,e),i){case 0:t=Cs(null,t,r,e,n);break e;case 1:t=Is(null,t,r,e,n);break e;case 11:t=ks(null,t,r,e,n);break e;case 14:t=Ss(null,t,r,mo(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Cs(e,t,r,i=t.elementType===r?i:mo(r,i),n);case 1:return r=t.type,i=t.pendingProps,Is(e,t,r,i=t.elementType===r?i:mo(r,i),n);case 3:e:{if(Ms(t),null===e)throw Error(o(387));r=t.pendingProps,i=(a=t.memoizedState).element,Oo(e,t),No(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=js(e,t,r,n,i=cs(Error(o(423)),t));break e}if(r!==i){t=js(e,t,r,n,i=cs(Error(o(424)),t));break e}for(ro=li(t.stateNode.containerInfo.firstChild),no=t,io=!0,oo=null,n=Zo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ho(),r===i){t=Hs(e,t,n);break e}xs(e,t,r,n)}t=t.child}return t;case 5:return aa(t),null===e&&lo(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==a&&ni(r,a)&&(t.flags|=32),Es(e,t),xs(e,t,s,n),t.child;case 6:return null===e&&lo(t),null;case 13:return Ns(e,t,n);case 4:return ia(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Qo(t,null,r,n):xs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,ks(e,t,r,i=t.elementType===r?i:mo(r,i),n);case 7:return xs(e,t,t.pendingProps,n),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Ei(yo,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===i.children&&!Ti.current){t=Hs(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var u=a.dependencies;if(null!==u){s=a.child;for(var l=u.firstContext;null!==l;){if(l.context===r){if(1===a.tag){(l=Lo(-1,n&-n)).tag=2;var c=a.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),_o(a.return,n,t),u.lanes|=n;break}l=l.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),_o(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}xs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Po(t,n),r=r(i=Eo(i)),t.flags|=1,xs(e,t,r,n),t.child;case 14:return i=mo(r=t.type,t.pendingProps),Ss(e,t,r,i=mo(r.type,i),n);case 15:return _s(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:mo(r,i),Ws(e,t),t.tag=1,Ai(r)?(e=!0,Di(t)):e=!1,Po(t,n),Wo(t,r,i),Yo(t,r,i,n),Ts(null,t,r,!0,e,n);case 19:return Vs(e,t,n);case 22:return Ps(e,t,n)}throw Error(o(156,t.tag))};var ql="function"===typeof reportError?reportError:function(e){console.error(e)};function $l(e){this._internalRoot=e}function Gl(e){this._internalRoot=e}function Ql(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jl(){}function ec(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if("function"===typeof i){var s=i;i=function(){var e=Hl(a);s.call(e)}}Wl(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var e=Hl(a);o.call(e)}}var a=Vl(t,r,e,0,null,!1,0,"",Jl);return e._reactRootContainer=a,e[hi]=a.current,Kr(8===e.nodeType?e.parentNode:e),dl(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=Hl(u);s.call(e)}}var u=Ul(e,0,!1,null,0,!1,0,"",Jl);return e._reactRootContainer=u,e[hi]=u.current,Kr(8===e.nodeType?e.parentNode:e),dl((function(){Wl(t,u,n,r)})),u}(n,t,e,i,r);return Hl(a)}Gl.prototype.render=$l.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Wl(e,t,null,null)},Gl.prototype.unmount=$l.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dl((function(){Wl(null,e,null,null)})),t[hi]=null}},Gl.prototype.unstable_scheduleHydration=function(e){if(e){var t=_t();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Rt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),il(t,Qe()),0===(6&Tu)&&(Vu=Qe()+500,Ki()))}break;case 13:dl((function(){var t=Mo(e,1);if(null!==t){var n=tl();rl(t,e,1,n)}})),Xl(e,1)}},kt=function(e){if(13===e.tag){var t=Mo(e,134217728);if(null!==t)rl(t,e,134217728,tl());Xl(e,134217728)}},St=function(e){if(13===e.tag){var t=nl(e),n=Mo(e,t);if(null!==n)rl(n,e,t,tl());Xl(e,t)}},_t=function(){return bt},Pt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=xi(r);if(!i)throw Error(o(90));X(r),Z(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=cl,Te=dl;var tc={usingClientEntryPoint:!1,Events:[bi,wi,xi,Ee,Ce,cl]},nc={findFiberByHostInstance:yi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rc={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ic=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ic.isDisabled&&ic.supportsFiber)try{it=ic.inject(rc),ot=ic}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ql(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Ql(e))throw Error(o(299));var n=!1,r="",i=ql;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Ul(e,1,!1,null,0,n,0,r,i),e[hi]=t.current,Kr(8===e.nodeType?e.parentNode:e),new $l(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return dl(e)},t.hydrate=function(e,t,n){if(!Zl(t))throw Error(o(200));return ec(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Ql(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",s=ql;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Vl(t,null,e,1,null!=n?n:null,i,0,a,s),e[hi]=t.current,Kr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Gl(t)},t.render=function(e,t,n){if(!Zl(t))throw Error(o(200));return ec(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zl(e))throw Error(o(40));return!!e._reactRootContainer&&(dl((function(){ec(null,null,e,!1,(function(){e._reactRootContainer=null,e[hi]=null}))})),!0)},t.unstable_batchedUpdates=cl,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zl(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return ec(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,n){"use strict";var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},6374:function(e,t,n){"use strict";var r=n(2791),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,o={},l=null,c=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,r)&&!u.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:l,ref:c,props:o,_owner:s.current}}t.Fragment=o,t.jsx=l,t.jsxs=l},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,g={};function m(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||h}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||h}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=m.prototype;var w=b.prototype=new y;w.constructor=b,v(w,m.prototype),w.isPureReactComponent=!0;var x=Array.isArray,k=Object.prototype.hasOwnProperty,S={current:null},_={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,r){var i,o={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)k.call(t,i)&&!_.hasOwnProperty(i)&&(o[i]=t[i]);var u=arguments.length-2;if(1===u)o.children=r;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];o.children=l}if(e&&e.defaultProps)for(i in u=e.defaultProps)void 0===o[i]&&(o[i]=u[i]);return{$$typeof:n,type:e,key:a,ref:s,props:o,_owner:S.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return a=a(u=e),e=""===o?"."+I(u,0):o,x(a)?(i="",null!=e&&(i=e.replace(C,"$&/")+"/"),T(a,t,i,"",(function(e){return e}))):null!=a&&(E(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||u&&u.key===a.key?"":(""+a.key).replace(C,"$&/")+"/")+e)),t.push(a)),1;if(u=0,o=""===o?".":o+":",x(e))for(var l=0;l<e.length;l++){var c=o+I(s=e[l],l);u+=T(s,t,i,c,a)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),l=0;!(s=e.next()).done;)u+=T(s=s.value,t,i,c=o+I(s,l++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function M(e,t,n){if(null==e)return e;var r=[],i=0;return T(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function j(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A={current:null},O={transition:null},L={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};t.Children={map:M,forEach:function(e,t,n){M(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return M(e,(function(){t++})),t},toArray:function(e){return M(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=i,t.Profiler=a,t.PureComponent=b,t.StrictMode=o,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=v({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=S.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(l in t)k.call(t,l)&&!_.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==u?u[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){u=Array(l);for(var c=0;c<l;c++)u[c]=arguments[c+2];i.children=u}return{$$typeof:n,type:e.type,key:o,ref:a,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=P,t.createFactory=function(e){var t=P.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:j}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return A.current.useCallback(e,t)},t.useContext=function(e){return A.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return A.current.useDeferredValue(e)},t.useEffect=function(e,t){return A.current.useEffect(e,t)},t.useId=function(){return A.current.useId()},t.useImperativeHandle=function(e,t,n){return A.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return A.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return A.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return A.current.useMemo(e,t)},t.useReducer=function(e,t,n){return A.current.useReducer(e,t,n)},t.useRef=function(e){return A.current.useRef(e)},t.useState=function(e){return A.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return A.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return A.current.useTransition()},t.version="18.2.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var s=2*(r+1)-1,u=e[s],l=s+1,c=e[l];if(0>o(u,n))l<i&&0>o(c,u)?(e[r]=c,e[l]=n,r=l):(e[r]=u,e[s]=n,r=s);else{if(!(l<i&&0>o(c,n)))break e;e[r]=c,e[l]=n,r=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var l=[],c=[],d=1,f=null,p=3,h=!1,v=!1,g=!1,m="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(l,t)}t=r(c)}}function x(e){if(g=!1,w(e),!v)if(null!==r(l))v=!0,O(k);else{var t=r(c);null!==t&&L(x,t.startTime-e)}}function k(e,n){v=!1,g&&(g=!1,y(E),E=-1),h=!0;var o=p;try{for(w(n),f=r(l);null!==f&&(!(f.expirationTime>n)||e&&!T());){var a=f.callback;if("function"===typeof a){f.callback=null,p=f.priorityLevel;var s=a(f.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?f.callback=s:f===r(l)&&i(l),w(n)}else i(l);f=r(l)}if(null!==f)var u=!0;else{var d=r(c);null!==d&&L(x,d.startTime-n),u=!1}return u}finally{f=null,p=o,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,_=!1,P=null,E=-1,C=5,I=-1;function T(){return!(t.unstable_now()-I<C)}function M(){if(null!==P){var e=t.unstable_now();I=e;var n=!0;try{n=P(!0,e)}finally{n?S():(_=!1,P=null)}}else _=!1}if("function"===typeof b)S=function(){b(M)};else if("undefined"!==typeof MessageChannel){var j=new MessageChannel,A=j.port2;j.port1.onmessage=M,S=function(){A.postMessage(null)}}else S=function(){m(M,0)};function O(e){P=e,_||(_=!0,S())}function L(e,n){E=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||h||(v=!0,O(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(c,e),null===r(l)&&e===r(c)&&(g?(y(E),E=-1):g=!0,L(x,o-a))):(e.sortIndex=s,n(l,e),v||h||(v=!0,O(k))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}!function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var o=Object.create(null);n.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){a[e]=function(){return r[e]}}));return a.default=function(){return r},n.d(o,a),o}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.nc=void 0,function(){"use strict";var e={};n.r(e),n.d(e,{ArrayOfValidator:function(){return Dt},DictValidator:function(){return Bt},ObjectValidator:function(){return Rt},UnionValidator:function(){return Nt},ValidationError:function(){return At},Validator:function(){return zt},any:function(){return Kt},array:function(){return Jt},arrayOf:function(){return en},bigint:function(){return Qt},boolean:function(){return Gt},dict:function(){return sn},integer:function(){return Xt},jsonDict:function(){return an},jsonValue:function(){return on},literal:function(){return Zt},literalEnum:function(){return pn},model:function(){return ln},nonZeroInteger:function(){return $t},nonZeroNumber:function(){return Yt},nullable:function(){return fn},number:function(){return Wt},object:function(){return nn},optional:function(){return dn},positiveInteger:function(){return qt},positiveNumber:function(){return Ht},setEnum:function(){return cn},string:function(){return Vt},union:function(){return un},unknown:function(){return Ut},unknownObject:function(){return tn}});var t=n(2791),r=n.t(t,2),i=n(1250);n(8624),n(9743),n(5470),n(2330),n(447),n(4178);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function s(e,t){if(e){if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function u(e){return function(e){if(Array.isArray(e))return o(e)}(e)||a(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){if(Array.isArray(e))return e}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e){return l(e)||a(e)||s(e)||c()}var f="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",p="a0",h="A00000000000000000000000000";function v(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-"a".charCodeAt(0)+2;if(e>="A"&&e<="Z")return"Z".charCodeAt(0)-e.charCodeAt(0)+2;throw new Error("Invalid index key head: "+e)}function g(e){if(e.length!==v(e.charAt(0)))throw new Error("invalid integer part of index key: "+e)}function m(e){if(void 0===e)throw Error("n is undefined")}function y(e){g(e);for(var t=d(e.split("")),n=t[0],r=t.slice(1),i=!0,o=r.length-1;i&&o>=0;o--){var a=f.indexOf(r[o])+1;a===f.length?r[o]="0":(r[o]=f.charAt(a),i=!1)}if(i){if("Z"===n)return"a0";if("z"===n)return;var s=String.fromCharCode(n.charCodeAt(0)+1);return s>"a"?r.push("0"):r.pop(),s+r.join("")}return n+r.join("")}function b(e,t){if(void 0!==t&&e>=t)throw new Error(e+" >= "+t);if("0"===e.slice(-1)||t&&"0"===t.slice(-1))throw new Error("trailing zero");if(t){for(var n=0;(e.charAt(n)||"0")===t.charAt(n);)n++;if(n>0)return t.slice(0,n)+b(e.slice(n),t.slice(n))}var r=e?f.indexOf(e.charAt(0)):0,i=void 0!==t?f.indexOf(t.charAt(0)):f.length;if(i-r>1){var o=Math.round(.5*(r+i));return f.charAt(o)}return t&&t.length>1?t.slice(0,1):f.charAt(r)+b(e.slice(1),void 0)}function w(e){var t=v(e.charAt(0));if(t>e.length)throw new Error("invalid index: "+e);return e.slice(0,t)}function x(e){if(e===h)throw new Error("invalid index: "+e);var t=w(e);if("0"===e.slice(t.length).slice(-1))throw new Error("invalid index: "+e)}function k(e,t){if(void 0!==e&&x(e),void 0!==t&&x(t),void 0!==e&&void 0!==t&&e>=t)throw new Error(e+" >= "+t);if(void 0===e&&void 0===t)return p;if(void 0===e){if(void 0===t)throw Error("b is undefined");var n=w(t),r=t.slice(n.length);if(n===h)return n+b("",r);if(n<t)return n;var i=function(e){g(e);for(var t=d(e.split("")),n=t[0],r=t.slice(1),i=!0,o=r.length-1;i&&o>=0;o--){var a=f.indexOf(r[o])-1;-1===a?r[o]=f.slice(-1):(r[o]=f.charAt(a),i=!1)}if(i){if("a"===n)return"Z"+f.slice(-1);if("A"===n)return;var s=String.fromCharCode(n.charCodeAt(0)-1);return s<"Z"?r.push(f.slice(-1)):r.pop(),s+r.join("")}return n+r.join("")}(n);return m(i),i}if(void 0===t){var o=w(e),a=e.slice(o.length),s=y(o);return void 0===s?o+b(a,void 0):s}var u=w(e),l=e.slice(u.length),c=w(t),v=t.slice(c.length);if(u===c)return u+b(l,v);var k=y(u);return m(k),k<t?k:u+b(l,void 0)}function S(e,t,n){if(0===n)return[];if(1===n)return[k(e,t)];if(void 0===t){for(var r=k(e,t),i=[r],o=0;o<n-1;o++)r=k(r,t),i.push(r);return i}if(void 0===e){for(var a=k(e,t),s=[a],l=0;l<n-1;l++)a=k(e,a),s.push(a);return s.reverse(),s}var c=Math.floor(n/2),d=k(e,t);return[].concat(u(S(e,d,c)),[d],u(S(d,t,n-c-1)))}function _(e,t,n){return S(e,t,n)}function P(e,t){return S(e,void 0,t)}function E(e,t){return S(e,t,1)[0]}function C(e){return S(e,void 0,1)[0]}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"a1";return[t].concat(u(S(t,void 0,e)))}function T(e,t){return e.index<t.index?-1:e.index>t.index?1:0}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function A(e){var t=function(e,t){if("object"!==j(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===j(t)?t:String(t)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,A(r.key),r)}}function L(e,t,n){return t&&O(e.prototype,t),n&&O(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function z(e,t,n){return(t=A(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D=function(){function e(){M(this,e),z(this,"arraySize",0),z(this,"array",Array(8)),z(this,"set",null)}return L(e,[{key:"isEmpty",get:function(){if(this.array)return 0===this.arraySize;if(this.set)return 0===this.set.size;throw new Error("no set or array")}},{key:"add",value:function(e){if(this.array)return-1===this.array.indexOf(e)&&(this.arraySize<8?(this.array[this.arraySize]=e,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(e),!0));if(this.set)return!this.set.has(e)&&(this.set.add(e),!0);throw new Error("no set or array")}},{key:"remove",value:function(e){if(this.array){var t=this.array.indexOf(e);return-1!==t&&(this.array[t]=void 0,this.arraySize--,t!==this.arraySize&&(this.array[t]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return!!this.set.has(e)&&(this.set.delete(e),!0);throw new Error("no set or array")}},{key:"visit",value:function(e){if(this.array)for(var t=0;t<this.arraySize;t++){var n=this.array[t];"undefined"!==typeof n&&e(n)}else{if(!this.set)throw new Error("no set or array");this.set.forEach(e)}}}]),e}();function R(e){return e&&"object"===typeof e&&"parents"in e}function N(e){for(var t=0,n=e.parents.length;t<n;t++)if(e.parents[t].__unsafe__getWithoutCapture(),e.parents[t].lastChangedEpoch!==e.parentEpochs[t])return!0;return!1}var B=function e(t,n){if(t.children.remove(n)&&t.children.isEmpty&&R(t))for(var r=0,i=t.parents.length;r<i;r++)e(t.parents[r],t)},F=function e(t,n){if(t.children.add(n)&&R(t))for(var r=0,i=t.parents.length;r<i;r++)e(t.parents[r],t)};function U(e,t){return e===t||Object.is(e,t)||Boolean(e&&t&&"function"===typeof e.equals&&e.equals(t))}var K=Object.freeze([]),V=Symbol.for("__@tldraw/state__"),W=globalThis;W[V]?console.error('Multiple versions of @tldraw/state detected. This will cause unexpected behavior. Please add "resolutions" (yarn/pnpm) or "overrides" (npm) in your package.json to ensure only one version of @tldraw/state is loaded.'):W[V]=!0;var H=L((function e(t,n){M(this,e),z(this,"offset",0),z(this,"numNewParents",0),z(this,"maybeRemoved",void 0),this.below=t,this.child=n})),Y=null;function X(e){Y=new H(Y,e)}function q(){var e,t=Y;if(Y=t.below,t.numNewParents>0||t.offset!==t.child.parents.length){for(var n=t.offset;n<t.child.parents.length;n++){var r=t.child.parents[n];t.child.parents.indexOf(r)>=t.offset&&B(r,t.child)}if(t.child.parents.length=t.offset,t.child.parentEpochs.length=t.offset,null!==(e=Y)&&void 0!==e&&e.maybeRemoved)for(var i=0;i<Y.maybeRemoved.length;i++){var o=Y.maybeRemoved[i];-1===t.child.parents.indexOf(o)&&B(o,t.child)}}}function $(e){if(Y){var t=Y.child.parents.indexOf(e);if(t<0&&(Y.numNewParents++,Y.child.isActivelyListening&&F(e,Y.child)),t<0||t>=Y.offset){if(t!==Y.offset&&t>0){var n=Y.child.parents[Y.offset];Y.maybeRemoved?-1===Y.maybeRemoved.indexOf(n)&&Y.maybeRemoved.push(n):Y.maybeRemoved=[n]}Y.child.parents[Y.offset]=e,Y.child.parentEpochs[Y.offset]=e.lastChangedEpoch,Y.offset++}}}function G(e,t){return l(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||s(e,t)||c()}var Q=Symbol("RESET_VALUE"),Z=function(){function e(t){M(this,e),z(this,"index",0),z(this,"buffer",void 0),this.capacity=t,this.buffer=new Array(t)}return L(e,[{key:"pushEntry",value:function(e,t,n){void 0!==n&&(n!==Q?(this.buffer[this.index]=[e,t,n],this.index=(this.index+1)%this.capacity):this.clear())}},{key:"clear",value:function(){this.index=0,this.buffer.fill(void 0)}},{key:"getChangesSince",value:function(e){for(var t=this.index,n=this.capacity,r=this.buffer,i=0;i<n;i++){var o=(t-1+n-i)%n,a=r[o];if(!a)return Q;var s=G(a,2),u=s[0],l=s[1];if(0===i&&e>=l)return[];if(u<=e&&e<l){for(var c=i+1,d=new Array(c),f=0;f<c;f++)d[f]=r[(o+f)%n][2];return d}}return Q}}]),e}();function J(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}var ee=-1,te=0,ne=!1;var re=function(){function e(t){M(this,e),z(this,"initialAtomValues",new Map),this.parent=t}return L(e,[{key:"isRoot",get:function(){return null===this.parent}},{key:"commit",value:function(){var e=this;if(this.isRoot){var t=this.initialAtomValues;this.initialAtomValues=new Map,ie(t.keys())}else this.initialAtomValues.forEach((function(t,n){e.parent.initialAtomValues.has(n)||e.parent.initialAtomValues.set(n,t)}))}},{key:"abort",value:function(){te++,this.initialAtomValues.forEach((function(e,t){var n;t.set(e),null===(n=t.historyBuffer)||void 0===n||n.clear()})),this.commit()}}]),e}();function ie(e){if(ne)throw new Error("cannot change atoms during reaction cycle");try{ne=!0;var t,n=new Set,r=function e(t){t.lastTraversedEpoch!==te&&(t.lastTraversedEpoch=te,"maybeScheduleEffect"in t?n.add(t):t.children.visit(e))},i=J(e);try{for(i.s();!(t=i.n()).done;){t.value.children.visit(r)}}catch(s){i.e(s)}finally{i.f()}var o,a=J(n);try{for(a.s();!(o=a.n()).done;){o.value.maybeScheduleEffect()}}catch(s){a.e(s)}finally{a.f()}}finally{ne=!1}}var oe=null;function ae(e){return oe?e():function(e){var t=new re(oe);oe=t;try{var n=!1,r=e((function(){return n=!0}));return n?t.abort():t.commit(),r}catch(ej){throw t.abort(),ej}finally{oe=oe.parent}}(e)}var se=function(){function e(t,n,r){var i;M(this,e),z(this,"isEqual",void 0),z(this,"computeDiff",void 0),z(this,"lastChangedEpoch",te),z(this,"children",new D),z(this,"historyBuffer",void 0),this.name=t,this.current=n,this.isEqual=null!==(i=null===r||void 0===r?void 0:r.isEqual)&&void 0!==i?i:null,r&&(r.historyLength&&(this.historyBuffer=new Z(r.historyLength)),this.computeDiff=r.computeDiff)}return L(e,[{key:"__unsafe__getWithoutCapture",value:function(){return this.current}},{key:"value",get:function(){return $(this),this.current}},{key:"set",value:function(e,t){var n,r,i,o;if(null!==(n=null===(r=this.isEqual)||void 0===r?void 0:r.call(this,this.current,e))&&void 0!==n?n:U(this.current,e))return this.current;(te++,this.historyBuffer)&&this.historyBuffer.pushEntry(this.lastChangedEpoch,te,null!==(i=null!==t&&void 0!==t?t:null===(o=this.computeDiff)||void 0===o?void 0:o.call(this,this.current,e,this.lastChangedEpoch,te))&&void 0!==i?i:Q);this.lastChangedEpoch=te;var a=this.current;return this.current=e,function(e,t){oe?oe.initialAtomValues.has(e)||oe.initialAtomValues.set(e,t):ie([e])}(this,a),e}},{key:"update",value:function(e){return this.set(e(this.current))}},{key:"getDiffSince",value:function(e){var t,n;return $(this),e>=this.lastChangedEpoch?K:null!==(t=null===(n=this.historyBuffer)||void 0===n?void 0:n.getChangesSince(e))&&void 0!==t?t:Q}}]),e}();function ue(e,t,n){return new se(e,t,n)}var le=Symbol("UNINITIALIZED"),ce=function(e){return e===le},de=L((function e(t,n){M(this,e),this.value=t,this.diff=n}));function fe(e,t){return new de(e,t)}var pe=function(){function e(t,n,r){var i;M(this,e),z(this,"lastChangedEpoch",ee),z(this,"lastTraversedEpoch",ee),z(this,"lastCheckedEpoch",ee),z(this,"parents",[]),z(this,"parentEpochs",[]),z(this,"children",new D),z(this,"historyBuffer",void 0),z(this,"state",le),z(this,"computeDiff",void 0),z(this,"isEqual",void 0),this.name=t,this.derive=n,null!==r&&void 0!==r&&r.historyLength&&(this.historyBuffer=new Z(r.historyLength)),this.computeDiff=null===r||void 0===r?void 0:r.computeDiff,this.isEqual=null!==(i=null===r||void 0===r?void 0:r.isEqual)&&void 0!==i?i:U}return L(e,[{key:"isActivelyListening",get:function(){return!this.children.isEmpty}},{key:"__unsafe__getWithoutCapture",value:function(){var e=this.lastChangedEpoch===ee;if(!e&&(this.lastCheckedEpoch===te||!N(this)))return this.lastCheckedEpoch=te,this.state;try{X(this);var t=this.derive(this.state,this.lastCheckedEpoch),n=t instanceof de?t.value:t;if(this.state===le||!this.isEqual(n,this.state)){if(this.historyBuffer&&!e){var r,i,o=t instanceof de?t.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,te,null!==(r=null!==o&&void 0!==o?o:null===(i=this.computeDiff)||void 0===i?void 0:i.call(this,this.state,n,this.lastCheckedEpoch,te))&&void 0!==r?r:Q)}this.lastChangedEpoch=te,this.state=n}return this.lastCheckedEpoch=te,this.state}finally{q()}}},{key:"value",get:function(){var e=this.__unsafe__getWithoutCapture();return $(this),e}},{key:"getDiffSince",value:function(e){var t,n;return this.value,e>=this.lastChangedEpoch?K:null!==(t=null===(n=this.historyBuffer)||void 0===n?void 0:n.getChangesSince(e))&&void 0!==t?t:Q}}]),e}();function he(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,r=n.get,i=Symbol.for("__@tldraw/state__computed__"+t);return n.get=function(){var n=this[i];return n||(n=new pe(t,r.bind(this),e),Object.defineProperty(this,i,{enumerable:!1,configurable:!1,writable:!1,value:n})),n.value},n}function ve(){if(1===arguments.length){var e=arguments[0];return function(t,n,r){return he(e,t,n,r)}}return"string"===typeof arguments[0]?new pe(arguments[0],arguments[1],arguments[2]):he(void 0,arguments[0],arguments[1],arguments[2])}var ge=function(){function e(t,n,r){var i=this;M(this,e),z(this,"_isActivelyListening",!1),z(this,"lastTraversedEpoch",ee),z(this,"lastReactedEpoch",ee),z(this,"_scheduleCount",0),z(this,"parentEpochs",[]),z(this,"parents",[]),z(this,"_scheduleEffect",void 0),z(this,"maybeExecute",(function(){i._isActivelyListening&&i.execute()})),this.name=t,this.runEffect=n,this._scheduleEffect=null===r||void 0===r?void 0:r.scheduleEffect}return L(e,[{key:"isActivelyListening",get:function(){return this._isActivelyListening}},{key:"scheduleCount",get:function(){return this._scheduleCount}},{key:"maybeScheduleEffect",value:function(){this._isActivelyListening&&this.lastReactedEpoch!==te&&(!this.parents.length||N(this)?this.scheduleEffect():this.lastReactedEpoch=te)}},{key:"scheduleEffect",value:function(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}},{key:"attach",value:function(){this._isActivelyListening=!0;for(var e=0,t=this.parents.length;e<t;e++)F(this.parents[e],this)}},{key:"detach",value:function(){this._isActivelyListening=!1;for(var e=0,t=this.parents.length;e<t;e++)B(this.parents[e],this)}},{key:"execute",value:function(){try{X(this);var e=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=te,e}finally{q()}}}]),e}();function me(e,t,n){var r=new ge(e,t,n);return r.attach(),r.scheduleEffect(),function(){r.detach()}}function ye(e,n){var r=t.useRef(n);r.current=n;var i=G(t.useMemo((function(){var t=null,n=new ge("useStateTracking(".concat(e,")"),(function(){var e;return null===(e=r.current)||void 0===e?void 0:e.call(r)}),{scheduleEffect:function(){var e;null===(e=t)||void 0===e||e()}});return[n,function(e){return t=e,function(){t=null}},function(){return n.scheduleCount}]}),[e]),3),o=i[0],a=i[1],s=i[2];return t.useSyncExternalStore(a,s,s),t.useEffect((function(){return o.attach(),o.maybeScheduleEffect(),function(){o.detach()}}),[o]),o.execute()}var be={apply:function(e,t,n){var r,i;return ye(null!==(r=null!==(i=e.displayName)&&void 0!==i?i:e.name)&&void 0!==r?r:"tracked(???)",(function(){return e.apply(t,n)}))}},we=Symbol.for("react.memo"),xe=Symbol.for("react.forward_ref");function ke(e){var n=null,r=e.$$typeof;return r===we&&(n=(e=e.type).compare),r===xe?(0,t.memo)((0,t.forwardRef)(new Proxy(e.render,be))):(0,t.memo)(new Proxy(e,be),n)}function Se(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:K;(0,t.useEffect)((function(){var t=new ge(e,n);return t.attach(),t.execute(),function(){t.detach()}}),r)}function _e(){var e=arguments,n=3===e.length?e[2]:[e[0]],r=3===e.length?e[0]:"useValue(".concat(e[0].name,")"),i=(0,t.useRef)(!0);i.current=!0;var o=(0,t.useMemo)((function(){return 1===e.length?e[0]:ve(r,(function(){if(i.current)return e[1]();try{return e[1]()}catch(t){return{}}}))}),n);try{var a=(0,t.useMemo)((function(){return{subscribe:function(e){return me("useValue(".concat(r,")"),(function(){o.value,e()}))},getSnapshot:function(){return o.value}}}),[o]),s=a.subscribe,u=a.getSnapshot;return(0,t.useSyncExternalStore)(s,u,u)}finally{i.current=!1}}var Pe=function(){function e(t){M(this,e),z(this,"nextValue",void 0),z(this,"diff",void 0),this.previousValue=t}return L(e,[{key:"get",value:function(){var e,t,n,r,i=null!==(e=null===(t=this.diff)||void 0===t||null===(t=t.removed)||void 0===t?void 0:t.size)&&void 0!==e?e:0,o=null!==(n=null===(r=this.diff)||void 0===r||null===(r=r.added)||void 0===r?void 0:r.size)&&void 0!==n?n:0;if(0!==i||0!==o)return{value:this.nextValue,diff:this.diff}}},{key:"_add",value:function(e,t){var n,r,i,o,a;(null!==(n=this.nextValue)&&void 0!==n||(this.nextValue=new Set(this.previousValue)),this.nextValue.add(e),null!==(r=this.diff)&&void 0!==r||(this.diff={}),t)?null===(i=this.diff.removed)||void 0===i||i.delete(e):(null!==(a=(o=this.diff).added)&&void 0!==a||(o.added=new Set),this.diff.added.add(e))}},{key:"add",value:function(e){var t,n=this.previousValue.has(e);if(n){var r;if(!(null===(r=this.diff)||void 0===r||null===(r=r.removed)||void 0===r?void 0:r.has(e)))return;return this._add(e,n)}(null===(t=this.nextValue)||void 0===t?void 0:t.has(e))||this._add(e,n)}},{key:"_remove",value:function(e,t){var n,r,i,o,a;(null!==(n=this.nextValue)&&void 0!==n||(this.nextValue=new Set(this.previousValue)),this.nextValue.delete(e),null!==(r=this.diff)&&void 0!==r||(this.diff={}),t)?(null!==(o=(i=this.diff).removed)&&void 0!==o||(i.removed=new Set),this.diff.removed.add(e)):null===(a=this.diff.added)||void 0===a||a.delete(e)}},{key:"remove",value:function(e){var t,n=this.previousValue.has(e);if(!n){var r;if(!(null===(r=this.diff)||void 0===r||null===(r=r.added)||void 0===r?void 0:r.has(e)))return;return this._remove(e,n)}(null===(t=this.diff)||void 0===t||null===(t=t.removed)||void 0===t?void 0:t.has(e))||this._remove(e,n)}}]),e}();function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(e,t){var n,r=[],i=J(e);try{e:for(i.s();!(n=i.n()).done;){var o,a=n.value,s=J(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;if(t?t(a,u):a===u)continue e}}catch(l){s.e(l)}finally{s.f()}r.push(a)}}catch(l){i.e(l)}finally{i.f()}return r}function Te(e){return e.filter((function(e){return void 0!==e&&null!==e}))}function Me(e){return e[e.length-1]}function je(e,t){var n,r,i=1/0,o=J(e);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=t(a);s<i&&(n=a,i=s)}}catch(u){o.e(u)}finally{o.f()}return n}function Ae(e){return function t(){try{return e.apply(void 0,arguments)}catch(n){throw n instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(n,t),n}}}function Oe(e,t){var n=t&&e&&"object"===typeof e&&t in e?e[t]:e;throw new Error("Unknown switch case ".concat(n))}var Le=Ae((function(e,t){if(!e)throw new Error(t||"Assertion Error")})),ze=Ae((function(e,t){if(null==e)throw new Error(null!==t&&void 0!==t?t:"value must be defined");return e}));function De(e,t){var n=void 0,r=function(){n||((n={}).promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))),clearTimeout(n.timeout);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return n.latestArgs=i,n.timeout=setTimeout((function(){var t=n;n=void 0;try{t.resolve(e.apply(void 0,u(t.latestArgs)))}catch(ej){t.reject(ej)}}),t),n.promise};return r.cancel=function(){n&&clearTimeout(n.timeout)},r}var Re=new WeakMap;function Ne(e,t){if("object"===typeof e&&null!==e){var n=Re.get(e);n||(n={tags:{},extras:{}},Re.set(e,n)),t.tags&&(n.tags=Ce(Ce({},n.tags),t.tags)),t.extras&&(n.extras=Ce(Ce({},n.extras),t.extras))}}function Be(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t+""}function Fe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=0,n=0,r=0,i=0;function o(){var e=t^t<<11;return t=n,n=r,r=i,(i^=(i>>>19^e^e>>>8)>>>0)/4294967296*2}for(var a=0;a<e.length+64;a++)t^=0|e.charCodeAt(a),o();return o}function Ue(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=G(t,2),o=i[0],a=i[1],s=G(n,2),u=s[0],l=s[1],c=u+(e-o)/(a-o)*(l-u);return r?u<l?Math.max(Math.min(c,l),u):Math.max(Math.min(c,u),l):c}function Ke(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ve(e,t){if(Ke(e,t))return e[t]}function We(e){if(!e)return e;if(Array.isArray(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(We(e[r]));return t}if("object"===typeof e){for(var i=Object.keys(e),o=i.length,a={},s=0;s<o;s++){var u=i[s];a[u]=We(e[u])}return a}return e}function He(e){return Object.keys(e)}function Ye(e){return Object.values(e)}function Xe(e){return Object.entries(e)}function qe(e){return Object.fromEntries(e)}function $e(e,t){var n,r={},i=!1,o=J(Xe(e));try{for(o.s();!(n=o.n()).done;){var a=G(n.value,2),s=a[0],u=a[1];t(s,u)?r[s]=u:i=!0}}catch(l){o.e(l)}finally{o.f()}return i?r:e}function Ge(e,t){var n,r={},i=J(Xe(e));try{for(i.s();!(n=i.n()).done;){var o=G(n.value,2),a=o[0],s=t(a,o[1]);r[a]=s}}catch(u){i.e(u)}finally{i.f()}return r}var Qe,Ze=function(){return"undefined"!==typeof process&&!1},Je=[],et=function(){var e,t=J(Je.splice(0,Je.length));try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(n){t.e(n)}finally{t.f()}};function tt(){Qe||(Qe=requestAnimationFrame((function(){Qe=void 0,et()})))}function nt(e,t){return e.id>t.id?1:-1}function rt(e){return null!==e}var it="undefined"!==typeof window&&window.structuredClone?window.structuredClone:function(e){return e?JSON.parse(JSON.stringify(e)):e},ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce((function(e,t){return e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"}),"")},at=function(){function e(t,n){var r,i,o=this;M(this,e),z(this,"createDefaultProperties",void 0),z(this,"migrations",void 0),z(this,"validator",void 0),z(this,"scope",void 0),z(this,"isInstance",(function(e){return(null===e||void 0===e?void 0:e.typeName)===o.typeName})),this.typeName=t,this.createDefaultProperties=n.createDefaultProperties,this.migrations=n.migrations,this.validator=null!==(r=n.validator)&&void 0!==r?r:{validate:function(e){return e}},this.scope=null!==(i=n.scope)&&void 0!==i?i:"document"}return L(e,[{key:"create",value:function(e){for(var t=Ce(Ce({},this.createDefaultProperties()),{},{id:this.createId()}),n=0,r=Object.entries(e);n<r.length;n++){var i=G(r[n],2),o=i[0],a=i[1];void 0!==a&&(t[o]=a)}return t.typeName=this.typeName,t}},{key:"clone",value:function(e){return Ce(Ce({},it(e)),{},{id:this.createId()})}},{key:"createId",value:function(e){return this.typeName+":"+(null!==e&&void 0!==e?e:ot())}},{key:"createCustomId",value:function(e){return this.typeName+":"+e}},{key:"parseId",value:function(e){if(!this.isId(e))throw new Error('ID "'.concat(e,'" is not a valid ID for type "').concat(this.typeName,'"'));return e.slice(this.typeName.length+1)}},{key:"isId",value:function(e){if(!e)return!1;for(var t=0;t<this.typeName.length;t++)if(e[t]!==this.typeName[t])return!1;return":"===e[this.typeName.length]}},{key:"withDefaultProperties",value:function(t){return new e(this.typeName,{createDefaultProperties:t,migrations:this.migrations,validator:this.validator,scope:this.scope})}},{key:"validate",value:function(e){return this.validator.validate(e)}}]),e}();function st(e,t){var n;return new at(e,{createDefaultProperties:function(){return{}},migrations:null!==(n=t.migrations)&&void 0!==n?n:{currentVersion:0,firstVersion:0,migrators:{}},validator:t.validator,scope:t.scope})}var ut=function(){function e(){M(this,e),z(this,"items",new WeakMap)}return L(e,[{key:"get",value:function(e,t){return this.items.has(e)||this.items.set(e,t(e)),this.items.get(e)}}]),e}(),lt=n(2467);function ct(e,t){for(var n=0,r=Object.entries(e);n<r.length;n++){var i=G(r[n],2),o=i[0],a=i[1],s=t[o];if("eq"in a&&s!==a.eq)return!1;if("neq"in a&&s===a.neq)return!1;if("gt"in a&&("number"!==typeof s||s<=a.gt))return!1}return!0}function dt(e,t,n){for(var r=Object.fromEntries(Object.keys(n).map((function(e){return[e,new Set]}))),i=0,o=Object.entries(n);i<o.length;i++){var a=G(o[i],2),s=a[0],u=a[1];if("eq"in u){var l=e.index(t,s).value.get(u.eq);if(l){var c,d=J(l);try{for(d.s();!(c=d.n()).done;){var f=c.value;r[s].add(f)}}catch(T){d.e(T)}finally{d.f()}}}else if("neq"in u){var p,h=J(e.index(t,s).value);try{for(h.s();!(p=h.n()).done;){var v=G(p.value,2),g=v[0],m=v[1];if(g!==u.neq){var y,b=J(m);try{for(b.s();!(y=b.n()).done;){var w=y.value;r[s].add(w)}}catch(T){b.e(T)}finally{b.f()}}}}catch(T){h.e(T)}finally{h.f()}}else if("gt"in u){var x,k=J(e.index(t,s).value);try{for(k.s();!(x=k.n()).done;){var S=G(x.value,2),_=S[0],P=S[1];if(_>u.gt){var E,C=J(P);try{for(C.s();!(E=C.n()).done;){var I=E.value;r[s].add(I)}}catch(T){C.e(T)}finally{C.f()}}}}catch(T){k.e(T)}finally{k.f()}}}return function(e){if(0===e.length)return new Set;var t,n=e[0],r=e.slice(1),i=new Set,o=J(n);try{var a=function(){var e=t.value;r.every((function(t){return t.has(e)}))&&i.add(e)};for(o.s();!(t=o.n()).done;)a()}catch(T){o.e(T)}finally{o.f()}return i}(Object.values(r))}var ft=function(){function e(t,n){M(this,e),z(this,"indexCache",new Map),z(this,"historyCache",new Map),this.atoms=t,this.history=n}return L(e,[{key:"filterHistory",value:function(e){var t=this;if(this.historyCache.has(e))return this.historyCache.get(e);var n=ve("filterHistory:"+e,(function(n,r){if(ce(n))return t.history.value;var i=t.history.getDiffSince(r);if(i===Q)return t.history.value;var o,a={added:{},removed:{},updated:{}},s=0,u=0,l=0,c=J(i);try{for(c.s();!(o=c.n()).done;){var d,f=o.value,p=J(Ye(f.added));try{for(p.s();!(d=p.n()).done;){var h=d.value;if(h.typeName===e)if(a.removed[h.id]){var v=a.removed[h.id];delete a.removed[h.id],u--,v!==h&&(a.updated[h.id]=[v,h],l++)}else a.added[h.id]=h,s++}}catch(_){p.e(_)}finally{p.f()}var g,m=J(Ye(f.updated));try{for(m.s();!(g=m.n()).done;){var y=G(g.value,2),b=y[0],w=y[1];w.typeName===e&&(a.added[w.id]?a.added[w.id]=w:a.updated[w.id]?a.updated[w.id]=[a.updated[w.id][0],w]:(a.updated[w.id]=[b,w],l++))}}catch(_){m.e(_)}finally{m.f()}var x,k=J(Ye(f.removed));try{for(k.s();!(x=k.n()).done;){var S=x.value;S.typeName===e&&(a.added[S.id]?(delete a.added[S.id],s--):a.updated[S.id]?(a.removed[S.id]=a.updated[S.id][0],delete a.updated[S.id],l--,u++):(a.removed[S.id]=S,u++))}}catch(_){k.e(_)}finally{k.f()}}}catch(_){c.e(_)}finally{c.f()}return s||u||l?fe(t.history.value,a):n}),{historyLength:100});return this.historyCache.set(e,n),n}},{key:"index",value:function(e,t){var n=e+":"+t;if(this.indexCache.has(n))return this.indexCache.get(n);var r=this.__uncached_createIndex(e,t);return this.indexCache.set(n,r),r}},{key:"__uncached_createIndex",value:function(e,t){var n=this,r=this.filterHistory(e),i=function(){r.value;var i,o=new Map,a=J(Ye(n.atoms.value));try{for(a.s();!(i=a.n()).done;){var s=i.value.value;if(s.typeName===e){var u=s[t];o.has(u)||o.set(u,new Set),o.get(u).add(s.id)}}}catch(l){a.e(l)}finally{a.f()}return o};return ve("index:"+e+":"+t,(function(n,o){if(ce(n))return i();var a=r.getDiffSince(o);if(a===Q)return i();var s,u=new Map,l=function(e,t){var r,i=u.get(e);i||(i=new Pe(null!==(r=n.get(e))&&void 0!==r?r:new Set)),i.add(t),u.set(e,i)},c=function(e,t){var r,i=u.get(e);i||(i=new Pe(null!==(r=n.get(e))&&void 0!==r?r:new Set)),i.remove(t),u.set(e,i)},d=J(a);try{for(d.s();!(s=d.n()).done;){var f,p=s.value,h=J(Ye(p.added));try{for(h.s();!(f=h.n()).done;){var v=f.value;if(v.typeName===e)l(v[t],v.id)}}catch(O){h.e(O)}finally{h.f()}var g,m=J(Ye(p.updated));try{for(m.s();!(g=m.n()).done;){var y=G(g.value,2),b=y[0],w=y[1];if(w.typeName===e){var x=b[t],k=w[t];x!==k&&(c(x,w.id),l(k,w.id))}}}catch(O){m.e(O)}finally{m.f()}var S,_=J(Ye(p.removed));try{for(_.s();!(S=_.n()).done;){var P=S.value;if(P.typeName===e)c(P[t],P.id)}}catch(O){_.e(O)}finally{_.f()}}}catch(O){d.e(O)}finally{d.f()}var E,C=void 0,I=void 0,T=J(u);try{for(T.s();!(E=T.n()).done;){var M=G(E.value,2),j=M[0],A=M[1].get();A&&(C||(C=new Map(n)),I||(I=new Map),0===A.value.size?C.delete(j):C.set(j,A.value),I.set(j,A.diff))}}catch(O){T.e(O)}finally{T.f()}return C&&I?fe(C,I):n}),{historyLength:100})}},{key:"record",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return{}},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"record:"+e+(n?":"+n.toString():""),i=this.ids(e,n,r);return ve(r,(function(){var e,n=J(i.value);try{for(n.s();!(e=n.n()).done;){var r,o=e.value;return null===(r=t.atoms.value[o])||void 0===r?void 0:r.value}}catch(a){n.e(a)}finally{n.f()}}))}},{key:"records",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return{}},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"records:"+e+(n?":"+n.toString():""),i=this.ids(e,n,"ids:"+r);return ve(r,(function(){return u(i.value).map((function(e){var n=t.atoms.value[e];if(!n)throw new Error("no atom found for record id: "+e);return n.value}))}))}},{key:"ids",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return{}},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ids:"+e+(n?":"+n.toString():""),i=this.filterHistory(e),o=function(){i.value;var r=n();return 0===Object.keys(r).length?new Set(Ye(t.atoms.value).flatMap((function(t){var n=t.value;return n.typeName===e?n.id:[]}))):dt(t,e,r)},a=function(e){var t=o(),n=function(e,t){var n,r={},i=J(t);try{for(i.s();!(n=i.n()).done;){var o,a=n.value;e.has(a)||(null!==(o=r.added)&&void 0!==o||(r.added=new Set),r.added.add(a))}}catch(d){i.e(d)}finally{i.f()}var s,u=J(e);try{for(u.s();!(s=u.n()).done;){var l,c=s.value;t.has(c)||(null!==(l=r.removed)&&void 0!==l||(r.removed=new Set),r.removed.add(c))}}catch(d){u.e(d)}finally{u.f()}return r.added||r.removed?r:void 0}(e,t);return n?fe(t,n):e},s=ve("ids_query:"+r,n,{isEqual:lt});return ve("query:"+r,(function(t,n){var r=s.value;if(ce(t))return o();if(n<s.lastChangedEpoch)return a(t);var u=i.getDiffSince(n);if(u===Q)return a(t);var l,c=new Pe(t),d=J(u);try{for(d.s();!(l=d.n()).done;){var f,p=l.value,h=J(Ye(p.added));try{for(h.s();!(f=h.n()).done;){var v=f.value;v.typeName===e&&ct(r,v)&&c.add(v.id)}}catch(_){h.e(_)}finally{h.f()}var g,m=J(Ye(p.updated));try{for(m.s();!(g=m.n()).done;){var y=G(g.value,2),b=(y[0],y[1]);b.typeName===e&&(ct(r,b)?c.add(b.id):c.remove(b.id))}}catch(_){m.e(_)}finally{m.f()}var w,x=J(Ye(p.removed));try{for(x.s();!(w=x.n()).done;){var k=w.value;k.typeName===e&&c.remove(k.id)}}catch(_){x.e(_)}finally{x.f()}}}catch(_){d.e(_)}finally{d.f()}var S=c.get();return S?fe(S.value,S.diff):t}),{historyLength:50})}},{key:"exec",value:function(e,t){var n=dt(this,e,t);if(0===n.size)return K;var r=this.atoms.value;return u(n).map((function(e){return r[e].value}))}}]),e}();var pt=function(){function e(t){var n=this;M(this,e),z(this,"id",ot()),z(this,"atoms",ue("store_atoms",{})),z(this,"history",ue("history",0,{historyLength:1e3})),z(this,"query",new ft(this.atoms,this.history)),z(this,"listeners",new Set),z(this,"historyAccumulator",new vt),z(this,"historyReactor",void 0),z(this,"schema",void 0),z(this,"props",void 0),z(this,"scopedTypes",void 0),z(this,"onAfterCreate",void 0),z(this,"onAfterChange",void 0),z(this,"onBeforeDelete",void 0),z(this,"onAfterDelete",void 0),z(this,"_runCallbacks",!0),z(this,"put",(function(e,t){ae((function(){for(var r,i={},o={},a=n.atoms.__unsafe__getWithoutCapture(),s=null,u=!1,l=0,c=e.length;l<c;l++){var d,f=(null!==(d=s)&&void 0!==d?d:a)[(r=e[l]).id];if(f){var p=f.__unsafe__getWithoutCapture();r=n.schema.validateRecord(n,r,null!==t&&void 0!==t?t:"updateRecord",p),f.set(r);var h=f.__unsafe__getWithoutCapture();p!==h&&(u=!0,i[r.id]=[p,h])}else u=!0,o[(r=n.schema.validateRecord(n,r,null!==t&&void 0!==t?t:"createRecord",null)).id]=r,s||(s=Ce({},a)),s[r.id]=ue("atom:"+r.id,r)}if(s&&n.atoms.set(s),u){n.updateHistory({added:o,updated:i,removed:{}});var v=n.onAfterCreate,g=n.onAfterChange;v&&n._runCallbacks&&Object.values(o).forEach((function(e){v(e)})),g&&n._runCallbacks&&Object.values(i).forEach((function(e){var t=G(e,2),n=t[0],r=t[1];g(n,r)}))}}))})),z(this,"remove",(function(e){ae((function(){if(n.onBeforeDelete&&n._runCallbacks){var t,r=J(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=n.atoms.__unsafe__getWithoutCapture()[i];o&&n.onBeforeDelete(o.value)}}catch(l){r.e(l)}finally{r.f()}}var a=void 0;if(n.atoms.update((function(t){var n,r,i=void 0,o=J(e);try{for(o.s();!(r=o.n()).done;){var s=r.value;s in t&&(i||(i=Ce({},t)),a||(a={}),delete i[s],a[s]=t[s].value)}}catch(l){o.e(l)}finally{o.f()}return null!==(n=i)&&void 0!==n?n:t})),a&&(n.updateHistory({added:{},updated:{},removed:a}),n.onAfterDelete&&n._runCallbacks))for(var s=0,u=e.length;s<u;s++)n.onAfterDelete(a[e[s]])}))})),z(this,"get",(function(e){var t;return null===(t=n.atoms.value[e])||void 0===t?void 0:t.value})),z(this,"unsafeGetWithoutCapture",(function(e){var t;return null===(t=n.atoms.value[e])||void 0===t?void 0:t.__unsafe__getWithoutCapture()})),z(this,"serialize",(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"document",r={},i=J(Xe(n.atoms.value));try{for(i.s();!(e=i.n()).done;){var o=G(e.value,2),a=o[0],s=o[1].value;("all"===t||n.scopedTypes[t].has(s.typeName))&&(r[a]=s)}}catch(u){i.e(u)}finally{i.f()}return r})),z(this,"allRecords",(function(){return Ye(n.atoms.value).map((function(e){return e.value}))})),z(this,"clear",(function(){n.remove(He(n.atoms.value))})),z(this,"update",(function(e,t){var r=n.atoms.value[e];r?n.put([t(r.__unsafe__getWithoutCapture())]):console.error("Record ".concat(e," not found. This is probably an error"))})),z(this,"has",(function(e){return!!n.atoms.value[e]})),z(this,"listen",(function(e,t){var r,i;n._flushHistory();var o={onHistory:e,filters:{source:null!==(r=null===t||void 0===t?void 0:t.source)&&void 0!==r?r:"all",scope:null!==(i=null===t||void 0===t?void 0:t.scope)&&void 0!==i?i:"all"}};return n.listeners.add(o),n.historyReactor.scheduler.isActivelyListening||n.historyReactor.start(),function(){n.listeners.delete(o),0===n.listeners.size&&n.historyReactor.stop()}})),z(this,"isMergingRemoteChanges",!1),z(this,"mergeRemoteChanges",(function(e){if(n.isMergingRemoteChanges)return e();try{n.isMergingRemoteChanges=!0,ae(e)}finally{n.isMergingRemoteChanges=!1}})),z(this,"createComputedCache",(function(e,t){var r=new ut;return{get:function(i){var o=n.atoms.value[i];if(o)return r.get(o,(function(){return ve(e+":"+i,(function(){return t(o.value)}))})).value}}})),z(this,"createSelectedComputedCache",(function(e,t,r){var i=new ut;return{get:function(o){var a=n.atoms.value[o];if(a){var s=ve(e+":"+o+":selector",(function(){return t(a.value)}));return i.get(a,(function(){return ve(e+":"+o,(function(){return r(s.value)}))})).value}}}})),z(this,"_integrityChecker",void 0),z(this,"_isPossiblyCorrupted",!1);var r=t.initialData,i=t.schema;this.schema=i,this.props=t.props,r&&this.atoms.set(qe(Xe(r).map((function(e){var t=G(e,2),r=t[0],i=t[1];return[r,ue("atom:"+r,n.schema.validateRecord(n,i,"initialize",null))]})))),this.historyReactor=function(e,t,n){var r=new ge(e,t,n);return{scheduler:r,start:function(e){var t,n=null!==(t=null===e||void 0===e?void 0:e.force)&&void 0!==t&&t;r.attach(),n?r.scheduleEffect():r.maybeScheduleEffect()},stop:function(){r.detach()}}}("Store.historyReactor",(function(){n.history.value,n._flushHistory()}),{scheduleEffect:function(e){return function(e){if(Ze())return e();Je.includes(e)||(Je.push(e),tt())}(e)}}),this.scopedTypes={document:new Set(Ye(this.schema.types).filter((function(e){return"document"===e.scope})).map((function(e){return e.typeName}))),session:new Set(Ye(this.schema.types).filter((function(e){return"session"===e.scope})).map((function(e){return e.typeName}))),presence:new Set(Ye(this.schema.types).filter((function(e){return"presence"===e.scope})).map((function(e){return e.typeName})))}}return L(e,[{key:"_flushHistory",value:function(){if(this.historyAccumulator.hasChanges()){var e,t=J(this.historyAccumulator.flush());try{for(t.s();!(e=t.n()).done;){var n,r=e.value,i=r.changes,o=r.source,a=null,s=null,u=null,l=J(this.listeners);try{for(l.s();!(n=l.n()).done;){var c=n.value,d=c.onHistory,f=c.filters;if("all"===f.source||f.source===o)if("all"!==f.scope)if("document"===f.scope){var p;if(null!==(p=s)&&void 0!==p||(s=this.filterChangesByScope(i,"document")),!s)continue;d({changes:s,source:o})}else if("session"===f.scope){var h;if(null!==(h=a)&&void 0!==h||(a=this.filterChangesByScope(i,"session")),!a)continue;d({changes:a,source:o})}else{var v;if(null!==(v=u)&&void 0!==v||(u=this.filterChangesByScope(i,"presence")),!u)continue;d({changes:u,source:o})}else d({changes:i,source:o})}}catch(g){l.e(g)}finally{l.f()}}}catch(g){t.e(g)}finally{t.f()}}}},{key:"filterChangesByScope",value:function(e,t){var n=this,r={added:$e(e.added,(function(e,r){return n.scopedTypes[t].has(r.typeName)})),updated:$e(e.updated,(function(e,r){return n.scopedTypes[t].has(r[1].typeName)})),removed:$e(e.removed,(function(e,r){return n.scopedTypes[t].has(r.typeName)}))};return 0===Object.keys(r.added).length&&0===Object.keys(r.updated).length&&0===Object.keys(r.removed).length?null:r}},{key:"updateHistory",value:function(e){this.historyAccumulator.add({changes:e,source:this.isMergingRemoteChanges?"remote":"user"}),0===this.listeners.size&&this.historyAccumulator.clear(),this.history.set(this.history.value+1,e)}},{key:"validate",value:function(e){var t=this;this.allRecords().forEach((function(n){return t.schema.validateRecord(t,n,e,null)}))}},{key:"getSnapshot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"document";return{store:this.serialize(e),schema:this.schema.serialize()}}},{key:"loadSnapshot",value:function(e){var t=this,n=this.schema.migrateStoreSnapshot(e);if("error"===n.type)throw new Error("Failed to migrate snapshot: ".concat(n.reason));ae((function(){t.clear(),t.put(Object.values(n.value)),t.ensureStoreIsUsable()}))}},{key:"extractingChanges",value:function(e){var t=[],n=this.historyAccumulator.intercepting((function(e){return t.push(e.changes)}));try{return ae(e),ht(t)}finally{n()}}},{key:"applyDiff",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this._runCallbacks;try{this._runCallbacks=n,ae((function(){var n=Ye(e.added).concat(Ye(e.updated).map((function(e){var t=G(e,2);t[0];return t[1]}))),r=He(e.removed);n.length&&t.put(n),r.length&&t.remove(r)}))}finally{this._runCallbacks=r}}},{key:"ensureStoreIsUsable",value:function(){var e,t;null!==(e=this._integrityChecker)&&void 0!==e||(this._integrityChecker=this.schema.createIntegrityChecker(this)),null===(t=this._integrityChecker)||void 0===t||t.call(this)}},{key:"markAsPossiblyCorrupted",value:function(){this._isPossiblyCorrupted=!0}},{key:"isPossiblyCorrupted",value:function(){return this._isPossiblyCorrupted}}]),e}();function ht(e){var t,n={added:{},removed:{},updated:{}},r=J(e);try{for(r.s();!(t=r.n()).done;){var i,o=t.value,a=J(Xe(o.added));try{for(a.s();!(i=a.n()).done;){var s=G(i.value,2),u=s[0],l=s[1];if(n.removed[u]){var c=n.removed[u];delete n.removed[u],c!==l&&(n.updated[u]=[c,l])}else n.added[u]=l}}catch(k){a.e(k)}finally{a.f()}var d,f=J(Xe(o.updated));try{for(f.s();!(d=f.n()).done;){var p=G(d.value,2),h=p[0],v=G(p[1],2),g=(v[0],v[1]);n.added[h]?(n.added[h]=g,delete n.updated[h],delete n.removed[h]):n.updated[h]?(n.updated[h][1]=g,delete n.removed[h]):(n.updated[h]=o.updated[h],delete n.removed[h])}}catch(k){f.e(k)}finally{f.f()}var m,y=J(Xe(o.removed));try{for(y.s();!(m=y.n()).done;){var b=G(m.value,2),w=b[0],x=b[1];n.added[w]?delete n.added[w]:n.updated[w]?(n.removed[w]=n.updated[w][0],delete n.updated[w]):n.removed[w]=x}}catch(k){y.e(k)}finally{y.f()}}}catch(k){r.e(k)}finally{r.f()}return n}var vt=function(){function e(){M(this,e),z(this,"_history",[]),z(this,"_interceptors",new Set)}return L(e,[{key:"intercepting",value:function(e){var t=this;return this._interceptors.add(e),function(){t._interceptors.delete(e)}}},{key:"add",value:function(e){this._history.push(e);var t,n=J(this._interceptors);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"flush",value:function(){var e=function(e){for(var t,n=[],r=e[0],i=1,o=e.length;i<o;i++)t=e[i],r.source!==t.source?(n.push(r),r=t):r={source:r.source,changes:ht([r.changes,t.changes])};return n.push(r),n}(this._history);return this._history=[],e}},{key:"clear",value:function(){this._history=[]}},{key:"hasChanges",value:function(){return this._history.length>0}}]),e}();function gt(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var mt=["typeName","id"];function yt(e){var t=e.currentVersion,n=e.firstVersion,r=e.migrators,i=void 0===r?{}:r,o=e.subTypeKey,a=e.subTypeMigrations;if("number"===typeof t&&"number"===typeof n){if(t===n)throw Error("Current version is equal to initial version.");if(t<n)throw Error("Current version is lower than initial version.")}return{firstVersion:null!==n&&void 0!==n?n:0,currentVersion:null!==t&&void 0!==t?t:0,migrators:i,subTypeKey:o,subTypeMigrations:a}}var bt=function(e){return e.IncompatibleSubtype="incompatible-subtype",e.UnknownType="unknown-type",e.TargetVersionTooNew="target-version-too-new",e.TargetVersionTooOld="target-version-too-old",e.MigrationError="migration-error",e.UnrecognizedSubtype="unrecognized-subtype",e}(bt||{});function wt(e){var t=e.record,n=e.migrations,r=e.fromVersion,i=e.toVersion,o=r;if(!function(e){return"object"===typeof e&&null!==e&&"id"in e&&"typeName"in e}(t))throw new Error("[migrateRecord] object is not a record");for(var a=t.typeName,s=t.id,u=gt(t,mt);o<i;){var l=o+1,c=n.migrators[l];if(!c)return{type:"error",reason:"target-version-too-new"};u=c.up(u),o=l}for(;o>i;){var d=o-1,f=n.migrators[o];if(!f)return{type:"error",reason:"target-version-too-old"};u=f.down(u),o=d}return{type:"success",value:Ce(Ce({},u),{},{id:s,typeName:a})}}function xt(e){for(var t=e.value,n=e.migrations,r=e.fromVersion,i=e.toVersion,o=r;o<i;){var a=o+1,s=n.migrators[a];if(!s)return{type:"error",reason:"target-version-too-new"};t=s.up(t),o=a}for(;o>i;){var u=o-1,l=n.migrators[o];if(!l)return{type:"error",reason:"target-version-too-old"};t=l.down(t),o=u}return{type:"success",value:t}}var kt=function(){function e(t,n){M(this,e),this.types=t,this.options=n}return L(e,[{key:"currentStoreVersion",get:function(){var e,t;return null!==(e=null===(t=this.options.snapshotMigrations)||void 0===t?void 0:t.currentVersion)&&void 0!==e?e:0}},{key:"validateRecord",value:function(e,t,n,r){try{var i=Ve(this.types,t.typeName);if(!i)throw new Error("Missing definition for record type ".concat(t.typeName));return i.validate(t)}catch(o){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:e,record:t,phase:n,recordBefore:r,error:o});throw o}}},{key:"migratePersistedRecord",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"up",i=Ve(this.types,e.typeName),o=t.recordVersions[e.typeName];if(!o||!i)return{type:"error",reason:bt.UnknownType};var a=i.migrations.currentVersion,s=o.version;if(a!==s){var u=wt("up"===r?{record:e,migrations:i.migrations,fromVersion:s,toVersion:a}:{record:e,migrations:i.migrations,fromVersion:a,toVersion:s});if("error"===u.type)return u;e=u.value}if(!i.migrations.subTypeKey)return{type:"success",value:e};var l=null===(n=i.migrations.subTypeMigrations)||void 0===n?void 0:n[e[i.migrations.subTypeKey]],c="subTypeVersions"in o?o.subTypeVersions[e[i.migrations.subTypeKey]]:void 0;if(void 0===l)return{type:"error",reason:bt.UnrecognizedSubtype};if(void 0===c)return{type:"error",reason:bt.IncompatibleSubtype};var d=wt("up"===r?{record:e,migrations:l,fromVersion:c,toVersion:l.currentVersion}:{record:e,migrations:l,fromVersion:l.currentVersion,toVersion:c});return"error"===d.type?d:{type:"success",value:d.value}}},{key:"migrateStoreSnapshot",value:function(e){var t,n=e.store,r=this.options.snapshotMigrations;if(!r)return{type:"success",value:n};var i=r.currentVersion,o=null!==(t=e.schema.storeVersion)&&void 0!==t?t:0;if(i<o)return{type:"error",reason:bt.TargetVersionTooOld};if(i>o){var a=xt({value:n,migrations:r,fromVersion:o,toVersion:i});if("error"===a.type)return a;n=a.value}var s,u=[],l=J(Ye(n));try{for(l.s();!(s=l.n()).done;){var c=s.value,d=this.migratePersistedRecord(c,e.schema);if("error"===d.type)return d;d.value&&d.value!==c&&u.push(d.value)}}catch(v){l.e(v)}finally{l.f()}if(u.length){n=Ce({},n);var f,p=J(u);try{for(p.s();!(f=p.n()).done;){var h=f.value;n[h.id]=h}}catch(v){p.e(v)}finally{p.f()}}return{type:"success",value:n}}},{key:"createIntegrityChecker",value:function(e){var t,n,r;return null!==(t=null===(n=(r=this.options).createIntegrityChecker)||void 0===n?void 0:n.call(r,e))&&void 0!==t?t:void 0}},{key:"serialize",value:function(){var e,t;return{schemaVersion:1,storeVersion:null!==(e=null===(t=this.options.snapshotMigrations)||void 0===t?void 0:t.currentVersion)&&void 0!==e?e:0,recordVersions:Object.fromEntries(Ye(this.types).map((function(e){return[e.typeName,e.migrations.subTypeKey&&e.migrations.subTypeMigrations?{version:e.migrations.currentVersion,subTypeKey:e.migrations.subTypeKey,subTypeVersions:e.migrations.subTypeMigrations?Object.fromEntries(Object.entries(e.migrations.subTypeMigrations).map((function(e){var t=G(e,2);return[t[0],t[1].currentVersion]}))):void 0}:{version:e.migrations.currentVersion}]})))}}},{key:"serializeEarliestVersion",value:function(){var e,t;return{schemaVersion:1,storeVersion:null!==(e=null===(t=this.options.snapshotMigrations)||void 0===t?void 0:t.firstVersion)&&void 0!==e?e:0,recordVersions:Object.fromEntries(Ye(this.types).map((function(e){return[e.typeName,e.migrations.subTypeKey&&e.migrations.subTypeMigrations?{version:e.migrations.firstVersion,subTypeKey:e.migrations.subTypeKey,subTypeVersions:e.migrations.subTypeMigrations?Object.fromEntries(Object.entries(e.migrations.subTypeMigrations).map((function(e){var t=G(e,2);return[t[0],t[1].firstVersion]}))):void 0}:{version:e.migrations.firstVersion}]})))}}}],[{key:"create",value:function(t,n){return new e(t,null!==n&&void 0!==n?n:{})}}]),e}(),St=function(e,t){if(e.schemaVersion>t.schemaVersion)return 1;if(e.schemaVersion<t.schemaVersion)return-1;if(e.storeVersion>t.storeVersion)return 1;if(e.storeVersion<t.storeVersion)return-1;for(var n=0,r=Object.keys(e.recordVersions);n<r.length;n++){var i=r[n],o=e.recordVersions[i],a=t.recordVersions[i];if(o.version>a.version)return 1;if(o.version<a.version)return-1;if("subTypeVersions"in o&&!("subTypeVersions"in a))return 1;if(!("subTypeVersions"in o)&&"subTypeVersions"in a)return-1;if("subTypeVersions"in o&&"subTypeVersions"in a)for(var s=0,u=Object.keys(o.subTypeVersions);s<u.length;s++){var l=u[s],c=o.subTypeVersions[l],d=a.subTypeVersions[l];if(c>d)return 1;if(c<d)return-1}}return 0};function _t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pt(e,t){return Pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pt(e,t)}function Et(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pt(e,t)}function Ct(e){return Ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ct(e)}function It(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ej){return!1}}function Tt(e){var t=It();return function(){var n,r=Ct(e);if(t){var i=Ct(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===j(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _t(e)}(this,n)}}function Mt(e,t,n){return Mt=It()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Pt(i,n.prototype),i},Mt.apply(null,arguments)}function jt(e){var t="function"===typeof Map?new Map:void 0;return jt=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Mt(e,arguments,Ct(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Pt(r,e)},jt(e)}var At=function(e){Et(n,e);var t=Tt(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];M(this,n);var o=function(e){if(!e.length)return null;var t,n="",r=J(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;"number"===typeof i?n+=".".concat(i):i.startsWith("(")?n.endsWith(")")?n="".concat(n.slice(0,-1),", ").concat(i.slice(1)):n+=i:n+=".".concat(i)}}catch(o){r.e(o)}finally{r.f()}return n.startsWith(".")?n.slice(1):n}(i),a=e.split("\n").map((function(e,t){return 0===t?e:"  ".concat(e)})).join("\n");return z(_t(r=t.call(this,i?"At ".concat(o,": ").concat(a):a)),"name","ValidationError"),r.rawMessage=e,r.path=i,r}return L(n)}(jt(Error));function Ot(e,t){try{return t()}catch(n){if(n instanceof At)throw new At(n.rawMessage,[e].concat(u(n.path)));throw new At(n.toString(),[e])}}function Lt(e){if(null===e)return"null";if(Array.isArray(e))return"an array";var t=typeof e;switch(t){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return"a ".concat(t);case"object":return"an ".concat(t);case"undefined":return"undefined";default:Oe(t)}}var zt=function(){function e(t){M(this,e),this.validationFn=t}return L(e,[{key:"validate",value:function(e){return this.validationFn(e)}},{key:"nullable",value:function(){return fn(this)}},{key:"optional",value:function(){return dn(this)}},{key:"refine",value:function(t){var n=this;return new e((function(e){return t(n.validate(e))}))}},{key:"check",value:function(e,t){return"string"===typeof e?this.refine((function(n){return Ot("(check ".concat(e,")"),(function(){return t(n)})),n})):this.refine((function(t){return e(t),t}))}}]),e}(),Dt=function(e){Et(n,e);var t=Tt(n);function n(e){var r;return M(this,n),r=t.call(this,(function(t){for(var n=Jt.validate(t),r=function(t){Ot(t,(function(){return e.validate(n[t])}))},i=0;i<n.length;i++)r(i);return n})),r.itemValidator=e,r}return L(n,[{key:"nonEmpty",value:function(){return this.check((function(e){if(0===e.length)throw new At("Expected a non-empty array")}))}},{key:"lengthGreaterThan1",value:function(){return this.check((function(e){if(e.length<=1)throw new At("Expected an array with length greater than 1")}))}}]),n}(zt),Rt=function(e){Et(n,e);var t=Tt(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return M(this,n),(r=t.call(this,(function(t){if("object"!==typeof t||null===t)throw new At("Expected object, got ".concat(Lt(t)));for(var n=function(){var e=G(o[r],2),n=e[0],i=e[1];Ot(n,(function(){i.validate(Ve(t,n))}))},r=0,o=Object.entries(e);r<o.length;r++)n();if(!i)for(var a=0,s=Object.keys(t);a<s.length;a++){var u=s[a];if(!Ke(e,u))throw new At("Unexpected property",[u])}return t}))).config=e,r.shouldAllowUnknownProperties=i,r}return L(n,[{key:"allowUnknownProperties",value:function(){return new n(this.config,!0)}},{key:"extend",value:function(e){return new n(Ce(Ce({},this.config),e))}}]),n}(zt),Nt=function(e){Et(n,e);var t=Tt(n);function n(e,r,i){var o;return M(this,n),(o=t.call(this,(function(t){if("object"!==typeof t||null===t)throw new At("Expected an object, got ".concat(Lt(t)),[]);var n=Ve(t,e);if("string"!==typeof n)throw new At('Expected a string for key "'.concat(e,'", got ').concat(Lt(n)));var i=Ke(r,n)?r[n]:void 0;return void 0===i?o.unknownValueValidation(t,n):Ot("(".concat(e," = ").concat(n,")"),(function(){return i.validate(t)}))}))).key=e,o.config=r,o.unknownValueValidation=i,o}return L(n,[{key:"validateUnknownVariants",value:function(e){return new n(this.key,this.config,e)}}]),n}(zt),Bt=function(e){Et(n,e);var t=Tt(n);function n(e,r){var i;return M(this,n),(i=t.call(this,(function(t){if("object"!==typeof t||null===t)throw new At("Expected object, got ".concat(Lt(t)));for(var n=function(){var t=G(o[i],2),n=t[0],a=t[1];Ot(n,(function(){e.validate(n),r.validate(a)}))},i=0,o=Object.entries(t);i<o.length;i++)n();return t}))).keyValidator=e,i.valueValidator=r,i}return L(n)}(zt);function Ft(e){return new zt((function(t){if(typeof t!==e)throw new At("Expected ".concat(e,", got ").concat(Lt(t)));return t}))}var Ut=new zt((function(e){return e})),Kt=new zt((function(e){return e})),Vt=Ft("string"),Wt=Ft("number").check((function(e){if(Number.isNaN(e))throw new At("Expected a number, got NaN");if(!Number.isFinite(e))throw new At("Expected a finite number, got ".concat(e))})),Ht=Wt.check((function(e){if(e<0)throw new At("Expected a positive number, got ".concat(e))})),Yt=Wt.check((function(e){if(e<=0)throw new At("Expected a non-zero positive number, got ".concat(e))})),Xt=Wt.check((function(e){if(!Number.isInteger(e))throw new At("Expected an integer, got ".concat(e))})),qt=Xt.check((function(e){if(e<0)throw new At("Expected a positive integer, got ".concat(e))})),$t=Xt.check((function(e){if(e<=0)throw new At("Expected a non-zero positive integer, got ".concat(e))})),Gt=Ft("boolean"),Qt=Ft("bigint");function Zt(e){return new zt((function(t){if(t!==e)throw new At("Expected ".concat(e,", got ").concat(JSON.stringify(t)));return e}))}var Jt=new zt((function(e){if(!Array.isArray(e))throw new At("Expected an array, got ".concat(Lt(e)));return e}));function en(e){return new Dt(e)}var tn=new zt((function(e){if("object"!==typeof e||null===e)throw new At("Expected object, got ".concat(Lt(e)));return e}));function nn(e){return new Rt(e)}function rn(e){return null===e||"number"===typeof e||"string"===typeof e||"boolean"===typeof e||(Array.isArray(e)?e.every(rn):"object"===typeof e&&Object.values(e).every(rn))}var on=new zt((function(e){if(rn(e))return e;throw new At("Expected json serializable value, got ".concat(typeof e))}));function an(){return sn(Vt,on)}function sn(e,t){return new Bt(e,t)}function un(e,t){return new Nt(e,t,(function(n,r){throw new At("Expected one of ".concat(Object.keys(t).map((function(e){return JSON.stringify(e)})).join(" or "),", got ").concat(JSON.stringify(r)),[e])}))}function ln(e,t){return new zt((function(n){return Ot(n&&"object"===typeof n&&"id"in n&&"string"===typeof n.id?"".concat(e,"(id = ").concat(n.id,")"):e,(function(){return t.validate(n)}))}))}function cn(e){return new zt((function(t){if(!e.has(t)){var n=Array.from(e,(function(e){return JSON.stringify(e)})).join(" or ");throw new At("Expected ".concat(n,", got ").concat(t))}return t}))}function dn(e){return new zt((function(t){if(void 0!==t)return e.validate(t)}))}function fn(e){return new zt((function(t){return null===t?null:e.validate(t)}))}function pn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return cn(new Set(t))}function hn(e){return Vt.refine((function(t){if(!t.startsWith("".concat(e,":")))throw new Error("".concat(e,' ID must start with "').concat(e,':"'));return t}))}var vn=hn("asset");function gn(e,t){return nn({id:vn,typeName:Zt("asset"),type:Zt(e),props:t,meta:on})}var mn,yn=["meta"],bn=ln("camera",nn({typeName:Zt("camera"),id:hn("camera"),x:Wt,y:Wt,z:Wt,meta:on})),wn=1,xn=yt({currentVersion:wn,migrators:z({},wn,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,yn))}})}),kn=st("camera",{validator:bn,migrations:xn,scope:"session"}).withDefaultProperties((function(){return{x:0,y:0,z:1,meta:{}}})),Sn=nn({x:Wt,y:Wt,z:Wt.optional()}),_n=nn({x:Wt,y:Wt,w:Wt,h:Wt}),Pn=cn(new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"])),En=cn(new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"])),Cn=nn({color:Pn,type:En,rotation:Wt}),In=Wt.check((function(e){if(e<0||e>1)throw new At("Opacity must be between 0 and 1")})),Tn=new Set(["starting","paused","active","stopping"]),Mn=nn({points:en(Sn),size:Ht,color:Pn,opacity:Wt,state:cn(Tn),delay:Wt}),jn=["meta"],An=hn("page"),On=ln("page",nn({typeName:Zt("page"),id:An,name:Vt,index:Vt,meta:on})),Ln=1,zn=yt({currentVersion:Ln,migrators:z({},Ln,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,jn))}})}),Dn=st("page",{validator:On,migrations:zn,scope:"document"}).withDefaultProperties((function(){return{meta:{}}}));function Rn(e){return Dn.isId(e)}var Nn=["exportBackground"],Bn=["dialog"],Fn=["isToolLocked"],Un=["propsForNextShape"],Kn=["propsForNextShape"],Vn=["labelColor"],Wn=["followingUserId"],Hn=["zoomBrush"],Yn=["verticalAlign"],Xn=["delay"],qn=["userId"],$n=["isPenMode","isGridMode"],Gn=["opacity"],Qn=["propsForNextShape"],Zn=["opacityForNextShape"],Jn=["chatMessage","isChatting"],er=["highlightedUserIds"],tr=["propsForNextShape"],nr=["stylesForNextShape"],rr=["meta"];hn("instance");var ir,or=2,ar=3,sr=4,ur=5,lr=6,cr=7,dr=8,fr=9,pr=10,hr=11,vr=12,gr=13,mr=14,yr=15,br=16,wr=17,xr=yt({currentVersion:wr,migrators:(mn={},z(mn,1,{up:function(e){return Ce(Ce({},e),{},{exportBackground:!0})},down:function(e){e.exportBackground;return gt(e,Nn)}}),z(mn,or,{up:function(e){e.dialog;return gt(e,Bn)},down:function(e){return Ce(Ce({},e),{},{dialog:null})}}),z(mn,ar,{up:function(e){return Ce(Ce({},e),{},{isToolLocked:!1})},down:function(e){e.isToolLocked;return gt(e,Fn)}}),z(mn,sr,{up:function(e){var t=e.propsForNextShape;return Ce(Ce({},gt(e,Un)),{},{propsForNextShape:Object.fromEntries(Object.entries(t).filter((function(e){var t=G(e,1)[0];return["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(t)})))})},down:function(e){return e}}),z(mn,ur,{up:function(e){var t=e.propsForNextShape;return Ce(Ce({},gt(e,Kn)),{},{propsForNextShape:Ce(Ce({},t),{},{labelColor:"black"})})},down:function(e){var t=e.propsForNextShape,n=(t.labelColor,gt(t,Vn));return Ce(Ce({},e),{},{propsForNextShape:Ce({},n)})}}),z(mn,lr,{up:function(e){return Ce(Ce({},e),{},{followingUserId:null})},down:function(e){e.followingUserId;return gt(e,Wn)}}),z(mn,cr,{up:function(e){var t=e.propsForNextShape.align;return"justify"===t&&(t="start"),Ce(Ce({},e),{},{propsForNextShape:Ce(Ce({},e.propsForNextShape),{},{align:t})})},down:function(e){return Ce({},e)}}),z(mn,dr,{up:function(e){return Ce(Ce({},e),{},{zoomBrush:null})},down:function(e){e.zoomBrush;return gt(e,Hn)}}),z(mn,fr,{up:function(e){return Ce(Ce({},e),{},{propsForNextShape:Ce(Ce({},e.propsForNextShape),{},{verticalAlign:"middle"})})},down:function(e){var t=e.propsForNextShape,n=(t.verticalAlign,gt(t,Yn));return Ce(Ce({},e),{},{propsForNextShape:n})}}),z(mn,pr,{up:function(e){return null!==e.scribble?Ce(Ce({},e),{},{scribble:Ce(Ce({},e.scribble),{},{delay:0})}):Ce({},e)},down:function(e){if(null!==e.scribble){var t=e.scribble,n=(t.delay,gt(t,Xn));return Ce(Ce({},e),{},{scribble:n})}return Ce({},e)}}),z(mn,hr,{up:function(e){e.userId;return gt(e,qn)},down:function(e){return Ce(Ce({},e),{},{userId:"user:none"})}}),z(mn,vr,{up:function(e){return Ce(Ce({},e),{},{isPenMode:!1,isGridMode:!1})},down:function(e){e.isPenMode,e.isGridMode;return gt(e,$n)}}),z(mn,gr,{up:function(e){var t=e.propsForNextShape,n=t.opacity,r=gt(t,Gn);return Ce(Ce({},gt(e,Qn)),{},{opacityForNextShape:Number(null!==n&&void 0!==n?n:"1"),propsForNextShape:r})},down:function(e){var t=e.opacityForNextShape,n=gt(e,Zn);return Ce(Ce({},n),{},{propsForNextShape:Ce(Ce({},n.propsForNextShape),{},{opacity:t<.175?"0.1":t<.375?"0.25":t<.625?"0.5":t<.875?"0.75":"1"})})}}),z(mn,mr,{up:function(e){return Ce(Ce({},e),{},{chatMessage:"",isChatting:!1})},down:function(e){e.chatMessage,e.isChatting;return gt(e,Jn)}}),z(mn,yr,{up:function(e){return Ce(Ce({},e),{},{highlightedUserIds:[]})},down:function(e){e.highlightedUserIds;return gt(e,er)}}),z(mn,br,{up:function(e){e.propsForNextShape;return Ce(Ce({},gt(e,tr)),{},{stylesForNextShape:{}})},down:function(e){e.stylesForNextShape;return Ce(Ce({},gt(e,nr)),{},{propsForNextShape:{color:"black",labelColor:"black",dash:"draw",fill:"none",size:"m",icon:"file",font:"draw",align:"middle",verticalAlign:"middle",geo:"rectangle",arrowheadStart:"none",arrowheadEnd:"arrow",spline:"line"}})}}),z(mn,wr,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,rr))}}),mn)}),kr="instance:instance",Sr=Vt.refine((function(e){if(!e.startsWith("page:")&&!e.startsWith("shape:"))throw new Error('Parent ID must start with "page:" or "shape:"');return e})),_r=hn("shape");var Pr,Er,Cr=["croppingId"],Ir=["instanceId","cameraId"],Tr=["meta"],Mr=ln("instance_page_state",nn({typeName:Zt("instance_page_state"),id:hn("instance_page_state"),pageId:An,selectedIds:en(_r),hintingIds:en(_r),erasingIds:en(_r),hoveredId:_r.nullable(),editingId:_r.nullable(),croppingId:_r.nullable(),focusLayerId:_r.nullable(),meta:on})),jr=2,Ar=3,Or=yt({currentVersion:Ar,migrators:(ir={},z(ir,1,{up:function(e){return Ce(Ce({},e),{},{croppingId:null})},down:function(e){e.croppingId;return gt(e,Cr)}}),z(ir,jr,{up:function(e){e.instanceId,e.cameraId;return gt(e,Ir)},down:function(e){return Ce(Ce({},e),{},{instanceId:kr,cameraId:kn.createId("void")})}}),z(ir,Ar,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,Tr))}}),ir)}),Lr=st("instance_page_state",{migrations:Or,validator:Mr,scope:"session"}).withDefaultProperties((function(){return{editingId:null,croppingId:null,selectedIds:[],hoveredId:null,erasingIds:[],hintingIds:[],focusLayerId:null,meta:{}}})),zr=["meta"],Dr=ln("pointer",nn({typeName:Zt("pointer"),id:hn("pointer"),x:Wt,y:Wt,lastActivityTimestamp:Wt,meta:on})),Rr=1,Nr=yt({currentVersion:Rr,migrators:z({},Rr,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,zr))}})}),Br=st("pointer",{validator:Dr,migrations:Nr,scope:"session"}).withDefaultProperties((function(){return{x:0,y:0,lastActivityTimestamp:0,meta:{}}})),Fr=Br.createId("pointer"),Ur=["delay"],Kr=["instanceId"],Vr=["chatMessage"],Wr=["meta"],Hr=ln("instance_presence",nn({typeName:Zt("instance_presence"),id:hn("instance_presence"),userId:Vt,userName:Vt,lastActivityTimestamp:Wt,followingUserId:Vt.nullable(),cursor:nn({x:Wt,y:Wt,type:En,rotation:Wt}),color:Vt,camera:nn({x:Wt,y:Wt,z:Wt}),screenBounds:_n,selectedIds:en(hn("shape")),currentPageId:hn("page"),brush:_n.nullable(),scribble:Mn.nullable(),chatMessage:Vt,meta:on})),Yr=2,Xr=3,qr=4,$r=yt({currentVersion:qr,migrators:(Pr={},z(Pr,1,{up:function(e){return null!==e.scribble?Ce(Ce({},e),{},{scribble:Ce(Ce({},e.scribble),{},{delay:0})}):Ce({},e)},down:function(e){if(null!==e.scribble){var t=e.scribble,n=(t.delay,gt(t,Ur));return Ce(Ce({},e),{},{scribble:n})}return Ce({},e)}}),z(Pr,Yr,{up:function(e){e.instanceId;return gt(e,Kr)},down:function(e){return Ce(Ce({},e),{},{instanceId:kr})}}),z(Pr,Xr,{up:function(e){return Ce(Ce({},e),{},{chatMessage:""})},down:function(e){e.chatMessage;return gt(e,Vr)}}),z(Pr,qr,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,Wr))}}),Pr)}),Gr=st("instance_presence",{migrations:$r,validator:Hr,scope:"presence"}).withDefaultProperties((function(){return{lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedIds:[],brush:null,scribble:null,chatMessage:"",meta:{}}})),Qr=["name"],Zr=["meta"],Jr=ln("document",nn({typeName:Zt("document"),id:Zt("document:document"),gridSize:Wt,name:Vt,meta:on})),ei=2,ti=yt({currentVersion:ei,migrators:(Er={},z(Er,1,{up:function(e){return Ce(Ce({},e),{},{name:""})},down:function(e){e.name;return gt(e,Qr)}}),z(Er,ei,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,Zr))}}),Er)}),ni=st("document",{migrations:ti,validator:Jr,scope:"document"}).withDefaultProperties((function(){return{gridSize:10,name:"",meta:{}}})),ri=ni.createId("document");function ii(e,t){return e.index<t.index?-1:e.index>t.index?1:0}function oi(e){"asset"===e.typeName&&("src"in e&&(e.src="<redacted>"),"src"in e.props&&(e.props.src="<redacted>"))}var ai=function(e){var t=e.error,n=e.phase,r=e.record,i=e.recordBefore;throw Ne(t,{tags:{origin:"store.validateRecord",storePhase:n,isExistingValidationIssue:"initialize"===n},extras:{recordBefore:i?oi(it(i)):void 0,recordAfter:oi(it(r))}}),t};function si(e){var t=e.query.ids("page");return function n(){if(!e.has(ri))return e.put([ni.create({id:ri,name:e.props.defaultName})]),n();if(!e.has(Fr))return e.put([Br.create({id:Fr})]),n();var r=t.value;if(0===r.size)return e.put([Dn.create({name:"Page 1",index:"a1",meta:{}})]),n();var i=function(){return u(r).map((function(t){return e.get(t)})).sort(ii)[0].id},o=e.get(kr);if(!o)return e.put([e.schema.types.instance.create({id:kr,currentPageId:i(),exportBackground:!0})]),n();if(!r.has(o.currentPageId))return e.put([Ce(Ce({},o),{},{currentPageId:i()})]),n();var a,s=new Set,l=new Set,c=J(r);try{for(c.s();!(a=c.n()).done;){var d=a.value,f=Lr.createId(d);e.has(f)||s.add(f);var p=kn.createId(d);e.has(p)||l.add(p)}}catch(h){c.e(h)}finally{c.f()}s.size>0&&e.put(u(s).map((function(e){return Lr.create({id:e,pageId:Lr.parseId(e)})}))),l.size>0&&e.put(u(l).map((function(e){return kn.create({id:e})})))}}var ui,li,ci,di,fi=gn("bookmark",nn({title:Vt,description:Vt,image:Vt,src:Vt.nullable()})),pi=yt({}),hi=["isAnimated"],vi=["width","height"],gi=["w","h"],mi=gn("image",nn({w:Wt,h:Wt,name:Vt,isAnimated:Gt,mimeType:Vt.nullable(),src:Vt.nullable()})),yi=2,bi=yt({currentVersion:yi,migrators:(ui={},z(ui,1,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{isAnimated:!1})})},down:function(e){var t=e.props,n=(t.isAnimated,gt(t,hi));return Ce(Ce({},e),{},{props:n})}}),z(ui,yi,{up:function(e){var t=e.props,n=t.width,r=t.height,i=gt(t,vi);return Ce(Ce({},e),{},{props:Ce({w:n,h:r},i)})},down:function(e){var t=e.props,n=t.w,r=t.h,i=gt(t,gi);return Ce(Ce({},e),{},{props:Ce({width:n,height:r},i)})}}),ui)}),wi=["isAnimated"],xi=["width","height"],ki=["w","h"],Si=gn("video",nn({w:Wt,h:Wt,name:Vt,isAnimated:Gt,mimeType:Vt.nullable(),src:Vt.nullable()})),_i=2,Pi=yt({currentVersion:_i,migrators:(li={},z(li,1,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{isAnimated:!1})})},down:function(e){var t=e.props,n=(t.isAnimated,gt(t,wi));return Ce(Ce({},e),{},{props:n})}}),z(li,_i,{up:function(e){var t=e.props,n=t.width,r=t.height,i=gt(t,xi);return Ce(Ce({},e),{},{props:Ce({w:n,h:r},i)})},down:function(e){var t=e.props,n=t.w,r=t.h,i=gt(t,ki);return Ce(Ce({},e),{},{props:Ce({width:n,height:r},i)})}}),li)}),Ei=["meta"],Ci=ln("asset",un("type",{image:mi,video:Si,bookmark:fi})),Ii=1,Ti=yt({subTypeKey:"type",subTypeMigrations:{image:bi,video:Pi,bookmark:pi},currentVersion:Ii,migrators:z({},Ii,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,Ei))}})}),Mi=st("asset",{migrations:Ti,validator:Ci,scope:"document"}).withDefaultProperties((function(){return{meta:{}}})),ji=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce((function(e,t){return e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"}),"")},Ai=function(){function e(t,n,r){M(this,e),this.id=t,this.defaultValue=n,this.type=r}return L(e,[{key:"validate",value:function(e){return this.type.validate(e)}}],[{key:"define",value:function(t,n){var r=n.defaultValue,i=n.type;return new e(t,r,void 0===i?Kt:i)}},{key:"defineEnum",value:function(e,t){var n=t.defaultValue,r=t.values;return new Oi(e,n,r)}}]),e}(),Oi=function(t){Et(r,t);var n=Tt(r);function r(t,i,o){var a;return M(this,r),(a=n.call(this,t,i,pn.apply(e,u(o)))).values=o,a}return L(r)}(Ai),Li=["isLocked"],zi=["opacity"],Di=["props"],Ri=["opacity"],Ni=["meta"],Bi=2,Fi=3,Ui=yt({currentVersion:Fi,migrators:(ci={},z(ci,1,{up:function(e){return Ce(Ce({},e),{},{isLocked:!1})},down:function(e){e.isLocked;return Ce({},gt(e,Li))}}),z(ci,Bi,{up:function(e){var t=e.props,n=t.opacity,r=gt(t,zi);return Ce(Ce({},gt(e,Di)),{},{opacity:Number(null!==n&&void 0!==n?n:"1"),props:r})},down:function(e){var t=e.opacity,n=gt(e,Ri);return Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{opacity:t<.175?"0.1":t<.375?"0.25":t<.625?"0.5":t<.875?"0.75":"1"})})}}),z(ci,Fi,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,Ni))}}),ci)});function Ki(e){return!!e&&"shape"===e.typeName}function Vi(e){return!!e&&e.startsWith("shape:")}function Wi(e){return"shape:".concat(null!==e&&void 0!==e?e:ji())}function Hi(e){for(var t=new Map,n=0,r=Object.entries(e);n<r.length;n++){var i=G(r[n],2),o=i[0],a=i[1];if(a instanceof Ai){if(t.has(a))throw new Error("Duplicate style prop ".concat(a.id,". Each style prop can only be used once within a shape."));t.set(a,o)}}return t}function Yi(e){return st("shape",{migrations:yt({currentVersion:Ui.currentVersion,firstVersion:Ui.firstVersion,migrators:Ui.migrators,subTypeKey:"type",subTypeMigrations:Ge(e,(function(e,t){var n;return null!==(n=t.migrations)&&void 0!==n?n:yt({})}))}),scope:"document",validator:ln("shape",un("type",Ge(e,(function(e,t){return function(e,t,n){return nn({id:_r,typeName:Zt("shape"),x:Wt,y:Wt,rotation:Wt,index:Vt,parentId:Sr,type:Zt(e),isLocked:Gt,opacity:In,props:t?nn(t):on,meta:n?nn(n):on})}(e,t.props,t.meta)}))))}).withDefaultProperties((function(){return{x:0,y:0,rotation:0,isLocked:!1,opacity:1,meta:{}}}))}var Xi=2,qi=3,$i=4,Gi=yt({currentVersion:$i,migrators:(di={},z(di,1,{up:function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=G(e,2),n=(t[0],t[1]);return"shape"!==n.typeName||"icon"!==n.type&&"code"!==n.type})))},down:function(e){return e}}),z(di,Xi,{up:function(e){return e},down:function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=G(e,2);t[0];return"instance_presence"!==t[1].typeName})))}}),z(di,qi,{up:function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=G(e,2);t[0];return!t[1].typeName.match(/^(user|user_presence)$/)})))},down:function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=G(e,2);t[0];return"pointer"!==t[1].typeName})))}}),z(di,$i,{up:function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=G(e,2);t[0];return!t[1].typeName.match("user_document")})))},down:function(e){return e}}),di)});function Qi(e){var t,n=e.shapes,r=new Map,i=J(Ye(n));try{for(i.s();!(t=i.n()).done;){var o,a,s=J(Hi(null!==(o=t.value.props)&&void 0!==o?o:{}).keys());try{for(s.s();!(a=s.n()).done;){var u=a.value;if(r.has(u.id)&&r.get(u.id)!==u)throw new Error("Multiple StyleProp instances with the same id: ".concat(u.id));r.set(u.id,u)}}catch(d){s.e(d)}finally{s.f()}}}catch(d){i.e(d)}finally{i.f()}var l=Yi(n),c=function(e){var t,n={},r=J(e);try{for(r.s();!(t=r.n()).done;){var i=G(t.value,2),o=i[0],a=i[1];n[o]=dn(a)}}catch(d){r.e(d)}finally{r.f()}var s=ln("instance",nn({typeName:Zt("instance"),id:hn("instance"),currentPageId:An,followingUserId:Vt.nullable(),brush:_n.nullable(),opacityForNextShape:In,stylesForNextShape:nn(n),cursor:Cn,scribble:Mn.nullable(),isFocusMode:Gt,isDebugMode:Gt,isToolLocked:Gt,exportBackground:Gt,screenBounds:_n,zoomBrush:_n.nullable(),isPenMode:Gt,isGridMode:Gt,chatMessage:Vt,isChatting:Gt,highlightedUserIds:en(Vt),meta:on}));return st("instance",{migrations:xr,validator:s,scope:"session"}).withDefaultProperties((function(){return{followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribble:null,cursor:{type:"default",color:"black",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[],meta:{}}}))}(r);return kt.create({asset:Mi,camera:kn,document:ni,instance:c,instance_page_state:Lr,page:Dn,shape:l,instance_presence:Gr,pointer:Br},{snapshotMigrations:Gi,onValidationFailure:ai,createIntegrityChecker:si})}var Zi=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red"],Ji={lightMode:{text:"#000000",background:"rgb(249, 250, 251)",solid:"#fcfffe",black:{solid:"#1d1d1d",semi:"#e8e8e8",pattern:"#494949",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},blue:{solid:"#4263eb",semi:"#dce1f8",pattern:"#6681ee",highlight:{srgb:"#10acff",p3:"color(display-p3 0.308 0.6632 0.9996)"}},green:{solid:"#099268",semi:"#d3e9e3",pattern:"#39a785",highlight:{srgb:"#00ffc8",p3:"color(display-p3 0.2536 0.984 0.7981)"}},grey:{solid:"#adb5bd",semi:"#eceef0",pattern:"#bcc3c9",highlight:{srgb:"#cbe7f1",p3:"color(display-p3 0.8163 0.9023 0.9416)"}},"light-blue":{solid:"#4dabf7",semi:"#ddedfa",pattern:"#6fbbf8",highlight:{srgb:"#00f4ff",p3:"color(display-p3 0.1512 0.9414 0.9996)"}},"light-green":{solid:"#40c057",semi:"#dbf0e0",pattern:"#65cb78",highlight:{srgb:"#65f641",p3:"color(display-p3 0.563 0.9495 0.3857)"}},"light-red":{solid:"#ff8787",semi:"#f4dadb",pattern:"#fe9e9e",highlight:{srgb:"#ff7fa3",p3:"color(display-p3 0.9988 0.5301 0.6397)"}},"light-violet":{solid:"#e599f7",semi:"#f5eafa",pattern:"#e9acf8",highlight:{srgb:"#ff88ff",p3:"color(display-p3 0.9676 0.5652 0.9999)"}},orange:{solid:"#f76707",semi:"#f8e2d4",pattern:"#f78438",highlight:{srgb:"#ffa500",p3:"color(display-p3 0.9988 0.6905 0.266)"}},red:{solid:"#e03131",semi:"#f4dadb",pattern:"#e55959",highlight:{srgb:"#ff636e",p3:"color(display-p3 0.9992 0.4376 0.45)"}},violet:{solid:"#ae3ec9",semi:"#ecdcf2",pattern:"#bd63d3",highlight:{srgb:"#c77cff",p3:"color(display-p3 0.7469 0.5089 0.9995)"}},yellow:{solid:"#ffc078",semi:"#f9f0e6",pattern:"#fecb92",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}}},darkMode:{text:"#f8f9fa",background:"#212529",solid:"#28292e",black:{solid:"#e1e1e1",semi:"#2c3036",pattern:"#989898",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},blue:{solid:"#4156be",semi:"#262d40",pattern:"#3a4b9e",highlight:{srgb:"#0079d2",p3:"color(display-p3 0.0032 0.4655 0.7991)"}},green:{solid:"#3b7b5e",semi:"#253231",pattern:"#366a53",highlight:{srgb:"#009774",p3:"color(display-p3 0.0085 0.582 0.4604)"}},grey:{solid:"#93989f",semi:"#33373c",pattern:"#7c8187",highlight:{srgb:"#9cb4cb",p3:"color(display-p3 0.6299 0.7012 0.7856)"}},"light-blue":{solid:"#588fc9",semi:"#2a3642",pattern:"#4d7aa9",highlight:{srgb:"#00bdc8",p3:"color(display-p3 0.0023 0.7259 0.7735)"}},"light-green":{solid:"#599f57",semi:"#2a3830",pattern:"#4e874e",highlight:{srgb:"#00a000",p3:"color(display-p3 0.2711 0.6172 0.0195)"}},"light-red":{solid:"#c67877",semi:"#3b3235",pattern:"#a56767",highlight:{srgb:"#db005b",p3:"color(display-p3 0.7849 0.0585 0.3589)"}},"light-violet":{solid:"#b583c9",semi:"#383442",pattern:"#9770a9",highlight:{srgb:"#c400c7",p3:"color(display-p3 0.7024 0.0403 0.753)"}},orange:{solid:"#bf612e",semi:"#3a2e2a",pattern:"#9f552d",highlight:{srgb:"#d07a00",p3:"color(display-p3 0.7699 0.4937 0.0085)"}},red:{solid:"#aa3c37",semi:"#36292b",pattern:"#8f3734",highlight:{srgb:"#de002c",p3:"color(display-p3 0.7978 0.0509 0.2035)"}},violet:{solid:"#873fa3",semi:"#31293c",pattern:"#763a8b",highlight:{srgb:"#9e00ee",p3:"color(display-p3 0.5651 0.0079 0.8986)"}},yellow:{solid:"#cba371",semi:"#3c3934",pattern:"#fecb92",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}}}};function eo(e){return e.isDarkMode?Ji.darkMode:Ji.lightMode}var to,no,ro,io,oo=Ai.defineEnum("tldraw:color",{defaultValue:"black",values:Zi}),ao=Ai.defineEnum("tldraw:labelColor",{defaultValue:"black",values:Zi}),so=Ai.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),uo=Ai.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern"]}),lo=Ai.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),co={draw:"'tldraw_draw', sans-serif",sans:"'tldraw_sans', sans-serif",serif:"'tldraw_serif', serif",mono:"'tldraw_mono', monospace"},fo=Ai.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),po=["labelColor"],ho=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],vo=Ai.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:ho}),go=Ai.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:ho}),mo=un("type",{binding:nn({type:Zt("binding"),boundShapeId:_r,normalizedAnchor:Sn,isExact:Gt}),point:nn({type:Zt("point"),x:Wt,y:Wt})}),yo={labelColor:ao,color:oo,fill:uo,dash:so,size:fo,arrowheadStart:vo,arrowheadEnd:go,font:lo,start:mo,end:mo,bend:Wt,text:Vt},bo=1,wo=yt({currentVersion:bo,migrators:z({},bo,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{labelColor:"black"})})},down:function(e){var t=e.props,n=(t.labelColor,gt(t,po));return Ce(Ce({},e),{},{props:n})}})}),xo=["assetId"],ko={w:Yt,h:Yt,assetId:vn.nullable(),url:Vt},So=1,_o=yt({currentVersion:So,migrators:z({},So,{up:function(e){return void 0===e.props.assetId?Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{assetId:null})}):e},down:function(e){if(null===e.props.assetId){var t=e.props,n=(t.assetId,gt(t,xo));return Ce(Ce({},e),{},{props:n})}return e}})}),Po=["isPen"],Eo=nn({type:pn("free","straight"),points:en(Sn)}),Co={color:oo,fill:uo,dash:so,size:fo,segments:en(Eo),isComplete:Gt,isClosed:Gt,isPen:Gt},Io=1,To=yt({currentVersion:Io,migrators:z({},Io,{up:function(e){var t=e.props.segments[0].points;if(0===t.length)return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{isPen:!1})});var n=!(0===t[0].z||.5===t[0].z);return t[1]&&(n=n&&!(0===t[1].z||.5===t[1].z)),Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{isPen:n})})},down:function(e){var t=e.props,n=(t.isPen,gt(t,Po));return Ce(Ce({},e),{},{props:Ce({},n)})}})}),Mo=["tmpOldUrl"],jo=["doesResize"],Ao=["tmpOldUrl"],Oo=["overridePermissions"],Lo=/(^\/r\/[^/]+\/?$)/,zo=function(e){try{return new URL(e)}catch(t){return}},Do=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","lite.tldraw.com","www.tldraw.com"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:function(e){var t=zo(e);if(t&&t.pathname.match(Lo))return e},fromEmbedUrl:function(e){var t=zo(e);if(t&&t.pathname.match(Lo))return e}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){var t=zo(e),n=t&&t.pathname.match(/\/s\/([^/]+)\/?/);if(n)return"https://codesandbox.io/embed/".concat(n[1])},fromEmbedUrl:function(e){var t=zo(e),n=t&&t.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return"https://codesandbox.io/s/".concat(n[1])}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){var t=e.match(/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/);if(t){var n=G(t,3),r=(n[0],n[1]),i=n[2];return"https://codepen.io/".concat(r,"/embed/").concat(i)}},fromEmbedUrl:function(e){var t=e.match(/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/);if(t){var n=G(t,3),r=(n[0],n[1]),i=n[2];return"https://codepen.io/".concat(r,"/pen/").concat(i)}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,canUnmount:!1,toEmbedUrl:function(e){var t=e.match(/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/);if(t){var n=G(t,2),r=(n[0],n[1]);return"https://scratch.mit.edu/projects/embed/".concat(r)}},fromEmbedUrl:function(e){var t=e.match(/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/);if(t){var n=G(t,2),r=(n[0],n[1]);return"https://scratch.mit.edu/projects/".concat(r)}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,canUnmount:!1,overridePermissions:{"allow-presentation":!0},isAspectRatioLocked:!0,toEmbedUrl:function(e){var t=zo(e);if(t){var n=t.hostname.replace(/^www./,"");if("youtu.be"===n){var r=t.pathname.split("/").filter(Boolean)[0];return"https://www.youtube.com/embed/".concat(r)}if(("youtube.com"===n||"m.youtube.com"===n)&&t.pathname.match(/^\/watch/)){var i=t.searchParams.get("v");return"https://www.youtube.com/embed/".concat(i)}}},fromEmbedUrl:function(e){var t=zo(e);if(t&&"youtube.com"===t.hostname.replace(/^www./,"")){var n=t.pathname.match(/^\/embed\/([^/]+)\/?/);if(n)return"https://www.youtube.com/watch?v=".concat(n[1])}}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:function(e){if(e.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!e.includes("figma.com/embed"))return"https://www.figma.com/embed?embed_host=share&url=".concat(e)},fromEmbedUrl:function(e){var t=zo(e);if(t&&t.pathname.match(/^\/embed\/?$/)){var n=t.searchParams.get("url");if(n)return n}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){if(e.includes("/maps/")){var t,n=e.match(/@(.*),(.*),(.*)z/);if(n){var r=G(n,4),i=r[1],o=r[2],a=r[3],s=new URL(e).host.replace("www.","");t="https://".concat(s,"/maps/embed/v1/view?key=").concat({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NEXT_PUBLIC_GC_API_KEY,"&center=").concat(i,",").concat(o,"&zoom=").concat(a)}else t="";return t}},fromEmbedUrl:function(e){var t=zo(e);if(t&&(t.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&t.searchParams.has("center")&&t.searchParams.get("zoom"))){var n=t.searchParams.get("zoom"),r=G(t.searchParams.get("center").split(","),2),i=r[0],o=r[1];return"https://www.google.com/maps/@".concat(i,",").concat(o,",").concat(n,"z")}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",toEmbedUrl:function(e){var t=zo(e),n=null===t||void 0===t?void 0:t.searchParams.get("cid");if(null!==t&&void 0!==t&&t.pathname.match(/\/calendar\/u\/0/)&&n){t.pathname="/calendar/embed";for(var r=0,i=Array.from(t.searchParams.keys());r<i.length;r++){var o=i[r];t.searchParams.delete(o)}return t.searchParams.set("src",n),t.href}},fromEmbedUrl:function(e){var t=zo(e),n=null===t||void 0===t?void 0:t.searchParams.get("src");if(null!==t&&void 0!==t&&t.pathname.match(/\/calendar\/embed/)&&n){t.pathname="/calendar/u/0";for(var r=0,i=Array.from(t.searchParams.keys());r<i.length;r++){var o=i[r];t.searchParams.delete(o)}return t.searchParams.set("cid",n),t.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){var t=zo(e);if(null!==t&&void 0!==t&&t.pathname.match(/^\/presentation/)&&null!==t&&void 0!==t&&t.pathname.match(/\/pub\/?$/)){t.pathname=t.pathname.replace(/\/pub$/,"/embed");for(var n=0,r=Array.from(t.searchParams.keys());n<r.length;n++){var i=r[n];t.searchParams.delete(i)}return t.href}},fromEmbedUrl:function(e){var t=zo(e);if(null!==t&&void 0!==t&&t.pathname.match(/^\/presentation/)&&null!==t&&void 0!==t&&t.pathname.match(/\/embed\/?$/)){t.pathname=t.pathname.replace(/\/embed$/,"/pub");for(var n=0,r=Array.from(t.searchParams.keys());n<r.length;n++){var i=r[n];t.searchParams.delete(i)}return t.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:function(e){var t=zo(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/)){if(!e.split("/").pop())return;return e}},fromEmbedUrl:function(e){var t=zo(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/)){if(!e.split("/").pop())return;return e}}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){var t=zo(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/))return"".concat(e,"?embed=true")},fromEmbedUrl:function(e){var t=zo(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/)&&t.searchParams.has("embed"))return t.searchParams.delete("embed"),t.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){var t=zo(e);if(t&&t.pathname.match(/^\/map\//))return t.origin+"/embed"+t.pathname},fromEmbedUrl:function(e){var t=zo(e);if(t&&t.pathname.match(/^\/embed\/map\//))return t.pathname=t.pathname.replace(/^\/embed/,""),t.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){var t=zo(e);if(t&&t.pathname.match(/^\/(artist|album)\//))return t.origin+"/embed"+t.pathname},fromEmbedUrl:function(e){var t=zo(e);if(t&&t.pathname.match(/^\/embed\/(artist|album)\//))return t.origin+t.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:function(e){var t=zo(e);if(t&&"vimeo.com"===t.hostname&&t.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+t.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:function(e){var t=zo(e);if(t&&"player.vimeo.com"===t.hostname){var n=t.pathname.match(/^\/video\/([^/]+)\/?$/);if(n)return"https://vimeo.com/"+n[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:function(e){var t=zo(e);if(t&&t.hash.match(/#room=/))return e},fromEmbedUrl:function(e){var t=zo(e);if(t&&t.hash.match(/#room=/))return e}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:function(e){var t=zo(e);if(t&&t.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return"".concat(t.origin,"/embed").concat(t.pathname,"?cell=*");if(t&&t.pathname.match(/^\/d\/([^/]+)\/?$/)){var n=t.pathname.replace(/^\/d/,"");return"".concat(t.origin,"/embed").concat(n,"?cell=*")}},fromEmbedUrl:function(e){var t=zo(e);return t&&t.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/)?"".concat(t.origin).concat(t.pathname.replace("/embed",""),"#cell-*"):t&&t.pathname.match(/^\/embed\/([^/]+)\/?$/)?"".concat(t.origin).concat(t.pathname.replace("/embed","/d"),"#cell-*"):void 0}}],Ro={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},No={w:Yt,h:Yt,url:Vt},Bo=2,Fo=3,Uo=4,Ko=yt({currentVersion:Uo,migrators:(to={},z(to,1,{up:function(e){for(var t,n,r=e.props.url,i=new URL(r).host.replace("www.",""),o=0,a=Do;o<a.length;o++){var s=a[o];if(s.hostnames.includes(i))try{n=s.fromEmbedUrl(r)}catch(u){console.warn(u)}}return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{tmpOldUrl:e.props.url,url:null!==(t=n)&&void 0!==t?t:""})})},down:function(e){var t,n=e.props.tmpOldUrl;if(!n||""===n)for(var r=e.props.url,i=new URL(r).host.replace("www.",""),o=0,a=Do;o<a.length;o++){var s=a[o];if(s.hostnames.includes(i))try{n=s.toEmbedUrl(r)}catch(c){console.warn(c)}}var u=e.props,l=(u.tmpOldUrl,gt(u,Mo));return Ce(Ce({},e),{},{props:Ce(Ce({},l),{},{url:null!==(t=n)&&void 0!==t?t:""})})}}),z(to,Bo,{up:function(e){var t=e.props,n=(t.doesResize,gt(t,jo));return Ce(Ce({},e),{},{props:Ce({},n)})},down:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{doesResize:!0})})}}),z(to,Fo,{up:function(e){var t=e.props,n=(t.tmpOldUrl,gt(t,Ao));return Ce(Ce({},e),{},{props:Ce({},n)})},down:function(e){return Ce(Ce({},e),{},{props:Ce({},e.props)})}}),z(to,Uo,{up:function(e){var t=e.props,n=(t.overridePermissions,gt(t,Oo));return Ce(Ce({},e),{},{props:Ce({},n)})},down:function(e){return Ce(Ce({},e),{},{props:Ce({},e.props)})}}),to)}),Vo={w:Yt,h:Yt,name:Vt},Wo=yt({}),Ho=Ai.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),Yo=Ai.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),Xo=["url"],qo=["labelColor"],$o=["verticalAlign"],Go=Ai.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box"]}),Qo={geo:Go,labelColor:ao,color:oo,fill:uo,dash:so,size:fo,font:lo,align:Ho,verticalAlign:Yo,url:Vt,w:Yt,h:Yt,growY:Ht,text:Vt},Zo=2,Jo=3,ea=4,ta=5,na=6,ra=yt({currentVersion:na,migrators:(no={},z(no,1,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{url:""})})},down:function(e){var t=e.props,n=(t.url,gt(t,Xo));return Ce(Ce({},e),{},{props:n})}}),z(no,Zo,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{labelColor:"black"})})},down:function(e){var t=e.props,n=(t.labelColor,gt(t,qo));return Ce(Ce({},e),{},{props:n})}}),z(no,Jo,{up:function(e){var t=e.props.align;return"justify"===t&&(t="start"),Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})},down:function(e){return Ce({},e)}}),z(no,ea,{up:function(e){return Ce({},e)},down:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{geo:"check-box"===e.props.geo?"rectangle":e.props.geo})})}}),z(no,ta,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{verticalAlign:"middle"})})},down:function(e){var t=e.props,n=(t.verticalAlign,gt(t,$o));return Ce(Ce({},e),{},{props:n})}}),z(no,na,{up:function(e){var t;switch(e.props.align){case"start":t="start-legacy";break;case"end":t="end-legacy";break;default:t="middle-legacy"}return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})},down:function(e){var t;switch(e.props.align){case"start-legacy":t="start";break;case"end-legacy":t="end";break;case"middle-legacy":t="middle";break;default:t=e.props.align}return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})}}),no)}),ia=yt({}),oa={color:oo,size:fo,segments:en(Eo),isComplete:Gt,isPen:Gt},aa=yt({}),sa=["url"],ua=["crop"],la=nn({topLeft:Sn,bottomRight:Sn}),ca={w:Yt,h:Yt,playing:Gt,url:Vt,assetId:vn.nullable(),crop:la.nullable()},da=2,fa=yt({currentVersion:da,migrators:(ro={},z(ro,1,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{url:""})})},down:function(e){var t=e.props,n=(t.url,gt(t,sa));return Ce(Ce({},e),{},{props:n})}}),z(ro,da,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{crop:null})})},down:function(e){var t=e.props,n=(t.crop,gt(t,ua));return Ce(Ce({},e),{},{props:n})}}),ro)}),pa=nn({id:Vt,type:cn(new Set(["vertex","virtual","create"])),canBind:Gt.optional(),index:Vt,x:Wt,y:Wt}),ha=Ai.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),va={color:oo,dash:so,size:fo,spline:ha,handles:sn(Vt,pa)},ga=yt({}),ma=["url"],ya=["verticalAlign"],ba={color:oo,size:fo,font:lo,align:Ho,verticalAlign:Yo,growY:Ht,url:Vt,text:Vt},wa=2,xa=3,ka=4,Sa=yt({currentVersion:ka,migrators:(io={},z(io,1,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{url:""})})},down:function(e){var t=e.props,n=(t.url,gt(t,ma));return Ce(Ce({},e),{},{props:n})}}),z(io,wa,{up:function(e){var t=e.props.align;return"justify"===t&&(t="start"),Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})},down:function(e){return Ce({},e)}}),z(io,xa,{up:function(e){var t;switch(e.props.align){case"start":t="start-legacy";break;case"end":t="end-legacy";break;default:t="middle-legacy"}return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})},down:function(e){var t;switch(e.props.align){case"start-legacy":t="start";break;case"end-legacy":t="end";break;case"middle-legacy":t="middle";break;default:t=e.props.align}return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})}}),z(io,ka,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{verticalAlign:"middle"})})},down:function(e){var t=e.props,n=(t.verticalAlign,gt(t,ya));return Ce(Ce({},e),{},{props:n})}}),io)}),_a={color:oo,size:fo,font:lo,align:Ho,w:Yt,text:Vt,scale:Yt,autoSize:Gt},Pa=1,Ea=yt({currentVersion:Pa,migrators:z({},Pa,{up:function(e){var t=e.props.align;return"justify"===t&&(t="start"),Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})},down:function(e){return Ce({},e)}})}),Ca=["url"],Ia={w:Yt,h:Yt,time:Wt,playing:Gt,url:Vt,assetId:vn.nullable()},Ta=1,Ma=yt({currentVersion:Ta,migrators:z({},Ta,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{url:""})})},down:function(e){var t=e.props,n=(t.url,gt(t,Ca));return Ce(Ce({},e),{},{props:n})}})}),ja=[{locale:"ar",label:"\u0639\u0631\u0628\u064a"},{locale:"ca",label:"Catal\xe0"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Espa\xf1ol"},{locale:"fa",label:"\u0641\u0627\u0631\u0633\u06cc"},{locale:"fi",label:"Suomi"},{locale:"fr",label:"Fran\xe7ais"},{locale:"gl",label:"Galego"},{locale:"he",label:"\u05e2\u05d1\u05e8\u05d9\u05ea"},{locale:"it",label:"Italiano"},{locale:"ja",label:"\u65e5\u672c\u8a9e"},{locale:"ko-kr",label:"\ud55c\uad6d\uc5b4"},{locale:"ku",label:"\u06a9\u0648\u0631\u062f\u06cc"},{locale:"hi-in",label:"\u0939\u093f\u0928\u094d\u0926\u0940"},{locale:"hu",label:"Magyar"},{locale:"my",label:"\u1019\u103c\u1014\u103a\u1019\u102c\u1005\u102c"},{locale:"ne",label:"\u0928\u0947\u092a\u093e\u0932\u0940"},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Portugu\xeas - Brasil"},{locale:"pt-pt",label:"Portugu\xeas - Europeu"},{locale:"ro",label:"Rom\xe2n\u0103"},{locale:"ru",label:"Russian"},{locale:"sv",label:"Svenska"},{locale:"te",label:"\u0c24\u0c46\u0c32\u0c41\u0c17\u0c41"},{locale:"th",label:"\u0e20\u0e32\u0e29\u0e32\u0e44\u0e17\u0e22"},{locale:"tr",label:"T\xfcrk\xe7e"},{locale:"uk",label:"Ukrainian"},{locale:"vi",label:"Ti\u1ebfng Vi\u1ec7t"},{locale:"zh-cn",label:"Chinese - Simplified"},{locale:"zh-tw",label:"\u7e41\u9ad4\u4e2d\u6587 (\u53f0\u7063)"}];function Aa(){var e;return function(e){var t,n=J(e);try{for(n.s();!(t=n.n()).done;){var r=La(t.value);if(r)return r}}catch(i){n.e(i)}finally{n.f()}return"en"}("undefined"!==typeof window&&null!==(e=window.navigator.languages)&&void 0!==e?e:["en"])}var Oa={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function La(e){var t=ja.find((function(t){return t.locale===e.toLowerCase()}));if(t)return t.locale;var n=e.split(/[-_]/).map((function(e){return e.toLowerCase()})),r=G(n,2),i=r[0];if(r[1]){var o=ja.find((function(e){return e.locale===i}));if(o)return o.locale}return i in Oa?Oa[i]:null}var za=n(184),Da="2.0.0-alpha.14",Ra={fonts:{draw:"https://unpkg.com/@tldraw/assets@".concat(Da,"/fonts/Shantell_Sans-Normal-SemiBold.woff2"),serif:"https://unpkg.com/@tldraw/assets@".concat(Da,"/fonts/IBMPlexSerif-Medium.woff2"),sansSerif:"https://unpkg.com/@tldraw/assets@".concat(Da,"/fonts/IBMPlexSans-Medium.woff2"),monospace:"https://unpkg.com/@tldraw/assets@".concat(Da,"/fonts/IBMPlexMono-Medium.woff2")}};function Na(){Na=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new M(r||[]);return i(a,"_invoke",{value:E(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var f="suspendedStart",p="suspendedYield",h="executing",v="completed",g={};function m(){}function y(){}function b(){}var w={};l(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==n&&r.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function n(i,o,a,s){var u=d(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==j(c)&&r.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(c).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function E(t,n,r){var i=f;return function(o,a){if(i===h)throw new Error("Generator is already running");if(i===v){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=C(s,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=h;var l=d(t,n,r);if("normal"===l.type){if(i=r.done?v:p,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=v,r.method="throw",r.arg=l.arg)}}}function C(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=d(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function A(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(j(t)+" is not iterable")}return y.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},_(P.prototype),l(P.prototype,s,(function(){return this})),t.AsyncIterator=P,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new P(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=A,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:A(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function Ba(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(r,i)}function Fa(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ba(o,r,i,a,s,"next",e)}function s(e){Ba(o,r,i,a,s,"throw",e)}a(void 0)}))}}var Ua=n(1694),Ka=t.createContext({}),Va=function(){return t.useContext(Ka)},Wa={openWindow:function(e,t){return window.open(e,t,"noopener noreferrer")},refreshPage:function(){return window.location.reload()},hardReset:function(){var e=Fa(Na().mark((function e(){var t,n;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=(n=window).__tldraw__hardReset)||void 0===t?void 0:t.call(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()};function Ha(){Wa.hardReset()}var Ya={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},easeInSine:function(e){return 1-Math.cos(e*Math.PI/2)},easeOutSine:function(e){return Math.sin(e*Math.PI/2)},easeInOutSine:function(e){return-(Math.cos(Math.PI*e)-1)/2},easeInExpo:function(e){return e<=0?0:Math.pow(2,10*e-10)},easeOutExpo:function(e){return e>=1?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return e<=0?0:e>=1?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2}},Xa=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;M(this,e),this.x=t,this.y=n,this.z=r}return L(e,[{key:"pressure",get:function(){return this.z}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.x,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.y,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.z;return this.x=e,this.y=t,this.z=n,this}},{key:"setTo",value:function(e){var t=e.x,n=void 0===t?0:t,r=e.y,i=void 0===r?0:r,o=e.z,a=void 0===o?1:o;return this.x=n,this.y=i,this.z=a,this}},{key:"rot",value:function(e){if(0===e)return this;var t=this.x,n=this.y,r=Math.sin(e),i=Math.cos(e);return this.x=t*i-n*r,this.y=t*r+n*i,this}},{key:"rotWith",value:function(e,t){if(0===t)return this;var n=this.x-e.x,r=this.y-e.y,i=Math.sin(t),o=Math.cos(t);return this.x=e.x+(n*o-r*i),this.y=e.y+(n*i+r*o),this}},{key:"clone",value:function(){return new e(this.x,this.y,this.z)}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this}},{key:"subXY",value:function(e,t){return this.x-=e,this.y-=t,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"addXY",value:function(e,t){return this.x+=e,this.y+=t,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"clamp",value:function(e,t){return this.x=Math.max(this.x,e),this.y=Math.max(this.y,e),void 0!==t&&(this.x=Math.min(this.x,t),this.y=Math.min(this.y,t)),this}},{key:"div",value:function(e){return this.x/=e,this.y/=e,this}},{key:"divV",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"mul",value:function(e){return this.x*=e,this.y*=e,this}},{key:"mulV",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"abs",value:function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}},{key:"nudge",value:function(t,n){var r=e.Tan(t,this);return this.add(r.mul(n))}},{key:"neg",value:function(){return this.x*=-1,this.y*=-1,this}},{key:"cross",value:function(e){return this.x=this.y*e.z-this.z*e.y,this.y=this.z*e.x-this.x*e.z,this}},{key:"dpr",value:function(t){return e.Dpr(this,t)}},{key:"cpr",value:function(t){return e.Cpr(this,t)}},{key:"len2",value:function(){return e.Len2(this)}},{key:"len",value:function(){return e.Len(this)}},{key:"pry",value:function(t){return e.Pry(this,t)}},{key:"per",value:function(){var e=this.x,t=this.y;return this.x=t,this.y=-e,this}},{key:"uni",value:function(){return e.Uni(this)}},{key:"tan",value:function(t){return e.Tan(this,t)}},{key:"dist",value:function(t){return e.Dist(this,t)}},{key:"distanceToLineSegment",value:function(t,n){return e.DistanceToLineSegment(t,n,this)}},{key:"slope",value:function(t){return e.Slope(this,t)}},{key:"snapToGrid",value:function(e){return this.x=Math.round(this.x/e)*e,this.y=Math.round(this.y/e)*e,this}},{key:"angle",value:function(t){return e.Angle(this,t)}},{key:"toAngle",value:function(){return e.ToAngle(this)}},{key:"lrp",value:function(e,t){return this.x=this.x+(e.x-this.x)*t,this.y=this.y+(e.y-this.y)*t,this}},{key:"equals",value:function(t){return e.Equals(this,t)}},{key:"equalsXY",value:function(t,n){return e.EqualsXY(this,t,n)}},{key:"norm",value:function(){var e=this.len();return this.x=0===e?0:this.x/e,this.y=0===e?0:this.y/e,this}},{key:"toFixed",value:function(){return e.ToFixed(this)}},{key:"toString",value:function(){return e.ToString(e.ToFixed(this))}},{key:"toJson",value:function(){return e.ToJson(this)}},{key:"toArray",value:function(){return e.ToArray(this)}}],[{key:"Add",value:function(t,n){return new e(t.x+n.x,t.y+n.y)}},{key:"AddXY",value:function(t,n,r){return new e(t.x+n,t.y+r)}},{key:"Sub",value:function(t,n){return new e(t.x-n.x,t.y-n.y)}},{key:"SubXY",value:function(t,n,r){return new e(t.x-n,t.y-r)}},{key:"AddScalar",value:function(t,n){return new e(t.x+n,t.y+n)}},{key:"SubScalar",value:function(t,n){return new e(t.x-n,t.y-n)}},{key:"Div",value:function(t,n){return new e(t.x/n,t.y/n)}},{key:"Mul",value:function(t,n){return new e(t.x*n,t.y*n)}},{key:"DivV",value:function(t,n){return new e(t.x/n.x,t.y/n.y)}},{key:"MulV",value:function(t,n){return new e(t.x*n.x,t.y*n.y)}},{key:"Neg",value:function(t){return new e(-t.x,-t.y)}},{key:"Per",value:function(t){return new e(t.y,-t.x)}},{key:"Dist2",value:function(t,n){return e.Sub(t,n).len2()}},{key:"Abs",value:function(t){return new e(Math.abs(t.x),Math.abs(t.y))}},{key:"Dist",value:function(e,t){return Math.hypot(e.y-t.y,e.x-t.x)}},{key:"Dpr",value:function(e,t){return e.x*t.x+e.y*t.y}},{key:"Cross",value:function(t,n){return new e(t.y*n.z-t.z*n.y,t.z*n.x-t.x*n.z)}},{key:"Cpr",value:function(e,t){return e.x*t.y-t.x*e.y}},{key:"Len2",value:function(e){return e.x*e.x+e.y*e.y}},{key:"Len",value:function(t){return Math.sqrt(e.Len2(t))}},{key:"Pry",value:function(t,n){return e.Dpr(t,n)/e.Len(n)}},{key:"Uni",value:function(t){return e.Div(t,e.Len(t))}},{key:"Tan",value:function(t,n){return e.Uni(e.Sub(t,n))}},{key:"Min",value:function(t,n){return new e(Math.min(t.x,n.x),Math.min(t.y,n.y))}},{key:"Max",value:function(t,n){return new e(Math.max(t.x,n.x),Math.max(t.y,n.y))}},{key:"From",value:function(t){var n=t.x,r=t.y,i=t.z;return new e(n,r,void 0===i?1:i)}},{key:"FromArray",value:function(t){return new e(t[0],t[1])}},{key:"Rot",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=Math.sin(n),i=Math.cos(n);return new e(t.x*i-t.y*r,t.x*r+t.y*i)}},{key:"RotWith",value:function(t,n,r){var i=t.x-n.x,o=t.y-n.y,a=Math.sin(r),s=Math.cos(r);return new e(n.x+(i*s-o*a),n.y+(i*a+o*s))}},{key:"NearestPointOnLineThroughPoint",value:function(t,n,r){return e.Mul(n,e.Sub(r,t).pry(n)).add(t)}},{key:"NearestPointOnLineSegment",value:function(t,n,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=e.Tan(n,t),a=e.Add(t,e.Mul(o,e.Sub(r,t).pry(o)));if(i){if(a.x<Math.min(t.x,n.x))return e.Cast(t.x<n.x?t:n);if(a.x>Math.max(t.x,n.x))return e.Cast(t.x>n.x?t:n);if(a.y<Math.min(t.y,n.y))return e.Cast(t.y<n.y?t:n);if(a.y>Math.max(t.y,n.y))return e.Cast(t.y>n.y?t:n)}return a}},{key:"DistanceToLineThroughPoint",value:function(t,n,r){return e.Dist(r,e.NearestPointOnLineThroughPoint(t,n,r))}},{key:"DistanceToLineSegment",value:function(t,n,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return e.Dist(r,e.NearestPointOnLineSegment(t,n,r,i))}},{key:"Snap",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new e(Math.round(t.x/n)*n,Math.round(t.y/n)*n)}},{key:"Cast",value:function(t){return t instanceof e?t:e.From(t)}},{key:"Slope",value:function(e,t){return e.x===t.y?NaN:(e.y-t.y)/(e.x-t.x)}},{key:"Angle",value:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}},{key:"Lrp",value:function(t,n,r){return e.Sub(n,t).mul(r).add(t)}},{key:"Med",value:function(t,n){return new e((t.x+n.x)/2,(t.y+n.y)/2)}},{key:"Equals",value:function(e,t){return Math.abs(e.x-t.x)<1e-4&&Math.abs(e.y-t.y)<1e-4}},{key:"EqualsXY",value:function(e,t,n){return e.x===t&&e.y===n}},{key:"Clockwise",value:function(e,t,n){return(n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y)<0}},{key:"Rescale",value:function(t,n){var r=e.Len(t);return new e(n*t.x/r,n*t.y/r)}},{key:"ScaleWithOrigin",value:function(t,n,r){return e.Sub(t,r).mul(n).add(r)}},{key:"ToFixed",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return new e(+t.x.toFixed(n),+t.y.toFixed(n),+t.z.toFixed(n))}},{key:"Nudge",value:function(t,n,r){return e.Add(t,e.Tan(n,t).mul(r))}},{key:"ToString",value:function(e){return"".concat(e.x,", ").concat(e.y)}},{key:"ToAngle",value:function(e){var t=Math.atan2(e.y,e.x);return t<0&&(t+=2*Math.PI),t}},{key:"ToArray",value:function(e){return[e.x,e.y,e.z]}},{key:"ToJson",value:function(e){return{x:e.x,y:e.y,z:e.z}}},{key:"Average",value:function(t){for(var n=t.length,r=new e(0,0),i=0;i<n;i++)r.add(t[i]);return r.div(n)}},{key:"Clamp",value:function(t,n,r){return void 0===r?new e(Math.min(Math.max(t.x,n)),Math.min(Math.max(t.y,n))):new e(Math.min(Math.max(t.x,n),r),Math.min(Math.max(t.y,n),r))}},{key:"PointsBetween",value:function(t,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,i=[],o=0;o<r;o++){var a=Ya.easeInQuad(o/(r-1)),s=e.Lrp(t,n,a);s.z=Math.min(1,.5+.65*Math.abs(.5-qa(a))),i.push(s)}return i}},{key:"SnapToGrid",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return new e(Math.round(t.x/n)*n,Math.round(t.y/n)*n)}}]),e}(),qa=function(e){return e<.5?2*e*e:(4-2*e)*e-1},$a=Math.PI,Ga=$a/2,Qa=2*$a,Za=Math.PI/180,Ja=Math.sin;function es(e,t,n){return Math.max(t,"undefined"!==typeof n?Math.min(e,n):e)}function ts(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e10;return e?Math.round(e*t)/t:0}function ns(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;return Math.abs(e-t)<=n}function rs(e,t){var n=Math.pow(e-t,2)/Math.pow(e+t,2);return $a*(e+t)*(1+3*n/(10+Math.sqrt(4-3*n)))}function is(e){return(e%=Qa)<0?e+=Qa:0===e&&(e=0),e}function os(e,t){var n=(t-e)%Qa;return 2*n%Qa-n}function as(e,t,n){return e+os(e,t)*n}function ss(e,t){return os(e,t)}function us(e){return(Qa+e)%Qa}function ls(e,t){var n=Qa/t,r=Math.floor((us(e)+n/2)/n)*n%Qa;return r<$a&&(r+=Qa),r>$a&&(r-=Qa),r}function cs(e,t){return e===t||ns(e%(Math.PI/2)-t%(Math.PI/2),0)}function ds(e,t,n,r){var i=function(e,t,n){return ss(Xa.Angle(e,t),Xa.Angle(e,n))}(e,n,r);return t*Qa*(i/Qa)}function fs(e,t,n,r){return new Xa(e+n*Math.cos(r),t+n*Math.sin(r))}function ps(e,t,n){for(var r=e/2,i=t/2,o=[],a=0;a<n;a++){var s=a*(Qa/n)-Ga;o.push(new Xa(r+r*Math.cos(s),i+i*Math.sin(s)))}return o}function hs(e,t,n,r){return e<r&&n<t}function vs(e,t,n,r){var i=Math.max(e,n),o=Math.min(t,r);return i<=o?[i,o]:null}function gs(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)}function ms(e,t){for(var n,r,i=0,o=0;o<t.length;o++)n=t[o],r=t[(o+1)%t.length],n.y<=e.y?r.y>e.y&&gs(n,r,e)>0&&(i+=1):r.y<=e.y&&gs(n,r,e)<0&&(i-=1);return 0!==i}function ys(e){return+e.toFixed(4)}function bs(e){return+e.toFixed(2)}var ws,xs=function(e){return Math.abs(e)<Number.MAX_SAFE_INTEGER},ks=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;M(this,e),z(this,"x",0),z(this,"y",0),z(this,"w",0),z(this,"h",0),this.x=t,this.y=n,this.w=r,this.h=i}return L(e,[{key:"point",get:function(){return new Xa(this.x,this.y)},set:function(e){this.x=e.x,this.y=e.y}},{key:"minX",get:function(){return this.x},set:function(e){this.x=e}},{key:"midX",get:function(){return this.x+this.w/2}},{key:"maxX",get:function(){return this.x+this.w}},{key:"minY",get:function(){return this.y},set:function(e){this.y=e}},{key:"midY",get:function(){return this.y+this.h/2}},{key:"maxY",get:function(){return this.y+this.h}},{key:"width",get:function(){return this.w},set:function(e){this.w=e}},{key:"height",get:function(){return this.h},set:function(e){this.h=e}},{key:"aspectRatio",get:function(){return this.width/this.height}},{key:"center",get:function(){return new Xa(this.midX,this.midY)},set:function(e){this.minX=e.x-this.width/2,this.minY=e.y-this.height/2}},{key:"corners",get:function(){return[new Xa(this.minX,this.minY),new Xa(this.maxX,this.minY),new Xa(this.maxX,this.maxY),new Xa(this.minX,this.maxY)]}},{key:"snapPoints",get:function(){return[new Xa(this.minX,this.minY),new Xa(this.maxX,this.minY),new Xa(this.maxX,this.maxY),new Xa(this.minX,this.maxY),this.center]}},{key:"sides",get:function(){var e=this.corners;return[[e[0],e[1]],[e[1],e[2]],[e[2],e[3]],[e[3],e[0]]]}},{key:"size",get:function(){return new Xa(this.w,this.h)}},{key:"toFixed",value:function(){return this.x=ts(this.x),this.y=ts(this.y),this.w=ts(this.w),this.h=ts(this.h),this}},{key:"setTo",value:function(e){return this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h,this}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.x=e,this.y=t,this.w=n,this.h=r,this}},{key:"expand",value:function(e){var t=Math.min(this.minX,e.minX),n=Math.min(this.minY,e.minY),r=Math.max(this.maxX,e.maxX),i=Math.max(this.maxY,e.maxY);return this.x=t,this.y=n,this.w=r-t,this.h=i-n,this}},{key:"expandBy",value:function(e){return this.x-=e,this.y-=e,this.w+=2*e,this.h+=2*e,this}},{key:"scale",value:function(e){return this.x/=e,this.y/=e,this.w/=e,this.h/=e,this}},{key:"clone",value:function(){return new e(this.x,this.y,this.w,this.h)}},{key:"translate",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"snapToGrid",value:function(e){var t=Math.round(this.minX/e)*e,n=Math.round(this.minY/e)*e,r=Math.round(this.maxX/e)*e,i=Math.round(this.maxY/e)*e;this.minX=t,this.minY=n,this.width=Math.max(1,r-t),this.height=Math.max(1,i-n)}},{key:"collides",value:function(t){return e.Collides(this,t)}},{key:"contains",value:function(t){return e.Contains(this,t)}},{key:"includes",value:function(t){return e.Includes(this,t)}},{key:"containsPoint",value:function(t,n){return e.ContainsPoint(this,t,n)}},{key:"getHandlePoint",value:function(e){switch(e){case"top_left":return new Xa(this.minX,this.minY);case"top_right":return new Xa(this.maxX,this.minY);case"bottom_left":return new Xa(this.minX,this.maxY);case"bottom_right":return new Xa(this.maxX,this.maxY);case"top":return new Xa(this.midX,this.minY);case"right":return new Xa(this.maxX,this.midY);case"bottom":return new Xa(this.midX,this.maxY);case"left":return new Xa(this.minX,this.midY)}}},{key:"toJson",value:function(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}},{key:"resize",value:function(e,t,n){var r=this.minX,i=this.minY,o=this.maxX,a=this.maxY,s=this.minX,u=this.minY,l=this.maxX,c=this.maxY;switch(e){case"left":case"top_left":case"bottom_left":s+=t;break;case"right":case"top_right":case"bottom_right":l+=t}switch(e){case"top":case"top_left":case"top_right":u+=n;break;case"bottom":case"bottom_left":case"bottom_right":c+=n}if((l-s)/(o-r)<0){var d=l;l=s,s=d}if((c-u)/(a-i)<0){var f=c;c=u,u=f}this.minX=s,this.minY=u,this.width=Math.abs(l-s),this.height=Math.abs(c-u)}},{key:"union",value:function(e){var t=Math.min(this.minX,e.x),n=Math.min(this.minY,e.y),r=Math.max(this.maxX,e.w+e.x),i=Math.max(this.maxY,e.h+e.y);return this.x=t,this.y=n,this.width=r-t,this.height=i-n,this}},{key:"equals",value:function(t){return e.Equals(this,t)}}],[{key:"From",value:function(t){return new e(t.x,t.y,t.w,t.h)}},{key:"FromPoints",value:function(t){if(0===t.length)return new e;for(var n,r=1/0,i=1/0,o=-1/0,a=-1/0,s=0,u=t.length;s<u;s++)n=t[s],r=Math.min(n.x,r),i=Math.min(n.y,i),o=Math.max(n.x,o),a=Math.max(n.y,a);return new e(r,i,o-r,a-i)}},{key:"Expand",value:function(t,n){var r=Math.min(n.minX,t.minX),i=Math.min(n.minY,t.minY);return new e(r,i,Math.max(n.maxX,t.maxX)-r,Math.max(n.maxY,t.maxY)-i)}},{key:"ExpandBy",value:function(t,n){return new e(t.minX-n,t.minY-n,t.width+2*n,t.height+2*n)}},{key:"Resize",value:function(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.minX,s=t.minY,u=t.maxX,l=t.maxY,c=t.minX,d=t.minY,f=t.maxX,p=t.maxY;switch(n){case"left":case"top_left":case"bottom_left":c+=r;break;case"right":case"top_right":case"bottom_right":f+=r}switch(n){case"top":case"top_left":case"top_right":d+=i;break;case"bottom":case"bottom_left":case"bottom_right":p+=i}var h=(f-c)/(u-a),v=(p-d)/(l-s),g=h<0,m=v<0;if(o){var y=(u-a)/(l-s),b=Math.abs(f-c),w=Math.abs(p-d),x=b*(v<0?1:-1)*(1/y),k=w*(h<0?1:-1)*y,S=y<b/w;switch(n){case"top_left":S?d=p+x:c=f+k;break;case"top_right":S?d=p+x:f=c-k;break;case"bottom_right":S?p=d-x:f=c-k;break;case"bottom_left":S?p=d-x:c=f+k;break;case"bottom":case"top":var _=(c+f)/2,P=w*y;c=_-P/2,f=_+P/2;break;case"left":case"right":var E=(d+p)/2,C=b/y;d=E-C/2,p=E+C/2}}if(g){var I=f;f=c,c=I}if(m){var T=p;p=d,d=T}var M=new e(c,d,Math.abs(f-c),Math.abs(p-d));return{box:M,scaleX:+(M.width/t.width*(h>0?1:-1)).toFixed(5),scaleY:+(M.height/t.height*(v>0?1:-1)).toFixed(5)}}},{key:"Equals",value:function(e,t){return t.x===e.x&&t.y===e.y&&t.w===e.w&&t.h===e.h}}]),e}();ws=ks,z(ks,"Collides",(function(e,t){return!(e.maxX<t.minX||e.minX>t.maxX||e.maxY<t.minY||e.minY>t.maxY)})),z(ks,"Contains",(function(e,t){return e.minX<t.minX&&e.minY<t.minY&&e.maxY>t.maxY&&e.maxX>t.maxX})),z(ks,"Includes",(function(e,t){return ws.Collides(e,t)||ws.Contains(e,t)})),z(ks,"ContainsPoint",(function(e,t,n){return"number"===typeof t?!(t<e.minX||n<e.minY||t>e.maxX||n>e.maxY):!(t.x<e.minX||t.y<e.minY||t.x>e.maxX||t.y>e.maxY)})),z(ks,"Common",(function(e){for(var t=1/0,n=1/0,r=-1/0,i=-1/0,o=0;o<e.length;o++){var a=e[o];t=Math.min(t,a.minX),n=Math.min(n,a.minY),r=Math.max(r,a.maxX),i=Math.max(i,a.maxY)}return new ws(t,n,r-t,i-n)})),z(ks,"Sides",(function(e){var t=e.corners;return[[t[0],t[1]],[t[1],t[2]],[t[2],t[3]],[t[3],t[0]]]}));var Ss,_s=function(){function e(t){M(this,e),z(this,"_values",void 0),z(this,"_computed",{}),this._values=t}return L(e,[{key:"values",get:function(){return this._values},set:function(e){this._values=e,this._computed={}}},{key:"length",get:function(){if(void 0!==this._computed.length)return this._computed.length;for(var e=this.lut,t=e[0],n=0,r=1;r<e.length;r++){var i=e[r];n+=t.dist(i),t=i}return this._computed.length=n,n}},{key:"bounds",get:function(){if(void 0!==this._computed.bounds)return this._computed.bounds;var e,t=1/0,n=1/0,r=-1/0,i=-1/0,o=J(this.lut);try{for(o.s();!(e=o.n()).done;){var a=e.value;t=Math.min(a.x,t),n=Math.min(a.y,n),r=Math.max(a.x,r),i=Math.max(a.y,i)}}catch(u){o.e(u)}finally{o.f()}var s=new ks(t,n,r-t,i-n);return this._computed.bounds=s,s}},{key:"lut",get:function(){if(this._computed.lut)return this._computed.lut;for(var e=this.values.p,t=[],n=0;n<e+1;n++)t.push(this.getPoint(n/e));return this._computed.lut=t,t}},{key:"midPoint",get:function(){if(this._computed.midPoint)return this._computed.midPoint;var e=this.getPoint(.5);return this._computed.midPoint=e,e}},{key:"path",get:function(){if(this._computed.path)return this._computed.path;var e=this.getPath();return this._computed.path=e,e}},{key:"getPointAtLength",value:function(e){var t=Math.max(0,Math.min(1,e/this.length));return this.getPoint(t)}},{key:"getNormal",value:function(e){return this.getPoint(e-.0025).tan(this.getPoint(e+.0025)).per().uni().toFixed()}},{key:"getNormalAtLength",value:function(e){return this.getNormal(e/this.length)}},{key:"getClosestPointTo",value:function(e){for(var t=this.lut,n=0,r=t[0],i=t[0].dist(e),o=1;o<t.length;o++){var a=Xa.Dist(t[o],e);a<i&&(i=a,r=t[o],n=o/t.length)}for(var s=1/this.values.p,u=Math.max(0,n-s/2);u<Math.min(1,n+s/2);u+=s/10){var l=this.getPoint(u),c=Xa.Dist(l,e);c<i&&(i=c,r=l)}return{point:r,distance:i}}},{key:"update",value:function(e){this._computed={},this.values=Ce(Ce({},this.values),e)}}]),e}();Ss=Symbol.iterator;var Ps,Es=function(e){Et(n,e);var t=Tt(n);function n(e,r,i,o){var a,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:25;return M(this,n),z(_t(a=t.call(this,{a:e,b:r,c:i,d:o,p:s})),Ss,Na().mark((function e(){var t,n,r,i,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.values,n=t.a,r=t.b,i=t.c,o=t.d,e.delegateYield([n,r,i,o],"t0",2);case 2:case"end":return e.stop()}}),e,this)}))),a}return L(n,[{key:"getPath",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.values,n=t.a,r=t.b,i=t.c,o=t.d;return Xa.Equals(n,o)?"":"".concat(e?"M".concat(n.x.toFixed(2),",").concat(n.y.toFixed(2),"C"):"").concat(r.x.toFixed(2),",").concat(r.y.toFixed(2)," ").concat(i.x.toFixed(2),",").concat(i.y.toFixed(2)," ").concat(o.x.toFixed(2),",").concat(o.y.toFixed(2))}},{key:"getPoint",value:function(e){var t=this.values,n=t.a,r=t.b,i=t.c,o=t.d;return e<=0?Xa.From(n):e>=1?Xa.From(o):new Xa((1-e)*(1-e)*(1-e)*n.x+(1-e)*(1-e)*3*e*r.x+3*(1-e)*(e*e)*i.x+e*e*e*o.x,(1-e)*(1-e)*(1-e)*n.y+(1-e)*(1-e)*3*e*r.y+3*(1-e)*(e*e)*i.y+e*e*e*o.y)}},{key:"getX",value:function(e){var t=this.values,n=t.a,r=t.b,i=t.c,o=t.d;return(1-e)*(1-e)*(1-e)*n.x+(1-e)*(1-e)*3*e*r.x+3*(1-e)*(e*e)*i.x+e*e*e*o.x}},{key:"getY",value:function(e){var t=this.values,n=t.a,r=t.b,i=t.c,o=t.d;return(1-e)*(1-e)*(1-e)*n.y+(1-e)*(1-e)*3*e*r.y+3*(1-e)*(e*e)*i.y+e*e*e*o.y}}]),n}(_s),Cs=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;M(this,e),z(this,"computed",{}),this.points=t,this.p=n,this.k=r}return L(e,[{key:"length",get:function(){if(void 0!==this.computed.length)return this.computed.length;var e=this.segments.reduce((function(e,t){return e+t.length}),0);return this.computed.length=e,e}},{key:"bounds",get:function(){if(void 0!==this.computed.bounds)return this.computed.bounds;var e=this.segments,t=ks.Common(e.map((function(e){return e.bounds})));return this.computed.bounds=t,t}},{key:"head",get:function(){return this.points[0]}},{key:"tail",get:function(){var e=this.points;return e[e.length-1]}},{key:"path",get:function(){if(void 0!==this.computed.path)return this.computed.path;var e=this.segments.map((function(e){return e.path})).filter((function(e){return void 0!==e&&null!==e&&""!==e})).join(" ");return this.computed.path=e,e}},{key:"addPoint",value:function(e){var t=this.points,n=this.k,r=this.p;return t.push(e),this.computed={},this.getSegmentsFromPoints(this.points,r,n),this}},{key:"removePoint",value:function(e){var t=this.points,n=this.k,r=this.p,i="number"===typeof e?Math.floor(e):t.indexOf(e);return-1===i||(t.splice(i,1),this.computed={},this.getSegmentsFromPoints(this.points,r,n)),this}},{key:"getPointAtLength",value:function(e){var t=this.segments,n=e;if(e<=0)return t[0].getPoint(0);if(e>=this.length)return t[t.length-1].getPoint(1);for(var r=0;r<t.length;r++){var i=t[r],o=i.length;if(n<o)return i.getPoint(n/o);n-=i.length}return t[t.length-1].getPoint(1)}},{key:"getPoint",value:function(e){return e<=0?this.segments[0].getPoint(0):e>=1?this.segments[this.segments.length-1].getPoint(1):this.getPointAtLength(e*this.length)}},{key:"getNormal",value:function(e){var t=this.length;return this.getNormalAtLength(e*t)}},{key:"getNormalAtLength",value:function(e){var t=this.segments;if(e<0)return new Xa(0,0);var n,r=e,i=J(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=o.length;if(r<=a)return o.getNormal(r/a);r-=a}}catch(s){i.e(s)}finally{i.f()}return new Xa(0,0)}},{key:"getClosestPointTo",value:function(e){var t,n=this.head,r=this.segments,i=n,o=Xa.Dist(e,n),a=J(r);try{for(a.s();!(t=a.n()).done;){var s=t.value.getClosestPointTo(e);s.distance<o&&(o=s.distance,i=s.point)}}catch(u){a.e(u)}finally{a.f()}return{point:i,distance:o}}}]),e}(),Is=function(e){Et(n,e);var t=Tt(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.2,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;return M(this,n),z(_t(r=t.call(this,e,i,o)),"segments",void 0),r.segments=r.getSegmentsFromPoints(e,i,o),r}return L(n,[{key:"getSegmentsFromPoints",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.25,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,r=e.length,i=r-2,o=[],a=0;a<r-1;a++){var s=0===a?e[0]:e[a-1],u=e[a],l=e[a+1],c=a===i?l:e[a+2];o.push(new Es(u,0===a?s:new Xa(u.x+(l.x-s.x)/6*t,u.y+(l.y-s.y)/6*t),a===i?l:new Xa(l.x-(c.x-u.x)/6*t,l.y-(c.y-u.y)/6*t),l,n))}return o}}],[{key:"FromPoints",value:function(e){return new n(e)}}]),n}(Cs),Ts=function(e){Et(n,e);var t=Tt(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return M(this,n),(i=t.call(this,{a:e,b:r,p:o})).a=e,i.b=r,i.values.p=Math.max(10,Math.ceil(i.length/20)),i}return L(n,[{key:"length",get:function(){return Xa.Dist(this.a,this.b)}},{key:"tangent",get:function(){return Xa.Tan(this.a,this.b)}},{key:"angle",get:function(){return Xa.Angle(this.a,this.b)}},{key:"bounds",get:function(){return ks.FromPoints([this.a,this.b])}},{key:"getX",value:function(e){var t=this.values,n=t.a,r=t.b;return n.x+(r.x-n.x)*e}},{key:"getY",value:function(e){var t=this.values,n=t.a,r=t.b;return n.y+(r.y-n.y)*e}},{key:"getPoint",value:function(e){var t=this.values,n=t.a,r=t.b;return e<=0?Xa.From(n):e>=1?Xa.From(r):Xa.Lrp(n,r,e)}},{key:"getPath",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.values,n=t.a,r=t.b;return Xa.Equals(n,r)?"":e?"M".concat(n.x,",").concat(n.y,"L").concat(r.x,",").concat(r.y):"".concat(r.x,",").concat(r.y)}},{key:"getNormal",value:function(){var e=this.values,t=e.a,n=e.b;return Xa.Sub(t,n).per().uni().toFixed()}},{key:"getClosestPointTo",value:function(e){var t=this.values,n=t.a,r=t.b,i=Xa.NearestPointOnLineSegment(n,r,e),o=i.dist(e);return{point:i,distance:o}}}],[{key:"Length",value:function(e){return Xa.Dist(e.a,e.b)}},{key:"Tangent",value:function(e){return Xa.Tan(e.a,e.b)}},{key:"Angle",value:function(e){return Xa.Angle(e.a,e.b)}}]),n}(_s),Ms=function(){function e(t,n,r,i,o,a){M(this,e),z(this,"a",1),z(this,"b",0),z(this,"c",0),z(this,"d",1),z(this,"e",0),z(this,"f",0),this.a=t,this.b=n,this.c=r,this.d=i,this.e=o,this.f=a}return L(e,[{key:"equals",value:function(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f}},{key:"identity",value:function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}},{key:"multiply",value:function(e){var t=e,n=this.a,r=this.b,i=this.c,o=this.d,a=this.e,s=this.f;return this.a=n*t.a+i*t.b,this.c=n*t.c+i*t.d,this.e=n*t.e+i*t.f+a,this.b=r*t.a+o*t.b,this.d=r*t.c+o*t.d,this.f=r*t.e+o*t.f+s,this}},{key:"rotate",value:function(t,n,r){return 0===t?this:void 0===n?this.multiply(e.Rotate(t)):this.translate(n,r).multiply(e.Rotate(t)).translate(-n,-r)}},{key:"translate",value:function(t,n){return this.multiply(e.Translate(t,n))}},{key:"scale",value:function(t,n){return this.multiply(e.Scale(t,n))}},{key:"invert",value:function(){var e=this.a,t=this.b,n=this.c,r=this.d,i=this.e,o=this.f,a=e*r-t*n;return this.a=r/a,this.b=t/-a,this.c=n/-a,this.d=e/a,this.e=(r*i-n*o)/-a,this.f=(t*i-e*o)/a,this}},{key:"applyToPoint",value:function(t){return e.applyToPoint(this,t)}},{key:"applyToPoints",value:function(t){return e.applyToPoints(this,t)}},{key:"decomposed",value:function(){return e.Decompose(this)}},{key:"toCssString",value:function(){return e.toCssString(this)}},{key:"setTo",value:function(e){return Object.assign(this,e),this}},{key:"decompose",value:function(){return e.Decompose(this)}},{key:"clone",value:function(){return new e(this.a,this.b,this.c,this.d,this.e,this.f)}}],[{key:"Identity",value:function(){return new e(1,0,0,1,0,0)}},{key:"Translate",value:function(t,n){return new e(1,0,0,1,t,n)}},{key:"Rotate",value:function(t,n,r){if(0===t)return e.Identity();var i=Math.cos(t),o=Math.sin(t),a=new e(i,o,-o,i,0,0);return void 0===n?a:e.Compose(e.Translate(n,r),a,e.Translate(-n,-r))}},{key:"Multiply",value:function(e,t){return{a:e.a*t.a+e.c*t.b,c:e.a*t.c+e.c*t.d,e:e.a*t.e+e.c*t.f+e.e,b:e.b*t.a+e.d*t.b,d:e.b*t.c+e.d*t.d,f:e.b*t.e+e.d*t.f+e.f}}},{key:"Inverse",value:function(e){var t=e.a*e.d-e.b*e.c;return{a:e.d/t,b:e.b/-t,c:e.c/-t,d:e.a/t,e:(e.d*e.e-e.c*e.f)/-t,f:(e.b*e.e-e.a*e.f)/t}}},{key:"Absolute",value:function(e){var t=e.a*e.d-e.b*e.c;return{a:e.d/t,b:e.b/-t,c:e.c/-t,d:e.a/t,e:(e.d*e.e-e.c*e.f)/t,f:(e.b*e.e-e.a*e.f)/-t}}},{key:"Compose",value:function(){for(var t=e.Identity(),n=0,r=arguments.length;n<r;n++)t.multiply(n<0||arguments.length<=n?void 0:arguments[n]);return t}},{key:"Decompose",value:function(e){var t,n,r;if(0!==e.a||0!==e.c){var i=Math.hypot(e.a,e.c);t=i,n=(e.a*e.d-e.b*e.c)/i,r=Math.acos(e.a/i)*(e.c>0?-1:1)}else if(0!==e.b||0!==e.d){var o=Math.hypot(e.b,e.d);t=(e.a*e.d-e.b*e.c)/o,n=o,r=Ga+Math.acos(e.b/o)*(e.d>0?-1:1)}else t=0,n=0,r=0;return{x:e.e,y:e.f,scaleX:t,scaleY:n,rotation:us(r)}}},{key:"Smooth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e10;return e.a=Math.round(e.a*t)/t,e.b=Math.round(e.b*t)/t,e.c=Math.round(e.c*t)/t,e.d=Math.round(e.d*t)/t,e.e=Math.round(e.e*t)/t,e.f=Math.round(e.f*t)/t,e}},{key:"toCssString",value:function(e){return"matrix(".concat(ys(e.a),", ").concat(ys(e.b),", ").concat(ys(e.c),", ").concat(ys(e.d),", ").concat(ys(e.e),", ").concat(ys(e.f),")")}},{key:"applyToPoint",value:function(e,t){return new Xa(e.a*t.x+e.c*t.y+e.e,e.b*t.x+e.d*t.y+e.f,t.z)}},{key:"applyToXY",value:function(e,t,n){return[e.a*t+e.c*n+e.e,e.b*t+e.d*n+e.f]}},{key:"applyToPoints",value:function(e,t){return t.map((function(t){return new Xa(e.a*t.x+e.c*t.y+e.e,e.b*t.x+e.d*t.y+e.f,t.z)}))}},{key:"applyToBounds",value:function(e,t){return new ks(e.e+t.minX,e.f+t.minY,t.width,t.height)}},{key:"From",value:function(t){return new e(t.a,t.b,t.c,t.d,t.e,t.f)}}]),e}();Ps=Ms,z(Ms,"Scale",(function(e,t,n,r){var i=new Ps(e,0,0,0,t,0);return void 0===n?i:Ps.Compose(Ps.Translate(n,r),i,Ps.Translate(-n,-r))}));var js=function(e){Et(n,e);var t=Tt(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.2,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;return M(this,n),z(_t(r=t.call(this,e,i,o)),"segments",void 0),r.segments=r.getSegmentsFromPoints(e,o),r}return L(n,[{key:"getSegmentsFromPoints",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=[],r=0;r<e.length-1;r++)n.push(new Ts(e[r],e[r+1],t));return n}}],[{key:"FromPoints",value:function(e){return new n(e)}}]),n}(Cs),As=Math.PI+1e-4;function Os(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.size,r=void 0===n?16:n,i=t.smoothing,o=void 0===i?.5:i,a=t.start,s=void 0===a?{}:a,u=t.end,l=void 0===u?{}:u,c=t.last,d=void 0!==c&&c,f=s.cap,p=void 0===f||f,h=l.cap,v=void 0===h||h;if(0===e.length||r<=0)return[];for(var g,m=e[0],y=e[e.length-1],b=y.runningLength,w=!1===s.taper?0:!0===s.taper?Math.max(r,b):s.taper,x=!1===l.taper?0:!0===l.taper?Math.max(r,b):l.taper,k=Math.pow(r*o,2),S=[],_=[],P=e[0].vector,E=e[0].point,C=E,I=E,T=C,M=!1,j=0;j<e.length;j++){g=e[j];var A=e[j],O=A.point,L=A.vector,z=g.vector.dpr(P),D=(j<e.length-1?e[j+1]:e[j]).vector,R=j<e.length-1?D.dpr(g.vector):1,N=null!==R&&R<.2;if(z<0&&!M||N){if(R>-.62&&b-g.runningLength>g.radius){var B=P.clone().mul(g.radius);P.clone().cpr(D)<0?(I=Xa.Add(O,B),T=Xa.Sub(O,B)):(I=Xa.Sub(O,B),T=Xa.Add(O,B)),S.push(I),_.push(T)}else for(var F=P.clone().mul(g.radius).per(),U=Xa.Sub(g.input,F),K=0;K<1;K+=.07692307692307693)I=Xa.RotWith(U,g.input,As*K),S.push(I),T=Xa.RotWith(U,g.input,As+As*-K),_.push(T);E=I,C=T,N&&(M=!0)}else if(M=!1,g!==m&&g!==y){var V=Xa.Lrp(D,L,R).per().mul(g.radius);I=Xa.Sub(O,V),(j<=1||Xa.Dist2(E,I)>k)&&(S.push(I),E=I),T=Xa.Add(O,V),(j<=1||Xa.Dist2(C,T)>k)&&(_.push(T),C=T),P=L}else{var W=Xa.Per(L).mul(g.radius);S.push(Xa.Sub(O,W)),_.push(Xa.Add(O,W))}}var H=m.point,Y=e.length>1?e[e.length-1].point:Xa.AddXY(m.point,1,1);if(1===e.length&&(!w&&!x||d)){for(var X=Xa.Add(H,Xa.Sub(H,Y).uni().per().mul(-m.radius)),q=[],$=1/13,G=$;G<=1;G+=$)q.push(Xa.RotWith(X,H,2*As*G));return q}var Q=[];if(w||x&&1===e.length);else if(p)for(var Z=.125;Z<=1;Z+=.125){var J=Xa.RotWith(_[0],H,As*Z);Q.push(J)}else{var ee=Xa.Sub(S[0],_[0]),te=Xa.Mul(ee,.5),ne=Xa.Mul(ee,.51);Q.push(Xa.Sub(H,te),Xa.Sub(H,ne),Xa.Add(H,ne),Xa.Add(H,te))}var re=[],ie=y.vector.clone().per().neg();if(x||w&&1===e.length)re.push(Y);else if(v)for(var oe=Xa.Add(Y,Xa.Mul(ie,y.radius)),ae=1/29,se=ae;se<1;se+=ae)re.push(Xa.RotWith(oe,Y,3*As*se));else re.push(Xa.Add(Y,Xa.Mul(ie,y.radius)),Xa.Add(Y,Xa.Mul(ie,.99*y.radius)),Xa.Sub(Y,Xa.Mul(ie,.99*y.radius)),Xa.Sub(Y,Xa.Mul(ie,y.radius)));return S.concat(re,_.reverse(),Q)}var Ls=.025,zs=.01;function Ds(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.streamline,i=void 0===r?.5:r,o=n.size,a=void 0===o?16:o,s=n.simulatePressure,l=void 0!==s&&s;if(0===e.length)return[];var c=.15+.85*(1-i),d=e.map(Xa.From),f=0;if(!l)for(var p=d[0];p&&!(p.z>=Ls);)d.shift(),p=d[0];if(!l)for(var h=d[d.length-1];h&&!(h.z>=zs);)d.pop(),h=d[d.length-1];if(0===d.length)return[{point:Xa.From(e[0]),input:Xa.From(e[0]),pressure:l?.5:.15,vector:new Xa(1,1),distance:0,runningLength:0,radius:1}];for(var v=d[1];v&&!(Xa.Dist(v,d[0])>a/3);)d[0].z=Math.max(d[0].z,v.z),d.splice(1,1),v=d[1];var g=d.pop();for(v=d[d.length-1];v&&!(Xa.Dist(v,g)>a/3);)d.pop(),v=d[d.length-1],f++;d.push(g);var m=n.last||!n.simulatePressure||d.length>1&&Xa.Dist(d[d.length-1],d[d.length-2])<a||f>0;if(2===d.length&&n.simulatePressure){var y=d[1];d=d.slice(0,-1);for(var b=1;b<5;b++){var w=Xa.Lrp(d[0],y,b/4);w.z=(d[0].z+(y.z-d[0].z))*b/4,d.push(w)}}var x,k,S=[{point:d[0],input:d[0],pressure:l?.5:d[0].z,vector:new Xa(1,1),distance:0,runningLength:0,radius:1}],_=0,P=S[0];m&&i>0&&d.push(d[d.length-1].clone());for(var E=1,C=d.length;E<C;E++)x=!c||n.last&&E===C-1?d[E].clone():d[E].clone().lrp(P.point,1-c),P.point.equals(x)||(_+=k=Xa.Dist(x,P.point),E<4&&_<a||(P={input:d[E],point:x,pressure:l?.5:d[E].z,vector:Xa.Sub(P.point,x).uni(),distance:k,runningLength:_,radius:1},S.push(P)));if(null!==(t=S[1])&&void 0!==t&&t.vector&&(S[0].vector=S[1].vector.clone()),_<1){var I=Math.max.apply(Math,[.5].concat(u(S.map((function(e){return e.pressure})))));S.forEach((function(e){return e.pressure=I}))}return S}var Rs=Math.min,Ns=.275;function Bs(e,t){var n,r,i=t.size,o=void 0===i?16:i,a=t.thinning,s=void 0===a?.5:a,u=t.simulatePressure,l=void 0===u||u,c=t.easing,d=void 0===c?function(e){return e}:c,f=t.start,p=void 0===f?{}:f,h=t.end,v=void 0===h?{}:h,g=p.easing,m=void 0===g?Ya.easeOutQuad:g,y=v.easing,b=void 0===y?Ya.easeOutCubic:y,w=e[e.length-1].runningLength,x=e[0].pressure;if(!l&&w<o){var k=e.reduce((function(e,t){return Math.max(e,t.pressure)}),.5);return e.forEach((function(e){e.pressure=k,e.radius=o*d(.5-s*(.5-e.pressure))})),e}for(var S,_=0,P=e.length;_<P&&!((r=e[_]).runningLength>5*o);_++){var E=Rs(1,r.distance/o);if(l){var C=Rs(1,1-E);S=Rs(1,x+E*Ns*(C-x))}else S=Rs(1,x+.5*(r.pressure-x));x+=.5*(S-x)}for(var I=0;I<e.length;I++){if(r=e[I],s){var T=r.pressure,M=Rs(1,r.distance/o);if(l){var j=Rs(1,1-M);T=Rs(1,x+M*Ns*(j-x))}else T=Rs(1,x+M*Ns*(T-x));r.radius=o*d(.5-s*(.5-T)),x=T}else r.radius=o/2;void 0===n&&(n=r.radius)}var A=!1===p.taper?0:!0===p.taper?Math.max(o,w):p.taper,O=!1===v.taper?0:!0===v.taper?Math.max(o,w):v.taper;if(A||O)for(var L=0;L<e.length;L++){var z=(r=e[L]).runningLength,D=z<A?m(z/A):1,R=w-z<O?b((w-z)/O):1;r.radius=Math.max(.01,r.radius*Math.min(D,R))}return e}function Fs(e,t,n,r){var i=e.x-n.x,o=e.y-n.y,a=r.x-n.x,s=r.y-n.y,u=t.x-e.x,l=t.y-e.y,c=a*o-s*i,d=u*o-l*i,f=s*u-a*l;if(0===c||0===d)return null;if(0===f)return null;if(0!==f){var p=c/f,h=d/f;if(0<=p&&p<=1&&0<=h&&h<=1)return Xa.AddXY(e,p*u,p*l)}return null}function Us(e,t,n,r){var i=(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y),o=2*((t.x-e.x)*(e.x-n.x)+(t.y-e.y)*(e.y-n.y)),a=o*o-4*i*(n.x*n.x+n.y*n.y+e.x*e.x+e.y*e.y-2*(n.x*e.x+n.y*e.y)-r*r);if(a<0)return null;if(0===a)return null;var s=Math.sqrt(a),u=(-o+s)/(2*i),l=(-o-s)/(2*i);if((u<0||u>1)&&(l<0||l>1))return null;var c=[];return 0<=u&&u<=1&&c.push(Xa.Lrp(e,t,u)),0<=l&&l<=1&&c.push(Xa.Lrp(e,t,l)),0===c.length?null:c}function Ks(e,t,n){for(var r,i=[],o=0,a=n.length-1;o<a;o++)(r=Fs(e,t,n[o],n[o+1]))&&i.push(r);return 0===i.length?null:i}function Vs(e,t,n){for(var r,i=[],o=1,a=n.length;o<a+1;o++)(r=Fs(e,t,n[o-1],n[o%n.length]))&&i.push(r);return 0===i.length?null:i}function Ws(e,t,n){for(var r,i=[],o=0,a=n.length;o<a;o++)(r=Us(n[o],n[(o+1)%n.length],e,t))&&i.push.apply(i,u(r));return 0===i.length?null:i}function Hs(e,t,n){for(var r,i=[],o=1,a=n.length;o<a;o++)(r=Us(n[o-1],n[o],e,t))&&i.push.apply(i,u(r));return 0===i.length?null:i}function Ys(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function Xs(e,t,n,r){return Ys(e,n,r)!==Ys(t,n,r)&&Ys(e,t,n)!==Ys(e,t,r)}function qs(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)ms(n=e[o],t)&&i.push(n);for(var s=0,u=t.length;s<u;s++)ms(n=t[s],e)&&i.push(n);for(var l=0,c=e.length;l<c;l++){n=e[l],r=e[(l+1)%e.length];for(var d=0,f=t.length;d<f;d++){var p=Fs(n,r,t[d],t[(d+1)%t.length]);null!==p&&i.push(p)}}return 0===i.length?null:function(e){var t=Xa.Average(e);return e.sort((function(e,n){return Xa.Angle(t,e)-Xa.Angle(t,n)}))}(i)}function $s(e){return"".concat(ys(e.x),",").concat(ys(e.y)," ")}function Gs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=0,n=0,r=0,i=0;function o(){var e=t^t<<11;return t=n,n=r,r=i,(i^=(i>>>19^e^e>>>8)>>>0)/4294967296*2}for(var a=0;a<e.length+64;a++)t^=0|e.charCodeAt(a),o();return o}function Qs(e){for(var t,n,r,i="M",o=0,a=e.length;o<a;o+=3)t=e[o],n=e[o+1],r=e[o+2],i+="".concat($s(t),"L").concat($s(n),"Q").concat($s(r));return i+="".concat($s(e[0]))}function Zs(e,t,n,r,i){for(var o,a=[],s=Gs(e),u=t[0],l=t.length,c=0,d=l*i;c<d;c++){o=Xa.AddXY(t[(c+1)%l],s()*n,s()*n);var f=Xa.Sub(o,u),p=Xa.Len(f),h=Xa.Div(f,p).mul(Math.min(p/4,r));a.push(Xa.Add(u,h),Xa.Add(o,h.neg()),o),u=o}return a}function Js(e,t,n){for(var r,i,o="M".concat($s(t[0]),"L"),a="M".concat($s(t[0]),"L"),s="M".concat($s(t[0]),"L"),u=n/3,l=2*n,c=Gs(e),d=t[0],f=t[0],p=0,h=t.length-1;p<h;p++){r=Xa.AddXY(t[p+1],c()*u,c()*u),i=Xa.AddXY(t[p+1],c(),c()*u);var v=Xa.Sub(r,d),g=Xa.Len(v),m=Xa.Div(v,g).mul(Math.min(g/4,l)),y=Xa.Add(d,m),b=Xa.Add(r,m.neg()),w=Xa.Sub(i,f),x=Xa.Len(w),k=Xa.Div(w,x).mul(Math.min(x/4,l)),S=Xa.Add(f,k),_=Xa.Add(i,k.neg());p===h-1?(o+="".concat($s(y)," L ").concat($s(r)),a+="".concat($s(y)," L ").concat($s(r)),s+="".concat($s(S)," L ").concat($s(i))):(o+="".concat($s(y),"L ").concat($s(b),"Q ").concat($s(r)),a+="".concat($s(y),"L ").concat($s(b),"Q ").concat($s(r)),s+="".concat($s(S),"L ").concat($s(_),"Q ").concat($s(i)),d=r,f=i)}return[o,a+s]}var eu={peopleMenu:iu("peopleMenu"),highlighterTool:iu("highlighterTool",{all:!0})},tu={preventDefaultLogging:ru("preventDefaultLogging",{defaults:{all:!1}}),pointerCaptureLogging:ru("pointerCaptureLogging",{defaults:{all:!1}}),pointerCaptureTracking:ru("pointerCaptureTracking",{defaults:{all:!1}}),pointerCaptureTrackingObject:ru("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),elementRemovalLogging:ru("elementRemovalLogging",{defaults:{all:!1}}),debugSvg:ru("debugSvg",{defaults:{all:!1}}),throwToBlob:ru("throwToBlob",{defaults:{all:!1}}),logMessages:ru("uiLog",{defaults:{all:[]}}),resetConnectionEveryPing:ru("resetConnectionEveryPing",{defaults:{all:!1}}),debugCursors:ru("debugCursors",{defaults:{all:!1}}),forceSrgb:ru("forceSrgbColors",{defaults:{all:!1}})};if("undefined"!==typeof window&&(window.tldrawLog=function(e){tu.logMessages.set(tu.logMessages.value.concat(e))}),"undefined"!==typeof Element){var nu=Element.prototype.removeChild;me("element removal logging",(function(){tu.elementRemovalLogging.value?Element.prototype.removeChild=function(e){return console.warn("[tldraw] removing child:",e),nu.call(this,e)}:Element.prototype.removeChild=nu}))}function ru(e,t){var n=t.defaults,r=t.shouldStoreForSession;return ou({name:e,defaults:n,shouldStoreForSession:void 0===r||r})}function iu(e){return ou({name:e,defaults:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{all:!0,production:!1},shouldStoreForSession:!0})}function ou(e){var t=function(e){var t,n,r,i,o,a;switch(null!==(t=null!==(n=null!==(r=au((function(){return{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.TLDRAW_ENV})))&&void 0!==r?r:au((function(){return{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.VERCEL_PUBLIC_TLDRAW_ENV})))&&void 0!==n?n:au((function(){return{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NEXT_PUBLIC_TLDRAW_ENV})))&&void 0!==t?t:"production"){case"production":return null!==(i=e.defaults.production)&&void 0!==i?i:e.defaults.all;case"preview":case"staging":return null!==(o=e.defaults.staging)&&void 0!==o?o:e.defaults.all;default:return null!==(a=e.defaults.development)&&void 0!==a?a:e.defaults.all}}(e),n=e.shouldStoreForSession?function(e){try{var t,n;return JSON.parse(null!==(t=null===(n=window)||void 0===n?void 0:n.sessionStorage.getItem("tldraw_debug:".concat(e)))&&void 0!==t?t:"null")}catch(r){return null}}(e.name):null,r=ue("debug:".concat(e.name),null!==n&&void 0!==n?n:t);return"undefined"!==typeof window&&(e.shouldStoreForSession&&me("debug:".concat(e.name),(function(){var n=r.value;try{n===t?window.sessionStorage.removeItem("tldraw_debug:".concat(e.name)):window.sessionStorage.setItem("tldraw_debug:".concat(e.name),JSON.stringify(n))}catch(i){}})),Object.defineProperty(window,"tldraw".concat(e.name.replace(/^[a-z]/,(function(e){return e.toUpperCase()}))),{get:function(){return r.value},set:function(e){r.set(e)},configurable:!0})),Object.assign(r,e)}function au(e){try{return e()}catch(t){return null}}function su(e){if(e instanceof HTMLElement)return e;if(e.parentElement)return su(e.parentElement);throw Error("Could not find a parent element of an HTML type!")}function uu(e){e.preventDefault(),tu.preventDefaultLogging.value&&console.warn("preventDefault called on event:",e)}function lu(e,t){if(e.setPointerCapture(t.pointerId),tu.pointerCaptureTracking.value){var n,r=tu.pointerCaptureTrackingObject.value;r.set(e,(null!==(n=r.get(e))&&void 0!==n?n:0)+1)}tu.pointerCaptureLogging.value&&console.warn("setPointerCapture called on element:",e,t)}function cu(e,t){if(e.hasPointerCapture(t.pointerId)){if(e.releasePointerCapture(t.pointerId),tu.pointerCaptureTracking.value){var n=tu.pointerCaptureTrackingObject.value;1===n.get(e)?n.delete(e):n.has(e)?n.set(e,n.get(e)-1):console.warn("Release without capture")}tu.pointerCaptureLogging.value&&console.warn("releasePointerCapture called on element:",e,t)}}var du=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function fu(e){var t=du.map((function(t){var n=t.offsetX,r=t.offsetY,i=t.blur,o=t.spread,a=t.color,s=new Xa(n,r).rot(-e),u=s.x,l=s.y;return"".concat(u,"px ").concat(l,"px ").concat(i,"px ").concat(o,"px ").concat(a)}));return t.join(", ")}function pu(){var e=G((0,t.useState)(!1),2),n=e[0],r=e[1];return(0,t.useEffect)((function(){var e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=function(){r(e.matches)};return t(),e.addEventListener("change",t),function(){return e.removeEventListener("change",t)}}),[]),n}var hu=function(e,t){return e.length<=t?e:e.substring(0,t-3)+"..."},vu=function(e){return e.stopPropagation()};function gu(e,t){e.isKilled=!0;var n=t.getBoundingClientRect(),r=n.top,i=n.left;return{point:{x:e.clientX-i,y:e.clientY-r,z:e.pressure},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:e.pointerId,button:e.button,isPen:"pen"===e.pointerType}}function mu(e){return"".concat(ys(e.x),",").concat(ys(e.y)," ")}function yu(e,t){return"".concat(ys((e.x+t.x)/2),",").concat(ys((e.y+t.y)/2)," ")}function bu(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.length;if(n<2)return"";var r=e[0],i=e[1];if(2===n)return"M".concat(mu(r),"L").concat(mu(i));for(var o="",a=2,s=n-1;a<s;a++)o+=yu(r=e[a],i=e[a+1]);return t?"M".concat(yu(e[0],e[1]),"Q").concat(mu(e[1])).concat(yu(e[1],e[2]),"T").concat(o).concat(yu(e[n-1],e[0])).concat(yu(e[0],e[1]),"Z"):"M".concat(mu(e[0]),"Q").concat(mu(e[1])).concat(yu(e[1],e[2])).concat(e.length>3?"T":"").concat(o,"L").concat(mu(e[n-1]))}function wu(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.length;if(n<2)return"";var r=e[0].point,i=e[1].point;if(2===n)return"M".concat(mu(r),"L").concat(mu(i));for(var o="",a=2,s=n-1;a<s;a++)o+=yu(r=e[a].point,i=e[a+1].point);return t?"M".concat(yu(e[0].point,e[1].point),"Q").concat(mu(e[1].point)).concat(yu(e[1].point,e[2].point),"T").concat(o).concat(yu(e[n-1].point,e[0].point)).concat(yu(e[0].point,e[1].point),"Z"):"M".concat(mu(e[0].point),"Q").concat(mu(e[1].point)).concat(yu(e[1].point,e[2].point)).concat(e.length>3?"T":"").concat(o,"L").concat(mu(e[n-1].point))}var xu=(0,t.createContext)(null);function ku(e){var t=e.container,n=e.children;return(0,za.jsx)(xu.Provider,{value:t,children:n})}function Su(){return ze((0,t.useContext)(xu),"useContainer used outside of <Tldraw />")}var _u=["input","select","button","textarea"];function Pu(){var e=document.activeElement;return!(!e||!(e.getAttribute("contenteditable")||_u.indexOf(e.tagName.toLowerCase())>-1))}function Eu(){return(0,za.jsx)("div",{className:"tl-background"})}function Cu(e,n,r,i,o,a){(0,t.useLayoutEffect)((function(){var t=e.current;if(t&&void 0!==n){var s="translate(".concat(n,"px, ").concat(r,"px)");void 0!==i&&(s+=" scale(".concat(i,")")),void 0!==o&&(s+=" rotate(".concat(o,"rad)")),a&&(s+=" translate(".concat(a.x,"px, ").concat(a.y,"px)")),t.style.transform=s}}))}for(var Iu=function(e){var n=e.brush,r=e.color,i=e.opacity,o=(0,t.useRef)(null);return Cu(o,n.x,n.y),(0,za.jsx)("svg",{className:"tl-overlays__item",ref:o,children:r?(0,za.jsxs)("g",{className:"tl-brush",opacity:i,children:[(0,za.jsx)("rect",{width:ys(Math.max(1,n.w)),height:ys(Math.max(1,n.h)),fill:r,opacity:.75}),(0,za.jsx)("rect",{width:ys(Math.max(1,n.w)),height:ys(Math.max(1,n.h)),fill:"none",stroke:r,opacity:.1})]}):(0,za.jsx)("rect",{className:"tl-brush tl-brush__default",width:ys(Math.max(1,n.w)),height:ys(Math.max(1,n.h))})})},Tu=function(e){var n=e.className,r=e.zoom,i=e.point,o=e.color,a=e.viewport,s=e.opacity,u=void 0===s?1:s,l=(0,t.useRef)(null);return Cu(l,es(i.x,a.minX+5/r,a.maxX-5/r),es(i.y,a.minY+5/r,a.maxY-5/r),1/r,Xa.Angle(a.center,i)),(0,za.jsxs)("svg",{ref:l,className:Ua("tl-overlays__item",n),children:[(0,za.jsx)("use",{href:"#cursor_hint",color:o,strokeWidth:3,stroke:"var(--color-background)"}),(0,za.jsx)("use",{href:"#cursor_hint",color:o,opacity:u})]})},Mu=(0,t.memo)((function(e){var n=e.className,r=e.zoom,i=e.point,o=e.color,a=e.name,s=e.chatMessage,u=(0,t.useRef)(null);return Cu(u,null===i||void 0===i?void 0:i.x,null===i||void 0===i?void 0:i.y,1/r),i?(0,za.jsxs)("div",{ref:u,className:Ua("tl-overlays__item",n),children:[(0,za.jsx)("svg",{className:"tl-cursor",children:(0,za.jsx)("use",{href:"#cursor",color:o})}),s?(0,za.jsxs)(za.Fragment,{children:[a&&(0,za.jsx)("div",{className:"tl-nametag-title",style:{color:o},children:a}),(0,za.jsx)("div",{className:"tl-nametag-chat",style:{backgroundColor:o},children:s})]}):a&&(0,za.jsx)("div",{className:"tl-nametag",style:{backgroundColor:o},children:a})]}):null})),ju=2e3,Au=(Symbol("remove"),320),Ou=[.1,.25,.5,1,2,4,8],Lu=.1,zu=8,Du={},Ru=1;Ru<=Math.ceil(zu);Ru++)Du[Ru+"_dark"]="hash_pattern_zoom_".concat(Ru,"_dark"),Du[Ru+"_light"]="hash_pattern_zoom_".concat(Ru,"_light");var Nu={duration:0,easing:Ya.easeInOutCubic},Bu=.09,Fu=[{min:-1,mid:.15,step:100},{min:.05,mid:.375,step:25},{min:.15,mid:1,step:5},{min:.7,mid:2.5,step:1}],Uu=6e4,Ku=3e3,Vu=-10,Wu=function(e){var t=e.x,n=e.y,r=e.z,i=e.size;return(0,za.jsxs)("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[(0,za.jsx)("defs",{children:Fu.map((function(e,o){var a=e.min,s=e.mid,u=e.step,l=u*i*r,c=.5+t*r,d=.5+n*r,f=c>0?c%l:l+c%l,p=d>0?d%l:l+d%l,h=r<s?Ue(r,[a,s],[0,1]):1;return(0,za.jsx)("pattern",{id:"grid-".concat(u),width:l,height:l,patternUnits:"userSpaceOnUse",children:(0,za.jsx)("circle",{className:"tl-grid-dot",cx:f,cy:p,r:1,opacity:h})},"grid-pattern-".concat(o))}))}),Fu.map((function(e,t){var n=e.step;return(0,za.jsx)("rect",{width:"100%",height:"100%",fill:"url(#grid-".concat(n,")")},"grid-rect-".concat(t))}))]})},Hu=function(e){var t=e.handle,n=e.className;return(0,za.jsxs)("g",{className:Ua("tl-handle",{"tl-handle__hint":"vertex"!==t.type},n),children:[(0,za.jsx)("circle",{className:"tl-handle__bg"}),(0,za.jsx)("circle",{className:"tl-handle__fg"})]})},Yu=function(e){var t=e.scribble,n=e.zoom,r=e.color,i=e.opacity,o=e.className;if(t.points.length){var a=bu(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Os(Bs(Ds(e,t),t),t)}(t.points,{size:t.size/n,start:{taper:!0,easing:Ya.linear},last:"stopping"===t.state,simulatePressure:!1,streamline:.32}));return(0,za.jsx)("svg",{className:o?Ua("tl-overlays__item",o):o,children:(0,za.jsx)("path",{className:"tl-scribble",d:a,fill:null!==r&&void 0!==r?r:"var(--color-".concat(t.color,")"),opacity:null!==i&&void 0!==i?i:t.opacity})})}},Xu=function(e){var t=e.error;return(0,za.jsx)("div",{className:"tl-shape-error-boundary",children:t})},qu=function(){return(0,za.jsx)("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"})};function $u(e){var t,n,r,i,o=e.points,a=2.5/e.zoom,s=o.reduce((function(e,t){return Math.min(e,t.x)}),1/0),u=o.reduce((function(e,t){return Math.max(e,t.x)}),-1/0),l=o.reduce((function(e,t){return Math.min(e,t.y)}),1/0),c=o.reduce((function(e,t){return Math.max(e,t.y)}),-1/0),d=o.some((function(e){return e.x===s&&e.y===l}));return d?(t=s,n=l,r=u,i=c):(t=s,n=c,r=u,i=l),(0,za.jsxs)("g",{className:"tl-snap-line",children:[(0,za.jsx)("line",{x1:t,y1:n,x2:r,y2:i}),o.map((function(e,t){return(0,za.jsx)("g",{transform:"translate(".concat(e.x,",").concat(e.y,")"),children:(0,za.jsx)("path",{className:"tl-snap-point",d:"M ".concat(-a,",").concat(-a," L ").concat(a,",").concat(a," M ").concat(-a,",").concat(a," L ").concat(a,",").concat(-a)})},t)}))]})}function Gu(e){var n,r=e.gaps,i=e.direction,o=3.5/e.zoom,a=[-1/0,1/0],s=null,u="horizontal"===i,l=J(r);try{for(l.s();!(n=l.n()).done;){var c=n.value;(s=vs(a[0],a[1],u?c.startEdge[0].y:c.startEdge[0].x,u?c.startEdge[1].y:c.startEdge[1].x))&&((s=vs((a=s)[0],a[1],u?c.endEdge[0].y:c.endEdge[0].x,u?c.endEdge[1].y:c.endEdge[1].x))&&(a=s))}}catch(f){l.e(f)}finally{l.f()}if(null===a)return null;var d=(a[0]+a[1])/2;return(0,za.jsx)("g",{className:"tl-snap-line",children:r.map((function(e,n){var r=e.startEdge,i=e.endEdge;return(0,za.jsx)(t.Fragment,{children:u?(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)("line",{x1:r[0].x,y1:d-2*o,x2:r[1].x,y2:d+2*o}),(0,za.jsx)("line",{x1:i[0].x,y1:d-2*o,x2:i[1].x,y2:d+2*o}),(0,za.jsx)("line",{x1:r[0].x,y1:d,x2:i[0].x,y2:d}),(0,za.jsx)("line",{x1:(r[0].x+i[0].x)/2,y1:d-o,x2:(r[0].x+i[0].x)/2,y2:d+o})]}):(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)("line",{x1:d-2*o,y1:r[0].y,x2:d+2*o,y2:r[1].y}),(0,za.jsx)("line",{x1:d-2*o,y1:i[0].y,x2:d+2*o,y2:i[1].y}),(0,za.jsx)("line",{x1:d,y1:r[0].y,x2:d,y2:i[0].y}),(0,za.jsx)("line",{x1:d-o,y1:(r[0].y+i[0].y)/2,x2:d+o,y2:(r[0].y+i[0].y)/2})]})},n)}))})}var Qu=function(e){var t=e.className,n=e.line,r=e.zoom;return(0,za.jsx)("svg",{className:Ua("tl-overlays__item",t),children:"points"===n.type?(0,za.jsx)($u,Ce(Ce({},n),{},{zoom:r})):"gaps"===n.type?(0,za.jsx)(Gu,Ce(Ce({},n),{},{zoom:r})):null})},Zu=function(){return(0,za.jsx)("svg",{width:16,height:16,viewBox:"0 0 16 16",children:(0,za.jsxs)("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[(0,za.jsx)("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"var(--color-text-1)"}),(0,za.jsx)("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"var(--color-text-1)",children:(0,za.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})},Ju=function(){return null},el=["children","fallback"],tl={error:null},nl=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"state",tl),e}return L(n,[{key:"componentDidCatch",value:function(e){var t,n;null===(t=(n=this.props).onError)||void 0===t||t.call(n,e)}},{key:"render",value:function(){var e=this.state.error;if(null!==e){var t=this.props.fallback;return(0,za.jsx)(t,{error:e})}return this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),n}(t.Component);function rl(e){var t=e.children,n=e.fallback,r=gt(e,el);return null===n?(0,za.jsx)(za.Fragment,{children:t}):(0,za.jsx)(nl,Ce(Ce({fallback:n},r),{},{children:t}))}var il=function(){function e(t){M(this,e),this.shape=t}return L(e,[{key:"equals",value:function(e){var t,n,r,i;return(null===(t=this.shape)||void 0===t?void 0:t.props)===(null===e||void 0===e||null===(n=e.shape)||void 0===n?void 0:n.props)&&(null===(r=this.shape)||void 0===r?void 0:r.meta)===(null===e||void 0===e||null===(i=e.shape)||void 0===i?void 0:i.meta)}}]),e}(),ol=function(e){var t=e.shape,n=e.util;return ye("Indicator:"+t.type,(function(){return n.indicator(t)}))},al=function(e){var t=e.editor,n=e.id,r=_e("shape",(function(){return new il(t.store.get(n))}),[t,n]),i=cl().ShapeIndicatorErrorFallback;return r.shape?(0,za.jsx)(rl,{fallback:i,onError:function(e){return t.annotateError(e,{origin:"react.shapeIndicator",willCrashApp:!1})},children:(0,za.jsx)(ol,{shape:r.shape,util:t.getShapeUtil(r.shape)},r.shape.id)}):null},sl=t.memo((function(e){var t=e.id,n=e.className,r=e.color,i=e.opacity,o=Va(),a=_e("transform",(function(){var e=o.getPageTransformById(t);return e?e.toCssString():""}),[o,t]);return(0,za.jsx)("svg",{className:Ua("tl-overlays__item",n),children:(0,za.jsx)("g",{className:"tl-shape-indicator",transform:a,stroke:null!==r&&void 0!==r?r:"var(--color-selected)",opacity:i,children:(0,za.jsx)(al,{editor:o,id:t})})})})),ul=(0,t.createContext)({});function ll(e){var t=e.overrides,n=e.children;return(0,za.jsx)(ul.Provider,{value:Ce({Background:Eu,SvgDefs:Ju,Brush:Iu,ZoomBrush:Iu,CollaboratorBrush:Iu,Cursor:Mu,CollaboratorCursor:Mu,CollaboratorHint:Tu,CollaboratorShapeIndicator:sl,Grid:Wu,Scribble:Yu,SnapLine:Qu,Handle:Hu,CollaboratorScribble:Yu,ErrorFallback:nf,ShapeErrorFallback:Xu,ShapeIndicatorErrorFallback:qu,Spinner:Zu},t),children:n})}function cl(){return(0,t.useContext)(ul)}var dl=["textarea","input"];function fl(){return fl="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ct(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},fl.apply(this,arguments)}var pl=function(e,t){return void 0===e&&(e=t),Array.isArray(e)?e:[e,e]},hl=function(e,t){return[e[0]+t[0],e[1]+t[1]]},vl=function(e,t){return[e[0]-t[0],e[1]-t[1]]},gl=function(e,t){e[0]+=t[0],e[1]+=t[1]};function ml(e,t,n){return 0===t||Math.abs(t)===1/0?Math.pow(e,5*n):e*t*n/(t+n*e)}function yl(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.15;return 0===r?function(e,t,n){return Math.max(t,Math.min(e,n))}(e,t,n):e<t?-ml(t-e,n-t,r)+t:e>n?+ml(e-n,n-t,r)+n:e}function bl(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function wl(e,t,n){return(t=bl(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xl(Object(n),!0).forEach((function(t){wl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Sl={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function _l(e){return e?e[0].toUpperCase()+e.slice(1):""}var Pl=["enter","leave"];function El(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Sl[e],i=r&&r[t]||t;return"on"+_l(e)+_l(i)+(function(){var e=arguments.length>1?arguments[1]:void 0;return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&!Pl.includes(e)}(n,i)?"Capture":"")}var Cl=["gotpointercapture","lostpointercapture"];function Il(e){var t=e.substring(2).toLowerCase(),n=!!~t.indexOf("passive");n&&(t=t.replace("passive",""));var r=Cl.includes(t)?"capturecapture":"capture",i=!!~t.indexOf(r);return i&&(t=t.replace("capture","")),{device:t,capture:i,passive:n}}function Tl(e){return"touches"in e}function Ml(e){return Tl(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function jl(e,t){try{var n=t.clientX-e.clientX,r=t.clientY-e.clientY,i=(t.clientX+e.clientX)/2,o=(t.clientY+e.clientY)/2,a=Math.hypot(n,r);return{angle:-180*Math.atan2(n,r)/Math.PI,distance:a,origin:[i,o]}}catch(s){}return null}function Al(e){return function(e){return Array.from(e.touches).filter((function(t){var n,r;return t.target===e.currentTarget||(null===(n=e.currentTarget)||void 0===n||null===(r=n.contains)||void 0===r?void 0:r.call(n,t.target))}))}(e).map((function(e){return e.identifier}))}function Ol(e,t){var n=G(Array.from(e.touches).filter((function(e){return t.includes(e.identifier)})),2);return jl(n[0],n[1])}function Ll(e){var t=e.deltaX,n=e.deltaY,r=e.deltaMode;return 1===r?(t*=40,n*=40):2===r&&(t*=800,n*=800),[t,n]}function zl(e){if("function"===typeof e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.apply(void 0,n)}return e}function Dl(){}function Rl(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?Dl:1===t.length?t[0]:function(){for(var e,n=0,r=t;n<r.length;n++){e=r[n].apply(this,arguments)||e}return e}}function Nl(e,t){return Object.assign({},t,e||{})}var Bl=function(){function e(t,n,r){M(this,e),this.ctrl=t,this.args=n,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}return L(e,[{key:"state",get:function(){return this.ctrl.state[this.key]},set:function(e){this.ctrl.state[this.key]=e}},{key:"shared",get:function(){return this.ctrl.state.shared}},{key:"eventStore",get:function(){return this.ctrl.gestureEventStores[this.key]}},{key:"timeoutStore",get:function(){return this.ctrl.gestureTimeoutStores[this.key]}},{key:"config",get:function(){return this.ctrl.config[this.key]}},{key:"sharedConfig",get:function(){return this.ctrl.config.shared}},{key:"handler",get:function(){return this.ctrl.handlers[this.key]}},{key:"reset",value:function(){var e=this.state,t=this.shared,n=this.ingKey,r=this.args;t[n]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=r,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}},{key:"start",value:function(e){var t=this.state,n=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=n.from?zl(n.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}},{key:"computeValues",value:function(e){var t=this.state;t._values=e,t.values=this.config.transform(e)}},{key:"computeInitial",value:function(){var e=this.state;e._initial=e._values,e.initial=e.values}},{key:"compute",value:function(e){var t=this.state,n=this.config,r=this.shared;t.args=this.args;var i=0;if(e&&(t.event=e,n.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,r.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,r.locked=!!document.pointerLockElement,Object.assign(r,function(e){var t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){var n=e.shiftKey,r=e.altKey,i=e.metaKey,o=e.ctrlKey;Object.assign(t,{shiftKey:n,altKey:r,metaKey:i,ctrlKey:o})}return t}(e)),r.down=r.pressed=r.buttons%2===1||r.touches>0,i=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){var o=t._delta.map(Math.abs);gl(t._distance,o)}this.axisIntent&&this.axisIntent(e);var a=G(t._movement,2),s=a[0],u=a[1],l=G(n.threshold,2),c=l[0],d=l[1],f=t._step,p=t.values;if(n.hasCustomTransform?(!1===f[0]&&(f[0]=Math.abs(s)>=c&&p[0]),!1===f[1]&&(f[1]=Math.abs(u)>=d&&p[1])):(!1===f[0]&&(f[0]=Math.abs(s)>=c&&Math.sign(s)*c),!1===f[1]&&(f[1]=Math.abs(u)>=d&&Math.sign(u)*d)),t.intentional=!1!==f[0]||!1!==f[1],t.intentional){var h=[0,0];if(n.hasCustomTransform){var v=G(p,2),g=v[0],m=v[1];h[0]=!1!==f[0]?g-f[0]:0,h[1]=!1!==f[1]?m-f[1]:0}else h[0]=!1!==f[0]?s-f[0]:0,h[1]=!1!==f[1]?u-f[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(h);var y=t.offset,b=t._active&&!t._blocked||t.active;b&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=r[this.ingKey]=t._active,e&&(t.first&&("bounds"in n&&(t._bounds=zl(n.bounds,t)),this.setup&&this.setup()),t.movement=h,this.computeOffset()));var w=G(t.offset,2),x=w[0],k=w[1],S=G(t._bounds,2),_=G(S[0],2),P=_[0],E=_[1],C=G(S[1],2),I=C[0],T=C[1];t.overflow=[x<P?-1:x>E?1:0,k<I?-1:k>T?1:0],t._movementBound[0]=!!t.overflow[0]&&(!1===t._movementBound[0]?t._movement[0]:t._movementBound[0]),t._movementBound[1]=!!t.overflow[1]&&(!1===t._movementBound[1]?t._movement[1]:t._movementBound[1]);var M=t._active&&n.rubberband||[0,0];if(t.offset=function(e,t,n){var r=G(t,2),i=r[0],o=r[1],a=G(n,2),s=a[0],u=a[1],l=G(e,2),c=G(l[0],2),d=c[0],f=c[1],p=G(l[1],2),h=p[0],v=p[1];return[yl(i,d,f,s),yl(o,h,v,u)]}(t._bounds,t.offset,M),t.delta=vl(t.offset,y),this.computeMovement(),b&&(!t.last||i>32)){t.delta=vl(t.offset,y);var j=t.delta.map(Math.abs);gl(t.distance,j),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&i>0&&(t.velocity=[j[0]/i,j[1]/i],t.timeDelta=i)}}}},{key:"emit",value:function(){var e=this.state,t=this.shared,n=this.config;if(e._active||this.clean(),!e._blocked&&e.intentional||e._force||n.triggerAllEvents){var r=this.handler(kl(kl(kl({},t),e),{},z({},this.aliasKey,e.values)));void 0!==r&&(e.memo=r)}}},{key:"clean",value:function(){this.eventStore.clean(),this.timeoutStore.clean()}}]),e}();var Fl=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wl(_t(e=t.call.apply(t,[this].concat(i))),"aliasKey","xy"),e}return L(n,[{key:"reset",value:function(){fl(Ct(n.prototype),"reset",this).call(this),this.state.axis=void 0}},{key:"init",value:function(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}},{key:"computeOffset",value:function(){this.state.offset=hl(this.state.lastOffset,this.state.movement)}},{key:"computeMovement",value:function(){this.state.movement=vl(this.state.offset,this.state.lastOffset)}},{key:"axisIntent",value:function(e){var t=this.state,n=this.config;if(!t.axis&&e){var r="object"===typeof n.axisThreshold?n.axisThreshold[Ml(e)]:n.axisThreshold;t.axis=function(e,t){var n=G(e,2),r=n[0],i=n[1],o=Math.abs(r),a=Math.abs(i);return o>a&&o>t?"x":a>o&&a>t?"y":void 0}(t._movement,r)}t._blocked=(n.lockDirection||!!n.axis)&&!t.axis||!!n.axis&&n.axis!==t.axis}},{key:"restrictToAxis",value:function(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0}}}]),n}(Bl),Ul=function(e){return e},Kl={enabled:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]},eventOptions:function(e,t,n){return kl(kl({},n.shared.eventOptions),e)},preventDefault:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]},triggerAllEvents:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]},rubberband:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case!0:return[.15,.15];case!1:return[0,0];default:return pl(e)}},from:function(e){return"function"===typeof e?e:null!=e?pl(e):void 0},transform:function(e,t,n){var r=e||n.shared.transform;return this.hasCustomTransform=!!r,r||Ul},threshold:function(e){return pl(e,0)}};var Vl=kl(kl({},Kl),{},{axis:function(e,t,n){var r=n.axis;if(this.lockDirection="lock"===r,!this.lockDirection)return r},axisThreshold:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:0},bounds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("function"===typeof e)return function(t){return Vl.bounds(e(t))};if("current"in e)return function(){return e.current};if("function"===typeof HTMLElement&&e instanceof HTMLElement)return e;var t=e.left,n=void 0===t?-1/0:t,r=e.right,i=void 0===r?1/0:r,o=e.top,a=void 0===o?-1/0:o,s=e.bottom;return[[n,i],[a,void 0===s?1/0:s]]}});var Wl="undefined"!==typeof window&&window.document&&window.document.createElement;function Hl(){return Wl&&"ontouchstart"in window}var Yl={isBrowser:Wl,gesture:function(){try{return"constructor"in GestureEvent}catch(ej){return!1}}(),touch:Hl(),touchscreen:Hl()||Wl&&window.navigator.maxTouchPoints>1,pointer:Wl&&"onpointerdown"in window,pointerLock:Wl&&"exitPointerLock"in window.document},Xl={mouse:0,touch:0,pen:8};kl(kl({},Vl),{},{device:function(e,t,n){var r=n.pointer,i=void 0===r?{}:r,o=i.touch,a=void 0!==o&&o,s=i.lock,u=void 0!==s&&s,l=i.mouse,c=void 0!==l&&l;return this.pointerLock=u&&Yl.pointerLock,Yl.touch&&a?"touch":this.pointerLock?"mouse":Yl.pointer&&!c?"pointer":Yl.touch?"touch":"mouse"},preventScrollAxis:function(e,t,n){var r=n.preventScroll;if(this.preventScrollDelay="number"===typeof r?r:r||void 0===r&&e?250:void 0,Yl.touchscreen&&!1!==r)return e||(void 0!==r?"y":void 0)},pointerCapture:function(e,t,n){var r=n.pointer,i=void 0===r?{}:r,o=i.capture,a=void 0===o||o,s=i.buttons,u=void 0===s?1:s,l=i.keys,c=void 0===l||l;return this.pointerButtons=u,this.keys=c,!this.pointerLock&&"pointer"===this.device&&a},threshold:function(e,t,n){var r=n.filterTaps,i=void 0!==r&&r,o=n.tapsThreshold,a=void 0===o?3:o,s=n.axis,u=pl(e,i?a:(void 0===s?void 0:s)?1:0);return this.filterTaps=i,this.tapsThreshold=a,u},swipe:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.velocity,n=void 0===t?.5:t,r=e.distance,i=void 0===r?50:r,o=e.duration,a=void 0===o?250:o;return{velocity:this.transform(pl(n)),distance:this.transform(pl(i)),duration:a}},delay:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case!0:return 180;case!1:return 0;default:return e}},axisThreshold:function(e){return e?kl(kl({},Xl),e):Xl},keyboardDisplacement:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:10}});function ql(e){var t=G(e.overflow,2),n=t[0],r=t[1],i=G(e._delta,2),o=i[0],a=i[1],s=G(e._direction,2),u=s[0],l=s[1];(n<0&&o>0&&u<0||n>0&&o<0&&u>0)&&(e._movement[0]=e._movementBound[0]),(r<0&&a>0&&l<0||r>0&&a<0&&l>0)&&(e._movement[1]=e._movementBound[1])}var $l=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wl(_t(e=t.call.apply(t,[this].concat(i))),"ingKey","pinching"),wl(_t(e),"aliasKey","da"),e}return L(n,[{key:"init",value:function(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}},{key:"reset",value:function(){fl(Ct(n.prototype),"reset",this).call(this);var e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}},{key:"computeOffset",value:function(){var e=this.state,t=e.type,n=e.movement,r=e.lastOffset;this.state.offset="wheel"===t?hl(n,r):[(1+n[0])*r[0],n[1]+r[1]]}},{key:"computeMovement",value:function(){var e=this.state,t=e.offset,n=e.lastOffset;this.state.movement=[t[0]/n[0],t[1]-n[1]]}},{key:"axisIntent",value:function(){var e=this.state,t=G(e._movement,2),n=t[0],r=t[1];if(!e.axis){var i=30*Math.abs(n)-Math.abs(r);i<0?e.axis="angle":i>0&&(e.axis="scale")}}},{key:"restrictToAxis",value:function(e){this.config.lockDirection&&("scale"===this.state.axis?e[1]=0:"angle"===this.state.axis&&(e[0]=0))}},{key:"cancel",value:function(){var e=this,t=this.state;t.canceled||setTimeout((function(){t.canceled=!0,t._active=!1,e.compute(),e.emit()}),0)}},{key:"touchStart",value:function(e){this.ctrl.setEventIds(e);var t=this.state,n=this.ctrl.touchIds;if((!t._active||!t._touchIds.every((function(e){return n.has(e)})))&&!(n.size<2)){this.start(e),t._touchIds=Array.from(n).slice(0,2);var r=Ol(e,t._touchIds);r&&this.pinchStart(e,r)}}},{key:"pointerStart",value:function(e){if(null==e.buttons||e.buttons%2===1){this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);var t=this.state,n=t._pointerEvents,r=this.ctrl.pointerIds;if((!t._active||!Array.from(n.keys()).every((function(e){return r.has(e)})))&&(n.size<2&&n.set(e.pointerId,e),!(t._pointerEvents.size<2))){this.start(e);var i=jl.apply(void 0,u(Array.from(n.values())));i&&this.pinchStart(e,i)}}}},{key:"pinchStart",value:function(e,t){this.state.origin=t.origin,this.computeValues([t.distance,t.angle]),this.computeInitial(),this.compute(e),this.emit()}},{key:"touchMove",value:function(e){if(this.state._active){var t=Ol(e,this.state._touchIds);t&&this.pinchMove(e,t)}}},{key:"pointerMove",value:function(e){var t=this.state._pointerEvents;if(t.has(e.pointerId)&&t.set(e.pointerId,e),this.state._active){var n=jl.apply(void 0,u(Array.from(t.values())));n&&this.pinchMove(e,n)}}},{key:"pinchMove",value:function(e,t){var n=this.state,r=n._values[1],i=t.angle-r,o=0;Math.abs(i)>270&&(o+=Math.sign(i)),this.computeValues([t.distance,t.angle-360*o]),n.origin=t.origin,n.turns=o,n._movement=[n._values[0]/n._initial[0]-1,n._values[1]-n._initial[1]],this.compute(e),this.emit()}},{key:"touchEnd",value:function(e){var t=this;this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some((function(e){return!t.ctrl.touchIds.has(e)}))&&(this.state._active=!1,this.compute(e),this.emit())}},{key:"pointerEnd",value:function(e){var t=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch(n){}t._pointerEvents.has(e.pointerId)&&t._pointerEvents.delete(e.pointerId),t._active&&t._pointerEvents.size<2&&(t._active=!1,this.compute(e),this.emit())}},{key:"gestureStart",value:function(e){e.cancelable&&e.preventDefault();var t=this.state;t._active||(this.start(e),this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}},{key:"gestureMove",value:function(e){if(e.cancelable&&e.preventDefault(),this.state._active){var t=this.state;this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY];var n=t._movement;t._movement=[e.scale-1,e.rotation],t._delta=vl(t._movement,n),this.compute(e),this.emit()}}},{key:"gestureEnd",value:function(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}},{key:"wheel",value:function(e){var t=this.config.modifierKey;t&&!(Array.isArray(t)?t.find((function(t){return e[t]})):e[t])||(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}},{key:"wheelStart",value:function(e){this.start(e),this.wheelChange(e)}},{key:"wheelChange",value:function(e){"uv"in e||e.cancelable&&e.preventDefault();var t=this.state;t._delta=[-Ll(e)[1]/100*t.offset[0],0],gl(t._movement,t._delta),ql(t),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}},{key:"wheelEnd",value:function(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}},{key:"bind",value:function(e){var t=this.config.device;t&&(e(t,"start",this[t+"Start"].bind(this)),e(t,"change",this[t+"Move"].bind(this)),e(t,"end",this[t+"End"].bind(this)),e(t,"cancel",this[t+"End"].bind(this)),e("lostPointerCapture","",this[t+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}}]),n}(Bl),Gl=kl(kl({},Kl),{},{device:function(e,t,n){var r=n.shared,i=n.pointer,o=(void 0===i?{}:i).touch,a=void 0!==o&&o;if(r.target&&!Yl.touch&&Yl.gesture)return"gesture";if(Yl.touch&&a)return"touch";if(Yl.touchscreen){if(Yl.pointer)return"pointer";if(Yl.touch)return"touch"}},bounds:function(e,t,n){var r=n.scaleBounds,i=void 0===r?{}:r,o=n.angleBounds,a=void 0===o?{}:o,s=function(e){var t=Nl(zl(i,e),{min:-1/0,max:1/0});return[t.min,t.max]},u=function(e){var t=Nl(zl(a,e),{min:-1/0,max:1/0});return[t.min,t.max]};return"function"!==typeof i&&"function"!==typeof a?[s(),u()]:function(e){return[s(e),u(e)]}},threshold:function(e,t,n){this.lockDirection="lock"===n.axis;var r=pl(e,this.lockDirection?[.1,3]:0);return r},modifierKey:function(e){return void 0===e?"ctrlKey":e},pinchOnWheel:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}}),Ql=(kl(kl({},Vl),{},{mouseOnly:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}}),function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wl(_t(e=t.call.apply(t,[this].concat(i))),"ingKey","wheeling"),e}return L(n,[{key:"wheel",value:function(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}},{key:"wheelChange",value:function(e){var t=this.state;t._delta=Ll(e),gl(t._movement,t._delta),ql(t),this.compute(e),this.emit()}},{key:"wheelEnd",value:function(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}},{key:"bind",value:function(e){e("wheel","",this.wheel.bind(this))}}]),n}(Fl)),Zl=Vl,Jl=(kl(kl({},Vl),{},{mouseOnly:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}}),new Map),ec=new Map;function tc(e){Jl.set(e.key,e.engine),ec.set(e.key,e.resolver)}var nc={key:"pinch",engine:$l,resolver:Gl},rc={key:"wheel",engine:Ql,resolver:Zl};function ic(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var oc={target:function(e){if(e)return function(){return"current"in e?e.current:e}},enabled:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]},window:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yl.isBrowser?window:void 0})),eventOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.passive,n=void 0===t||t,r=e.capture;return{passive:n,capture:void 0!==r&&r}},transform:function(e){return e}},ac=["target","eventOptions","window","enabled","transform"];function sc(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n={},r=0,i=Object.entries(t);r<i.length;r++){var o=G(i[r],2),a=o[0],s=o[1];switch(typeof s){case"function":n[a]=s.call(n,e[a],a,e);break;case"object":n[a]=sc(e[a],s);break;case"boolean":s&&(n[a]=e[a])}}return n}var uc=function(){function e(t,n){M(this,e),wl(this,"_listeners",new Set),this._ctrl=t,this._gestureKey=n}return L(e,[{key:"add",value:function(e,t,n,r,i){var o=this._listeners,a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Sl[e];return e+(n&&n[t]||t)}(t,n),s=kl(kl({},this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{}),i);e.addEventListener(a,r,s);var u=function t(){e.removeEventListener(a,r,s),o.delete(t)};return o.add(u),u}},{key:"clean",value:function(){this._listeners.forEach((function(e){return e()})),this._listeners.clear()}}]),e}(),lc=function(){function e(){M(this,e),wl(this,"_timeouts",new Map)}return L(e,[{key:"add",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:140;this.remove(e);for(var i=arguments.length,o=new Array(i>3?i-3:0),a=3;a<i;a++)o[a-3]=arguments[a];this._timeouts.set(e,(n=window).setTimeout.apply(n,[t,r].concat(o)))}},{key:"remove",value:function(e){var t=this._timeouts.get(e);t&&window.clearTimeout(t)}},{key:"clean",value:function(){this._timeouts.forEach((function(e){window.clearTimeout(e)})),this._timeouts.clear()}}]),e}(),cc=function(){function e(t){M(this,e),wl(this,"gestures",new Set),wl(this,"_targetEventStore",new uc(this)),wl(this,"gestureEventStores",{}),wl(this,"gestureTimeoutStores",{}),wl(this,"handlers",{}),wl(this,"config",{}),wl(this,"pointerIds",new Set),wl(this,"touchIds",new Set),wl(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),function(e,t){t.drag&&dc(e,"drag");t.wheel&&dc(e,"wheel");t.scroll&&dc(e,"scroll");t.move&&dc(e,"move");t.pinch&&dc(e,"pinch");t.hover&&dc(e,"hover")}(this,t)}return L(e,[{key:"setEventIds",value:function(e){return Tl(e)?(this.touchIds=new Set(Al(e)),this.touchIds):"pointerId"in e?("pointerup"===e.type||"pointercancel"===e.type?this.pointerIds.delete(e.pointerId):"pointerdown"===e.type&&this.pointerIds.add(e.pointerId),this.pointerIds):void 0}},{key:"applyHandlers",value:function(e,t){this.handlers=e,this.nativeHandlers=t}},{key:"applyConfig",value:function(e,t){this.config=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e,i=r.target,o=r.eventOptions,a=r.window,s=r.enabled,u=r.transform,l=ic(r,ac);if(n.shared=sc({target:i,eventOptions:o,window:a,enabled:s,transform:u},oc),t){var c=ec.get(t);n[t]=sc(kl({shared:n.shared},l),c)}else for(var d in l){var f=ec.get(d);f&&(n[d]=sc(kl({shared:n.shared},l[d]),f))}return n}(e,t,this.config)}},{key:"clean",value:function(){this._targetEventStore.clean();var e,t=J(this.gestures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.gestureEventStores[n].clean(),this.gestureTimeoutStores[n].clean()}}catch(r){t.e(r)}finally{t.f()}}},{key:"effect",value:function(){var e=this;return this.config.shared.target&&this.bind(),function(){return e._targetEventStore.clean()}}},{key:"bind",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i,o=this.config.shared,a={};if(!o.target||(i=o.target())){if(o.enabled){var s,l=J(this.gestures);try{for(l.s();!(s=l.n()).done;){var c=s.value,d=this.config[c],f=fc(a,d.eventOptions,!!i);if(d.enabled)new(Jl.get(c))(this,n,c).bind(f)}}catch(k){l.e(k)}finally{l.f()}var p=fc(a,o.eventOptions,!!i),h=function(t){p(t,"",(function(r){return e.nativeHandlers[t](kl(kl({},e.state.shared),{},{event:r,args:n}))}),void 0,!0)};for(var v in this.nativeHandlers)h(v)}for(var g in a)a[g]=Rl.apply(void 0,u(a[g]));if(!i)return a;for(var m in a){var y=Il(m),b=y.device,w=y.capture,x=y.passive;this._targetEventStore.add(i,b,"",a[m],{capture:w,passive:x})}}}}]),e}();function dc(e,t){e.gestures.add(t),e.gestureEventStores[t]=new uc(e,t),e.gestureTimeoutStores[t]=new lc}var fc=function(e,t,n){return function(r,i,o){var a,s,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=null!==(a=u.capture)&&void 0!==a?a:t.capture,d=null!==(s=u.passive)&&void 0!==s?s:t.passive,f=l?r:El(r,i,c);n&&d&&(f+="Passive"),e[f]=e[f]||[],e[f].push(o)}},pc=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function hc(e,t,n,r,i,o){if(e.has(n)&&Jl.has(r)){var a=n+"Start",s=n+"End";i[r]=function(e){var r=void 0;return e.first&&a in t&&t[a](e),n in t&&(r=t[n](e)),e.last&&s in t&&t[s](e),r},o[r]=o[r]||{}}}function vc(e,t){var n=function(e){var t={},n={},r=new Set;for(var i in e)pc.test(i)?(r.add(RegExp.lastMatch),n[i]=e[i]):t[i]=e[i];return[n,t,r]}(e),r=G(n,3),i=r[0],o=r[1],a=r[2],s={};return hc(a,i,"onDrag","drag",s,t),hc(a,i,"onWheel","wheel",s,t),hc(a,i,"onScroll","scroll",s,t),hc(a,i,"onPinch","pinch",s,t),hc(a,i,"onMove","move",s,t),hc(a,i,"onHover","hover",s,t),{handlers:s,config:t,nativeHandlers:o}}function gc(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=t.useMemo((function(){return new cc(e)}),[]);if(o.applyHandlers(e,i),o.applyConfig(n,r),t.useEffect(o.effect.bind(o)),t.useEffect((function(){return o.clean.bind(o)}),[]),void 0===n.target)return o.bind.bind(o)}function mc(e){return e.forEach(tc),function(e,t){var n=vc(e,t||{}),r=n.handlers,i=n.nativeHandlers;return gc(r,n.config,void 0,i)}}var yc=n(3881),bc=10,wc=/Mac|iPod|iPhone|iPad/.test("undefined"===typeof window?"node":window.navigator.platform);function xc(e){var t=e.deltaY,n=e.deltaX,r=0;if(e.ctrlKey||e.altKey||e.metaKey){var i=Math.sign(e.deltaY),o=t;Math.abs(e.deltaY)>bc&&(o=bc*i),r=o/100}else e.shiftKey&&!wc&&(n=t,t=0);return{x:-n,y:-t,z:-r}}var kc=mc([rc,nc]),Sc=void 0;function _c(e){var n=Va(),r=t.useMemo((function(){var t=null,r=1,i=1,o=1,a=0,s=new Xa,u=new Xa,l=yc((function(e){if(null===t){var n=Math.abs(a-r),i=Xa.Dist(s,u);"gesture"===e&&n||"touch"===e&&n>16?t="zooming":i>16&&(t="panning")}}),32);return{onWheel:function(e){var r=e.event;if(n.isFocused&&(t=null,i=Date.now(),!(void 0===Sc?(Sc=i,0):i-Sc>120&&i-Sc<160?(Sc=i,1):(Sc=i,0)))){var i;if(n.editingId){var o=n.getShapeById(n.editingId);if(o)if(n.getShapeUtil(o).canScroll(o)){var a=n.getPageBoundsById(n.editingId);if(null!==a&&void 0!==a&&a.containsPoint(n.inputs.currentPagePoint))return}}uu(r);var s=xc(r);if(0!==s.x||0!==s.y){var u={type:"wheel",name:"wheel",delta:s,shiftKey:r.shiftKey,altKey:r.altKey,ctrlKey:r.metaKey||r.ctrlKey};n.dispatch(u)}}},onPinchStart:function(o){var a=e.current;t=null;var l=o.event,c=o.origin,d=o.da;l instanceof WheelEvent||(l.target===a||null!==a&&void 0!==a&&a.contains(l.target))&&(u.x=c[0],u.y=c[1],s.x=c[0],s.y=c[1],r=d[0],i=n.zoomLevel,n.dispatch({type:"pinch",name:"pinch_start",point:{x:c[0],y:c[1],z:n.zoomLevel},delta:{x:0,y:0},shiftKey:l.shiftKey,altKey:l.altKey,ctrlKey:l.metaKey||l.ctrlKey}))},onPinchEnd:function(r){var i=e.current,o=r.event,a=r.origin,s=r.offset;if(!(o instanceof WheelEvent)&&(o.target===i||null!==i&&void 0!==i&&i.contains(o.target))){var u=s[0];t=null,requestAnimationFrame((function(){n.dispatch({type:"pinch",name:"pinch_end",point:{x:a[0],y:a[1],z:u},delta:{x:a[0],y:a[1]},shiftKey:o.shiftKey,altKey:o.altKey,ctrlKey:o.metaKey||o.ctrlKey})}))}},onPinch:function(r){var s=e.current,c=r.event,d=r.origin,f=r.offset,p=r.da;if(!(c instanceof WheelEvent)&&(c.target===s||null!==s&&void 0!==s&&s.contains(c.target))){var h=!("touches"in c);a=p[0],(h||a>64)&&(o=f[0]);var v=d[0]-u.x,g=d[1]-u.y;switch(u.x=d[0],u.y=d[1],l(h?"gesture":"touch"),t){case"zooming":n.dispatch({type:"pinch",name:"pinch",point:{x:d[0],y:d[1],z:o},delta:{x:v,y:g},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey});break;case"panning":n.dispatch({type:"pinch",name:"pinch",point:{x:d[0],y:d[1],z:i},delta:{x:v,y:g},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey})}}}}}),[n,e]);kc(r,{target:e,eventOptions:{passive:!1},pinch:{from:function(){return[n.zoomLevel,0]},scaleBounds:function(){return{from:n.zoomLevel,max:8,min:.05}}}})}function Pc(e,t,n){var r=e.getShapeById(t);return{shape:r,handle:e.getHandles(r).find((function(e){return e.id===n}))}}var Ec=n(9409);function Cc(){var e=Va(),n=(0,t.useMemo)((function(){return e.store.query.records("instance_presence",(function(){return{userId:{neq:e.user.id}}}))}),[e]),r=function(){var e=arguments[0],n=arguments[1],r=3===arguments.length?void 0:arguments[2],i=3===arguments.length?arguments[2]:arguments[3];return(0,t.useMemo)((function(){return ve("useComputed(".concat(e,")"),n,r)}),i)}("userIds",(function(){return Ec(n.value.map((function(e){return e.userId}))).sort()}),{isEqual:function(e,t){var n;return e.join(",")===(null===(n=t.join)||void 0===n?void 0:n.call(t,","))}},[n]);return _e(r)}function Ic(e){var n=Va(),r=(0,t.useMemo)((function(){return n.store.query.records("instance_presence",(function(){return{userId:{eq:e}}}))}),[n,e]),i=_e("latestPresence:".concat(e),(function(){return r.value.slice().sort((function(e,t){return t.lastActivityTimestamp-e.lastActivityTimestamp}))[0]}),[]);return null!==i&&void 0!==i?i:null}var Tc=ke((function(){var e=Cc();return(0,za.jsx)(za.Fragment,{children:e.map((function(e){return(0,za.jsx)(Mc,{collaboratorId:e},e)}))})})),Mc=ke((function(e){var n=e.collaboratorId,r=Va(),i=Ic(n),o=function(e){var n,r=(0,t.useRef)(null!==(n=null===e||void 0===e?void 0:e.lastActivityTimestamp)&&void 0!==n?n:-1),i=G((0,t.useState)((function(){return Ac(Date.now()-r.current)})),2),o=i[0],a=i[1];(0,t.useEffect)((function(){var e=setInterval((function(){a(Ac(Date.now()-r.current))}),1200);return function(){return clearInterval(e)}}),[]),e&&(r.current=e.lastActivityTimestamp);return o}(i);if(!i||i.currentPageId!==r.currentPageId)return null;switch(o){case"inactive":var a=r.instanceState,s=a.followingUserId,u=a.highlightedUserIds;if(s!==i.userId&&!u.includes(i.userId))return null;break;case"idle":var l=r.instanceState.highlightedUserIds;if(i.followingUserId===r.user.id&&!i.chatMessage&&!l.includes(i.userId))return null}return(0,za.jsx)(jc,{latestPresence:i})})),jc=ke((function(e){var t=e.latestPresence,n=Va(),r=cl(),i=r.CollaboratorBrush,o=r.CollaboratorScribble,a=r.CollaboratorCursor,s=r.CollaboratorHint,u=r.CollaboratorShapeIndicator,l=n.viewportPageBounds,c=n.zoomLevel,d=t.userId,f=t.chatMessage,p=t.brush,h=t.scribble,v=t.selectedIds,g=t.userName,m=t.cursor,y=t.color,b=!(m.x<l.minX-12/c||m.y<l.minY-16/c||m.x>l.maxX-12/c||m.y>l.maxY-16/c);return(0,za.jsxs)(za.Fragment,{children:[p&&i?(0,za.jsx)(i,{className:"tl-collaborator__brush",brush:p,color:y,opacity:.1},d+"_brush"):null,b&&a?(0,za.jsx)(a,{className:"tl-collaborator__cursor",point:m,color:y,zoom:c,name:"New User"!==g?g:null,chatMessage:f},d+"_cursor"):s?(0,za.jsx)(s,{className:"tl-collaborator__cursor-hint",point:m,color:y,zoom:c,viewport:l},d+"_cursor_hint"):null,h&&o?(0,za.jsx)(o,{className:"tl-collaborator__scribble",scribble:h,color:y,zoom:c,opacity:"laser"===h.color?.5:.1},d+"_scribble"):null,u&&v.map((function(e){return(0,za.jsx)(u,{className:"tl-collaborator__shape-indicator",id:e,color:y,opacity:.5},d+"_"+e)}))]})}));function Ac(e){return e>Uu?"inactive":e>Ku?"idle":"active"}var Oc=ke((function(){var e=Va(),n=t.useMemo((function(){return{onPointerDown:function(t){if(!t.isKilled){lu(t.currentTarget,t);var n=Ce({type:"pointer",target:"selection",name:"pointer_down"},gu(t,e.getContainer()));e.dispatch(n)}},onPointerMove:function(t){if(!t.isKilled){var n=Ce({type:"pointer",target:"selection",name:"pointer_move"},gu(t,e.getContainer()));e.dispatch(n)}},onPointerUp:function(t){if(!t.isKilled){cu(t.currentTarget,t);var n=Ce({type:"pointer",target:"selection",name:"pointer_up"},gu(t,e.getContainer()));e.dispatch(n)}},onPointerEnter:function(t){if(!t.isKilled){var n=Ce({type:"pointer",target:"selection",name:"pointer_enter"},gu(t,e.getContainer()));e.dispatch(n)}},onPointerLeave:function(t){if(!t.isKilled){var n=Ce({type:"pointer",target:"selection",name:"pointer_leave"},gu(t,e.getContainer()));e.dispatch(n)}}}}),[e]),r=e.selectionBounds,i=e.selectedIds;if(!r)return null;var o=e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing");if(1===i.length){var a=e.getShapeById(i[0]);if(!a)return null;if(e.getShapeUtil(a).hideSelectionBoundsBg(a))return null}var s=Ms.toCssString(Ms.Compose(Ms.Translate(r.minX,r.minY),Ms.Rotate(e.selectionRotation)));return(0,za.jsx)("div",Ce({className:"tl-selection__bg",draggable:!1,style:{transform:s,width:ys(Math.max(1,r.width)),height:ys(Math.max(1,r.height)),pointerEvents:o?"all":"none",opacity:o?1:0}},n))})),Lc=["children","className"];function zc(e){var t=e.children,n=e.className,r=void 0===n?"":n,i=gt(e,Lc);return(0,za.jsx)("div",Ce(Ce({},i),{},{className:"tl-html-container ".concat(r),children:t}))}function Dc(e){var t=Va();return _e("isEditing",(function(){return t.editingId===e}),[t,e])}var Rc=function(e){return e.split("*").map((function(e){return function(e){if("string"!==typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}(e)})).join(".+")},Nc=function(e,t){return!!e.find((function(e){var n=new RegExp(Rc(e));return t.match(n)}))};function Bc(e){var t;return null!==(t=function(e){var t,n=new URL(e).host.replace("www.",""),r=J(Do);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(Nc(i.hostnames,n)){var o=i.toEmbedUrl(e);if(o)return{definition:i,embedUrl:o,url:e}}}}catch(a){r.e(a)}finally{r.f()}}(e))&&void 0!==t?t:function(e){var t,n=new URL(e).host.replace("www.",""),r=J(Do);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(Nc(i.hostnames,n)){var o=i.fromEmbedUrl(e);if(o)return{definition:i,url:o,embedUrl:e}}}}catch(a){r.e(a)}finally{r.f()}}(e)}function Fc(e){try{return Bc(e)}catch(ej){console.error(ej)}}var Uc=function(){function e(t,n,r){M(this,e),z(this,"canSnap",(function(){return!0})),z(this,"canScroll",(function(){return!1})),z(this,"canUnmount",(function(){return!0})),z(this,"canBind",(function(e,t){return!0})),z(this,"canEdit",(function(){return!1})),z(this,"canResize",(function(){return!0})),z(this,"canCrop",(function(){return!1})),z(this,"isClosed",(function(){return!0})),z(this,"hideResizeHandles",(function(){return!1})),z(this,"hideRotateHandle",(function(){return!1})),z(this,"hideSelectionBoundsBg",(function(){return!1})),z(this,"hideSelectionBoundsFg",(function(){return!1})),z(this,"isAspectRatioLocked",(function(){return!1})),z(this,"onBeforeCreate",void 0),z(this,"onBeforeUpdate",void 0),z(this,"onDragShapesOver",void 0),z(this,"onDragShapesOut",void 0),z(this,"onDropShapesOver",void 0),z(this,"onResizeStart",void 0),z(this,"onResize",void 0),z(this,"onResizeEnd",void 0),z(this,"onTranslateStart",void 0),z(this,"onTranslate",void 0),z(this,"onTranslateEnd",void 0),z(this,"onRotateStart",void 0),z(this,"onRotate",void 0),z(this,"onRotateEnd",void 0),z(this,"onHandleChange",void 0),z(this,"onBindingChange",void 0),z(this,"onChildrenChange",void 0),z(this,"onDoubleClickHandle",void 0),z(this,"onDoubleClickEdge",void 0),z(this,"onDoubleClick",void 0),z(this,"onClick",void 0),z(this,"onEditEnd",void 0),this.editor=t,this.type=n,this.styleProps=r}return L(e,[{key:"setStyleInPartial",value:function(e,t,n){var r=this.styleProps.get(e);return r?Ce(Ce({},t),{},{props:Ce(Ce({},t.props),{},z({},r,n))}):t}},{key:"providesBackgroundForChildren",value:function(e){return!1}},{key:"getOutlineSegments",value:function(e){return[this.editor.getOutline(e)]}},{key:"getOutline",value:function(e){return this.editor.getBounds(e).corners}},{key:"snapPoints",value:function(e){return this.editor.getBounds(e).snapPoints}},{key:"center",value:function(e){return this.getCenter(e)}},{key:"getCenter",value:function(e){return this.editor.getBounds(e).center}},{key:"canReceiveNewChildrenOfType",value:function(e,t){return!1}},{key:"canDropShapes",value:function(e,t){return!1}},{key:"expandSelectionOutlinePx",value:function(e){return 0}},{key:"hitTestPoint",value:function(e,t){return this.editor.getBounds(e).containsPoint(t)}},{key:"hitTestLineSegment",value:function(e,t,n){for(var r=this.editor.getOutline(e),i=0;i<r.length;i++){if(Xs(t,n,r[i],r[(i+1)%r.length]))return!0}return!1}},{key:"getCanvasSvgDefs",value:function(){return[]}}]),e}();function Kc(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.newPoint,i=t.handle,o=t.scaleX,a=t.scaleY,s=n.minWidth,u=void 0===s?1:s,l=n.maxWidth,c=void 0===l?1/0:l,d=n.minHeight,f=void 0===d?1:d,p=n.maxHeight,h=void 0===p?1/0:p,v=e.props.w*o,g=e.props.h*a,m=new Xa(0,0);if(v>0){if(v<u){switch(i){case"top_left":case"left":case"bottom_left":m.x=v-u;break;case"top":case"bottom":m.x=(v-u)/2;break;default:m.x=0}v=u}}else if(m.x=v,(v=-v)<u){switch(i){case"top_left":case"left":case"bottom_left":m.x=-v;break;default:m.x=-u}v=u}if(g>0){if(g<f){switch(i){case"top_left":case"top":case"top_right":m.y=g-f;break;case"right":case"left":m.y=(g-f)/2;break;default:m.y=0}g=f}}else if(m.y=g,(g=-g)<f){switch(i){case"top_left":case"top":case"top_right":m.y=-g;break;default:m.y=-f}g=f}var y=m.rot(e.rotation).add(r);return{x:y.x,y:y.y,props:{w:Math.min(c,v),h:Math.min(h,g)}}}z(Uc,"type",void 0);var Vc=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onResize",(function(e,t){return Kc(e,t)})),e}return L(n,[{key:"getBounds",value:function(e){return new ks(0,0,e.props.w,e.props.h)}},{key:"getCenter",value:function(e){return new Xa(e.props.w/2,e.props.h/2)}},{key:"getOutline",value:function(e){return this.editor.getBounds(e).corners}},{key:"hitTestPoint",value:function(e,t){return ms(t,this.editor.getOutline(e))}},{key:"hitTestLineSegment",value:function(e,t,n){for(var r=this.editor.getOutline(e),i=0;i<r.length;i++){if(Xs(t,n,r[i],r[(i+1)%r.length]))return!0}return!1}}]),n}(Uc),Wc=function(e){Et(r,e);var n=Tt(r);function r(){var e;M(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return z(_t(e=n.call.apply(n,[this].concat(i))),"hideSelectionBoundsBg",(function(t){return!e.canResize(t)})),z(_t(e),"hideSelectionBoundsFg",(function(t){return!e.canResize(t)})),z(_t(e),"canEdit",(function(){return!0})),z(_t(e),"canUnmount",(function(e){var t;return!(null===(t=Fc(e.props.url))||void 0===t||null===(t=t.definition)||void 0===t||!t.canUnmount)})),z(_t(e),"canResize",(function(e){var t;return!(null===(t=Fc(e.props.url))||void 0===t||null===(t=t.definition)||void 0===t||!t.doesResize)})),z(_t(e),"isAspectRatioLocked",(function(e){var t,n=Fc(e.props.url);return null!==(t=null===n||void 0===n?void 0:n.definition.isAspectRatioLocked)&&void 0!==t&&t})),z(_t(e),"onResize",(function(t,n){var r,i,o=e.isAspectRatioLocked(t),a=Fc(t.props.url),s=null!==(r=null===a||void 0===a?void 0:a.definition.minWidth)&&void 0!==r?r:200,u=null!==(i=null===a||void 0===a?void 0:a.definition.minHeight)&&void 0!==i?i:200;if(o){var l=t.props.w/t.props.h;l>1?s*=l:u/=l}return Kc(t,n,{minWidth:s,minHeight:u})})),e}return L(r,[{key:"getDefaultProps",value:function(){return{w:300,h:300,url:""}}},{key:"component",value:function(e){var n,i,o=this,a=e.props,s=a.w,u=a.h,l=a.url,c=Dc(e.id),d=(0,t.useMemo)((function(){return Bc(l)}),[l]),f=_e("is hovering",(function(){var e=o.editor.pageState,t=e.editingId,n=e.hoveredId;if(t&&n!==t){var i=o.editor.getShapeById(t);if(i&&o.editor.isShapeOfType(i,r))return!0}return!1}),[]),p=this.editor.getPageRotation(e),h=c||f;if("github_gist"===(null===d||void 0===d?void 0:d.definition.type)){var v=d.url.split("/").pop();if(!v)throw Error("No gist id!");return(0,za.jsx)(zc,{className:"tl-embed-container",id:e.id,children:(0,za.jsx)(Hc,{id:v,width:ys(s),height:ys(u),isInteractive:h,pageRotation:p})})}var g,m=(g=Ce(Ce({},Ro),null!==(n=null===d||void 0===d?void 0:d.definition.overridePermissions)&&void 0!==n?n:{}),Object.entries(g).filter((function(e){var t=G(e,2);return t[0],t[1]})).map((function(e){return G(e,1)[0]})).join(" "));return(0,za.jsx)(zc,{className:"tl-embed-container",id:e.id,children:null!==d&&void 0!==d&&d.definition?(0,za.jsx)("iframe",{className:"tl-embed tl-embed-".concat(e.id),sandbox:m,src:d.embedUrl,width:ys(s),height:ys(u),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:h?"auto":"none",zIndex:h?"":"-1",boxShadow:fu(p),borderRadius:null!==(i=null===d||void 0===d?void 0:d.definition.overrideOutlineRadius)&&void 0!==i?i:8,background:null===d||void 0===d?void 0:d.definition.backgroundColor}}):(0,za.jsx)("g",{transform:"translate(".concat((s-38)/2,", ").concat((u-38)/2,")"),children:(0,za.jsx)(Zu,{})})})}},{key:"indicator",value:function(e){var n,r,i=(0,t.useMemo)((function(){return Fc(e.props.url)}),[e.props.url]);return(0,za.jsx)("rect",{width:ys(e.props.w),height:ys(e.props.h),rx:null!==(n=null===i||void 0===i?void 0:i.definition.overrideOutlineRadius)&&void 0!==n?n:8,ry:null!==(r=null===i||void 0===i?void 0:i.definition.overrideOutlineRadius)&&void 0!==r?r:8})}}]),r}(Vc);function Hc(e){var t=e.id,n=e.file,r=e.isInteractive,i=e.width,o=e.height,a=e.style,s=e.pageRotation;return(0,za.jsx)("iframe",{className:"tl-embed",draggable:!1,width:ys(i),height:ys(o),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:Ce(Ce({},a),{},{pointerEvents:r?"all":"none",zIndex:r?"":"-1",boxShadow:fu(s)}),srcDoc:'\n\t\t\t<html>\n\t\t\t\t<head>\n\t\t\t\t\t<base target="_blank">\n\t\t\t\t</head>\n\t\t\t\t<body>\n\t\t\t\t\t<script src='.concat("https://gist.github.com/".concat(t,".js").concat(n?"?file=".concat(n):""),'><\/script>\n\t\t\t\t\t<style type="text/css">\n\t\t\t\t\t\t* { margin: 0px; }\n\t\t\t\t\t\ttable { height: 100%; background-color: red; }\n\t\t\t\t\t\t.gist { background-color: none; height: 100%;  }\n\t\t\t\t\t\t.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }\n\t\t\t\t\t</style>\n\t\t\t\t</body>\n\t\t\t</html>')})}z(Wc,"type","embed");var Yc=function(){function e(){M(this,e),z(this,"items",new WeakMap)}return L(e,[{key:"get",value:function(e,t){return this.items.has(e)||this.items.set(e,t(e)),this.items.get(e)}},{key:"access",value:function(e){return this.items.get(e)}},{key:"set",value:function(e,t){this.items.set(e,t)}},{key:"has",value:function(e){return this.items.has(e)}},{key:"invalidate",value:function(e){this.items.delete(e)}},{key:"bust",value:function(){this.items=new WeakMap}}]),e}();function Xc(e,t){return e.match(/^\s*$/)?t:e}function qc(e,t,n){var r,i,o=n.padding,a=void 0===o?0:o,s=document.createElementNS("http://www.w3.org/2000/svg","text");if(s.setAttribute("font-size",n.fontSize+"px"),s.setAttribute("font-family",n.fontFamily),s.setAttribute("font-style",n.fontStyle),s.setAttribute("font-weight",n.fontWeight),s.setAttribute("line-height",n.lineHeight*n.fontSize+"px"),s.setAttribute("dominant-baseline","mathematical"),s.setAttribute("alignment-baseline","mathematical"),0===t.length)return s;var u,l=ks.From(t[0].box),c=J(t);try{for(c.s();!(u=c.n()).done;){var d=u.value.box;l.union(d)}}catch(S){c.e(S)}finally{c.f()}var f,p=a+(null!==(r=n.offsetX)&&void 0!==r?r:0),h=(null!==(i=n.offsetY)&&void 0!==i?i:0)+n.fontSize/2+("start"===n.verticalTextAlign?a:"end"===n.verticalTextAlign?n.height-a-l.height:(Math.ceil(n.height)-l.height)/2),v=null,g=J(t);try{for(g.s();!(f=g.n()).done;){var m=f.value,y=m.text,b=m.box;if(null!==v&&b.y>v){var w=document.createElementNS("http://www.w3.org/2000/svg","tspan");w.setAttribute("alignment-baseline","mathematical"),w.setAttribute("x",p+"px"),w.setAttribute("y",b.y+h+"px"),w.textContent="\n",s.appendChild(w)}var x=document.createElementNS("http://www.w3.org/2000/svg","tspan");x.setAttribute("alignment-baseline","mathematical"),x.setAttribute("x",b.x+p+"px"),x.setAttribute("y",b.y+h+"px");var k=y.replace(/\s/g,"\xa0");x.textContent=k,s.appendChild(x),v=b.y}}catch(S){g.e(S)}finally{g.f()}return n.stroke&&n.strokeWidth&&(s.setAttribute("stroke",n.stroke),s.setAttribute("stroke-width",n.strokeWidth+"px")),n.fill&&s.setAttribute("fill",n.fill),s}var $c={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px",maxWidth:"auto"},Gc={s:2,m:3.5,l:5,xl:10},Qc={s:18,m:24,l:36,xl:44},Zc={s:18,m:22,l:26,xl:32},Jc={s:18,m:20,l:24,xl:28},ed={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"};function td(e){return{key:"".concat(lo.id,":").concat(e),getElement:function(){var t=Fa(Na().mark((function t(){var n,r,i,o,a,s,u;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=nd(e)){t.next=3;break}return t.abrupt("return",null);case 3:if(r=n.$$_url,i=n.$$_fontface,r&&i){t.next=7;break}return t.abrupt("return",null);case 7:return t.next=9,fetch(r);case 9:return t.next=11,t.sent.blob();case 11:return o=t.sent,t.next=14,new Promise((function(e,t){var n=new FileReader;n.onload=function(){return e(n.result)},n.onerror=t,n.readAsDataURL(o)}));case 14:return a=t.sent,s=i.replace(r,a),(u=document.createElementNS("http://www.w3.org/2000/svg","style")).textContent=s,t.abrupt("return",u);case 19:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}function nd(e){var t,n=co[e],r=J(document.fonts);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.includes(i.family))return i}}catch(o){r.e(o)}finally{r.f()}return null}function rd(e,t){return{key:"".concat(lo.id,":").concat(e),getElement:function(){var n=Fa(Na().mark((function n(){var r,i;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("pattern"===e){n.next=2;break}return n.abrupt("return",null);case 2:return r=8/12,(i=document.createElement("div")).innerHTML='\n\t\t\t\t<svg>\n\t\t\t\t\t<defs>\n\t\t\t\t\t\t<mask id="hash_pattern_mask">\n\t\t\t\t\t\t\t<rect x="0" y="0" width="8" height="8" fill="white" />\n\t\t\t\t\t\t\t<g\n\t\t\t\t\t\t\t\tstrokeLinecap="round"\n\t\t\t\t\t\t\t\tstroke="black"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<line x1="'.concat(1*r,'" y1="').concat(2,'" x2="').concat(2,'" y2="').concat(1*r,'" />\n\t\t\t\t\t\t\t\t<line x1="').concat(5*r,'" y1="').concat(7*r,'" x2="').concat(7*r,'" y2="').concat(5*r,'" />\n\t\t\t\t\t\t\t\t<line x1="').concat(6,'" y1="').concat(11*r,'" x2="').concat(11*r,'" y2="').concat(6,'" />\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t</mask>\n\t\t\t\t\t\t<pattern\n\t\t\t\t\t\t\tid="hash_pattern"\n\t\t\t\t\t\t\twidth="8"\n\t\t\t\t\t\t\theight="8"\n\t\t\t\t\t\t\tpatternUnits="userSpaceOnUse"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<rect x="0" y="0" width="8" height="8" fill="').concat(t.solid,'" mask="url(#hash_pattern_mask)" />\n\t\t\t\t\t\t</pattern>\n\t\t\t\t\t</defs>\n\t\t\t\t</svg>\n\t\t\t'),n.abrupt("return",Array.from(i.querySelectorAll("defs > *")));case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()}}function id(){return{key:"".concat(lo.id,":pattern"),component:ld}}var od=8,ad=function(e,t,n){return new Promise((function(r,i){var o=od*t*e,a=document.createElement("canvas");a.width=o,a.height=o;var s=a.getContext("2d");if(s){s.fillStyle=n?"#212529":"#f8f9fa",s.fillRect(0,0,o,o),s.globalCompositeOperation="destination-out",s.lineCap="round",s.lineWidth=1.25*t*e;var u=8/12,l=function(n){return n*t*e};s.beginPath(),s.moveTo(l(1*u),l(2)),s.lineTo(l(2),l(1*u)),s.moveTo(l(5*u),l(7*u)),s.lineTo(l(7*u),l(5*u)),s.moveTo(l(6),l(11*u)),s.lineTo(l(11*u),l(6)),s.stroke(),a.toBlob((function(e){!e||tu.throwToBlob.value?i():r(e)}))}}))},sd=function(e,t){var n=document.createElement("canvas");n.width=e[0],n.height=e[1];var r=n.getContext("2d");return r?(t(r),n.toDataURL()):""},ud=function(){for(var e=[],t=1;t<=Math.ceil(zu);t++){var n=sd([1,1],(function(e){e.fillStyle=Ji.lightMode.black.semi,e.fillRect(0,0,1,1)})),r=sd([1,1],(function(e){e.fillStyle=Ji.darkMode.black.semi,e.fillRect(0,0,1,1)}));e.push({zoom:t,url:n,darkMode:!1}),e.push({zoom:t,url:r,darkMode:!0})}return e};function ld(){var e=Va(),n=(0,t.useRef)(null),r=function(){var e=Va().devicePixelRatio,n=G((0,t.useState)(!1),2),r=n[0],i=n[1],o=(0,t.useMemo)((function(){return ud()}),[]),a=G((0,t.useState)(o),2),s=a[0],u=a[1];return(0,t.useEffect)((function(){for(var t=[],n=function(n){t.push(ad(e,n,!1).then((function(e){return{zoom:n,url:URL.createObjectURL(e),darkMode:!1}}))),t.push(ad(e,n,!0).then((function(e){return{zoom:n,url:URL.createObjectURL(e),darkMode:!0}})))},r=1;r<=Math.ceil(zu);r++)n(r);var o=!1;return Promise.all(t).then((function(e){o||(u(e),i(!0))})),function(){o=!0,i(!1)}}),[e]),{defs:(0,za.jsx)(za.Fragment,{children:s.map((function(e){var t=e.zoom+(e.darkMode?"_dark":"_light");return(0,za.jsx)("pattern",{id:Du[t],width:od,height:od,patternUnits:"userSpaceOnUse",children:(0,za.jsx)("image",{href:e.url,width:od,height:od})},t)}))}),isReady:r}}(),i=r.defs,o=r.isReady;return(0,t.useEffect)((function(){if(o&&e.isSafari){var t=cd(n.current);t&&requestAnimationFrame((function(){t.style.display="none",requestAnimationFrame((function(){t.style.display=""}))}))}}),[e,o]),(0,za.jsx)("g",{ref:n,children:i})}function cd(e){return e.classList.contains("tl-html-layer")?e:e.parentElement?cd(e.parentElement):null}var dd="  ",fd=function(){function e(){M(this,e)}return L(e,null,[{key:"insertTextFirefox",value:function(e,t){e.setRangeText(t,e.selectionStart||0,e.selectionEnd||0,"end"),e.dispatchEvent(new InputEvent("input",{data:t,inputType:"insertText",isComposing:!1}))}},{key:"insert",value:function(t,n){var r=t.ownerDocument,i=r.activeElement;i!==t&&t.focus(),r.execCommand("insertText",!1,n)||e.insertTextFirefox(t,n),i===r.body?t.blur():i instanceof HTMLElement&&i!==t&&i.focus()}},{key:"set",value:function(t,n){t.select(),e.insert(t,n)}},{key:"getSelection",value:function(e){var t=e.selectionStart,n=e.selectionEnd;return e.value.slice(t||void 0,n||void 0)}},{key:"wrapSelection",value:function(t,n,r){var i=t.selectionStart,o=t.selectionEnd,a=e.getSelection(t);e.insert(t,n+a+(null!==r&&void 0!==r?r:n)),t.selectionStart=(i||0)+n.length,t.selectionEnd=(o||0)+n.length}},{key:"replace",value:function(t,n,r){var i=0;t.value.replace(n,(function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=i+o[o.length-2],u=o[0].length;t.selectionStart=s,t.selectionEnd=s+u;var l="string"===typeof r?r:r.apply(void 0,o);return e.insert(t,l),t.selectionStart=s,i+=l.length-u,l}))}},{key:"findLineEnd",value:function(e,t){var n=e.lastIndexOf("\n",t-1)+1;return"\t"!==e.charAt(n)?t:n+1}},{key:"indent",value:function(t){var n,r=t.selectionStart,i=t.selectionEnd,o=t.value,a=o.slice(r,i),s=null===(n=/\n/g.exec(a))||void 0===n?void 0:n.length;if(s&&s>0){var u=o.lastIndexOf("\n",r-1)+1,l=t.value.slice(u,i-1),c=l.replace(/^|\n/g,"$&".concat(dd)),d=c.length-l.length;t.setSelectionRange(u,i-1),e.insert(t,c),t.setSelectionRange(r+1,i+d)}else e.insert(t,dd)}},{key:"unindent",value:function(t){var n=t.selectionStart,r=t.selectionEnd,i=t.value,o=i.lastIndexOf("\n",n-1)+1,a=e.findLineEnd(i,r),s=t.value.slice(o,a),u=s.replace(/(^|\n)(\t| {1,2})/g,"$1"),l=s.length-u.length;t.setSelectionRange(o,a),e.insert(t,u);var c=/\t| {1,2}/.exec(i.slice(o,n)),d=c?c[0].length:0,f=n-d;t.setSelectionRange(n-d,Math.max(f,r-l))}},{key:"indentCE",value:function(e){var t,n,r,i=window.getSelection(),o=e.innerText,a=null!==(t=pd(e))&&void 0!==t?t:0,s=null!==(n=pd(e))&&void 0!==n?n:0,u=o.slice(a,s),l=null===(r=/\n/g.exec(u))||void 0===r?void 0:r.length;if(l&&l>0){var c=o.lastIndexOf("\n",a-1)+1,d=o.slice(c,s-1),f=d.replace(/^|\n/g,"$&".concat(dd)).length-d.length;i&&i.setBaseAndExtent(e,a+1,e,s+f)}else{var p=window.getSelection();e.innerText=o.slice(0,a)+dd+o.slice(a),null===p||void 0===p||p.setBaseAndExtent(e,a+1,e,a+2)}}},{key:"unindentCE",value:function(t){var n,r,i=window.getSelection(),o=t.innerText,a=null!==(n=pd(t))&&void 0!==n?n:0,s=null!==(r=pd(t))&&void 0!==r?r:0,u=o.lastIndexOf("\n",a-1)+1,l=e.findLineEnd(o,s),c=o.slice(u,l),d=c.replace(/(^|\n)(\t| {1,2})/g,"$1"),f=c.length-d.length;if(i){i.setBaseAndExtent(t,u,t,l);var p=/\t| {1,2}/.exec(o.slice(u,a)),h=p?p[0].length:0,v=a-h;i.setBaseAndExtent(t,a-h,t,Math.max(v,s-f))}}},{key:"normalizeText",value:function(t){return t.replace(e.fixNewLines,"\n")}},{key:"normalizeTextForDom",value:function(t){return t.replace(e.fixNewLines,"\n").split("\n").map((function(e){return e||" "})).join("\n")}}]),e}();function pd(e){if("undefined"!==typeof window.getSelection){var t=window.getSelection();if(t){var n=0;if(0!==t.rangeCount){var r=t.getRangeAt(0),i=r.cloneRange();i.selectNodeContents(e),i.setEnd(r.endContainer,r.endOffset),n=i.toString().length}return n}}}function hd(e,n,r){var i=Va(),o=(0,t.useRef)(null),a=_e("isEditing",(function(){return i.pageState.editingId===e}),[i,e]),s=(0,t.useRef)(!1),u=(0,t.useRef)(),l=_e("is editable hovering",(function(){if("text"===n&&i.isIn("text")&&i.hoveredId===e)return!0;if(i.isIn("select.editing_shape")){var t=i.editingShape;return!!t&&(i.hoveredId===e&&t.type===n&&i.getShapeUtil(t).canEdit(t))}return!1}),[n,e]),c=(0,t.useCallback)((function(){l||requestAnimationFrame((function(){var t=o.current;if(t){var n=i.getShapeById(e);n&&(t.value=n.props.text,t.value.length&&!s.current&&t.select(),s.current=!1)}}))}),[i,e,l]),d=(0,t.useCallback)((function(){var e=u.current;requestAnimationFrame((function(){var t,n=o.current;if(i.isIn("select.editing_shape")&&n)if(e)if(e.length){s.current=!0,n.focus();var r=window.getSelection();r&&e.forEach((function(e){return r.addRange(e)}))}else n.focus();else n.focus();else null===(t=window.getSelection())||void 0===t||t.removeAllRanges(),i.complete()}))}),[i]),f=(0,t.useCallback)((function(e){switch((e.ctrlKey||e.metaKey)&&vu(e),e.key){case"Enter":(e.ctrlKey||e.metaKey)&&i.complete();break;case"Tab":uu(e),e.shiftKey?fd.unindent(e.currentTarget):fd.indent(e.currentTarget)}}),[i]),p=(0,t.useCallback)((function(t){var r=fd.normalizeText(t.currentTarget.value),o=r.replace(/\t/g,dd);if(o!==r){var a=t.currentTarget.selectionStart;t.currentTarget.value=o,t.currentTarget.selectionStart=a+(o.length-r.length),t.currentTarget.selectionEnd=a+(o.length-r.length),r=o}i.updateShapes([{id:e,type:n,props:{text:r}}])}),[i,e,n]),h=0===r.trim().length;return(0,t.useEffect)((function(){if(o.current){var e=function(){var e,t,n=null===(e=(t=window).getSelection)||void 0===e?void 0:e.call(t);if(n&&"None"!==n.type){var r=[];if(n)for(var i=0;i<n.rangeCount;i++){var o;r.push(null===(o=n.getRangeAt)||void 0===o?void 0:o.call(n,i))}u.current=r}};return document.addEventListener("selectionchange",e),function(){document.removeEventListener("selectionchange",e)}}})),{rInput:o,isEditing:a,isEditableFromHover:l,handleFocus:c,handleBlur:d,handleKeyDown:f,handleChange:p,isEmpty:h}}z(fd,"fixNewLines",/\r?\n|\r/g);var vd=new Yc,gd=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"canEdit",(function(){return!0})),z(_t(e),"isAspectRatioLocked",(function(){return!0})),z(_t(e),"onResize",(function(e,t){var n=t.initialBounds,r=t.initialShape,i=t.scaleX,o=t.handle;if("scale_shape"===t.mode||"right"!==o&&"left"!==o)return Ce({id:e.id,type:e.type},function(e,t){var n=t.initialBounds,r=t.scaleX,i=t.scaleY,o=t.newPoint,a=Math.max(.01,Math.min(Math.abs(r),Math.abs(i))),s=new Xa(0,0);r<0&&(s.x=-n.width*a),i<0&&(s.y=-n.height*a);var u=Xa.Add(o,s.rot(e.rotation));return{x:u.x,y:u.y,props:{scale:a*e.props.scale}}}(e,t));var a=n.width,s=a*i,u=new Xa(0,0);s=Math.max(1,Math.abs(s)),"left"===o?(u.x=a-s,i<0&&(u.x+=s)):i<0&&(u.x-=s);var l=u.rot(e.rotation).add(r),c=l.x,d=l.y;return{id:e.id,type:e.type,x:c,y:d,props:{w:s/r.props.scale,autoSize:!1}}})),z(_t(e),"onBeforeCreate",(function(t){if(t.props.autoSize&&!t.props.text.trim()){var n=e.getMinDimensions(t);return Ce(Ce({},t),{},{x:t.x-n.width/2,y:t.y-n.height/2})}})),z(_t(e),"onEditEnd",(function(t){var n=t.id,r=t.type,i=t.props.text,o=t.props.text.trimEnd();0===o.length?e.editor.deleteShapes([t.id]):o!==t.props.text&&e.editor.updateShapes([{id:n,type:r,props:{text:i.trimEnd()}}])})),z(_t(e),"onBeforeUpdate",(function(t,n){if(n.props.autoSize){var r=t.props.size!==n.props.size||t.props.align!==n.props.align||t.props.font!==n.props.font||1!==t.props.scale&&1===n.props.scale,i=t.props.text!==n.props.text;if(r||i){var o,a=e.getMinDimensions(t),s=md(e.editor,n.props),u=a.width*t.props.scale,l=a.height*t.props.scale,c=s.width*n.props.scale,d=s.height*n.props.scale;switch(n.props.align){case"middle":o=new Xa((c-u)/2,i?0:(d-l)/2);break;case"end":o=new Xa(c-u,i?0:(d-l)/2);break;default:if(i)break;o=new Xa(0,(d-l)/2)}if(o){o.rot(n.rotation);var f=n.x,p=n.y;return Ce(Ce({},n),{},{x:f-o.x,y:p-o.y,props:Ce(Ce({},n.props),{},{w:c})})}return Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{w:c})})}}})),z(_t(e),"onDoubleClickEdge",(function(e){return e.props.autoSize?1!==e.props.scale?{id:e.id,type:e.type,props:{scale:1}}:void 0:{id:e.id,type:e.type,props:{autoSize:!0}}})),e}return L(n,[{key:"getDefaultProps",value:function(){return{color:"black",size:"m",w:8,text:"",font:"draw",align:"middle",autoSize:!0,scale:1}}},{key:"getMinDimensions",value:function(e){var t=this;return vd.get(e.props,(function(e){return md(t.editor,e)}))}},{key:"getBounds",value:function(e){var t=e.props.scale,n=this.getMinDimensions(e),r=n.width,i=n.height;return new ks(0,0,r*t,i*t)}},{key:"getOutline",value:function(e){var t=this.editor.getBounds(e);return[new Xa(0,0),new Xa(t.width,0),new Xa(t.width,t.height),new Xa(0,t.height)]}},{key:"component",value:function(e){var t=e.id,n=e.type,r=e.props,i=r.text,o=r.color,a=eo(this.editor),s=this.getMinDimensions(e),u=s.width,l=s.height,c=hd(t,n,i),d=c.rInput,f=c.isEmpty,p=c.isEditing,h=c.isEditableFromHover,v=c.handleFocus,g=c.handleChange,m=c.handleKeyDown,y=c.handleBlur;return(0,za.jsx)(zc,{id:e.id,children:(0,za.jsxs)("div",{className:"tl-text-shape__wrapper tl-text-shadow","data-font":e.props.font,"data-align":e.props.align,"data-hastext":!f,"data-isediting":p||h,"data-textwrap":!0,style:{fontSize:Qc[e.props.size],lineHeight:Qc[e.props.size]*$c.lineHeight+"px",transform:"scale(".concat(e.props.scale,")"),transformOrigin:"top left",width:Math.max(1,u),height:Math.max(Qc[e.props.size]*$c.lineHeight,l),color:a[o].solid},children:[(0,za.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:i}),p||h?(0,za.jsx)("textarea",{ref:d,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:p,placeholder:"",spellCheck:"true",wrap:"off",dir:"ltr",datatype:"wysiwyg",defaultValue:i,onFocus:v,onChange:g,onKeyDown:m,onBlur:y,onTouchEnd:vu,onContextMenu:vu}):null]})})}},{key:"indicator",value:function(e){var t=this.getBounds(e);return(0,za.jsx)("rect",{width:ys(t.width),height:ys(t.height)})}},{key:"toSvg",value:function(e,t){var n,r;t.addExportDef(td(e.props.font));var i=eo(this.editor),o=this.getBounds(e),a=e.props.text,s=o.width/(null!==(n=e.props.scale)&&void 0!==n?n:1),u=o.height/(null!==(r=e.props.scale)&&void 0!==r?r:1),l={fontSize:Qc[e.props.size],fontFamily:co[e.props.font],textAlign:e.props.align,verticalTextAlign:"middle",width:s,height:u,padding:0,lineHeight:$c.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},c=i[e.props.color].solid,d=document.createElementNS("http://www.w3.org/2000/svg","g"),f=qc(this.editor,this.editor.textMeasure.measureTextSpans(a,l),Ce(Ce({},l),{},{stroke:i.background,strokeWidth:2,fill:i.background,padding:0})),p=f.cloneNode(!0);return p.setAttribute("fill",c),p.setAttribute("stroke","none"),d.append(f),d.append(p),d}}]),n}(Uc);function md(e,t){var n=t.font,r=t.text,i=t.autoSize,o=t.size,a=t.w,s=Qc[o],u=i?"fit-content":Math.floor(Math.max(16,a))+"px",l=e.textMeasure.measureText(r,Ce(Ce({},$c),{},{fontFamily:ed[n],fontSize:s,width:u}));return i&&(l.w+=1),{width:Math.max(16,l.w),height:Math.max(s,l.h)}}z(gd,"type","text");var yd="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",bd="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",wd='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>';function xd(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:16,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:16,s=$a/180*(-n-t),u=Math.sin(s),l=Math.cos(s),c=1*l-1*u,d=1*u+1*l;return"url(\"data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ".concat(i,";'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='").concat(c,"' dy='").concat(d,"' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(").concat(t+n," 16 16)").concat(r?" scale(-1,-1) translate(0, -32)":"","' filter='url(%23shadow)'>")+e.replaceAll('"',"'")+'</g></svg>") '.concat(o," ").concat(a,", pointer")}var kd={none:function(){return"none"},default:function(e,t,n){return xd('<path d="m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z" fill="white"/><path d="m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z" fill="white"/><path d="m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z" fill="black"/><path d="m13 10.814v11.188l2.969-2.866.428-.139h4.768z" fill="black"/>',e,0,t,n,12,8)},pointer:function(e,t,n){return xd('<path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" stroke-linejoin="round"/><path d="m21.5664 21.7344v-3.459"/><path d="m19.5508 21.7461-.016-3.473"/><path d="m17.5547 18.3047.021 3.426"/></g>',e,0,t,n,14,10)},cross:function(e,t,n){return xd('<path d="m25 16h-6.01v-6h-2.98v6h-6.01v3h6.01v6h2.98v-6h6.01z" fill="white"/><path d="m23.9902 17.0103h-6v-6.01h-.98v6.01h-6v.98h6v6.01h.98v-6.01h6z" fill="%23231f1f"/>',e,0,t,n)},move:function(e,t,n){return xd('<path d="m19 14h1v1h-1zm1 6h-1v-1h1zm-5-5h-1v-1h1zm0 5h-1v-1h1zm2-10.987-7.985 7.988 5.222 5.221 2.763 2.763 7.984-7.985z" fill="white"/><g fill="black"><path d="m23.5664 16.9971-2.557-2.809v1.829h-4.009-4.001v-1.829l-2.571 2.809 2.572 2.808-.001-1.808h4.001 4.009l-.001 1.808z"/><path d="m17.9873 17h.013v-4.001l1.807.001-2.807-2.571-2.809 2.57h1.809v4.001h.008v4.002l-1.828-.001 2.807 2.577 2.805-2.576h-1.805z"/></g>',e,0,t,n)},grab:function(e,t,n){return xd('<path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin="round"/><path d="m20.5664 21.7344v-3.459"/><path d="m18.5508 21.7461-.016-3.473"/><path d="m16.5547 18.3047.021 3.426"/></g>',e,0,t,n)},grabbing:function(e,t,n){return xd("<path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill='white'/><g stroke='black' stroke-width='.75'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin='round'/><path d='m20.5664 19.7344v-3.459' stroke-linecap='round'/><path d='m18.5508 19.7461-.016-3.473' stroke-linecap='round'/><path d='m16.5547 16.3047.021 3.426' stroke-linecap='round'/></g>",e,0,t,n)},text:function(e,t,n){return xd('<path fill="white" d="M7.94 0a5.25 5.25 0 0 0-3.47 1.17A5.27 5.27 0 0 0 1 0H0v3h1c1.41 0 1.85.7 2 1v3.94H2v3h1v3c-.13.3-.57 1-2 1H0v3h1a5.27 5.27 0 0 0 3.47-1.17c.98.8 2.21 1.21 3.47 1.17h1v-3h-1c-1.41 0-1.85-.7-2-1v-3H7v-3H6V4c.13-.3.57-1 2-1h1V0H7.94z"/><path fill="black" d="M7.94 2V1a4 4 0 0 0-3.47 1.64A4 4 0 0 0 1 1v1c1.3-.17 2.56.6 3 1.84v5.1H3v1h1v4.16c-.45 1.24-1.7 2-3 1.84v1a4.05 4.05 0 0 0 3.47-1.63 4.05 4.05 0 0 0 3.47 1.63v-1A2.82 2.82 0 0 1 5 14.1V9.93h1v-1H5V3.85A2.81 2.81 0 0 1 7.94 2z"/>',e,0,t,n,4,10)},"ew-resize":function(e,t,n){return xd(bd,e,0,t,n)},"ns-resize":function(e,t,n){return xd(bd,e,90,t,n)},"nesw-resize":function(e,t,n){return xd(yd,e,0,t,n)},"nwse-resize":function(e,t,n){return xd(yd,e,90,t,n)},"nwse-rotate":function(e,t,n){return xd(wd,e,0,t,n)},"nesw-rotate":function(e,t,n){return xd(wd,e,90,t,n)},"senw-rotate":function(e,t,n){return xd(wd,e,180,t,n)},"swne-rotate":function(e,t,n){return xd(wd,e,270,t,n)},"zoom-in":function(e,t,n){return xd('<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 14h-2v-2h-2v2h-2v1.98h2v2.02h2v-2.02h2z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',e,0,t,n)},"zoom-out":function(e,t,n){return xd('<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 16h-5.98v-1.98h5.98z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',e,0,t,n)}};function Sd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"black";return kd[e](function(e){return 180*e/$a}(t),!1,n)}var _d=["default","pointer","cross","move","grab","grabbing","text"];function Pd(e){var n=Va(),r=(0,t.useMemo)((function(){var t,r;return{onPointerDown:function(t){if(!t.isKilled&&0===t.button){var r=su(t.currentTarget);lu(r,t),r.addEventListener("pointerup",(function e(){r.removeEventListener("pointerup",e),cu(r,t)})),n.dispatch(Ce({name:"pointer_down",type:"pointer",target:"selection",handle:e},gu(t,n.getContainer()))),t.stopPropagation()}},onPointerMove:function(i){i.isKilled||0===i.button&&(i.clientX===t&&i.clientY===r||(t=i.clientX,r=i.clientY,n.dispatch(Ce({name:"pointer_move",type:"pointer",target:"selection",handle:e},gu(i,n.getContainer())))))},onPointerUp:function(t){t.isKilled||0===t.button&&n.dispatch(Ce({name:"pointer_up",type:"pointer",target:"selection",handle:e},gu(t,n.getContainer())))}}}),[n,e]);return r}function Ed(e){var t=e.size,n=e.width,r=e.height,i=e.hideAlternateHandles,o=ys(t/3),a=o/2;return(0,za.jsxs)("svg",{className:"tl-overlays__item",children:[(0,za.jsx)("polyline",{className:"tl-corner-crop-handle",points:"\n\t\t\t\t\t\t".concat(ys(0-a),",").concat(ys(t)," \n\t\t\t\t\t\t").concat(ys(0-a),",").concat(ys(0-a)," \n\t\t\t\t\t\t").concat(ys(t),",").concat(ys(0-a)),strokeWidth:o,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),(0,za.jsx)("line",{className:Ua("tl-corner-crop-edge-handle",{"tl-hidden":i}),x1:ys(n/2-t),y1:ys(0-a),x2:ys(n/2+t),y2:ys(0-a),strokeWidth:o,"data-testid":"selection.crop.top","aria-label":"top handle"}),(0,za.jsx)("polyline",{className:Ua("tl-corner-crop-handle",{"tl-hidden":i}),points:"\n\t\t\t\t\t\t".concat(ys(n-t),",").concat(ys(0-a)," \n\t\t\t\t\t\t").concat(ys(n+a),",").concat(ys(0-a)," \n\t\t\t\t\t\t").concat(ys(n+a),",").concat(ys(t)),strokeWidth:o,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),(0,za.jsx)("line",{className:Ua("tl-corner-crop-edge-handle",{"tl-hidden":i}),x1:ys(n+a),y1:ys(r/2-t),x2:ys(n+a),y2:ys(r/2+t),strokeWidth:o,"data-testid":"selection.crop.right","aria-label":"right handle"}),(0,za.jsx)("polyline",{className:"tl-corner-crop-handle",points:"\n\t\t\t\t\t\t".concat(ys(n+a),",").concat(ys(r-t)," \n\t\t\t\t\t\t").concat(ys(n+a),",").concat(ys(r+a),"\n\t\t\t\t\t\t").concat(ys(n-t),",").concat(ys(r+a)),strokeWidth:o,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),(0,za.jsx)("line",{className:Ua("tl-corner-crop-edge-handle",{"tl-hidden":i}),x1:ys(n/2-t),y1:ys(r+a),x2:ys(n/2+t),y2:ys(r+a),strokeWidth:o,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),(0,za.jsx)("polyline",{className:Ua("tl-corner-crop-handle",{"tl-hidden":i}),points:"\n\t\t\t\t\t\t".concat(ys(0+t),",").concat(ys(r+a)," \n\t\t\t\t\t\t").concat(ys(0-a),",").concat(ys(r+a),"\n\t\t\t\t\t\t").concat(ys(0-a),",").concat(ys(r-t)),strokeWidth:o,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),(0,za.jsx)("line",{className:Ua("tl-corner-crop-edge-handle",{"tl-hidden":i}),x1:ys(0-a),y1:ys(r/2-t),x2:ys(0-a),y2:ys(r/2+t),strokeWidth:o,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}var Cd="undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1,Id=ke((function(){var e,n,r=Va(),i=(0,t.useRef)(null),o=r.isReadOnly,a=Pd("top"),s=Pd("right"),u=Pd("bottom"),l=Pd("left"),c=Pd("top_left"),d=Pd("top_right"),f=Pd("bottom_right"),p=Pd("bottom_left"),h=!r.isMenuOpen&&"default"===r.cursor.type,v=r.isCoarsePointer,g=r.selectionBounds,m=r.selectedShapes,y=r.onlySelectedShape,b=y&&r.isShapeOrAncestorLocked(y),w=y?r.getShapeUtil(y).expandSelectionOutlinePx(y):0;if(Cu(i,null===(e=g)||void 0===e?void 0:e.x,null===(n=g)||void 0===n?void 0:n.y,1,r.selectionRotation,{x:-w,y:-w}),!g)return null;g=g.clone().expandBy(w);var x=r.zoomLevel,k=r.selectionRotation,S=r.isChangingStyle,_=Math.max(1,g.width),P=Math.max(1,g.height),E=8/x,C=_<2*E,I=P<2*E,T=_<4*E,M=P<4*E,j=_<5*E,A=P<5*E,O=v?1.75:1,L=6/x*O,z=(T?L/2:L)*(.75*O),D=(M?L/2:L)*(.75*O),R=(!y||!r.getShapeUtil(y).hideSelectionBoundsFg(y))&&!S,N=R&&r.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.pointing_resize_handle","select.pointing_crop_handle","select.editing_shape")||R&&r.isIn("select.resizing")&&y&&r.isShapeOfType(y,gd);y&&r.isShapeOfType(y,Wc)&&N&&Cd&&(N=!1);var B=r.isInAny("select.pointing_crop_handle","select.crop.idle","select.crop.pointing_crop")&&!S&&!o,F=r.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!S&&!o,U=!v&&!(C||I)&&(F||B)&&(!y||!r.getShapeUtil(y).hideRotateHandle(y))&&!b,K=v&&(!T||!M)&&(F||B)&&(!y||!r.getShapeUtil(y).hideRotateHandle(y))&&!b,V=F&&(!y||r.getShapeUtil(y).canResize(y)&&!r.getShapeUtil(y).hideResizeHandles(y))&&!B&&!b,W=C||I,H=C&&I,Y=j||A,X=V||B,q=!U,$=!F||!K,G=!F||!X,Q=!F||!X||W,Z=!F||!X||W,J=!F||!X||H&&!B,ee=v;ee&&m.every((function(e){return r.getShapeUtil(e).isAspectRatioLocked(e)}))&&(ee=!1);var te=!0;B?te=Y:V&&(te=W||H||ee);var ne=Math.min(24/x,P-3*D),re=F&&v&&y&&r.isShapeOfType(y,gd)&&ne*x>=4;return(0,za.jsxs)("svg",{ref:i,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:[N&&(0,za.jsx)("rect",{className:Ua("tl-selection__fg__outline"),width:ys(_),height:ys(P)}),(0,za.jsx)(Td,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:L,corner:"top_left_rotate",cursor:h?Sd("nwse-rotate",k):void 0,isHidden:q}),(0,za.jsx)(Td,{"data-testid":"selection.rotate.top-right",cx:_+3*L,cy:0,targetSize:L,corner:"top_right_rotate",cursor:h?Sd("nesw-rotate",k):void 0,isHidden:q}),(0,za.jsx)(Td,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:P+3*L,targetSize:L,corner:"bottom_left_rotate",cursor:h?Sd("swne-rotate",k):void 0,isHidden:q}),(0,za.jsx)(Td,{"data-testid":"selection.rotate.bottom-right",cx:_+3*L,cy:P+3*L,targetSize:L,corner:"bottom_right_rotate",cursor:h?Sd("senw-rotate",k):void 0,isHidden:q})," ",(0,za.jsx)(jd,{"data-testid":"selection.rotate.mobile",cx:T?1.5*-L:_/2,cy:T?P/2:1.5*-L,size:E,isHidden:$}),(0,za.jsx)("rect",Ce({className:Ua("tl-transparent",{"tl-hidden":te}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:ys(0-(M?2*D:D)),width:ys(Math.max(1,_)),height:ys(Math.max(1,2*D)),style:h?{cursor:Sd("ns-resize",k)}:void 0},a)),(0,za.jsx)("rect",Ce({className:Ua("tl-transparent",{"tl-hidden":te}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:ys(_-(T?0:z)),y:0,height:ys(Math.max(1,P)),width:ys(Math.max(1,2*z)),style:h?{cursor:Sd("ew-resize",k)}:void 0},s)),(0,za.jsx)("rect",Ce({className:Ua("tl-transparent",{"tl-hidden":te}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:ys(P-(M?0:D)),width:ys(Math.max(1,_)),height:ys(Math.max(1,2*D)),style:h?{cursor:Sd("ns-resize",k)}:void 0},u)),(0,za.jsx)("rect",Ce({className:Ua("tl-transparent",{"tl-hidden":te}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:ys(0-(T?2*z:z)),y:0,height:ys(Math.max(1,P)),width:ys(Math.max(1,2*z)),style:h?{cursor:Sd("ew-resize",k)}:void 0},l)),(0,za.jsx)("rect",Ce({className:Ua("tl-transparent",{"tl-hidden":G}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:ys(0-(T?2*z:1.5*z)),y:ys(0-(M?2*D:1.5*D)),width:ys(3*z),height:ys(3*D),style:h?{cursor:Sd("nwse-resize",k)}:void 0},c)),(0,za.jsx)("rect",Ce({className:Ua("tl-transparent",{"tl-hidden":Q}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:ys(_-(T?0:1.5*z)),y:ys(0-(M?2*D:1.5*D)),width:ys(3*z),height:ys(3*D),style:h?{cursor:Sd("nesw-resize",k)}:void 0},d)),(0,za.jsx)("rect",Ce({className:Ua("tl-transparent",{"tl-hidden":J}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:ys(_-(T?z:1.5*z)),y:ys(P-(M?D:1.5*D)),width:ys(3*z),height:ys(3*D),style:h?{cursor:Sd("nwse-resize",k)}:void 0},f)),(0,za.jsx)("rect",Ce({className:Ua("tl-transparent",{"tl-hidden":Z}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:ys(0-(T?3*z:1.5*z)),y:ys(P-(M?0:1.5*D)),width:ys(3*z),height:ys(3*D),style:h?{cursor:Sd("nesw-resize",k)}:void 0},p)),V&&(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)("rect",{"data-testid":"selection.resize.top-left",className:Ua("tl-corner-handle",{"tl-hidden":G}),"aria-label":"top_left handle",x:ys(0-E/2),y:ys(0-E/2),width:ys(E),height:ys(E)}),(0,za.jsx)("rect",{"data-testid":"selection.resize.top-right",className:Ua("tl-corner-handle",{"tl-hidden":Q}),"aria-label":"top_right handle",x:ys(_-E/2),y:ys(0-E/2),width:ys(E),height:ys(E)}),(0,za.jsx)("rect",{"data-testid":"selection.resize.bottom-right",className:Ua("tl-corner-handle",{"tl-hidden":J}),"aria-label":"bottom_right handle",x:ys(_-E/2),y:ys(P-E/2),width:ys(E),height:ys(E)}),(0,za.jsx)("rect",{"data-testid":"selection.resize.bottom-left",className:Ua("tl-corner-handle",{"tl-hidden":Z}),"aria-label":"bottom_left handle",x:ys(0-E/2),y:ys(P-E/2),width:ys(E),height:ys(E)})]}),re&&(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:ys(0-E/4),y:ys(P/2-ne/2),rx:E/4,width:ys(E/2),height:ys(ne)}),(0,za.jsx)("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:E/4,x:ys(_-E/4),y:ys(P/2-ne/2),width:ys(E/2),height:ys(ne)})]}),B&&(0,za.jsx)(Ed,Ce({},{size:E,width:_,height:P,hideAlternateHandles:Y}))]})})),Td=function(e){var t=e.cx,n=e.cy,r=e.targetSize,i=e.corner,o=e.cursor,a=e.isHidden,s=e["data-testid"],u=Pd(i);return(0,za.jsx)("rect",Ce({className:Ua("tl-transparent","tl-rotate-corner",{"tl-hidden":a}),"data-testid":s,"aria-label":"".concat(i," target"),pointerEvents:"all",x:ys(t-3*r),y:ys(n-3*r),width:ys(Math.max(1,3*r)),height:ys(Math.max(1,3*r)),cursor:o},u))},Md=Math.sqrt(Math.PI),jd=function(e){var t=e.cx,n=e.cy,r=e.size,i=e.isHidden,o=e["data-testid"],a=Pd("mobile_rotate");return(0,za.jsxs)("g",{children:[(0,za.jsx)("circle",Ce({"data-testid":o,pointerEvents:"all",className:Ua("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":i}),cx:t,cy:n},a)),(0,za.jsx)("circle",{className:Ua("tl-mobile-rotate__fg",{"tl-hidden":i}),cx:t,cy:n,r:r/Md})]})},Ad=function(e,t,n){return function(r){if("pointer_move"!==n&&e.pageState.editingId===t&&(r.isKilled=!0),!r.isKilled){switch(n){case"pointer_down":if(0!==r.button&&1!==r.button&&2!==r.button)return;lu(r.currentTarget,r);break;case"pointer_up":cu(r.currentTarget,r)}var i=e.getShapeById(t);i?e.dispatch(Ce({type:"pointer",target:"shape",shape:i,name:n},gu(r,e.getContainer()))):console.error("Shape not found",t)}}};var Od=ke((function(e){var n=e.id,r=e.index,i=e.backgroundIndex,o=e.opacity,a=e.isCulled,s=Va(),u=cl().ShapeErrorFallback,l=function(e){var n=Va();return t.useMemo((function(){var t,r,i=Ad(n,e,"pointer_move");return{onPointerDown:Ad(n,e,"pointer_down"),onPointerUp:Ad(n,e,"pointer_up"),onPointerEnter:Ad(n,e,"pointer_enter"),onPointerLeave:Ad(n,e,"pointer_leave"),onPointerMove:function(e){if(!e.isKilled&&(e.clientX!==t||e.clientY!==r))return t=e.clientX,r=e.clientY,i(e)},onTouchStart:function(e){e.isKilled=!0,uu(e)},onTouchEnd:function(e){e.isKilled=!0,uu(e)}}}),[n,e])}(n),c=t.useRef(null),d=t.useRef(null),f=t.useCallback((function(e,t){var n,r;null===(n=c.current)||void 0===n||n.style.setProperty(e,t),null===(r=d.current)||void 0===r||r.style.setProperty(e,t)}),[]);Se("set shape container transform position",(function(){var e=s.getShapeById(n),t=s.getPageTransformById(n);if(!e||!t)return null;var r=Ms.toCssString(t);f("transform",r)}),[s,f]),Se("set shape container clip path",(function(){if(!s.getShapeById(n))return null;var e=s.getClipPathById(n);f("clip-path",null!==e&&void 0!==e?e:"none")}),[s,f]),Se("set shape height and width",(function(){var e=s.getShapeById(n);if(!e)return null;var t=s.getBounds(e);f("width",Math.ceil(t.width)+"px"),f("height",Math.ceil(t.height)+"px")}),[s]),t.useLayoutEffect((function(){var e,t;f("opacity",o+""),null===(e=c.current)||void 0===e||e.style.setProperty("z-index",r+""),null===(t=d.current)||void 0===t||t.style.setProperty("z-index",i+"")}),[o,r,i,f]);var p=s.getShapeById(n),h=t.useCallback((function(e){s.annotateError(e,{origin:"react.shape",willCrashApp:!1})}),[s]);if(!p)return null;var v=s.getShapeUtil(p);return(0,za.jsxs)(za.Fragment,{children:[v.backgroundComponent&&(0,za.jsx)("div",{ref:d,className:"tl-shape tl-shape-background","data-shape-type":p.type,draggable:!1,children:!a&&(0,za.jsx)(rl,{fallback:u,onError:h,children:(0,za.jsx)(zd,{shape:p,util:v})})}),(0,za.jsx)("div",{ref:c,className:"tl-shape","data-shape-type":p.type,draggable:!1,onPointerDown:l.onPointerDown,onPointerMove:l.onPointerMove,onPointerUp:l.onPointerUp,onPointerEnter:l.onPointerEnter,onPointerLeave:l.onPointerLeave,children:a&&v.canUnmount(p)?(0,za.jsx)(Dd,{shape:p}):(0,za.jsx)(rl,{fallback:u,onError:h,children:(0,za.jsx)(Ld,{shape:p,util:v})})})]})})),Ld=t.memo((function(e){var t=e.shape,n=e.util;return ye("InnerShape:"+n.type,(function(){return n.component(t)}))}),(function(e,t){return e.shape.props===t.shape.props&&e.shape.meta===t.shape.meta})),zd=t.memo((function(e){var t=e.shape,n=e.util;return ye("InnerShape:"+n.type,(function(){var e;return null===(e=n.backgroundComponent)||void 0===e?void 0:e.call(n,t)}))}),(function(e,t){return e.shape.props===t.shape.props&&e.shape.meta===t.shape.meta})),Dd=t.memo((function(e){var t=e.shape,n=Va().getBounds(t);return(0,za.jsx)("div",{className:"tl-shape__culled",style:{transform:"translate(".concat(n.minX,"px, ").concat(n.minY,"px)"),width:n.width,height:n.height}})}),(function(){return!0})),Rd=ke((function(){var e=Va(),n=cl(),r=n.Background,i=n.SvgDefs,o=t.useRef(null),a=t.useRef(null);!function(){var e=Va(),n=Su();(0,t.useLayoutEffect)((function(){var t=yc((function(){e.updateViewportScreenBounds()}),200,{trailing:!0}),r=new ResizeObserver((function(e){e[0].contentRect&&t()}));return n&&r.observe(n),t(),function(){r.disconnect()}}),[e,n])}(),function(){var e=Va(),n=Su(),r=_e("isFocused",(function(){return e.isFocused}),[e]);(0,t.useEffect)((function(){if(void 0===typeof matchMedia){var t=matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)"));return t.addEventListener("change",n),function(){t.removeEventListener("change",n)}}function n(){e.setDevicePixelRatio(window.devicePixelRatio)}}),[e]),(0,t.useEffect)((function(){if(r){var t=function(t){if(!t.altKey||!e.isIn("zoom")&&e.root.path.value.endsWith(".idle")||Pu()||uu(t),!t.isKilled){switch(t.isKilled=!0,t.key){case"=":case"-":case"0":if(t.metaKey||t.ctrlKey)return void uu(t);break;case"Tab":default:if(Pu()||e.isMenuOpen)return;break;case",":if(!Pu()&&(uu(t),!e.inputs.keys.has("Comma"))){var r=e.inputs.currentScreenPoint,i=r.x,o=r.y,a=r.z,s=e.pageState.hoveredId;e.inputs.keys.add("Comma");var u=Ce({type:"pointer",name:"pointer_down",point:{x:i,y:o,z:a},shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey,pointerId:0,button:0,isPen:e.isPenMode},s?{target:"shape",shape:e.getShapeById(s)}:{target:"canvas"});return void e.dispatch(u)}break;case"Escape":return void(e.inputs.keys.has("Escape")||(e.inputs.keys.add("Escape"),e.cancel(),n.focus()))}var l={type:"keyboard",name:e.inputs.keys.has(t.code)?"key_repeat":"key_down",key:t.key,code:t.code,shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey};e.dispatch(l)}},i=function(t){if(!t.isKilled&&(t.isKilled=!0,!Pu()&&!e.isMenuOpen)){var n;if(","===t.key&&(null!==(n=document.activeElement)&&void 0!==n&&n.ELEMENT_NODE&&uu(t),e.inputs.keys.has(t.code))){var r=e.inputs.currentScreenPoint,i=r.x,o=r.y,a=r.z,s=e.pageState.hoveredId;e.inputs.keys.delete(t.code);var u=Ce({type:"pointer",name:"pointer_up",point:{x:i,y:o,z:a},shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey,pointerId:0,button:0,isPen:e.isPenMode},s?{target:"shape",shape:e.getShapeById(s)}:{target:"canvas"});return void e.dispatch(u)}var l={type:"keyboard",name:"key_up",key:t.key,code:t.code,shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey};e.dispatch(l)}},o=function(e){n.contains(e.target)&&(e.ctrlKey||e.metaKey)&&uu(e)};return n.addEventListener("touchstart",a,{passive:!1}),n.addEventListener("wheel",o,{passive:!1}),document.addEventListener("gesturestart",uu),document.addEventListener("gesturechange",uu),document.addEventListener("gestureend",uu),n.addEventListener("keydown",t),n.addEventListener("keyup",i),window.addEventListener("blur",s),window.addEventListener("focus",u),function(){n.removeEventListener("touchstart",a),n.removeEventListener("wheel",o),document.removeEventListener("gesturestart",uu),document.removeEventListener("gesturechange",uu),document.removeEventListener("gestureend",uu),n.removeEventListener("keydown",t),n.removeEventListener("keyup",i),window.removeEventListener("blur",s),window.removeEventListener("focus",u)}}function a(t){if(n.contains(t.target)){var r,i,o=t.touches[0].pageX,a=t.touches[0].radiusX||0;if(o-a<10||o+a>e.viewportScreenBounds.width-10)"BUTTON"===(null===(r=t.target)||void 0===r?void 0:r.tagName)&&(null===(i=t.target)||void 0===i||i.click()),uu(t)}}function s(){e.complete()}function u(){e.updateViewportScreenBounds()}}),[e,n,r])}(),function(){var e=Va();(0,t.useEffect)((function(){if(window.matchMedia){var t=window.matchMedia("(pointer: coarse)"),n=function(){e.isCoarsePointer=t.matches};return n(),t.addEventListener("change",n),function(){return t.removeEventListener("change",n)}}}),[e])}(),_c(o),function(e){var n=Va();(0,t.useEffect)((function(){var t=e.current;if(t){var r=function(e){if(e instanceof PointerEvent&&"pen"===e.pointerType){var t;e.isKilled=!0;var r=e.target;if(dl.includes(null===(t=r.tagName)||void 0===t?void 0:t.toLocaleLowerCase())||n.isIn("select.editing_shape"))return;uu(e)}};return t.addEventListener("touchstart",r),t.addEventListener("touchend",r),function(){t.removeEventListener("touchstart",r),t.addEventListener("touchend",r)}}}),[n,e])}(o),Se("position layers",(function(){var t=a.current;if(t){var n=e.camera,r=n.x,i=n.y,o=n.z,s=o>=1?Ue(o,[1,8],[.125,.5],!0):Ue(o,[.1,1],[-2,.125],!0);t.style.setProperty("transform","scale(".concat(ys(o),") translate(").concat(ys(r+s),"px,").concat(ys(i+s),"px)"))}}),[e]);var s=function(){var e=Va(),n=(0,t.useMemo)((function(){var t,n;function r(){return r=Fa(Na().mark((function t(n){var r,i,o;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(uu(n),null!==(r=n.dataTransfer)&&void 0!==r&&null!==(r=r.files)&&void 0!==r&&r.length){t.next=3;break}return t.abrupt("return");case 3:return i=Array.from(n.dataTransfer.files),o=e.getContainer().getBoundingClientRect(),t.next=7,e.putExternalContent({type:"files",files:i,point:e.screenToPage(n.clientX-o.x,n.clientY-o.y),ignoreParent:!1});case 7:case"end":return t.stop()}}),t)}))),r.apply(this,arguments)}return{onPointerDown:function(t){t.isKilled||0!==t.button&&1!==t.button&&5!==t.button||(lu(t.currentTarget,t),e.dispatch(Ce({type:"pointer",target:"canvas",name:"pointer_down"},gu(t,e.getContainer()))))},onPointerMove:function(r){r.isKilled||r.clientX===t&&r.clientY===n||(t=r.clientX,n=r.clientY,e.dispatch(Ce({type:"pointer",target:"canvas",name:"pointer_move"},gu(r,e.getContainer()))))},onPointerUp:function(r){r.isKilled||0!==r.button&&1!==r.button&&2!==r.button&&5!==r.button||(t=r.clientX,n=r.clientY,cu(r.currentTarget,r),e.dispatch(Ce({type:"pointer",target:"canvas",name:"pointer_up"},gu(r,e.getContainer()))))},onPointerEnter:function(t){t.isKilled||e.dispatch(Ce({type:"pointer",target:"canvas",name:"pointer_enter"},gu(t,e.getContainer())))},onPointerLeave:function(t){t.isKilled||e.dispatch(Ce({type:"pointer",target:"canvas",name:"pointer_leave"},gu(t,e.getContainer())))},onDragOver:function(e){uu(e)},onDrop:function(e){return r.apply(this,arguments)},onTouchStart:function(e){e.isKilled=!0,document.body.click(),uu(e)},onTouchEnd:function(e){e.isKilled=!0,"A"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&uu(e)}}}),[e]);return n}(),l=_e("shapeSvgDefs",(function(){var t,n=new Map,r=J(Ye(e.shapeUtils));try{for(r.s();!(t=r.n()).done;){var i=t.value;if(!i)return;var o,a=J(i.getCanvasSvgDefs());try{for(a.s();!(o=a.n()).done;){var s=o.value,l=s.key,c=s.component;n.has(l)||n.set(l,(0,za.jsx)(c,{},l))}}catch(d){a.e(d)}finally{a.f()}}}catch(d){r.e(d)}finally{r.f()}return u(n.values())}),[e]);return t.useEffect((function(){var e;null===(e=o.current)||void 0===e||e.focus()}),[]),(0,za.jsxs)("div",Ce(Ce({ref:o,draggable:!1,className:"tl-canvas","data-testid":"canvas"},s),{},{children:[r&&(0,za.jsx)(r,{}),(0,za.jsx)(Nd,{}),(0,za.jsx)(ef,{}),(0,za.jsxs)("div",{ref:a,className:"tl-html-layer",draggable:!1,children:[(0,za.jsx)("svg",{className:"tl-svg-context",children:(0,za.jsxs)("defs",{children:[l,$d&&(0,za.jsx)($d,{}),(0,za.jsx)(Gd,{}),(0,za.jsx)(Qd,{}),(0,za.jsx)(Zd,{}),i&&(0,za.jsx)(i,{})]})}),(0,za.jsx)(Oc,{}),(0,za.jsx)("div",{className:"tl-shapes",children:(0,za.jsx)(Hd,{})}),(0,za.jsxs)("div",{className:"tl-overlays",children:[(0,za.jsx)(Vd,{}),(0,za.jsx)(Fd,{}),(0,za.jsx)(Bd,{}),(0,za.jsx)(Ud,{}),(0,za.jsx)(Yd,{}),(0,za.jsx)(Xd,{}),(0,za.jsx)(qd,{}),(0,za.jsx)(Kd,{}),(0,za.jsx)(Id,{}),(0,za.jsx)(Tc,{})]})]})]}))})),Nd=ke((function(){var e=Va(),t=cl().Grid,n=e.camera,r=n.x,i=n.y,o=n.z,a=e.isGridMode;return t&&a?(0,za.jsx)(t,{x:r,y:i,z:o,size:e.gridSize}):null})),Bd=ke((function(){var e=Va(),t=e.scribble,n=e.zoomLevel,r=cl().Scribble;return r&&t?(0,za.jsx)(r,{className:"tl-user-scribble",scribble:t,zoom:n}):null})),Fd=ke((function(){var e=Va(),t=e.brush,n=cl().Brush;return n&&t&&e.isIn("select.brushing")?(0,za.jsx)(n,{className:"tl-user-brush",brush:t}):null})),Ud=ke((function(){var e=Va(),t=e.zoomBrush,n=cl().ZoomBrush;return n&&t&&e.isIn("zoom")?(0,za.jsx)(n,{className:"tl-user-brush",brush:t}):null})),Kd=ke((function(){var e=Va(),t=e.snaps.lines,n=e.zoomLevel,r=cl().SnapLine;return r&&t.length>0?(0,za.jsx)(za.Fragment,{children:t.map((function(e){return(0,za.jsx)(r,{className:"tl-user-snapline",line:e,zoom:n},e.id)}))}):null})),Vd=ke((function(){var e=Va(),t=e.zoomLevel,n=e.isChangingStyle,r=e.onlySelectedShape,i=e.isInAny("select.idle","select.pointing_handle")&&!n&&!e.isReadOnly;if(!r||!i)return null;var o=e.getHandles(r);if(!o)return null;var a=e.getPageTransform(r);if(!a)return null;for(var s=[],u=0,l=o[u];u<o.length;l=o[++u]){if("vertex"!==l.type){var c=o[u-1],d=o[u+1];if(c&&d&&Math.hypot(c.y-d.y,c.x-d.x)<48/t)continue}s.push(l)}return s.sort((function(e){return"vertex"===e.type?1:-1})),(0,za.jsx)("svg",{className:"tl-user-handles tl-overlays__item",children:(0,za.jsx)("g",{transform:Ms.toCssString(a),children:s.map((function(e){return(0,za.jsx)(Wd,{shapeId:r.id,handle:e},e.id)}))})})})),Wd=function(e){var n=e.shapeId,r=e.handle,i=function(e,n){var r=Va();return t.useMemo((function(){var t,i;return{onPointerDown:function(t){if(!t.isKilled){lu(su(t.currentTarget),t);var i=Pc(r,e,n),o=i.shape,a=i.handle;a&&r.dispatch(Ce({type:"pointer",target:"handle",handle:a,shape:o,name:"pointer_down"},gu(t,r.getContainer())))}},onPointerMove:function(o){if(!o.isKilled&&(o.clientX!==t||o.clientY!==i)){t=o.clientX,i=o.clientY;var a=Pc(r,e,n),s=a.shape,u=a.handle;u&&r.dispatch(Ce({type:"pointer",target:"handle",handle:u,shape:s,name:"pointer_move"},gu(o,r.getContainer())))}},onPointerUp:function(t){if(!t.isKilled){cu(su(t.currentTarget),t);var i=Pc(r,e,n),o=i.shape,a=i.handle;a&&r.dispatch(Ce({type:"pointer",target:"handle",handle:a,shape:o,name:"pointer_up"},gu(t,r.getContainer())))}},onPointerEnter:function(t){if(!t.isKilled){var i=Pc(r,e,n),o=i.shape,a=i.handle;a&&r.dispatch(Ce({type:"pointer",target:"handle",handle:a,shape:o,name:"pointer_enter"},gu(t,r.getContainer())))}},onPointerLeave:function(t){if(!t.isKilled){var i=Pc(r,e,n),o=i.shape,a=i.handle;a&&r.dispatch(Ce({type:"pointer",target:"handle",handle:a,shape:o,name:"pointer_leave"},gu(t,r.getContainer())))}}}}),[r,e,n])}(n,r.id),o=cl().Handle;return o?(0,za.jsx)("g",Ce(Ce({"aria-label":"handle",transform:"translate(".concat(r.x,", ").concat(r.y,")")},i),{},{children:(0,za.jsx)(o,{shapeId:n,handle:r})})):null},Hd=ke((function(){var e=Va().renderingShapes;return tu.debugSvg.value?(0,za.jsx)(za.Fragment,{children:e.map((function(e){return(0,za.jsxs)(t.Fragment,{children:[(0,za.jsx)(Od,Ce({},e)),(0,za.jsx)(Jd,{id:e.id})]},e.id+"_fragment")}))}):(0,za.jsx)(za.Fragment,{children:e.map((function(e){return(0,za.jsx)(Od,Ce({},e),e.id+"_shape")}))})})),Yd=ke((function(){var e=Va();return e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!e.isChangingStyle?(0,za.jsx)(za.Fragment,{children:e.selectedIds.map((function(e){return(0,za.jsx)(sl,{className:"tl-user-indicator__selected",id:e},e+"_indicator")}))}):null})),Xd=function(){var e=Va(),t=_e("hovered id and should display",(function(){return e.isInAny("select.idle","select.editing_shape")?e.pageState.hoveredId:null}),[e]);return t?(0,za.jsx)(sl,{className:"tl-user-indicator__hovered",id:t}):null},qd=ke((function(){var e=Ie(Va().hintingIds);return e.length?(0,za.jsx)(za.Fragment,{children:e.map((function(e){return(0,za.jsx)(sl,{className:"tl-user-indicator__hint",id:e},e+"_hinting")}))}):null}));function $d(){return(0,za.jsxs)("g",{id:"cursor",children:[(0,za.jsxs)("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[(0,za.jsx)("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),(0,za.jsx)("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),(0,za.jsxs)("g",{fill:"white",transform:"translate(-12,-12)",children:[(0,za.jsx)("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),(0,za.jsx)("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),(0,za.jsxs)("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[(0,za.jsx)("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),(0,za.jsx)("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function Gd(){return(0,za.jsx)("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function Qd(){return(0,za.jsx)("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:(0,za.jsx)("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function Zd(){return(0,za.jsxs)("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[(0,za.jsx)("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),(0,za.jsx)("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}var Jd=ke((function(e){var n=e.id,r=Va(),i=r.getShapeById(n),o=G(t.useState(""),2),a=o[0],s=o[1],u=(null===i||void 0===i?void 0:i.parentId)===r.currentPageId;return t.useEffect((function(){if(u){var e=null,t=me("shape to svg",Fa(Na().mark((function t(){var i,o,a;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Math.random(),e=i,o=r.getPageBoundsById(n),t.next=5,r.getSvg([n],{padding:0});case 5:(a=t.sent)&&o&&e===i&&(a.style.setProperty("overflow","visible"),a.setAttribute("preserveAspectRatio","xMidYMin slice"),a.style.setProperty("transform","translate(".concat(o.x,"px, ").concat(o.y+o.h+12,"px)")),a.style.setProperty("border","1px solid black"),s(null===a||void 0===a?void 0:a.outerHTML));case 7:case"end":return t.stop()}}),t)}))));return function(){e=null,t()}}}),[r,n,u]),u?(0,za.jsx)("div",{style:{paddingTop:12,position:"absolute"},children:(0,za.jsx)("div",{style:{display:"flex"},dangerouslySetInnerHTML:{__html:a}})}):null})),ef=ke((function(){var e=tu.logMessages.value;return(0,za.jsx)("div",{className:"debug__ui-logger",children:e.map((function(e,t){var n="string"===typeof e?e:JSON.stringify(e);return(0,za.jsx)("div",{className:"debug__ui-logger__line",children:n},t)}))})}));function tf(){}var nf=function(e){var n=e.error,r=e.editor,i=(0,t.useRef)(null),o=G((0,t.useState)(!1),2),a=o[0],s=o[1],u=G((0,t.useState)(!1),2),l=u[0],c=u[1],d=G((0,t.useState)(!1),2),f=d[0],p=d[1],h=n instanceof Error?n.message:String(n),v=n instanceof Error?n.stack:null,g=_e("isDarkMode",(function(){try{if(r)return r.isDarkMode}catch(e){}return null}),[r]),m=G((0,t.useState)(null),2),y=m[0],b=m[1];(0,t.useLayoutEffect)((function(){var e;null!==g&&b(g);for(var t=null===(e=i.current)||void 0===e?void 0:e.parentElement,n=!1;t;){if(t.classList.contains("tl-theme__dark")||t.classList.contains("tl-theme__light")){n=!0;break}t=t.parentElement}b(n?null:window.matchMedia("(prefers-color-scheme: dark)").matches)}),[g]),(0,t.useEffect)((function(){if(l){var e=setTimeout((function(){c(!1)}),2e3);return function(){return clearTimeout(e)}}}),[l]);var w=function(){var e=Fa(Na().mark((function e(){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ha();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=new URL("https://github.com/tldraw/tldraw/issues/new");return x.searchParams.set("title",h),x.searchParams.set("labels","bug"),x.searchParams.set("body","Hey, I ran into an error while using tldraw:\n\n```js\n".concat(null!==v&&void 0!==v?v:h,"\n```\n\nMy browser: ").concat(navigator.userAgent)),(0,za.jsxs)("div",{ref:i,className:Ua("tl-container tl-error-boundary",null===y?"":y?"tl-theme__dark":"tl-theme__light"),children:[(0,za.jsx)("div",{className:"tl-error-boundary__overlay"}),r&&(0,za.jsx)(nl,{onError:tf,fallback:function(){return null},children:(0,za.jsx)(Ka.Provider,{value:r,children:(0,za.jsx)("div",{className:"tl-overlay tl-error-boundary__canvas",children:(0,za.jsx)(Rd,{})})})}),(0,za.jsx)("div",{className:Ua("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":a&&!f}),children:f?(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)("h2",{children:"Are you sure?"}),(0,za.jsx)("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),(0,za.jsxs)("div",{className:"tl-error-boundary__content__actions",children:[(0,za.jsx)("button",{onClick:function(){return p(!1)},children:"Cancel"}),(0,za.jsx)("button",{className:"tl-error-boundary__reset",onClick:w,children:"Reset data"})]})]}):(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)("h2",{children:"Something's gone wrong."}),(0,za.jsxs)("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",(0,za.jsx)("a",{href:x.toString(),children:"create a GitHub issue"})," or"," ",(0,za.jsx)("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),a&&(0,za.jsxs)("div",{className:"tl-error-boundary__content__error",children:[(0,za.jsx)("pre",{children:(0,za.jsx)("code",{children:null!==v&&void 0!==v?v:h})}),(0,za.jsx)("button",{onClick:function(){var e=document.createElement("textarea");e.value=null!==v&&void 0!==v?v:h,document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove(),c(!0)},children:l?"Copied!":"Copy"})]}),(0,za.jsxs)("div",{className:"tl-error-boundary__content__actions",children:[(0,za.jsx)("button",{onClick:function(){return s(!a)},children:a?"Hide details":"Show details"}),(0,za.jsxs)("div",{className:"tl-error-boundary__content__actions__group",children:[(0,za.jsx)("button",{className:"tl-error-boundary__reset",onClick:function(){return p(!0)},children:"Reset data"}),(0,za.jsx)("button",{className:"tl-error-boundary__refresh",onClick:function(){Wa.refreshPage()},children:"Refresh Page"})]})]})]})})]})},rf=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce((function(e,t){return e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"}),"")};function of(){return rf()}var af,sf=new RegExp(/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i);function uf(e){return sf.test(e)}var lf=["animationSpeed"],cf=["isSnapMode"],df="TLDRAW_USER_DATA_v3",ff=nn({id:Vt,name:Vt,locale:Vt,color:Vt,isDarkMode:Gt,animationSpeed:Wt,isSnapMode:Gt}),pf=2,hf=yt({currentVersion:pf,migrators:(af={},z(af,1,{up:function(e){return Ce(Ce({},e),{},{animationSpeed:1})},down:function(e){e.animationSpeed;return gt(e,lf)}}),z(af,pf,{up:function(e){return Ce(Ce({},e),{},{isSnapMode:!1})},down:function(e){e.isSnapMode;return gt(e,cf)}}),af)}),vf=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function gf(){return{id:of(),locale:"undefined"!==typeof window?Aa():"en",name:"New User",color:vf[Math.floor(Math.random()*vf.length)],isDarkMode:!1,animationSpeed:1,isSnapMode:!1}}function mf(e){var t;if(null===e||"object"!==typeof e)return gf();if(!("version"in e)||!("user"in e)||"number"!==typeof e.version)return gf();var n=xt({value:e.user,fromVersion:e.version,toVersion:null!==(t=hf.currentVersion)&&void 0!==t?t:0,migrations:hf});if("error"===n.type)return gf();try{ff.validate(n.value)}catch(ej){return gf()}return n.value}var yf=ue("globalUserData",function(){var e,t;return mf("undefined"===typeof window?null:null!==(e=JSON.parse((null===(t=window)||void 0===t||null===(t=t.localStorage)||void 0===t?void 0:t.getItem(df))||"null"))&&void 0!==e?e:null)}());function bf(e){ff.validate(e),yf.set(e),"undefined"!==typeof window&&window.localStorage&&window.localStorage.setItem(df,JSON.stringify({version:hf.currentVersion,user:yf.value})),null===xf||void 0===xf||xf.postMessage({type:Sf,origin:kf,data:{user:yf.value,version:hf.currentVersion}})}var wf="undefined"!==typeof process&&!1,xf="undefined"===typeof BroadcastChannel||wf?null:new BroadcastChannel("tldraw-user-sync");null===xf||void 0===xf||xf.addEventListener("message",(function(e){var t=e.data;(null===t||void 0===t?void 0:t.type)===Sf&&(null===t||void 0===t?void 0:t.origin)!==kf&&yf.set(mf(t.data))}));var kf=of(),Sf="tldraw-user-preferences-change";function _f(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{derivePresenceState:null!==(e=r.derivePresenceState)&&void 0!==e?e:function(){return ve("presence",(function(){return null}))},userPreferences:null!==(t=r.userPreferences)&&void 0!==t?t:ve("userPreferences",(function(){return yf.value})),setUserPreferences:null!==(n=r.setUserPreferences)&&void 0!==n?n:bf}}var Pf=n(7143);function Ef(e,t){return Le(e===t.util.type,'Shape type "'.concat(e,'" does not match util type "').concat(t.util.type,'"')),Ce({type:e},t)}var Cf={wheel:"onWheel",pointer_enter:"onPointerEnter",pointer_leave:"onPointerLeave",pointer_down:"onPointerDown",pointer_move:"onPointerMove",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick"},If=function(){function e(t,n){var r=this;M(this,e),z(this,"path",void 0),z(this,"id",void 0),z(this,"current",void 0),z(this,"type",void 0),z(this,"shapeType",void 0),z(this,"initial",void 0),z(this,"children",void 0),z(this,"parent",void 0),z(this,"isActive",!1),z(this,"onWheel",void 0),z(this,"onPointerEnter",void 0),z(this,"onPointerLeave",void 0),z(this,"onPointerDown",void 0),z(this,"onPointerMove",void 0),z(this,"onPointerUp",void 0),z(this,"onDoubleClick",void 0),z(this,"onTripleClick",void 0),z(this,"onQuadrupleClick",void 0),z(this,"onRightClick",void 0),z(this,"onMiddleClick",void 0),z(this,"onKeyDown",void 0),z(this,"onKeyUp",void 0),z(this,"onKeyRepeat",void 0),z(this,"onCancel",void 0),z(this,"onComplete",void 0),z(this,"onInterrupt",void 0),z(this,"onEnter",void 0),z(this,"onExit",void 0),this.editor=t;var i=this.constructor,o=i.id,a=i.children,s=i.initial;this.id=o,this.current=ue("toolState"+this.id,void 0),this.path=ve("toolPath"+this.id,(function(){var e=r.current.value;return r.id+(e?".".concat(e.path.value):"")})),this.parent=null!==n&&void 0!==n?n:{},this.parent?a&&s?(this.type="branch",this.initial=s,this.children=Object.fromEntries(a().map((function(e){return[e.id,new e(r.editor,r)]}))),this.current.set(this.children[this.initial])):this.type="leaf":(this.type="root",a&&s&&(this.initial=s,this.children=Object.fromEntries(a().map((function(e){return[e.id,new e(r.editor,r)]}))),this.current.set(this.children[this.initial])))}return L(e,[{key:"transition",value:function(e,t){for(var n=e.split("."),r=this,i=0;i<n.length;i++){var o,a=n[i],s=r.current.value,u=null===(o=r.children)||void 0===o?void 0:o[a];if(!u)throw Error("".concat(r.id," - no child state exists with the id ").concat(a,"."));if((null===s||void 0===s?void 0:s.id)!==u.id&&(null===s||void 0===s||s.exit(t,a),r.current.set(u),u.enter(t,(null===s||void 0===s?void 0:s.id)||"initial"),!u.isActive))break;r=u}return this}},{key:"handleEvent",value:function(e){var t,n=Cf[e.name],r=this.current.value;null===(t=this[n])||void 0===t||t.call(this,e),this.current.value===r&&this.isActive&&(null===r||void 0===r||r.handleEvent(e))}},{key:"enter",value:function(e,t){var n;if(this.isActive=!0,null===(n=this.onEnter)||void 0===n||n.call(this,e,t),this.children&&this.initial&&this.isActive){var r=this.children[this.initial];this.current.set(r),r.enter(e,t)}}},{key:"exit",value:function(e,t){var n,r;(this.isActive=!1,null===(n=this.onExit)||void 0===n||n.call(this,e,t),this.isActive)||(null===(r=this.current.value)||void 0===r||r.exit(e,t))}}]),e}();z(If,"id",void 0),z(If,"initial",void 0),z(If,"children",void 0);var Tf=["children","className"];function Mf(e){var t=e.children,n=e.className,r=void 0===n?"":n,i=gt(e,Tf);return(0,za.jsx)("svg",Ce(Ce({},i),{},{className:"tl-svg-container ".concat(r),children:t}))}function jf(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.closed,i=void 0!==r&&r,o=n.snap,a=void 0===o?1:o,s=n.start,u=void 0===s?"outset":s,l=n.end,c=void 0===l?"outset":l,d=n.lengthRatio,f=void 0===d?2:d,p=n.style,h=void 0===p?"dashed":p,v=0,g=0,m=1,y=0,b=0;switch(h){case"dashed":m=1,v=Math.min(t*f,e/4);break;case"dotted":v=t/(m=100);break;default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return i||("outset"===u?(e+=v/2,b+=v/2):"skip"===u&&(e-=v,b-=v),"outset"===c?e+=v/2:"skip"===c&&(e-=v)),g=Math.floor(e/v/(2*m)),(g-=g%a)<3&&"dashed"===h?e/t<5?(v=e,g=1,y=0):(v=.333*e,y=.333*e):(v=e/(g=Math.max(g,3))/(2*m),i?(b=v/2,y=(e-g*v)/g):y=(e-g*v)/Math.max(1,g-1)),{strokeDasharray:[v,y].join(" "),strokeDashoffset:b.toString()}}function Af(){return eo(Va())}var Of=t.memo((function(e){var t=e.d,n=e.color,r=e.fill,i=Af();switch(r){case"none":return(0,za.jsx)("path",{className:"tl-hitarea-stroke",fill:"none",d:t});case"solid":return(0,za.jsx)("path",{className:"tl-hitarea-fill-solid",fill:i[n].semi,d:t});case"semi":return(0,za.jsx)("path",{className:"tl-hitarea-fill-solid",fill:i.solid,d:t});case"pattern":return(0,za.jsx)(Lf,{color:n,fill:r,d:t})}})),Lf=function(e){var t=e.d,n=e.color,r=Va(),i=Af(),o=_e("zoomLevel",(function(){return r.zoomLevel}),[r]),a=_e("isDarkMode",(function(){return r.isDarkMode}),[r]),s=Math.ceil(o),u=r.zoomLevel<=.18;return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)("path",{className:"tl-hitarea-fill-solid",fill:i[n].pattern,d:t}),(0,za.jsx)("path",{fill:u?i[n].semi:"url(#".concat(Du[s+(a?"_dark":"_light")],")"),d:t})]})};function zf(e){var t=e.d,n=e.color,r=e.fill,i=e.theme;if("none"!==r){if("pattern"===r){var o=document.createElementNS("http://www.w3.org/2000/svg","g"),a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",t),a.setAttribute("fill",i[n].pattern);var s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",t),s.setAttribute("fill","url(#hash_pattern)"),o.appendChild(a),o.appendChild(s),o}var u=document.createElementNS("http://www.w3.org/2000/svg","path");switch(u.setAttribute("d",t),r){case"semi":u.setAttribute("fill",i.solid);break;case"solid":u.setAttribute("fill",i[n].semi)}return u}}function Df(e,t){if(t){var n=document.createElementNS("http://www.w3.org/2000/svg","g");return n.appendChild(t),n.appendChild(e),n}return e}function Rf(e,t,n){var r,i="end"===t?e.end.point:e.start.point,o="end"===t?e.start.point:e.end.point,a=e.isStraight?Xa.Dist(o,i):Math.abs(e.bodyArc.length),s=Math.max(Math.min(a/5,3*n),n);if(e.isStraight)r=Xa.Nudge(i,o,s);else{var u=function(e,t,n,r){var i=n.x-e.x,o=n.y-e.y,a=Math.sqrt(i*i+o*o),s=(a*a-r*r+t*t)/(2*a),u=Math.sqrt(t*t-s*s);return i/=a,o/=a,[new Xa(e.x+i*s-o*u,e.y+o*s+i*u),new Xa(e.x+i*s+o*u,e.y+o*s-i*u)]}(i,s,e.handleArc.center,e.handleArc.radius);r="end"===t?e.handleArc.sweepFlag?u[0]:u[1]:e.handleArc.sweepFlag?u[1]:u[0]}return{point:i,int:r}}function Nf(e,t,n){var r="end"===t?e.end.arrowhead:e.start.arrowhead;if("none"!==r){var i=Rf(e,t,n);if(i){switch(r){case"bar":return function(e){var t=e.int,n=e.point,r=Xa.Sub(t,n).div(2),i=Xa.Add(n,Xa.Rot(r,Ga)),o=Xa.Sub(n,Xa.Rot(r,Ga));return"M ".concat(i.x," ").concat(i.y," L ").concat(o.x," ").concat(o.y)}(i);case"square":return function(e){var t=e.int,n=e.point,r=Xa.Lrp(n,t,.85),i=Xa.Sub(r,n).div(2),o=Xa.Add(n,Xa.Rot(i,Ga)),a=Xa.Sub(n,Xa.Rot(i,Ga)),s=Xa.Add(r,Xa.Rot(i,Ga)),u=Xa.Sub(r,Xa.Rot(i,Ga));return"M ".concat(o.x," ").concat(o.y," L ").concat(s.x," ").concat(s.y," L ").concat(u.x," ").concat(u.y," L ").concat(a.x," ").concat(a.y," Z")}(i);case"diamond":return function(e){var t=e.point,n=e.int,r=Xa.Lrp(t,n,.75),i=Xa.RotWith(r,t,$a/4),o=Xa.RotWith(r,t,-$a/4),a=Xa.Lrp(i,o,.5);return a.add(Xa.Sub(a,t)),"M ".concat(a.x," ").concat(a.y," L ").concat(i.x," ").concat(i.y," ").concat(t.x," ").concat(t.y," L ").concat(o.x," ").concat(o.y," Z")}(i);case"dot":return function(e){var t=e.point,n=e.int,r=Xa.Lrp(t,n,.45),i=Xa.Dist(r,t);return"M ".concat(r.x-i,",").concat(r.y,"\n  a ").concat(i,",").concat(i," 0 1,0 ").concat(2*i,",0\n  a ").concat(i,",").concat(i," 0 1,0 -").concat(2*i,",0 ")}(i);case"inverted":return function(e){var t=e.point,n=e.int,r=Xa.Sub(n,t).div(2),i=Xa.Add(t,Xa.Rot(r,Ga)),o=Xa.Sub(t,Xa.Rot(r,Ga));return"M ".concat(i.x," ").concat(i.y," L ").concat(n.x," ").concat(n.y," L ").concat(o.x," ").concat(o.y," Z")}(i);case"arrow":return function(e){var t=e.point,n=e.int,r=Xa.RotWith(n,t,$a/6),i=Xa.RotWith(n,t,-$a/6);return"M ".concat(r.x," ").concat(r.y," L ").concat(t.x," ").concat(t.y," L ").concat(i.x," ").concat(i.y)}(i);case"triangle":return function(e){var t=e.point,n=e.int,r=Xa.RotWith(n,t,$a/6),i=Xa.RotWith(n,t,-$a/6);return"M ".concat(r.x," ").concat(r.y," L ").concat(t.x," ").concat(t.y," L ").concat(i.x," ").concat(i.y," Z")}(i)}return""}}}function Bf(e){return Math.abs(e.props.bend)<8}function Ff(e,t){if("point"!==t.type){var n=e.getShapeById(t.boundShapeId),r=e.getShapeUtil(n);return{shape:n,transform:e.getPageTransform(n),isClosed:r.isClosed(n),isExact:t.isExact,didIntersect:!1,outline:e.getOutline(n)}}}function Uf(e,t,n){if("point"===n.type)return Xa.From(n);var r=e.getShapeById(n.boundShapeId);if(r){var i=e.getBounds(r),o=i.point,a=i.size,s=Xa.Add(o,Xa.MulV(n.normalizedAnchor,a)),u=Ms.applyToPoint(e.getPageTransform(r),s);return Ms.applyToPoint(Ms.Inverse(t),u)}return new Xa(0,0)}function Kf(e,t){var n=e.getPageTransform(t);return{start:Uf(e,n,t.props.start),end:Uf(e,n,t.props.end)}}var Vf=48,Wf=10;function Hf(e,t){var n=t.props,r=n.start,i=n.end,o=n.arrowheadStart,a=n.arrowheadEnd,s=Kf(e,t),u=s.start.clone(),l=s.end.clone(),c=Xa.Med(u,l),d=Xa.Sub(l,u).uni(),f=Ff(e,r),p=Ff(e,i),h=e.getPageTransform(t);Yf(l,s.start,h,p),Yf(u,s.end,h,f);var v=Vf,g=f&&p&&f.shape===p.shape;!f||!p||g||f.isExact||p.isExact||(p.didIntersect&&!f.didIntersect?f.isClosed&&u.setTo(Xa.Nudge(l,u,v)):p.didIntersect||p.isClosed&&l.setTo(Xa.Nudge(u,l,v)));var m=Xa.Sub(l,u).uni(),y=!Xa.Equals(m,d);if(!g){if(f&&"none"!==o&&!f.isExact){var b=Wf+Gc[t.props.size]/2+("size"in f.shape.props?Gc[f.shape.props.size]/2:0);v-=b,u.nudge(l,b*(y?-1:1))}if(p&&"none"!==a&&!p.isExact){var w=Wf+Gc[t.props.size]/2+("size"in p.shape.props?Gc[p.shape.props.size]/2:0);v-=w,l.nudge(u,w*(y?-1:1))}}f&&p&&(y?l.setTo(Xa.Add(u,m.mul(-v))):Xa.Dist(u,l)<Vf/2&&l.setTo(Xa.Add(u,m.mul(Vf/2)))),y?c.setTo(Xa.Med(s.start,s.end)):c.setTo(Xa.Med(u,l));var x=Xa.Dist(u,l);return{isStraight:!0,start:{handle:s.start,point:u,arrowhead:t.props.arrowheadStart},end:{handle:s.end,point:l,arrowhead:t.props.arrowheadEnd},middle:c,isValid:x>0,length:x}}function Yf(e,t,n,r){if(void 0!==r&&!r.isExact){var i,o,a=Ms.applyToPoint(n,t),s=Ms.applyToPoint(n,e),u=Ms.applyToPoint(Ms.Inverse(r.transform),a),l=Ms.applyToPoint(Ms.Inverse(r.transform),s),c=r.isClosed,d=(c?Vs:Ks)(u,l,r.outline);if(null!==d)i=null!==(o=d.sort((function(e,t){return Xa.Dist(e,u)-Xa.Dist(t,u)}))[0])&&void 0!==o?o:c?void 0:l;if(void 0!==i){var f=Ms.applyToPoint(r.transform,i),p=Ms.applyToPoint(Ms.Inverse(n),f);e.setTo(p),r.didIntersect=!0}}}function Xf(e){return $f(e.start.handle,e.end.handle)}function qf(e){return $f(e.start.point,e.end.point)}function $f(e,t){return"M".concat(e.x,",").concat(e.y,"L").concat(t.x,",").concat(t.y)}function Gf(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=t.props,i=r.arrowheadEnd,o=r.arrowheadStart,a=t.props.bend+n;if(Math.abs(a)>Math.abs(10*t.props.bend))return Hf(e,t);var s=Kf(e,t),u=Xa.Med(s.start,s.end),l=Xa.Sub(s.end,s.start).uni(),c=Xa.Add(u,l.per().mul(-a)),d=Ff(e,t.props.start),f=Ff(e,t.props.end),p=s.start.clone(),h=s.end.clone(),v=c.clone(),g=Jf(p,h,v);if(0===g.length||0===g.size||!xs(g.length)||!xs(g.size))return Hf(e,t);var m=e.getPageTransform(t);if(d&&!d.isExact){var y,b=Ms.applyToPoint(m,p),w=Ms.applyToPoint(m,h),x=Ms.applyToPoint(m,g.center),k=Ms.Inverse(d.transform),S=Ms.applyToPoint(k,b),_=Ms.applyToPoint(k,w),P=Ms.applyToPoint(k,x),E=d.isClosed,C=(E?Ws:Hs)(P,g.radius,e.getOutline(d.shape));if(C){var I;C=C.filter((function(e){return+Xa.Clockwise(S,e,_)===g.sweepFlag}));var T=as(Xa.Angle(g.center,c),Xa.Angle(g.center,s.start),.5);C.sort((function(e,t){return Math.abs(os(T,P.angle(e)))-Math.abs(os(T,P.angle(t)))})),y=null!==(I=C[0])&&void 0!==I?I:E?void 0:S}else y=E?void 0:S;if(y&&(p.setTo(e.getPointInShapeSpace(t,Ms.applyToPoint(d.transform,y))),d.didIntersect=!0,"none"!==o)){var M=Wf+Gc[t.props.size]/2+("size"in d.shape.props?Gc[d.shape.props.size]/2:0);p.setTo(fs(g.center.x,g.center.y,g.radius,as(Xa.Angle(g.center,p),Xa.Angle(g.center,c),M/Math.abs(ds(g.center,g.radius,p,c)))))}}if(f&&!f.isExact){var j,A,O=Ms.applyToPoint(m,p),L=Ms.applyToPoint(m,h),z=Ms.applyToPoint(m,g.center),D=Ms.Inverse(f.transform),R=Ms.applyToPoint(D,O),N=Ms.applyToPoint(D,L),B=Ms.applyToPoint(D,z),F=f.isClosed,U=F?Ws:Hs,K=as(Xa.Angle(g.center,c),Xa.Angle(g.center,s.end),.5),V=U(B,g.radius,e.getOutline(f.shape));if(V)(V=V.filter((function(e){return+Xa.Clockwise(R,e,N)===g.sweepFlag}))).sort((function(e,t){return Math.abs(os(K,B.angle(e)))-Math.abs(os(K,B.angle(t)))})),j=null!==(A=V[0])&&void 0!==A?A:F?void 0:N;else j=F?void 0:N;if(j&&(h.setTo(e.getPointInShapeSpace(t,Ms.applyToPoint(f.transform,j))),f.didIntersect=!0,"none"!==i)){var W=Wf+Gc[t.props.size]/2+("size"in f.shape.props?Gc[f.shape.props.size]/2:0);Xa.Dist(p,h)<Vf&&(W*=-2),h.setTo(fs(g.center.x,g.center.y,g.radius,as(Xa.Angle(g.center,h),Xa.Angle(g.center,c),W/Math.abs(ds(g.center,g.radius,h,c)))))}}if(Math.abs(ds(g.center,g.radius,p,h))<Vf/2&&(p.setTo(s.start),h.setTo(s.end)),d&&f&&d.shape!==f.shape&&!d.isExact&&!f.isExact){var H=Xa.Angle(g.center,p),Y=Xa.Angle(g.center,h),X=g.sweepFlag?Vf:-Vf,q=ds(g.center,g.radius,h,p),$=g.center,G=$.x,Q=$.y,Z=g.radius;d&&!d.didIntersect&&p.setTo(fs(G,Q,Z,as(H,Y,X/q))),f&&!f.didIntersect&&h.setTo(fs(G,Q,Z,as(H,Y,-X/q)))}var J=as(Xa.Angle(g.center,p),Xa.Angle(g.center,h),.5),ee=fs(g.center.x,g.center.y,g.radius,J);+Xa.Clockwise(p,ee,h)!==g.sweepFlag&&(J+=$a,ee=fs(g.center.x,g.center.y,g.radius,J)),v.setTo(ee);var te=Jf(p,h,v);return{isStraight:!1,start:{point:p,handle:s.start,arrowhead:t.props.arrowheadStart},end:{point:h,handle:s.end,arrowhead:t.props.arrowheadEnd},middle:v,handleArc:g,bodyArc:te,isValid:0!==te.length&&isFinite(te.center.x)&&isFinite(te.center.y)}}function Qf(e){var t=e.start,n=e.end,r=e.handleArc,i=r.radius,o=r.largeArcFlag,a=r.sweepFlag;return"M".concat(t.handle.x,",").concat(t.handle.y," A").concat(i," ").concat(i," 0 ").concat(o," ").concat(a," ").concat(n.handle.x,",").concat(n.handle.y)}function Zf(e){var t=e.start,n=e.end,r=e.bodyArc,i=r.radius,o=r.largeArcFlag,a=r.sweepFlag;return"M".concat(t.point.x,",").concat(t.point.y," A").concat(i," ").concat(i," 0 ").concat(o," ").concat(a," ").concat(n.point.x,",").concat(n.point.y)}function Jf(e,t,n){var r=-2*(e.x*(t.y-n.y)-e.y*(t.x-n.x)+t.x*n.y-n.x*t.y),i={x:((e.x*e.x+e.y*e.y)*(n.y-t.y)+(t.x*t.x+t.y*t.y)*(e.y-n.y)+(n.x*n.x+n.y*n.y)*(t.y-e.y))/r,y:((e.x*e.x+e.y*e.y)*(t.x-n.x)+(t.x*t.x+t.y*t.y)*(n.x-e.x)+(n.x*n.x+n.y*n.y)*(e.x-t.x))/r},o=Xa.Dist(i,e),a=+Xa.Clockwise(e,n,t),s=Math.hypot(e.y-t.y,e.x-t.x),u=Math.hypot(t.y-n.y,t.x-n.x),l=Math.hypot(n.y-e.y,n.x-e.x),c=2*Math.acos((u*u+l*l-s*s)/(2*u*l)),d=(Qa-c)*(a?1:-1);return{center:i,radius:o,size:d,length:d*o,largeArcFlag:+($a>c),sweepFlag:a}}var ep=t.memo((function(e){var t=e.id,n=e.text,r=e.size,i=e.font,o=e.position,a=e.width,s=e.labelColor,u=hd(t,"arrow",n),l=u.rInput,c=u.isEditing,d=u.handleFocus,f=u.handleBlur,p=u.handleKeyDown,h=u.handleChange,v=u.isEmpty;return!c&&v?null:(0,za.jsx)("div",{className:"tl-arrow-label","data-font":i,"data-align":"center","data-hastext":!v,"data-isediting":c,style:{textAlign:"center",fontSize:Jc[r],lineHeight:Jc[r]*$c.lineHeight+"px",transform:"translate(".concat(o.x,"px, ").concat(o.y,"px)"),color:s},children:(0,za.jsxs)("div",{className:"tl-arrow-label__inner",children:[(0,za.jsx)("p",{style:{width:a||"9px"},children:n?fd.normalizeTextForDom(n):" "}),c&&(0,za.jsx)("textarea",{ref:l,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:n,onFocus:d,onChange:h,onKeyDown:p,onBlur:f,onContextMenu:vu})]})})})),tp=Object.defineProperty,np=Object.getOwnPropertyDescriptor,rp=function(e,t,n,r){for(var i,o=r>1?void 0:r?np(t,n):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(r?i(t,n,o):i(o))||o);return r&&o&&tp(t,n,o),o},ip=0,op=function(e){Et(r,e);var n=Tt(r);function r(){var e;M(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return z(_t(e=n.call.apply(n,[this].concat(i))),"canEdit",(function(){return!0})),z(_t(e),"canBind",(function(){return!1})),z(_t(e),"isClosed",(function(){return!1})),z(_t(e),"canSnap",(function(){return!0})),z(_t(e),"hideResizeHandles",(function(){return!0})),z(_t(e),"hideRotateHandle",(function(){return!0})),z(_t(e),"hideSelectionBoundsFg",(function(){return!0})),z(_t(e),"hideSelectionBoundsBg",(function(){return!0})),z(_t(e),"onHandleChange",(function(t,n){var r=n.handle,i=n.isPrecise,o=We(t);switch(r.id){case"start":case"end":var a=e.editor.getPageTransformById(o.id),s=Ms.applyToPoint(a,r);if(e.editor.inputs.ctrlKey)o.props[r.id]={type:"point",x:r.x,y:r.y};else{var u=Me(e.editor.sortedShapesArray.filter((function(n){if(n.id!==t.id){var r=e.editor.getShapeUtil(n);if(r.canBind(n)){var i=e.editor.getPageMaskById(n.id);if(!i||ms(s,i)){var o=e.editor.getPointInShapeSpace(n,s);return r.isClosed(n)?ms(o,e.editor.getOutline(n)):r.hitTestPoint(n,o)}}}})));if(u){var l=e.editor.getBounds(u),c=e.editor.getPointInShapeSpace(u,s),d=o.props[r.id],f="binding"===t.props.start.type&&t.props.start.boundShapeId,p="binding"===t.props.end.type&&t.props.end.boundShapeId,h=i||(f||p)&&f===p||!e.editor.getShapeUtil(u).isClosed(o);("point"===d.type||"binding"===d.type&&u.id!==d.boundShapeId)&&(h=e.editor.inputs.pointerVelocity.len()<.5),h&&(h=Xa.Dist(c,l.center)>Math.max(4,Math.min(.15*Math.min(l.width,l.height),16))/e.editor.zoomLevel),o.props[r.id]={type:"binding",boundShapeId:u.id,normalizedAnchor:h?{x:(c.x-l.minX)/l.width,y:(c.y-l.minY)/l.height}:{x:.5,y:.5},isExact:e.editor.inputs.altKey}}else o.props[r.id]={type:"point",x:r.x,y:r.y}}break;case"middle":var v=Kf(e.editor,o),g=v.start,m=v.end,y=Xa.Sub(m,g),b=Xa.Per(y),w=Xa.Med(m,g),x=Xa.Sub(w,b),k=Xa.Add(w,b),S=Xa.NearestPointOnLineSegment(x,k,r,!1),_=Xa.Dist(S,w);Xa.Clockwise(S,m,w)&&(_*=-1),o.props.bend=_}return o})),z(_t(e),"onTranslateStart",(function(t){var n="binding"===t.props.start.type?t.props.start.boundShapeId:null,r="binding"===t.props.end.type?t.props.end.boundShapeId:null;if(!(n&&e.editor.isWithinSelection(n)||r&&e.editor.isWithinSelection(r))){n=null,r=null;var i=Kf(e.editor,t),o=i.start,a=i.end;return{id:t.id,type:t.type,props:Ce(Ce({},t.props),{},{start:{type:"point",x:o.x,y:o.y},end:{type:"point",x:a.x,y:a.y}})}}})),z(_t(e),"onResize",(function(t,n){var r=n.scaleX,i=n.scaleY,o=Kf(e.editor,t),a=We(t.props),s=a.start,u=a.end,l=t.props.bend;"point"===s.type&&(s.x=o.start.x*r,s.y=o.start.y*i),"point"===u.type&&(u.x=o.end.x*r,u.y=o.end.y*i);var c=Math.abs(r),d=Math.abs(i);return r<0&&i>=0?(0!==l&&(l*=-1,l*=Math.max(c,d)),"binding"===s.type&&(s.normalizedAnchor.x=1-s.normalizedAnchor.x),"binding"===u.type&&(u.normalizedAnchor.x=1-u.normalizedAnchor.x)):r>=0&&i<0?(0!==l&&(l*=-1,l*=Math.max(c,d)),"binding"===s.type&&(s.normalizedAnchor.y=1-s.normalizedAnchor.y),"binding"===u.type&&(u.normalizedAnchor.y=1-u.normalizedAnchor.y)):r>=0&&i>=0?0!==l&&(l*=Math.max(c,d)):r<0&&i<0&&(0!==l&&(l*=Math.max(c,d)),"binding"===s.type&&(s.normalizedAnchor.x=1-s.normalizedAnchor.x,s.normalizedAnchor.y=1-s.normalizedAnchor.y),"binding"===u.type&&(u.normalizedAnchor.x=1-u.normalizedAnchor.x,u.normalizedAnchor.y=1-u.normalizedAnchor.y)),{props:{start:s,end:u,bend:l}}})),z(_t(e),"onDoubleClickHandle",(function(e,t){switch(t.id){case"start":return{id:e.id,type:e.type,props:Ce(Ce({},e.props),{},{arrowheadStart:"none"===e.props.arrowheadStart?"arrow":"none"})};case"end":return{id:e.id,type:e.type,props:Ce(Ce({},e.props),{},{arrowheadEnd:"none"===e.props.arrowheadEnd?"arrow":"none"})}}})),z(_t(e),"onEditEnd",(function(t){var n=t.id,r=t.type,i=t.props.text;i.trimEnd()!==t.props.text&&e.editor.updateShapes([{id:n,type:r,props:{text:i.trimEnd()}}])})),e}return L(r,[{key:"getDefaultProps",value:function(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{type:"point",x:0,y:0},end:{type:"point",x:0,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",font:"draw"}}},{key:"getCenter",value:function(e){return this.editor.getBounds(e).center}},{key:"getBounds",value:function(e){return ks.FromPoints(this.getOutlineWithoutLabel(e))}},{key:"getOutlineWithoutLabel",value:function(e){var t=this.getArrowInfo(e);if(!t)return[];if(t.isStraight)return t.isValid?[Xa.From(t.start.point),Xa.From(t.end.point)]:[new Xa(0,0),new Xa(1,1)];if(!t.isValid)return[new Xa(0,0),new Xa(1,1)];var n=Math.max(5,Math.ceil(Math.abs(t.bodyArc.length)/16));if(n<=0&&!isFinite(n))return[new Xa(0,0),new Xa(1,1)];for(var r=Array(n),i=Xa.Angle(t.bodyArc.center,t.start.point),o=Xa.Angle(t.bodyArc.center,t.end.point),a=t.bodyArc.sweepFlag?o:i,s=t.bodyArc.sweepFlag?i:o,u=t.bodyArc.largeArcFlag?-(Qa-os(a,s)):os(a,s),l=Math.max(1,t.bodyArc.radius),c=0;c<n;c++){var d=a+u*(c/(n-1)),f=fs(t.bodyArc.center.x,t.bodyArc.center.y,l,d);r[c]=f}return r}},{key:"getOutline",value:function(e){var t=this.getOutlineWithoutLabel(e),n=this.getLabelBounds(e);if(!n)return t;for(var r=n.sides,i=[0,1,2,3],o=t[0],a=!1,s=[o],u=function(){var e=t[l];if(!a){var n=je(i.filter((function(t){return Xs(r[t][0],r[t][1],o,e)})),(function(e){return Xa.DistanceToLineSegment(r[e][0],r[e][1],o)}));if(void 0!==n){var u=Xa.NearestPointOnLineSegment(r[n][0],r[n][1],o);s.push(u);for(var c=0;c<4;c++){var d=(n+c)%4;s.push(r[d][1])}s.push(u),a=!0}}s.push(e),o=e},l=1;l<t.length;l++)u();return s}},{key:"snapPoints",value:function(e){return K}},{key:"infoCache",get:function(){var e=this;return this.editor.store.createComputedCache("arrow infoCache",(function(t){return Bf(t)?Hf(e.editor,t):Gf(e.editor,t)}))}},{key:"getArrowInfo",value:function(e){return this.infoCache.get(e.id)}},{key:"getHandles",value:function(e){var t=this.infoCache.get(e.id);return[{id:"start",type:"vertex",index:"a0",x:t.start.handle.x,y:t.start.handle.y,canBind:!0},{id:"middle",type:"vertex",index:"a2",x:t.middle.x,y:t.middle.y,canBind:!1},{id:"end",type:"vertex",index:"a3",x:t.end.handle.x,y:t.end.handle.y,canBind:!0}]}},{key:"hitTestPoint",value:function(e,t){for(var n=this.editor.getOutline(e),r=this.editor.zoomLevel,i=Gc[e.props.size]/r,o=0;o<n.length-1;o++){var a=n[o],s=n[o+1];if(Xa.DistanceToLineSegment(a,s,t)<i)return!0}return!1}},{key:"hitTestLineSegment",value:function(e,t,n){for(var r=this.editor.getOutline(e),i=0;i<r.length-1;i++){if(Xs(t,n,r[i],r[i+1]))return!0}return!1}},{key:"component",value:function(e){var n,r=this,i=Af(),o=this.editor.onlySelectedShape,a=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","arrow.dragging")&&!this.editor.isReadOnly,s=this.getArrowInfo(e),u=this.editor.getBounds(e),l=this.getLabelBounds(e),c=t.useMemo((function(){return r.editor.isSafari?ip+=1:0}),[e]);if(null===s||void 0===s||!s.isValid)return null;var d=Gc[e.props.size],f=s.start.arrowhead&&Nf(s,"start",d),p=s.end.arrowhead&&Nf(s,"end",d),h=s.isStraight?qf(s):Zf(s),v=null;if(o===e&&a){var g=jf(s.isStraight?Xa.Dist(s.start.handle,s.end.handle):Math.abs(s.handleArc.length),2,{end:"skip",start:"skip",lengthRatio:2.5}),m=g.strokeDasharray,y=g.strokeDashoffset;v="binding"===e.props.start.type||"binding"===e.props.end.type?(0,za.jsx)("path",{className:"tl-arrow-hint",d:s.isStraight?Xf(s):Qf(s),strokeDasharray:m,strokeDashoffset:y,strokeWidth:2,markerStart:"binding"===e.props.start.type?e.props.start.isExact?"":up(e.props.start.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:"binding"===e.props.end.type?e.props.end.isExact?"":up(e.props.end.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}var b=jf(s.isStraight?s.length:Math.abs(s.bodyArc.length),d,{style:e.props.dash}),w=b.strokeDasharray,x=b.strokeDashoffset,k=!("none"===s.start.arrowhead||"arrow"===s.start.arrowhead),S=!("none"===s.end.arrowhead||"arrow"===s.end.arrowhead),_=k||S||l,P=(e.id+"_clip_"+c).replace(":","_");return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsxs)(Mf,{id:e.id,style:{minWidth:50,minHeight:50},children:[_&&(0,za.jsx)("defs",{children:(0,za.jsxs)("mask",{id:P,children:[(0,za.jsx)("rect",{x:ys(-100+u.minX),y:ys(-100+u.minY),width:ys(u.width+200),height:ys(u.height+200),fill:"white"}),l&&(0,za.jsx)("rect",{x:ys(l.x),y:ys(l.y),width:ys(l.w),height:ys(l.h),fill:"black",rx:4,ry:4}),f&&k&&(0,za.jsx)("path",{d:f,fill:"arrow"===s.start.arrowhead?"none":"black",stroke:"none"}),p&&S&&(0,za.jsx)("path",{d:p,fill:"arrow"===s.end.arrowhead?"none":"black",stroke:"none"})]})}),(0,za.jsxs)("g",{fill:"none",stroke:i[e.props.color].solid,strokeWidth:d,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[v,(0,za.jsxs)("g",Ce(Ce({},_?{mask:"url(#".concat(P,")")}:void 0),{},{children:[_&&(0,za.jsx)("rect",{x:ys(u.minX-100),y:ys(u.minY-100),width:ys(u.width+200),height:ys(u.height+200),opacity:0}),(0,za.jsx)("path",{d:h,strokeDasharray:w,strokeDashoffset:x})]})),f&&k&&"none"!==e.props.fill&&(0,za.jsx)(Of,{d:f,color:e.props.color,fill:e.props.fill}),p&&S&&"none"!==e.props.fill&&(0,za.jsx)(Of,{d:p,color:e.props.color,fill:e.props.fill}),f&&(0,za.jsx)("path",{d:f}),p&&(0,za.jsx)("path",{d:p})]}),(0,za.jsx)("path",{d:h,className:"tl-hitarea-stroke"})]}),(0,za.jsx)(ep,{id:e.id,text:e.props.text,font:e.props.font,size:e.props.size,position:s.middle,width:null!==(n=null===l||void 0===l?void 0:l.w)&&void 0!==n?n:0,labelColor:e.props.labelColor})]})}},{key:"indicator",value:function(e){var t=Kf(this.editor,e),n=t.start,r=t.end,i=this.getArrowInfo(e),o=this.editor.getBounds(e),a=this.getLabelBounds(e);if(!i)return null;if(Xa.Equals(n,r))return null;var s=Gc[e.props.size],u=i.start.arrowhead&&Nf(i,"start",s),l=i.end.arrowhead&&Nf(i,"end",s),c=i.isStraight?qf(i):Zf(i),d=u&&"arrow"!==i.start.arrowhead||l&&"arrow"!==i.end.arrowhead||null!==a,f=(e.id+"_clip").replace(":","_");return(0,za.jsxs)("g",{children:[d&&(0,za.jsx)("defs",{children:(0,za.jsxs)("mask",{id:f,children:[(0,za.jsx)("rect",{x:o.minX-100,y:o.minY-100,width:o.w+200,height:o.h+200,fill:"white"}),a&&(0,za.jsx)("rect",{x:a.x,y:a.y,width:a.w,height:a.h,fill:"black",rx:4,ry:4}),u&&(0,za.jsx)("path",{d:u,fill:"arrow"===i.start.arrowhead?"none":"black",stroke:"none"}),l&&(0,za.jsx)("path",{d:l,fill:"arrow"===i.end.arrowhead?"none":"black",stroke:"none"})]})}),(0,za.jsxs)("g",Ce(Ce({},d?{mask:"url(#".concat(f,")")}:void 0),{},{children:[d&&(0,za.jsx)("rect",{x:o.minX-100,y:o.minY-100,width:o.width+200,height:o.height+200,opacity:0}),(0,za.jsx)("path",{d:c})]})),u&&(0,za.jsx)("path",{d:u}),l&&(0,za.jsx)("path",{d:l}),a&&(0,za.jsx)("rect",{x:a.x,y:a.y,width:a.w,height:a.h,rx:4,ry:4})]})}},{key:"labelBoundsCache",get:function(){var e=this;return this.editor.store.createComputedCache("labelBoundsCache",(function(t){var n=e.getArrowInfo(t),r=e.editor.getBounds(t),i=t.props,o=i.text,a=i.font,s=i.size;if(!n)return null;if(!o.trim())return null;var u=e.editor.textMeasure.measureText(o,Ce(Ce({},$c),{},{fontFamily:ed[a],fontSize:Jc[s],width:"fit-content"})),l=u.w,c=l,d=u.h;if(r.width>r.height){c=Math.max(Math.min(l,64),Math.min(r.width-64,l));var f=e.editor.textMeasure.measureText(o,Ce(Ce({},$c),{},{fontFamily:ed[a],fontSize:Jc[s],width:c+"px"}));c=f.w,d=f.h}if(c>16*Jc[s]){c=16*Jc[s];var p=e.editor.textMeasure.measureText(o,Ce(Ce({},$c),{},{fontFamily:ed[a],fontSize:Jc[s],width:c+"px"}));c=p.w,d=p.h}return new ks(n.middle.x-(c+8)/2,n.middle.y-(d+8)/2,c+8,d+8)}))}},{key:"getLabelBounds",value:function(e){return this.labelBoundsCache.get(e.id)||null}},{key:"toSvg",value:function(e,t){var n=eo(this.editor);t.addExportDef(rd(e.props.fill,n));var r=n[e.props.color].solid,i=this.getArrowInfo(e),o=Gc[e.props.size],a=document.createElementNS("http://www.w3.org/2000/svg","g");if(!i)return a;var s=i.start.arrowhead&&Nf(i,"start",o),u=i.end.arrowhead&&Nf(i,"end",o),l=this.editor.getBounds(e),c=this.getLabelBounds(e),d=(e.id+"_clip").replace(":","_");if(s||u||c){var f=document.createElementNS("http://www.w3.org/2000/svg","defs"),p=document.createElementNS("http://www.w3.org/2000/svg","mask");p.id=d;var h=document.createElementNS("http://www.w3.org/2000/svg","rect");if(h.setAttribute("x",l.minX-100+""),h.setAttribute("y",l.minY-100+""),h.setAttribute("width",l.width+200+""),h.setAttribute("height",l.height+200+""),h.setAttribute("fill","white"),p.appendChild(h),s&&p.appendChild(ap(s,i.start.arrowhead)),u&&p.appendChild(ap(u,i.end.arrowhead)),c){var v=document.createElementNS("http://www.w3.org/2000/svg","rect");v.setAttribute("x",c.x+""),v.setAttribute("y",c.y+""),v.setAttribute("width",c.w+""),v.setAttribute("height",c.h+""),v.setAttribute("fill","black"),p.appendChild(v)}f.appendChild(p),a.appendChild(f)}var g=document.createElementNS("http://www.w3.org/2000/svg","g");g.setAttribute("mask","url(#".concat(d,")")),a.appendChild(g);var m=document.createElementNS("http://www.w3.org/2000/svg","rect");m.setAttribute("x","-100"),m.setAttribute("y","-100"),m.setAttribute("width",l.width+200+""),m.setAttribute("height",l.height+200+""),m.setAttribute("fill","transparent"),m.setAttribute("stroke","none"),g.appendChild(m);var y=function(e,t,n){var r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",e),r.setAttribute("fill","none"),r.setAttribute("stroke",t),r.setAttribute("stroke-width",n+""),r}(i.isStraight?qf(i):Zf(i),r,o),b=jf(i.isStraight?i.length:Math.abs(i.bodyArc.length),o,{style:e.props.dash}),w=b.strokeDasharray,x=b.strokeDashoffset;if(y.setAttribute("stroke-dasharray",w),y.setAttribute("stroke-dashoffset",x),g.appendChild(y),s&&a.appendChild(sp(s,e.props.color,o,"arrow"===e.props.arrowheadStart?"none":e.props.fill,n)),u&&a.appendChild(sp(u,e.props.color,o,"arrow"===e.props.arrowheadEnd?"none":e.props.fill,n)),c){t.addExportDef(td(e.props.font));var k={fontSize:Jc[e.props.size],lineHeight:$c.lineHeight,fontFamily:co[e.props.font],padding:0,textAlign:"middle",width:c.w-8,verticalTextAlign:"middle",height:c.h,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},S=qc(this.editor,this.editor.textMeasure.measureTextSpans(e.props.text,k),k);S.setAttribute("fill",n[e.props.labelColor].solid),Array.from(S.children).forEach((function(e){var t=parseFloat(e.getAttribute("x")||"0"),n=parseFloat(e.getAttribute("y")||"0");e.setAttribute("x",t+4+c.x+"px"),e.setAttribute("y",n+c.y+"px")}));var _=S.cloneNode(!0);_.setAttribute("stroke-width","2"),_.setAttribute("fill",n.background),_.setAttribute("stroke",n.background),a.appendChild(_),a.appendChild(S)}return a}},{key:"getCanvasSvgDefs",value:function(){return[id()]}}]),r}(Uc);function ap(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",e),n.setAttribute("fill","arrow"===t?"none":"black"),n.setAttribute("stroke","none"),n}function sp(e,t,n,r,i){var o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d",e),o.setAttribute("fill","none"),o.setAttribute("stroke",i[t].solid),o.setAttribute("stroke-width",n+"");var a=zf({d:e,fill:r,color:t,theme:i});if(a){var s=document.createElementNS("http://www.w3.org/2000/svg","g");return s.appendChild(a),s.appendChild(o),s}return o}function up(e){return.5!==e.x||.5!==e.y}z(op,"type","arrow"),rp([ve],op.prototype,"infoCache",1),rp([ve],op.prototype,"labelBoundsCache",1);var lp=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("pointing",t)})),z(_t(e),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),z(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return L(n)}(If);z(lp,"id","idle");var cp=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shape",void 0),z(_t(e),"preciseTimeout",-1),z(_t(e),"didTimeout",!1),z(_t(e),"onEnter",(function(){var t=e.editor.inputs.currentPagePoint;e.didTimeout=!1,e.editor.mark("creating");var n=Wi();e.editor.createShapes([{id:n,type:"arrow",x:t.x,y:t.y}]);var r=e.editor.getShapeUtil(op),i=e.editor.getShapeById(n);if(i){var o=e.editor.getHandles(i);if(o){var a,s=e.editor.getPointInShapeSpace(i,t),u=null===(a=r.onHandleChange)||void 0===a?void 0:a.call(r,i,{handle:Ce(Ce({},o[0]),{},{x:s.x,y:s.y}),isPrecise:!0});if(u){var l,c=null===(l=u.props)||void 0===l?void 0:l.start;"binding"===(null===c||void 0===c?void 0:c.type)&&e.editor.setHintingIds([c.boundShapeId]),e.editor.updateShapes([u],!0)}}e.editor.select(n),e.shape=e.editor.getShapeById(n),e.startPreciseTimeout()}})),z(_t(e),"onExit",(function(){e.clearPreciseTimeout()})),z(_t(e),"onPointerMove",(function(){if(e.shape&&e.editor.inputs.isDragging){var t=e.editor.getHandles(e.shape);if(!t)throw e.editor.bailToMark("creating"),Error("No handles found");if(!e.didTimeout){var n=e.editor.getShapeUtil(op),r=e.editor.getShapeById(e.shape.id);if(!r)return;if(t){var i,o=e.editor.getPointInShapeSpace(r,e.editor.inputs.originPagePoint),a=o.x,s=o.y,u=null===(i=n.onHandleChange)||void 0===i?void 0:i.call(n,r,{handle:Ce(Ce({},t[0]),{},{x:a,y:s}),isPrecise:!1});u&&e.editor.updateShapes([u],!0)}}e.editor.setSelectedTool("select.dragging_handle",{shape:e.shape,handle:t.find((function(e){return"end"===e.id})),isCreating:!0,onInteractionEnd:"arrow"})}})),z(_t(e),"onPointerUp",(function(){e.cancel()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.cancel()})),z(_t(e),"onInterrupt",(function(){e.cancel()})),e}return L(n,[{key:"startPreciseTimeout",value:function(){var e=this;this.preciseTimeout=window.setTimeout((function(){e.isActive&&e.shape&&(e.didTimeout=!0)}),300)}},{key:"clearPreciseTimeout",value:function(){clearTimeout(this.preciseTimeout)}},{key:"cancel",value:function(){this.editor.bailToMark("creating"),this.editor.setHintingIds([]),this.parent.transition("idle",{})}}]),n}(If);z(cp,"id","pointing");var dp=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",op),e}return L(n)}(If);z(dp,"id","arrow"),z(dp,"initial","idle"),z(dp,"children",(function(){return[lp,cp]}));var fp=Ef("arrow",{util:op,props:yo,migrations:wo,tool:dp}),pp="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function hp(e){var t=e.url,n=e.zoomLevel;return(0,za.jsx)("a",{className:Ua("tl-hyperlink-button",{"tl-hyperlink-button__hidden":n<.32}),href:t,target:"_blank",rel:"noopener noreferrer",onPointerDown:vu,onPointerUp:vu,title:t,draggable:!1,children:(0,za.jsx)("div",{className:"tl-hyperlink-button__icon",style:{mask:'url("'.concat(pp,'") center 100% / 100% no-repeat'),WebkitMask:'url("'.concat(pp,'") center 100% / 100% no-repeat')}})})}var vp=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"canResize",(function(){return!1})),z(_t(e),"hideSelectionBoundsBg",(function(){return!0})),z(_t(e),"hideSelectionBoundsFg",(function(){return!0})),z(_t(e),"onBeforeCreate",(function(t){mp(e.editor,t)})),z(_t(e),"onBeforeUpdate",(function(t,n){if(t.props.url!==n.props.url){if(!uf(n.props.url))return Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{url:t.props.url})});mp(e.editor,n)}})),e}return L(n,[{key:"getDefaultProps",value:function(){return{url:"",w:300,h:320,assetId:null}}},{key:"component",value:function(e){var t=e.props.assetId?this.editor.getAssetById(e.props.assetId):null,n=this.editor.getPageRotation(e),r=gp(e);return(0,za.jsx)(zc,{children:(0,za.jsxs)("div",{className:"tl-bookmark__container tl-hitarea-stroke",style:{boxShadow:fu(n)},children:[(0,za.jsxs)("div",{className:"tl-bookmark__image_container",children:[null!==t&&void 0!==t&&t.props.image?(0,za.jsx)("img",{className:"tl-bookmark__image",draggable:!1,src:null===t||void 0===t?void 0:t.props.image,alt:(null===t||void 0===t?void 0:t.props.title)||""}):(0,za.jsx)("div",{className:"tl-bookmark__placeholder"}),(0,za.jsx)(hp,{url:e.props.url,zoomLevel:this.editor.zoomLevel})]}),(0,za.jsxs)("div",{className:"tl-bookmark__copy_container",children:[(null===t||void 0===t?void 0:t.props.title)&&(0,za.jsx)("h2",{className:"tl-bookmark__heading",children:hu((null===t||void 0===t?void 0:t.props.title)||"",54)}),(null===t||void 0===t?void 0:t.props.description)&&(0,za.jsx)("p",{className:"tl-bookmark__description",children:hu((null===t||void 0===t?void 0:t.props.description)||"",128)}),(0,za.jsx)("a",{className:"tl-bookmark__link",href:e.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:vu,onPointerUp:vu,onClick:vu,children:hu(r,45)})]})]})})}},{key:"indicator",value:function(e){return(0,za.jsx)("rect",{width:ys(e.props.w),height:ys(e.props.h),rx:"8",ry:"8"})}}]),n}(Vc);z(vp,"type","bookmark");var gp=function(e){try{var t=new URL(e.props.url),n=t.pathname.replace(/\/*$/,"");return"".concat(t.hostname).concat(n)}catch(ej){return e.props.url}};function mp(e,t){var n=t.props.url,r=Mi.createId(Be(n));e.getAssetById(r)?t.props.assetId!==r&&e.updateShapes([{id:t.id,type:t.type,props:{assetId:r}}]):(e.updateShapes([{id:t.id,type:t.type,props:{assetId:null}}]),yp(e,t))}var yp=De(function(){var e=Fa(Na().mark((function e(t,n){var r,i;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props.url,e.next=3,t.externalContentManager.createAssetFromUrl(t,r);case 3:if(i=e.sent){e.next=6;break}return e.abrupt("return");case 6:t.batch((function(){t.createAssets([i]),t.updateShapes([{id:n.id,type:n.type,props:{assetId:i.id}}])}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),500),bp=Ef("bookmark",{util:vp,props:ko,migrations:_o});function wp(){var e=Va();return _e("zoom",(function(){return e.zoomLevel<.35}),[e])}var xp=function(e){return.65*e+.35*Ja(e*$a/2)},kp=function(e){return{size:1+e,thinning:0,streamline:.62+(1+e)/8*.06,smoothing:.62,simulatePressure:!1,easing:Ya.linear}};function Sp(e){var t=e.strokeWidth,n=e.showAsComplete,r=e.isPen;return{size:1+t,thinning:.1,streamline:.5,smoothing:.5,simulatePressure:!r,easing:r?xp:Ya.easeOutSine,last:n}}function _p(e,t,n,r){return Ce(Ce({},r?kp(t):"draw"===e.dash?e.isPen?function(e){return{size:1+1.2*e,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:xp}}(t):function(e){return{size:1+e,thinning:.5,streamline:.62+(1+e)/8*.06,smoothing:.62,easing:Ya.easeOutSine,simulatePressure:!0}}(t):kp(t)),{},{last:e.isComplete||n})}function Pp(e){var t,n=[],r=J(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if("free"===i.type||i.points.length<2)n.push.apply(n,u(i.points.map(Xa.Cast)));else{var o=Math.max(4,Math.floor(Xa.Dist(i.points[0],i.points[1])/16));n.push.apply(n,u(Xa.PointsBetween(i.points[0],i.points[1],o)))}}}catch(a){r.e(a)}finally{r.f()}return n}function Ep(e,t){return{draw:"none",solid:"none",dotted:"0.1 ".concat(2*t),dashed:"".concat(2*t," ").concat(2*t)}[e.props.dash]}var Cp=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"hideResizeHandles",(function(e){return Tp(e)})),z(_t(e),"hideRotateHandle",(function(e){return Tp(e)})),z(_t(e),"hideSelectionBoundsBg",(function(e){return Tp(e)})),z(_t(e),"hideSelectionBoundsFg",(function(e){return Tp(e)})),z(_t(e),"isClosed",(function(e){return e.props.isClosed})),z(_t(e),"onResize",(function(e,t){var n,r=t.scaleX,i=t.scaleY,o=[],a=J(e.props.segments);try{for(a.s();!(n=a.n()).done;){var s=n.value;o.push(Ce(Ce({},s),{},{points:s.points.map((function(e){var t=e.x,n=e.y,o=e.z;return{x:bs(r*t),y:bs(i*n),z:o}}))}))}}catch(u){a.e(u)}finally{a.f()}return{props:{segments:o}}})),e}return L(n,[{key:"getDefaultProps",value:function(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1}}},{key:"getBounds",value:function(e){return ks.FromPoints(this.editor.getOutline(e))}},{key:"getOutline",value:function(e){return Pp(e.props.segments)}},{key:"getCenter",value:function(e){return this.editor.getBounds(e).center}},{key:"hitTestPoint",value:function(e,t){var n=this.editor.getOutline(e),r=this.editor.zoomLevel,i=Gc[e.props.size]/r;if(1===e.props.segments.length&&e.props.segments[0].points.length<4&&e.props.segments[0].points.some((function(e){return Xa.Dist(t,e)<1.5*i})))return!0;if(this.isClosed(e))return ms(t,n);if(this.editor.getBounds(e).containsPoint(t))for(var o=0;o<n.length;o++){var a=n[o],s=n[(o+1)%n.length];if(Xa.DistanceToLineSegment(a,s,t)<i)return!0}return!1}},{key:"hitTestLineSegment",value:function(e,t,n){var r=this.editor.getOutline(e);if(1===e.props.segments.length&&e.props.segments[0].points.length<4){var i=this.editor.zoomLevel,o=Gc[e.props.size]/i;if(e.props.segments[0].points.some((function(e){return Xa.DistanceToLineSegment(t,n,e)<1.5*o})))return!0}if(this.isClosed(e))for(var a=0;a<r.length;a++){var s=r[a],u=r[(a+1)%r.length];if(Xs(t,n,s,u))return!0}else for(var l=0;l<r.length-1;l++){var c=r[l],d=r[l+1];if(Xs(t,n,c,d))return!0}return!1}},{key:"component",value:function(e){var t,n=Af(),r=wp(),i=Gc[e.props.size],o=Pp(e.props.segments),a=e.props.isComplete||"straight"===(null===(t=Me(e.props.segments))||void 0===t?void 0:t.type),s=i;r||e.props.isPen||"draw"!==e.props.dash||1!==o.length||(s+=Fe(e.id)()*(i/6));var u=_p(e.props,s,a,r),l=Ds(o,u),c=l.length>1?wu(l,e.props.isClosed):Ip(o[0],s);if(!r&&"draw"===e.props.dash||l.length<2){Bs(l,u);var d=Os(l,u);return(0,za.jsxs)(Mf,{id:e.id,children:[(0,za.jsx)(Of,{fill:e.props.isClosed?e.props.fill:"none",color:e.props.color,d:c}),(0,za.jsx)("path",{d:bu(d,!0),strokeLinecap:"round",fill:n[e.props.color].solid})]})}return(0,za.jsxs)(Mf,{id:e.id,children:[(0,za.jsx)(Of,{color:e.props.color,fill:e.props.isClosed?e.props.fill:"none",d:c}),(0,za.jsx)("path",{d:c,strokeLinecap:"round",fill:"none",stroke:n[e.props.color].solid,strokeWidth:i,strokeDasharray:Ep(e,i),strokeDashoffset:"0"})]})}},{key:"indicator",value:function(e){var t,n=wp(),r=Gc[e.props.size],i=Pp(e.props.segments),o=r;n||e.props.isPen||"draw"!==e.props.dash||1!==i.length||(o+=Fe(e.id)()*(r/6));var a=e.props.isComplete||"straight"===(null===(t=Me(e.props.segments))||void 0===t?void 0:t.type),s=Ds(i,_p(e.props,o,a,!0)),u=s.length>1?wu(s,e.props.isClosed):Ip(i[0],o);return(0,za.jsx)("path",{d:u})}},{key:"toSvg",value:function(e,t){var n,r=eo(this.editor);t.addExportDef(rd(e.props.fill,r));var i=e.props.color,o=Gc[e.props.size],a=Pp(e.props.segments),s=e.props.isComplete||"straight"===(null===(n=Me(e.props.segments))||void 0===n?void 0:n.type),u=o;e.props.isPen||"draw"!==e.props.dash||1!==a.length||(u+=Fe(e.id)()*(o/6));var l,c=_p(e.props,u,s,!1),d=Ds(a,c),f=d.length>1?wu(d,e.props.isClosed):Ip(a[0],u);if("draw"===e.props.dash||d.length<2){Bs(d,c);var p=Os(d,c),h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("d",bu(p,!0)),h.setAttribute("fill",r[i].solid),h.setAttribute("stroke-linecap","round"),l=h}else{var v=document.createElementNS("http://www.w3.org/2000/svg","path");v.setAttribute("d",f),v.setAttribute("stroke",r[i].solid),v.setAttribute("fill","none"),v.setAttribute("stroke-linecap","round"),v.setAttribute("stroke-width",o.toString()),v.setAttribute("stroke-dasharray",Ep(e,o)),v.setAttribute("stroke-dashoffset","0"),l=v}var g=zf({fill:e.props.isClosed?e.props.fill:"none",d:f,color:e.props.color,theme:r});if(g){var m=document.createElementNS("http://www.w3.org/2000/svg","g");return m.appendChild(g),m.appendChild(l),m}return l}},{key:"getCanvasSvgDefs",value:function(){return[id()]}},{key:"expandSelectionOutlinePx",value:function(e){var t="draw"===e.props.dash?1.6:1;return Gc[e.props.size]*t/2}}]),n}(Uc);function Ip(e,t){var n=.5*(t+1);return"M ".concat(e.x," ").concat(e.y," m -").concat(n,", 0 a ").concat(n,",").concat(n," 0 1,0 ").concat(2*n,",0 a ").concat(n,",").concat(n," 0 1,0 -").concat(2*n,",0")}function Tp(e){return 1===e.props.segments.length&&e.props.segments[0].points.length<2}z(Cp,"type","draw");var Mp=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"hideResizeHandles",(function(e){return zp(e)})),z(_t(e),"hideRotateHandle",(function(e){return zp(e)})),z(_t(e),"hideSelectionBoundsBg",(function(e){return zp(e)})),z(_t(e),"hideSelectionBoundsFg",(function(e){return zp(e)})),z(_t(e),"onResize",(function(e,t){var n,r=t.scaleX,i=t.scaleY,o=[],a=J(e.props.segments);try{for(a.s();!(n=a.n()).done;){var s=n.value;o.push(Ce(Ce({},s),{},{points:s.points.map((function(e){var t=e.x,n=e.y,o=e.z;return{x:r*t,y:i*n,z:o}}))}))}}catch(u){a.e(u)}finally{a.f()}return{props:{segments:o}}})),e}return L(n,[{key:"getDefaultProps",value:function(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1}}},{key:"getBounds",value:function(e){return ks.FromPoints(this.editor.getOutline(e))}},{key:"getOutline",value:function(e){return Pp(e.props.segments)}},{key:"getCenter",value:function(e){return this.editor.getBounds(e).center}},{key:"hitTestPoint",value:function(e,t){var n=this.editor.getOutline(e),r=this.editor.zoomLevel,i=Lp(e)/r;if(1===e.props.segments.length&&e.props.segments[0].points.length<4&&e.props.segments[0].points.some((function(e){return Xa.Dist(t,e)<1.5*i})))return!0;if(this.editor.getBounds(e).containsPoint(t))for(var o=0;o<n.length;o++){var a=n[o],s=n[(o+1)%n.length];if(Xa.DistanceToLineSegment(a,s,t)<i)return!0}return!1}},{key:"hitTestLineSegment",value:function(e,t,n){var r=this.editor.getOutline(e);if(1===e.props.segments.length&&e.props.segments[0].points.length<4){var i=this.editor.zoomLevel,o=Lp(e)/i;if(e.props.segments[0].points.some((function(e){return Xa.DistanceToLineSegment(t,n,e)<1.5*o})))return!0}for(var a=0;a<r.length-1;a++){var s=r[a],u=r[a+1];if(Xs(t,n,s,u))return!0}return!1}},{key:"component",value:function(e){return(0,za.jsx)(Ap,{strokeWidth:Lp(e),shape:e,opacity:.35})}},{key:"backgroundComponent",value:function(e){return(0,za.jsx)(Ap,{strokeWidth:Lp(e),shape:e,opacity:.82})}},{key:"indicator",value:function(e){var t,n=wp(),r=Lp(e),i=Pp(e.props.segments),o=r;n||e.props.isPen||1!==i.length||(o+=Fe(e.id)()*(r/6));var a,s=Ds(i,Sp({strokeWidth:r,showAsComplete:e.props.isComplete||"straight"===(null===(t=Me(e.props.segments))||void 0===t?void 0:t.type),isPen:e.props.isPen}));return a=s.length<2?function(e,t){var n=t/2;return"M ".concat(e.x," ").concat(e.y," m -").concat(n,", 0 a ").concat(n,",").concat(n," 0 1,0 ").concat(2*n,",0 a ").concat(n,",").concat(n," 0 1,0 -").concat(2*n,",0")}(i[0],o):wu(s,!1),(0,za.jsx)("path",{d:a})}},{key:"expandSelectionOutlinePx",value:function(e){return Lp(e)/2}},{key:"toSvg",value:function(e){var t=eo(this.editor);return Op(Lp(e),e,.35,t)}},{key:"toBackgroundSvg",value:function(e){var t=eo(this.editor);return Op(Lp(e),e,.82,t)}}]),n}(Uc);function jp(e,t,n){var r,i=Pp(e.props.segments),o=e.props.isComplete||"straight"===(null===(r=Me(e.props.segments))||void 0===r?void 0:r.type),a=t;n||e.props.isPen||1!==i.length||(a+=Fe(e.id)()*(t/6));var s=Ds(i,Sp({strokeWidth:a,showAsComplete:o,isPen:e.props.isPen})),u=s.length>1?wu(s,!1):function(e){var t=.1;return"M ".concat(e.x," ").concat(e.y," m -").concat(t,", 0 a ").concat(t,",").concat(t," 0 1,0 ").concat(.2,",0 a ").concat(t,",").concat(t," 0 1,0 -").concat(.2,",0")}(i[0]);return{solidStrokePath:u,sw:a}}function Ap(e){var n=e.strokeWidth,r=e.shape,i=e.opacity,o=Af(),a=jp(r,n,wp()),s=a.solidStrokePath,u=a.sw,l=function(){var e=G((0,t.useState)(!1),2),n=e[0],r=e[1];return(0,t.useEffect)((function(){var e=CSS.supports("color","color(display-p3 1 1 1)"),t=matchMedia("(color-gamut: p3)");r(e&&t.matches);var n=function(){return r(e&&t.matches)};return t.addEventListener("change",n),function(){return t.removeEventListener("change",n)}}),[]),_e(tu.forceSrgb)||!n?"srgb":"p3"}(),c=o[r.props.color].highlight[l];return(0,za.jsx)(Mf,{id:r.id,style:{opacity:i},children:(0,za.jsx)("path",{d:s,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:c,strokeWidth:u})})}function Op(e,t,n,r){var i=jp(t,e,!1),o=i.solidStrokePath,a=i.sw,s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",o),s.setAttribute("fill","none"),s.setAttribute("stroke",r[t.props.color].highlight.srgb),s.setAttribute("stroke-width","".concat(a)),s.setAttribute("opacity","".concat(n)),s}function Lp(e){return 1.12*Qc[e.props.size]}function zp(e){return 1===e.props.segments.length&&e.props.segments[0].points.length<2}z(Mp,"type","highlight");var Dp=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"initialShape",void 0),z(_t(e),"shapeType","highlight"===e.parent.id?Mp:Cp),z(_t(e),"util",e.editor.getShapeUtil(e.shapeType)),z(_t(e),"isPen",!1),z(_t(e),"segmentMode","free"),z(_t(e),"didJustShiftClickToExtendPreviousShapeLine",!1),z(_t(e),"pagePointWhereCurrentSegmentChanged",{}),z(_t(e),"pagePointWhereNextSegmentChanged",null),z(_t(e),"lastRecordedPoint",{}),z(_t(e),"mergeNextPoint",!1),z(_t(e),"currentLineLength",0),z(_t(e),"canDraw",!1),z(_t(e),"onEnter",(function(t){e.info=t,e.canDraw=!e.editor.isMenuOpen,e.lastRecordedPoint=e.editor.inputs.currentPagePoint.clone(),e.canDraw&&e.startShape()})),z(_t(e),"onPointerMove",(function(){var t=_t(e).editor.inputs;e.isPen!==t.isPen&&e.cancel(),!e.canDraw&&t.isDragging&&(e.startShape(),e.canDraw=!0),e.canDraw&&(t.isPen?Xa.Dist(t.currentPagePoint,e.lastRecordedPoint)>=1/e.editor.zoomLevel?(e.lastRecordedPoint=t.currentPagePoint.clone(),e.mergeNextPoint=!1):e.mergeNextPoint=!0:e.mergeNextPoint=!1,e.updateShapes())})),z(_t(e),"onKeyDown",(function(t){if("Shift"===t.key)switch(e.segmentMode){case"free":e.segmentMode="starting_straight",e.pagePointWhereNextSegmentChanged=e.editor.inputs.currentPagePoint.clone();break;case"starting_free":e.segmentMode="starting_straight"}e.updateShapes()})),z(_t(e),"onKeyUp",(function(t){if("Shift"===t.key)switch(e.editor.snaps.clear(),e.segmentMode){case"straight":e.segmentMode="starting_free",e.pagePointWhereNextSegmentChanged=e.editor.inputs.currentPagePoint.clone();break;case"starting_straight":e.pagePointWhereNextSegmentChanged=null,e.segmentMode="free"}e.updateShapes()})),z(_t(e),"onExit",(function(){e.editor.snaps.clear(),e.pagePointWhereCurrentSegmentChanged=e.editor.inputs.currentPagePoint.clone()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onInterrupt",(function(){e.editor.inputs.isDragging||(e.editor.bail(),e.cancel())})),e}return L(n,[{key:"canClose",value:function(){return"highlight"!==this.shapeType.type}},{key:"getIsClosed",value:function(e,t){if(!this.canClose())return!1;var n=Gc[t],r=e[0].points[0],i=e[e.length-1],o=i.points[i.points.length-1];return r!==o&&this.currentLineLength>4*n&&Xa.Dist(r,o)<2*n}},{key:"startShape",value:function(){var e=this.editor.inputs,t=e.originPagePoint,n=e.isPen;this.editor.mark("draw create start"),this.isPen=n;var r=this.isPen?1.25*this.info.point.z:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=t.clone(),this.initialShape){var i=this.editor.getShapeById(this.initialShape.id);if(i&&"straight"===this.segmentMode){this.didJustShiftClickToExtendPreviousShapeLine=!0;var o=Me(i.props.segments);if(!o)throw Error("Expected a previous segment!");var a=Me(o.points);if(!a)throw Error("Expected a previous point!");var s=this.editor.getPointInShapeSpace(i,t).toFixed(),l=s.x,c=s.y,d=this.isPen?1.25*this.info.point.z:.5,f={type:this.segmentMode,points:[{x:a.x,y:a.y,z:+d.toFixed(2)},{x:l,y:c,z:+d.toFixed(2)}]},p=Ms.applyToPoint(this.editor.getPageTransformById(i.id),a);this.pagePointWhereCurrentSegmentChanged=p,this.pagePointWhereNextSegmentChanged=null;var h=[].concat(u(i.props.segments),[f]);this.currentLineLength=this.getLineLength(h);var v={id:i.id,type:this.shapeType.type,props:{segments:h}};return this.canClose()&&(v.props.isClosed=this.getIsClosed(h,i.props.size)),void this.editor.updateShapes([v])}}this.pagePointWhereCurrentSegmentChanged=t.clone();var g=Wi();this.editor.createShapes([{id:g,type:this.shapeType.type,x:t.x,y:t.y,props:{isPen:this.isPen,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+r.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShapeById(g)}},{key:"updateShapes",value:function(){var e=this.editor.inputs,t=this.initialShape;if(t){var n=t.id,r=t.props.size,i=this.editor.getShapeById(n);if(i){var o=i.props.segments,a=this.editor.getPointInShapeSpace(i,e.currentPagePoint).toFixed(),s=a.x,l=a.y,c=a.z,d={x:s,y:l,z:this.isPen?+(1.25*c).toFixed(2):.5};switch(this.segmentMode){case"starting_straight":var f=this.pagePointWhereNextSegmentChanged;if(null===f)throw Error("We should have a point where the segment changed");if(Xa.Dist(f,e.currentPagePoint)>4){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";var p=Me(o);if(!p)throw Error("Expected a previous segment!");var h,v=Me(p.points);if(!v)throw Error("Expected a previous last point!");var g=this.editor.getPointInShapeSpace(i,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if("straight"===p.type){this.currentLineLength+=Xa.Dist(v,g),h={type:"straight",points:[Ce({},v),g]};var m=this.editor.getPageTransform(i);this.pagePointWhereCurrentSegmentChanged=Ms.applyToPoint(m,v)}else h={type:"straight",points:[g,d]};var y={id:n,type:this.shapeType.type,props:{segments:[].concat(u(o),[h])}};this.canClose()&&(y.props.isClosed=this.getIsClosed(o,r)),this.editor.updateShapes([y],!0)}break;case"starting_free":var b=this.pagePointWhereNextSegmentChanged;if(null===b)throw Error("We should have a point where the segment changed");if(Xa.Dist(b,e.currentPagePoint)>4){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";var w=o.slice(),x=Me(w[w.length-1].points);if(!x)throw Error("No previous point!");var k={type:"free",points:u(Xa.PointsBetween(x,d,6).map((function(e){return e.toFixed().toJson()})))},S=[].concat(u(w),[k]);this.currentLineLength=this.getLineLength(S);var _={id:n,type:this.shapeType.type,props:{segments:S}};this.canClose()&&(_.props.isClosed=this.getIsClosed(S,r)),this.editor.updateShapes([_],!0)}break;case"straight":var P,E=o.slice(),C=E[E.length-1],I=this.pagePointWhereCurrentSegmentChanged,T=this.editor.inputs,M=T.currentPagePoint,j=T.ctrlKey;if(!I)throw Error("We should have a point where the segment changed");var A=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(A=!j,this.didJustShiftClickToExtendPreviousShapeLine=!1):A=!j;var O=this.editor.getPointInShapeSpace(i,M).toFixed().toJson(),L=!1,z=void 0;if((this.editor.isSnapMode?!j:j)&&E.length>2){for(var D=void 0,R=8/this.editor.zoomLevel,N=0,B=o.length-2;N<B;N++){var F=o[N];if(!F)break;if("free"!==F.type){var U=F.points[0],K=Me(F.points);if(U&&K){var V=Xa.NearestPointOnLineSegment(U,K,O),W=Xa.Dist(V,O);if(W<R){D=V.toFixed().toJson(),R=W,z=F;break}}}}D&&(L=!0,O=D)}if(L&&z){var H=this.editor.getPageTransform(i),Y=z.points[0],X=Me(z.points);if(!X)throw Error("Expected a last point!");var q=Ms.applyToPoint(H,Y),$=Ms.applyToPoint(H,X),G=Ms.applyToPoint(H,O);this.editor.snaps.setLines([{id:of(),type:"points",points:[q,G,$]}])}else{if(this.editor.snaps.clear(),A){var Q=Xa.Angle(I,M),Z=ls(Q,24)-Q;P=Xa.RotWith(M,I,Z)}else P=M;O=this.editor.getPointInShapeSpace(i,P).toFixed().toJson()}this.currentLineLength+=Xa.Dist(C.points[0],O),E[E.length-1]=Ce(Ce({},C),{},{type:"straight",points:[C.points[0],O]});var J={id:n,type:this.shapeType.type,props:{segments:E}};this.canClose()&&(J.props.isClosed=this.getIsClosed(o,r)),this.editor.updateShapes([J],!0);break;case"free":var ee=o.slice(),te=ee[ee.length-1],ne=u(te.points);if(ne.length&&this.mergeNextPoint){var re=ne[ne.length-1].z;ne[ne.length-1]={x:d.x,y:d.y,z:re?Math.max(re,d.z):d.z}}else this.currentLineLength+=Xa.Dist(ne[ne.length-1],d),ne.push(d);ee[ee.length-1]=Ce(Ce({},te),{},{points:ne}),this.currentLineLength=this.getLineLength(ee);var ie={id:n,type:this.shapeType.type,props:{segments:ee}};if(this.canClose()&&(ie.props.isClosed=this.getIsClosed(ee,r)),this.editor.updateShapes([ie],!0),ne.length>500){this.editor.updateShapes([{id:n,type:this.shapeType.type,props:{isComplete:!0}}]);var oe=this.editor.inputs.currentPagePoint,ae=Wi();this.editor.createShapes([{id:ae,type:this.shapeType.type,x:bs(oe.x),y:bs(oe.y),props:{isPen:this.isPen,segments:[{type:"free",points:[{x:0,y:0,z:this.isPen?+(1.25*c).toFixed():.5}]}]}}]),this.initialShape=it(this.editor.getShapeById(ae)),this.mergeNextPoint=!1,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.currentLineLength=0}}}}}},{key:"getLineLength",value:function(e){var t,n=0,r=J(e);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,o=0;o<i.points.length-1;o++){var a=i.points[o],s=i.points[o+1];n+=Xa.Sub(s,a).len2()}}catch(u){r.e(u)}finally{r.f()}return Math.sqrt(n)}},{key:"complete",value:function(){if(this.canDraw){var e=this.initialShape;e&&(this.editor.updateShapes([{id:e.id,type:e.type,props:{isComplete:!0}}]),this.parent.transition("idle",{}))}else this.cancel()}},{key:"cancel",value:function(){this.parent.transition("idle",this.info)}}]),n}(If);z(Dp,"id","drawing");var Rp=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("drawing",t)})),z(_t(e),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),z(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return L(n)}(If);z(Rp,"id","idle");var Np=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",Cp),z(_t(e),"onExit",(function(){e.children.drawing.initialShape=void 0})),e}return L(n)}(If);z(Np,"id","draw"),z(Np,"initial","idle"),z(Np,"children",(function(){return[Rp,Dp]}));var Bp=Ef("draw",{util:Cp,props:Co,migrations:To,tool:Np}),Fp=Ef("embed",{util:Wc,props:No,migrations:Ko}),Up=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("pointing",t)})),z(_t(e),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),z(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return L(n)}(If);z(Up,"id","idle");var Kp=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"markId","creating"),z(_t(e),"wasFocusedOnEnter",!1),z(_t(e),"onEnter",(function(){var t=e.editor.isMenuOpen;e.wasFocusedOnEnter=!t})),z(_t(e),"onPointerMove",(function(t){if(e.editor.inputs.isDragging){var n=e.editor.inputs.originPagePoint,r=e.parent.shapeType.type,i=Wi();e.editor.mark(e.markId),e.editor.createShapes([{id:i,type:r,x:n.x,y:n.y,props:{w:1,h:1}}],!0),e.editor.setSelectedTool("select.resizing",Ce(Ce({},t),{},{target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:e.parent.id}))}})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onInterrupt",(function(){e.cancel()})),e}return L(n,[{key:"complete",value:function(){var e=this.editor.inputs.originPagePoint;if(this.wasFocusedOnEnter){this.editor.mark(this.markId);var t=this.parent.shapeType.type,n=Wi();this.editor.mark(this.markId),this.editor.createShapes([{id:n,type:t,x:e.x,y:e.y}]);var r=this.editor.getShapeById(n),i=this.editor.getShapeUtil(r).getDefaultProps(),o=i.w,a=i.h,s=this.editor.getDeltaInParentSpace(r,new Xa(o/2,a/2));this.editor.updateShapes([{id:n,type:t,x:r.x-s.x,y:r.y-s.y}]),this.editor.setSelectedIds([n]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setSelectedTool("select.idle")}}},{key:"cancel",value:function(){this.parent.transition("idle",{})}}]),n}(If);z(Kp,"id","pointing");var Vp=function(e){Et(n,e);var t=Tt(n);function n(){return M(this,n),t.apply(this,arguments)}return L(n)}(If);function Wp(e){var t=e.bounds,n=e.zoomLevel,r=e.className;return(0,za.jsx)("g",{className:r,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:t.sides.map((function(e,t){var r=jf(e[0].dist(e[1]),1/n,{style:"dashed",lengthRatio:4}),i=r.strokeDasharray,o=r.strokeDashoffset;return(0,za.jsx)("line",{x1:e[0].x,y1:e[0].y,x2:e[1].x,y2:e[1].y,strokeDasharray:i,strokeDashoffset:o},t)}))})}z(Vp,"id","box"),z(Vp,"initial","idle"),z(Vp,"children",(function(){return[Up,Kp]}));var Hp=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"type","group"),z(_t(e),"hideSelectionBoundsBg",(function(){return!1})),z(_t(e),"hideSelectionBoundsFg",(function(){return!0})),z(_t(e),"canBind",(function(){return!1})),z(_t(e),"onChildrenChange",(function(t){var n=e.editor.getSortedChildIds(t.id);return 0===n.length?(e.editor.pageState.focusLayerId===t.id&&e.editor.popFocusLayer(),void e.editor.deleteShapes([t.id])):1===n.length?(e.editor.pageState.focusLayerId===t.id&&e.editor.popFocusLayer(),e.editor.reparentShapesById(n,t.parentId),void e.editor.deleteShapes([t.id])):void 0})),e}return L(n,[{key:"getDefaultProps",value:function(){return{}}},{key:"getBounds",value:function(e){var t=this,n=this.editor.getSortedChildIds(e.id);if(0===n.length)return new ks;var r=n.flatMap((function(e){var n=t.editor.getShapeById(e);return t.editor.getOutlineById(e).map((function(e){return Ms.applyToPoint(t.editor.getTransform(n),e)}))}));return ks.FromPoints(r)}},{key:"getCenter",value:function(e){return this.editor.getBounds(e).center}},{key:"getOutline",value:function(e){return this.editor.getBounds(e).corners}},{key:"component",value:function(e){var t=this,r=this.editor,i=r.erasingIdsSet,o=r.pageState,a=o.hintingIds,s=o.focusLayerId,u=r.zoomLevel,l=i.has(e.id),c=a.length>0&&a.some((function(r){return r!==e.id&&t.editor.isShapeOfType(t.editor.getShapeById(r),n)}));if(!l&&(e.id!==s||c))return null;var d=this.editor.getBounds(e);return(0,za.jsx)(Mf,{id:e.id,children:(0,za.jsx)(Wp,{className:"tl-group",bounds:d,zoomLevel:u})})}},{key:"indicator",value:function(e){var t=this.editor.camera.z,n=this.editor.getBounds(e);return(0,za.jsx)(Wp,{className:"",bounds:n,zoomLevel:t})}}]),n}(Uc);z(Hp,"type","group");var Yp=(0,t.forwardRef)((function(e,n){var r=e.id,i=e.name,o=e.isEditing,a=Va(),s=(0,t.useCallback)((function(e){"Enter"===e.key&&(e.stopPropagation(),e.currentTarget.blur(),a.setEditingId(null))}),[a]),u=(0,t.useCallback)((function(e){var t=a.getShapeById(r);if(t){var n=t.props.name,i=e.currentTarget.value.trim();n!==i&&a.updateShapes([{id:r,type:"frame",props:{name:i}}],!0)}}),[r,a]),l=(0,t.useCallback)((function(e){var t=a.getShapeById(r);if(t){var n=t.props.name,i=e.currentTarget.value;n!==i&&a.updateShapes([{id:r,type:"frame",props:{name:i}}],!0)}}),[r,a]);return(0,za.jsxs)("div",{className:"tl-frame-label ".concat(o?"tl-frame-label__editing":""),children:[(0,za.jsx)("input",{className:"tl-frame-name-input",ref:n,style:{display:o?void 0:"none"},value:i,autoFocus:!0,onKeyDown:s,onBlur:u,onChange:l}),Xc(i,"Frame")+String.fromCharCode(8203)]})})),Xp=function(e){var n=e.id,r=e.name,i=e.width,o=e.height,a=is(Va().getPageRotationById(n)),s=Dc(n),u=(0,t.useRef)(null);(0,t.useEffect)((function(){var e=u.current;e&&s&&(e.focus(),e.select(),requestAnimationFrame((function(){document.activeElement!==e&&(e.focus(),e.select())})))}),[u,s]);var l,c=((a+Math.PI/4)*(2/Math.PI)+4)%4,d=["top","left","bottom","right"][Math.floor(c)];switch(d){case"top":l="";break;case"right":l="translate(".concat(ys(i),"px, 0px) rotate(90deg)");break;case"bottom":l="translate(".concat(ys(i),"px, ").concat(ys(o),"px) rotate(180deg)");break;case"left":l="translate(0px, ".concat(ys(o),"px) rotate(270deg)")}return(0,za.jsx)("div",{className:"tl-frame-heading",style:{overflow:s?"visible":"hidden",maxWidth:"calc(var(--tl-zoom) * ".concat("top"===d||"bottom"===d?Math.ceil(i):Math.ceil(o),"px + var(--space-5))"),bottom:Math.ceil(o),transform:"".concat(l," scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))")},children:(0,za.jsx)("div",{className:"tl-frame-heading-hit-area",children:(0,za.jsx)(Yp,{ref:u,id:n,name:r,isEditing:s})})})},qp=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"canBind",(function(){return!0})),z(_t(e),"canEdit",(function(){return!0})),z(_t(e),"canReceiveNewChildrenOfType",(function(e,t){return!e.isLocked})),z(_t(e),"canDropShapes",(function(e,t){return!e.isLocked})),z(_t(e),"onDragShapesOver",(function(t,n){return n.every((function(e){return e.parentId===t.id}))?{shouldHint:!1}:(e.editor.reparentShapesById(n.map((function(e){return e.id})),t.id),{shouldHint:!0})})),z(_t(e),"onDragShapesOut",(function(t,n){var r=e.editor.getShapeById(t.parentId);r&&e.editor.isShapeOfType(r,Hp)?e.editor.reparentShapesById(n.map((function(e){return e.id})),r.id):e.editor.reparentShapesById(n.map((function(e){return e.id})),e.editor.currentPageId)})),z(_t(e),"onResizeEnd",(function(t){var n,r=e.editor.getPageBounds(t),i=[],o=J(e.editor.getSortedChildIds(t.id));try{for(o.s();!(n=o.n()).done;){var a=n.value,s=e.editor.getPageBoundsById(a);r.includes(s)||i.push(a)}}catch(u){o.e(u)}finally{o.f()}i.length>0&&e.editor.reparentShapesById(i,e.editor.currentPageId)})),e}return L(n,[{key:"getDefaultProps",value:function(){return{w:320,h:180,name:""}}},{key:"component",value:function(e){var t=this.editor.getBounds(e),n=Af();return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsxs)(Mf,{children:[(0,za.jsx)("rect",{className:"tl-hitarea-stroke",width:t.width,height:t.height}),(0,za.jsx)("rect",{className:"tl-frame__body",width:t.width,height:t.height,fill:n.solid,stroke:n.text})]}),(0,za.jsx)(Xp,{id:e.id,name:e.props.name,width:t.width,height:t.height})]})}},{key:"toSvg",value:function(e){var t=eo(this.editor),n=document.createElementNS("http://www.w3.org/2000/svg","g"),r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttribute("width",e.props.w.toString()),r.setAttribute("height",e.props.h.toString()),r.setAttribute("fill",t.solid),r.setAttribute("stroke",t.black.solid),r.setAttribute("stroke-width","1"),r.setAttribute("rx","1"),r.setAttribute("ry","1"),n.appendChild(r);var i,o=((is(this.editor.getPageRotationById(e.id))+Math.PI/4)*(2/Math.PI)+4)%4;switch(["top","left","bottom","right"][Math.floor(o)]){case"top":default:i="";break;case"right":i="translate(".concat(ys(e.props.w),"px, 0px) rotate(90deg)");break;case"bottom":i="translate(".concat(ys(e.props.w),"px, ").concat(ys(e.props.h),"px) rotate(180deg)");break;case"left":i="translate(0px, ".concat(ys(e.props.h),"px) rotate(270deg)")}var a={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:e.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},s=this.editor.textMeasure.measureTextSpans(Xc(e.props.name,"Frame")+String.fromCharCode(8203),a),u=s[0],l=Me(s),c=l.box.w+l.box.x-u.box.x,d=qc(this.editor,s,Ce({offsetY:-a.height-2},a));d.style.setProperty("transform",i);var f=document.createElementNS("http://www.w3.org/2000/svg","rect");return f.setAttribute("x","-8px"),f.setAttribute("y",-a.height-4+"px"),f.setAttribute("width",c+16+"px"),f.setAttribute("height","".concat(a.height,"px")),f.setAttribute("rx","4px"),f.setAttribute("ry","4px"),f.setAttribute("fill",t.background),n.appendChild(f),n.appendChild(d),n}},{key:"indicator",value:function(e){var t=this.editor.getBounds(e);return(0,za.jsx)("rect",{width:ys(t.width),height:ys(t.height),className:"tl-frame-indicator"})}},{key:"providesBackgroundForChildren",value:function(){return!0}}]),n}(Vc);z(qp,"type","frame");var $p=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",qp),e}return L(n)}(Vp);z($p,"id","frame"),z($p,"initial","idle");var Gp=Ef("frame",{util:qp,props:Vo,migrations:Wo,tool:$p});function Qp(e){var t=e.bounds,n=e.editor,r=e.font,i=e.shape,o={fontSize:Zc[i.props.size],fontFamily:r,textAlign:i.props.align,verticalTextAlign:i.props.verticalAlign,width:Math.ceil(t.width),height:Math.ceil(t.height),padding:16,lineHeight:$c.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0},a=n.textMeasure.measureTextSpans(i.props.text,o),s=function(e,t,n,r){if(("start-legacy"===e||"end-legacy"===e)&&0!==n.length){var i,o=ks.From(n[0].box),a=J(n);try{for(a.s();!(i=a.n()).done;){var s=i.value.box;o.union(s)}}catch(u){a.e(u)}finally{a.f()}if("start-legacy"===e)return(r-2*t-o.width)/2;if("end-legacy"===e)return-(r-2*t-o.width)/2}}(i.props.align,16,a,t.width);return s&&(o.offsetX=s),qc(0,a,o)}var Zp=t.memo((function(e){var t=e.id,n=e.type,r=e.text,i=e.size,o=e.labelColor,a=e.font,s=e.align,u=e.verticalAlign,l=e.wrap,c=hd(t,n,r),d=c.rInput,f=c.isEmpty,p=c.isEditing,h=c.isEditableFromHover,v=c.handleFocus,g=c.handleChange,m=c.handleKeyDown,y=c.handleBlur,b=p||h,w=fd.normalizeTextForDom(r),x=w.trim().length>0,k=function(e){return"start-legacy"===e||"middle-legacy"===e||"end-legacy"===e}(s),S=Af();return(0,za.jsx)("div",{className:"tl-text-label","data-font":a,"data-align":s,"data-hastext":!f,"data-isediting":p,"data-textwrap":!!l,style:x||b?{justifyContent:"middle"===s||k?"center":s,alignItems:"middle"===u?"center":u}:void 0,children:(0,za.jsxs)("div",{className:"tl-text-label__inner",style:{fontSize:Zc[i],lineHeight:Zc[i]*$c.lineHeight+"px",minHeight:f?Zc[i]*$c.lineHeight+32:0,minWidth:f?33:0,color:S[o].solid},children:[(0,za.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:w}),b?(0,za.jsx)("textarea",{ref:d,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:p,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:r,onFocus:v,onChange:g,onKeyDown:m,onBlur:y,onContextMenu:vu}):null]})})})),Jp=t.memo((function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.dash,o=e.color,a=e.fill,s=Af(),u=t/2,l=n/2,c=Math.max(0,u-r/2),d=Math.max(0,l-r/2),f=rs(c,d),p=jf(f<64?2*f:f,r,{style:i,snap:4,closed:!0}),h=p.strokeDasharray,v=p.strokeDashoffset,g="M".concat(u-c,",").concat(l,"a").concat(c,",").concat(d,",0,1,1,").concat(2*c,",0a").concat(c,",").concat(d,",0,1,1,-").concat(2*c,",0");return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(Of,{d:g,color:o,fill:a}),(0,za.jsx)("path",{d:g,strokeWidth:r,width:ys(t),height:ys(n),fill:"none",stroke:s[o].solid,strokeDasharray:h,strokeDashoffset:v,pointerEvents:"all"})]})}));function eh(e,t){if(t>e){var n=e/2;return"\n    M0,".concat(n,"\n    a").concat(n,",").concat(n,",0,1,1,").concat(2*n,",0\n    L").concat(e,",").concat(t-n,"\n    a").concat(n,",").concat(n,",0,1,1,-").concat(2*n,",0\n    Z")}var r=t/2;return"\n    M".concat(r,",0\n    L").concat(e-r,",0\n    a").concat(r,",").concat(r,",0,1,1,0,").concat(2*r,"\n    L").concat(r,",").concat(t,"\n    a").concat(r,",").concat(r,",0,1,1,0,").concat(2*-r,"\n    Z")}function th(e,t){if(e>t){var n=t/2;return rs(n,n)+2*(e-2*n)}var r=e/2;return rs(r,r)+2*(t-2*r)}var nh=t.memo((function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.dash,o=e.color,a=e.fill,s=Af(),u=eh(t,n),l=th(t,n),c=jf(l<64?2*l:l,r,{style:i,snap:4,start:"outset",end:"outset",closed:!0}),d=c.strokeDasharray,f=c.strokeDashoffset;return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(Of,{d:u,color:o,fill:a}),(0,za.jsx)("path",{d:u,strokeWidth:r,width:ys(t),height:ys(n),fill:"none",stroke:s[o].solid,strokeDasharray:d,strokeDashoffset:f,pointerEvents:"all"})]})}));function rh(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.dash,o=e.color,a=e.theme,s=e.fill,u=eh(t,n),l=th(t,n),c=jf(l<64?2*l:l,r,{style:i,snap:4,closed:!0}),d=c.strokeDasharray,f=c.strokeDashoffset,p=document.createElementNS("http://www.w3.org/2000/svg","path");return p.setAttribute("d",u),p.setAttribute("stroke-width",r.toString()),p.setAttribute("width",t.toString()),p.setAttribute("height",n.toString()),p.setAttribute("fill","none"),p.setAttribute("stroke",a[o].solid),p.setAttribute("stroke-dasharray",d),p.setAttribute("stroke-dashoffset",f),Df(p,zf({d:u,fill:s,color:o,theme:a}))}var ih=t.memo((function(e){var t=e.dash,n=e.fill,r=e.color,i=e.strokeWidth,o=e.outline,a=e.lines,s=Af(),u="M"+o[0]+"L"+o.slice(1)+"Z";return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(Of,{d:u,fill:n,color:r}),a&&a.map((function(e,t){return(0,za.jsx)("path",{className:"tl-hitarea-stroke",fill:"none",d:"M".concat(e[0].x,",").concat(e[0].y,"L").concat(e[1].x,",").concat(e[1].y)},"line_bg_".concat(t))})),(0,za.jsxs)("g",{strokeWidth:i,stroke:s[r].solid,fill:"none",pointerEvents:"all",children:[Array.from(Array(o.length)).map((function(e,n){var r=o[n],a=o[(n+1)%o.length],s=jf(Xa.Dist(r,a),i,{style:t,start:"outset",end:"outset"}),u=s.strokeDasharray,l=s.strokeDashoffset;return(0,za.jsx)("line",{x1:r.x,y1:r.y,x2:a.x,y2:a.y,strokeDasharray:u,strokeDashoffset:l},n)})),a&&a.map((function(e,n){var o=G(e,2),a=o[0],u=o[1],l=jf(Xa.Dist(a,u),i,{style:t,start:"skip",end:"outset",snap:"dotted"===t?4:void 0}),c=l.strokeDasharray,d=l.strokeDashoffset;return(0,za.jsx)("path",{d:"M".concat(a.x,",").concat(a.y,"L").concat(u.x,",").concat(u.y),stroke:s[r].solid,strokeWidth:i,fill:"none",strokeDasharray:c,strokeDashoffset:d},"line_fg_".concat(n))}))]})]})}));t.memo((function(e){var t=e.id,n=e.w,r=e.h,i=e.strokeWidth,o=e.fill,a=e.color,s=Af(),u=uh(t,n,r,i),l=sh(t,n,r,i);return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(Of,{d:u,color:a,fill:o}),(0,za.jsx)("path",{d:l,fill:s[a].solid,strokeWidth:0,pointerEvents:"all"})]})}));function oh(e){return{size:1+e,thinning:.25,end:{taper:e},start:{taper:e},streamline:0,smoothing:1,simulatePressure:!1}}function ah(e,t,n,r){for(var i=Fe(e),o=t/2,a=n/2,s=rs(o,a),u=[],l=Qa*i(),c=Qa+Ga/2+Math.abs(i())*Ga,d=Math.max(16,s/10),f=0;f<d;f++){var p=f/(d-1),h=l+p*c,v=Math.cos(h),g=Math.sin(h);u.push(new Xa(o*v+.5*t+.05*i(),a*g+n/2+.05*i(),Math.min(1,.5+Math.abs(.5-(i()>0?Ya.easeInOutSine(p):Ya.easeInExpo(p)))/2)))}return Ds(u,oh(r))}function sh(e,t,n,r){var i=oh(r);return bu(Os(Bs(ah(e,t,n,r),i),i))}function uh(e,t,n,r){return wu(ah(e,t,n,r))}var lh=t.memo((function(e){var t=e.id,n=e.outline,r=e.lines,i=e.fill,o=e.color,a=e.strokeWidth,s=Af(),u=Qs(Zs(t,n,a/3,2*a,2));if(r){var l,c=J(r);try{for(c.s();!(l=c.n()).done;){var d=G(l.value,2),f=d[0],p=d[1];u+="M".concat(f.x,",").concat(f.y,"L").concat(p.x,",").concat(p.y)}}catch(v){c.e(v)}finally{c.f()}}var h=Qs(Zs(t,n,0,2*a,1));return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(Of,{d:h,fill:i,color:o}),(0,za.jsx)("path",{d:u,stroke:s[o].solid,strokeWidth:a,fill:"none"})]})}));var ch=t.memo((function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.fill,o=e.color,a=Af(),s=t/2,u=n/2,l=Math.max(0,s),c=Math.max(0,u),d="M".concat(s-l,",").concat(u,"a").concat(l,",").concat(c,",0,1,1,").concat(2*l,",0a").concat(l,",").concat(c,",0,1,1,-").concat(2*l,",0");return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(Of,{d:d,color:o,fill:i}),(0,za.jsx)("path",{d:d,stroke:a[o].solid,strokeWidth:r,fill:"none"})]})}));var dh=t.memo((function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.fill,o=e.color,a=Af(),s=fh(t,n);return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(Of,{d:s,color:o,fill:i}),(0,za.jsx)("path",{d:s,stroke:a[o].solid,strokeWidth:r,fill:"none"})]})}));function fh(e,t){var n;if(t>e){var r=e/2;n="\n    M0,".concat(r,"\n    a").concat(r,",").concat(r,",0,1,1,").concat(2*r,",0\n    L").concat(e,",").concat(t-r,"\n    a").concat(r,",").concat(r,",0,1,1,-").concat(2*r,",0\n    Z")}else{var i=t/2;n="\n    M".concat(i,",0\n    L").concat(e-i,",0\n    a").concat(i,",").concat(i,",0,1,1,0,").concat(2*i,"\n    L").concat(i,",").concat(t,"\n    a").concat(i,",").concat(i,",0,1,1,0,").concat(2*-i,"\n    Z")}return n}var ph=t.memo((function(e){var t=e.outline,n=e.lines,r=e.fill,i=e.color,o=e.strokeWidth,a=Af(),s="M"+t[0]+"L"+t.slice(1)+"Z";if(n){var u,l=J(n);try{for(l.s();!(u=l.n()).done;){var c=G(u.value,2),d=c[0],f=c[1];s+="M".concat(d.x,",").concat(d.y,"L").concat(f.x,",").concat(f.y)}}catch(p){l.e(p)}finally{l.f()}}return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(Of,{d:s,fill:r,color:i}),(0,za.jsx)("path",{d:s,stroke:a[i].solid,strokeWidth:o,fill:"none"})]})}));var hh=51,vh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"canEdit",(function(){return!0})),z(_t(e),"onEditEnd",(function(t){var n=t.id,r=t.type,i=t.props.text;i.trimEnd()!==t.props.text&&e.editor.updateShapes([{id:n,type:r,props:{text:i.trimEnd()}}])})),z(_t(e),"onResize",(function(t,n){var r=n.initialBounds,i=n.handle,o=n.newPoint,a=n.scaleX,s=n.scaleY,u=r.width*a,l=r.height*s,c=0,d=0;if(t.props.text.trim()){var f=Math.max(Math.abs(u),hh),p=Math.max(Math.abs(l),hh);f<hh&&p===hh&&(f=hh),f===hh&&p<hh&&(p=hh);var h=gh(e.editor,Ce(Ce({},t),{},{props:Ce(Ce({},t.props),{},{w:f,h:p})})),v=Math.max(Math.abs(u),h.w)*Math.sign(u),g=Math.max(Math.abs(l),h.h)*Math.sign(l);c=Math.abs(v)-Math.abs(u),d=Math.abs(g)-Math.abs(l),u=v,l=g}var m=new Xa(0,0);a<0&&(m.x+=u),"left"!==i&&"top_left"!==i&&"bottom_left"!==i||(m.x+=a<0?c:-c),s<0&&(m.y+=l),"top"!==i&&"top_left"!==i&&"top_right"!==i||(m.y+=s<0?d:-d);var y=m.rot(t.rotation).add(o);return{x:y.x,y:y.y,props:{w:Math.max(Math.abs(u),1),h:Math.max(Math.abs(l),1),growY:0}}})),z(_t(e),"onBeforeCreate",(function(t){if(!t.props.text)return t.props.growY?Ce(Ce({},t),{},{props:Ce(Ce({},t.props),{},{growY:0})}):void 0;var n=t.props.h,r=gh(e.editor,t).h,i=null;return r>n?i=r-n:t.props.growY&&(i=0),null!==i?Ce(Ce({},t),{},{props:Ce(Ce({},t.props),{},{growY:i})}):void 0})),z(_t(e),"onBeforeUpdate",(function(t,n){var r=t.props.text.trimEnd(),i=n.props.text.trimEnd();if(r!==i||t.props.font!==n.props.font||t.props.size!==n.props.size){if(r&&!i)return Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{growY:0})});var o=t.props.w,a=t.props.h,s=gh(e.editor,n),u=s.w,l=s.h;if(!r&&i&&1===i.length){var c=Math.max(o,u),d=Math.max(a,l);return t.props.w<hh&&t.props.h<hh&&(c=Math.max(c,hh),d=Math.max(d,hh),c=Math.max(c,d),d=Math.max(c,d)),Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{w:c,h:d,growY:0})})}var f=null;return l>a?f=l-a:t.props.growY&&(f=0),null!==f?Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{growY:f,w:Math.max(n.props.w,u)})}):u>t.props.w?Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{w:u})}):void 0}})),z(_t(e),"onDoubleClick",(function(t){if(e.editor.inputs.altKey)switch(t.props.geo){case"rectangle":return Ce(Ce({},t),{},{props:{geo:"check-box"}});case"check-box":return Ce(Ce({},t),{},{props:{geo:"rectangle"}})}})),e}return L(n,[{key:"getDefaultProps",value:function(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:""}}},{key:"hitTestLineSegment",value:function(e,t,n){for(var r=this.editor.getOutline(e),i=0;i<r.length;i++){if(Xs(t,n,r[i],r[(i+1)%r.length]))return!0}var o=mh(e.props,0);if(void 0!==o){var a,s=J(o);try{for(s.s();!(a=s.n()).done;){var u=G(a.value,2);if(Xs(t,n,u[0],u[1]))return!0}}catch(l){s.e(l)}finally{s.f()}}return!1}},{key:"hitTestPoint",value:function(e,t){var n=this.editor.getOutline(e);if("none"===e.props.fill){for(var r=this.editor.zoomLevel,i=Gc[e.props.size]/r,o=0;o<n.length;o++){var a=n[o],s=n[(o+1)%n.length];if(Xa.DistanceToLineSegment(a,s,t)<i)return!0}var u=mh(e.props,1);if(void 0!==u){var l,c=J(u);try{for(c.s();!(l=c.n()).done;){var d=G(l.value,2),f=d[0],p=d[1];if(Xa.DistanceToLineSegment(f,p,t)<i)return!0}}catch(h){c.e(h)}finally{c.f()}}return!1}return ms(t,n)}},{key:"getBounds",value:function(e){return new ks(0,0,e.props.w,e.props.h+e.props.growY)}},{key:"getCenter",value:function(e){return new Xa(e.props.w/2,(e.props.h+e.props.growY)/2)}},{key:"getOutline",value:function(e){var t=Math.max(1,e.props.w),n=Math.max(1,e.props.h+e.props.growY),r=t/2,i=n/2;switch(e.props.geo){case"triangle":return[new Xa(r,0),new Xa(t,n),new Xa(0,n)];case"diamond":return[new Xa(r,0),new Xa(t,i),new Xa(r,n),new Xa(0,i)];case"pentagon":return ps(t,n,5);case"hexagon":return ps(t,n,6);case"octagon":return ps(t,n,8);case"ellipse":var o=Math.pow(r-i,2)/Math.pow(r+i,2),a=$a*(r+i)*(1+3*o/(10+Math.sqrt(4-3*o))),s=Math.max(4,Math.ceil(a/10));s=4*Math.ceil(s/4);for(var u=Qa/s,l=Math.cos(u),c=Math.sin(u),d=0,f=1,p=1,h=Array(s),v=0;v<s;v++)h[v]=new Xa(r+r*f,i+i*d),p=l*f-c*d,d=c*f+l*d,f=p;return h;case"oval":var g=10,m=Array(20);if(n>t)for(var y=0;y<g;y++){var b=$a*y/8-$a,w=$a*y/8;m[y]=new Xa(r+r*Math.cos(b),r+r*Math.sin(b)),m[y+g]=new Xa(r+r*Math.cos(w),n-r+r*Math.sin(w))}else for(var x=0;x<g;x++){var k=$a*x/8-Ga,S=Ga+$a*-x/8;m[x]=new Xa(t-i+i*Math.cos(k),n-i+i*Math.sin(k)),m[x+g]=new Xa(i-i*Math.cos(S),n-i+i*Math.sin(S))}return m;case"star":var _=Qa/5/2,P=2*Math.floor(5/4),E=10-P,C=2*Math.floor(2.5),I=Math.cos(P*_-Ga)*t/2,T=Math.cos(E*_-Ga)*t/2,M=Math.sin(0*_-Ga)*n/2,j=Math.sin(C*_-Ga)*n/2,A=t-Math.abs(I-T),O=n-Math.abs(j-M),L=(t-(t/2+T-(t/2-I)))/2,z=(n-(n/2+M-(n/2-j)))/2,D=(t+A)/2,R=(n+O)/2,N=1*D/2,B=1*R/2;return Array.from(Array(10)).map((function(e,t){var n=t*_-Ga;return new Xa(L+(t%2?N:D)*Math.cos(n),z+(t%2?B:R)*Math.sin(n))}));case"rhombus":var F=Math.min(.38*t,.38*n);return[new Xa(F,0),new Xa(t,0),new Xa(t-F,n),new Xa(0,n)];case"rhombus-2":var U=Math.min(.38*t,.38*n);return[new Xa(0,0),new Xa(t-U,0),new Xa(t,n),new Xa(U,n)];case"trapezoid":var K=Math.min(.38*t,.38*n);return[new Xa(K,0),new Xa(t-K,0),new Xa(t,n),new Xa(0,n)];case"arrow-right":var V=.38*Math.min(t,n),W=.16*n;return[new Xa(0,W),new Xa(t-V,W),new Xa(t-V,0),new Xa(t,n/2),new Xa(t-V,n),new Xa(t-V,n-W),new Xa(0,n-W)];case"arrow-left":var H=.38*Math.min(t,n),Y=.16*n;return[new Xa(H,0),new Xa(H,Y),new Xa(t,Y),new Xa(t,n-Y),new Xa(H,n-Y),new Xa(H,n),new Xa(0,n/2)];case"arrow-up":var X=.16*t,q=.38*Math.min(t,n);return[new Xa(t/2,0),new Xa(t,q),new Xa(t-X,q),new Xa(t-X,n),new Xa(X,n),new Xa(X,q),new Xa(0,q)];case"arrow-down":var $=.16*t,G=.38*Math.min(t,n);return[new Xa($,0),new Xa(t-$,0),new Xa(t-$,n-G),new Xa(t,n-G),new Xa(t/2,n),new Xa(0,n-G),new Xa($,n-G)];case"check-box":case"x-box":case"rectangle":return[new Xa(0,0),new Xa(t,0),new Xa(t,n),new Xa(0,n)]}}},{key:"component",value:function(e){var t=this,n=e.id,r=e.type,i=e.props,o=wp(),a=Gc[i.size],s=i.w,u=i.color,l=i.labelColor,c=i.fill,d=i.dash,f=i.growY,p=i.font,h=i.align,v=i.verticalAlign,g=i.size,m=i.text;return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(Mf,{id:n,children:function(){var r=i.h+f;switch(i.geo){case"ellipse":if("solid"===d||"draw"===d&&o)return(0,za.jsx)(ch,{strokeWidth:a,w:s,h:r,color:u,fill:c});if("dashed"===d||"dotted"===d)return(0,za.jsx)(Jp,{id:n,strokeWidth:a,w:s,h:r,dash:"dashed"===d?d:"s"===g&&o?"dashed":d,color:u,fill:c});if("draw"===d)return(0,za.jsx)(ch,{strokeWidth:a,w:s,h:r,color:u,fill:c});break;case"oval":if("solid"===d||"draw"===d&&o)return(0,za.jsx)(dh,{strokeWidth:a,w:s,h:r,color:u,fill:c});if("dashed"===d||"dotted"===d)return(0,za.jsx)(nh,{id:n,strokeWidth:a,w:s,h:r,dash:"dashed"===d?d:"s"===g&&o?"dashed":d,color:u,fill:c});if("draw"===d)return(0,za.jsx)(dh,{strokeWidth:a,w:s,h:r,color:u,fill:c});break;default:var l=t.editor.getOutline(e),p=mh(e.props,a);if("solid"===d||"draw"===d&&o)return(0,za.jsx)(ph,{fill:c,color:u,strokeWidth:a,outline:l,lines:p});if("dashed"===d||"dotted"===d)return(0,za.jsx)(ih,{dash:"dashed"===d?d:"s"===g&&o?"dashed":d,fill:c,color:u,strokeWidth:a,outline:l,lines:p});if("draw"===d)return(0,za.jsx)(lh,{id:n,fill:c,color:u,strokeWidth:a,outline:l,lines:p})}}()}),(0,za.jsx)(Zp,{id:n,type:r,font:p,fill:c,size:g,align:h,verticalAlign:v,text:m,labelColor:l,wrap:!0}),e.props.url&&(0,za.jsx)(hp,{url:e.props.url,zoomLevel:this.editor.zoomLevel})]})}},{key:"indicator",value:function(e){var t=e.id,n=e.props,r=n.w,i=n.h,o=n.growY,a=n.size,s=wp(),u=Gc[a];switch(n.geo){case"ellipse":return"draw"!==n.dash||s?(0,za.jsx)("ellipse",{cx:r/2,cy:(i+o)/2,rx:r/2,ry:(i+o)/2}):(0,za.jsx)("path",{d:uh(t,r,i+o,u)});case"oval":return(0,za.jsx)("path",{d:fh(r,i+o)});default:var l,c=this.editor.getOutline(e);if("draw"!==n.dash||s)l="M"+c[0]+"L"+c.slice(1)+"Z";else l=Qs(Zs(t,c,0,2*u,1));var d=mh(e.props,u);if(d){var f,p=J(d);try{for(p.s();!(f=p.n()).done;){var h=G(f.value,2),v=h[0],g=h[1];l+="M".concat(v.x,",").concat(v.y,"L").concat(g.x,",").concat(g.y)}}catch(m){p.e(m)}finally{p.f()}}return(0,za.jsx)("path",{d:l})}}},{key:"toSvg",value:function(e,t){var n,r=e.id,i=e.props,o=Gc[i.size],a=eo(this.editor);switch(t.addExportDef(rd(e.props.fill,a)),i.geo){case"ellipse":switch(i.dash){case"draw":n=function(e){var t=e.id,n=e.w,r=e.h,i=e.strokeWidth,o=e.fill,a=e.color,s=e.theme,u=document.createElementNS("http://www.w3.org/2000/svg","path");return u.setAttribute("d",sh(t,n,r,i)),u.setAttribute("fill",s[a].solid),Df(u,zf({d:uh(t,n,r,i),fill:o,color:a,theme:s}))}({id:r,w:i.w,h:i.h,color:i.color,fill:i.fill,strokeWidth:o,theme:a});break;case"solid":n=function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.fill,o=e.color,a=e.theme,s=t/2,u=n/2,l=Math.max(0,s),c=Math.max(0,u),d="M".concat(s-l,",").concat(u,"a").concat(l,",").concat(c,",0,1,1,").concat(2*l,",0a").concat(l,",").concat(c,",0,1,1,-").concat(2*l,",0"),f=document.createElementNS("http://www.w3.org/2000/svg","path");return f.setAttribute("d",d),f.setAttribute("stroke-width",r.toString()),f.setAttribute("width",t.toString()),f.setAttribute("height",n.toString()),f.setAttribute("fill","none"),f.setAttribute("stroke",a[o].solid),Df(f,zf({d:d,fill:i,color:o,theme:a}))}({strokeWidth:o,w:i.w,h:i.h,color:i.color,fill:i.fill,theme:a});break;default:n=function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.dash,o=e.color,a=e.theme,s=e.fill,u=t/2,l=n/2,c=Math.max(0,u-r/2),d=Math.max(0,l-r/2),f=rs(c,d),p=jf(f<64?2*f:f,r,{style:i,snap:4,closed:!0}),h=p.strokeDasharray,v=p.strokeDashoffset,g="M".concat(u-c,",").concat(l,"a").concat(c,",").concat(d,",0,1,1,").concat(2*c,",0a").concat(c,",").concat(d,",0,1,1,-").concat(2*c,",0"),m=document.createElementNS("http://www.w3.org/2000/svg","path");return m.setAttribute("d",g),m.setAttribute("stroke-width",r.toString()),m.setAttribute("width",t.toString()),m.setAttribute("height",n.toString()),m.setAttribute("fill","none"),m.setAttribute("stroke",a[o].solid),m.setAttribute("stroke-dasharray",h),m.setAttribute("stroke-dashoffset",v),Df(m,zf({d:g,fill:s,color:o,theme:a}))}({id:r,strokeWidth:o,w:i.w,h:i.h,dash:i.dash,color:i.color,fill:i.fill,theme:a})}break;case"oval":switch(i.dash){case"draw":default:n=rh({id:r,strokeWidth:o,w:i.w,h:i.h,dash:i.dash,color:i.color,fill:i.fill,theme:a});break;case"solid":n=function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.fill,o=e.color,a=e.theme,s=fh(t,n),u=document.createElementNS("http://www.w3.org/2000/svg","path");return u.setAttribute("d",s),u.setAttribute("stroke-width",r.toString()),u.setAttribute("width",t.toString()),u.setAttribute("height",n.toString()),u.setAttribute("fill","none"),u.setAttribute("stroke",a[o].solid),Df(u,zf({d:s,fill:i,color:o,theme:a}))}({strokeWidth:o,w:i.w,h:i.h,color:i.color,fill:i.fill,theme:a})}break;default:var s=this.editor.getOutline(e),u=mh(e.props,o);switch(i.dash){case"draw":n=function(e){var t=e.id,n=e.outline,r=e.lines,i=e.fill,o=e.color,a=e.theme,s=e.strokeWidth,u=Qs(Zs(t,n,s/3,2*s,2));if(r){var l,c=J(r);try{for(c.s();!(l=c.n()).done;){var d=G(l.value,2),f=d[0],p=d[1];u+="M".concat(f.x,",").concat(f.y,"L").concat(p.x,",").concat(p.y)}}catch(g){c.e(g)}finally{c.f()}}var h=Qs(Zs(t,n,0,2*s,1)),v=document.createElementNS("http://www.w3.org/2000/svg","path");return v.setAttribute("d",u),v.setAttribute("fill","none"),v.setAttribute("stroke",a[o].solid),v.setAttribute("stroke-width",s.toString()),Df(v,zf({d:h,fill:i,color:o,theme:a}))}({id:r,fill:i.fill,color:i.color,strokeWidth:o,outline:s,lines:u,theme:a});break;case"solid":n=function(e){var t=e.outline,n=e.lines,r=e.fill,i=e.color,o=e.strokeWidth,a=e.theme,s="M"+t[0]+"L"+t.slice(1)+"Z",u=s,l=s;if(n){var c,d=J(n);try{for(d.s();!(c=d.n()).done;){var f=G(c.value,2),p=f[0],h=f[1];l+="M".concat(p.x,",").concat(p.y,"L").concat(h.x,",").concat(h.y)}}catch(g){d.e(g)}finally{d.f()}}var v=document.createElementNS("http://www.w3.org/2000/svg","path");return v.setAttribute("d",l),v.setAttribute("stroke-width",o.toString()),v.setAttribute("stroke",a[i].solid),v.setAttribute("fill","none"),Df(v,zf({d:u,fill:r,color:i,theme:a}))}({fill:i.fill,color:i.color,strokeWidth:o,outline:s,lines:u,theme:a});break;default:n=function(e){var t=e.dash,n=e.fill,r=e.color,i=e.theme,o=e.strokeWidth,a=e.outline,s=e.lines,u=document.createElementNS("http://www.w3.org/2000/svg","g");if(u.setAttribute("stroke-width",o.toString()),u.setAttribute("stroke",i[r].solid),u.setAttribute("fill","none"),Array.from(Array(a.length)).forEach((function(e,n){var r=a[n],i=a[(n+1)%a.length],s=jf(Xa.Dist(r,i),o,{style:t}),l=s.strokeDasharray,c=s.strokeDashoffset,d=document.createElementNS("http://www.w3.org/2000/svg","line");d.setAttribute("x1",r.x.toString()),d.setAttribute("y1",r.y.toString()),d.setAttribute("x2",i.x.toString()),d.setAttribute("y2",i.y.toString()),d.setAttribute("stroke-dasharray",l.toString()),d.setAttribute("stroke-dashoffset",c.toString()),u.appendChild(d)})),s){var l,c=J(s);try{for(c.s();!(l=c.n()).done;){var d=G(l.value,2),f=d[0],p=d[1],h=jf(Xa.Dist(f,p),o,{style:t,start:"skip",end:"skip",snap:"dotted"===t?4:2}),v=h.strokeDasharray,g=h.strokeDashoffset,m=document.createElementNS("http://www.w3.org/2000/svg","line");m.setAttribute("x1",f.x.toString()),m.setAttribute("y1",f.y.toString()),m.setAttribute("x2",p.x.toString()),m.setAttribute("y2",p.y.toString()),m.setAttribute("stroke-dasharray",v.toString()),m.setAttribute("stroke-dashoffset",g.toString()),u.appendChild(m)}}catch(b){c.e(b)}finally{c.f()}}var y=zf({d:"M"+a[0]+"L"+a.slice(1)+"Z",fill:n,color:r,theme:i});return Df(u,y)}({dash:i.dash,fill:i.fill,color:i.color,strokeWidth:o,outline:s,lines:u,theme:a})}}if(i.text){var l=this.editor.getBounds(e);t.addExportDef(td(e.props.font));var c=Qp({editor:this.editor,shape:e,font:co[e.props.font],bounds:l}),d=c.cloneNode(!0);d.setAttribute("fill",a[e.props.labelColor].solid),d.setAttribute("stroke","none");var f=c.cloneNode(!0);f.setAttribute("stroke-width","2"),f.setAttribute("fill",a.background),f.setAttribute("stroke",a.background);var p=document.createElementNS("http://www.w3.org/2000/svg","g");if(p.append(f),p.append(d),"g"===n.nodeName)return n.appendChild(p),n;var h=document.createElementNS("http://www.w3.org/2000/svg","g");return h.appendChild(n),h.appendChild(p),h}return n}},{key:"getCanvasSvgDefs",value:function(){return[id()]}}]),n}(Vc);function gh(e,t){var n=t.props.text.trimEnd();if(!n)return{w:0,h:0};var r=e.textMeasure.measureText("w",Ce(Ce({},$c),{},{fontFamily:ed[t.props.font],fontSize:Zc[t.props.size],width:"fit-content",maxWidth:"100px"})),i=e.textMeasure.measureText(n,Ce(Ce({},$c),{},{fontFamily:ed[t.props.font],fontSize:Zc[t.props.size],width:"fit-content",minWidth:r.w+"px",maxWidth:Math.max(0,Math.ceil(r.w+{s:2,m:3.5,l:5,xl:10}[t.props.size]),Math.ceil(t.props.w-32))+"px"}));return{w:i.w+32,h:i.h+32}}function mh(e,t){switch(e.geo){case"x-box":return function(e,t,n,r){var i="draw"===r?.62:0;if("dashed"===r)return[[new Xa(0,0),new Xa(e/2,t/2)],[new Xa(e,t),new Xa(e/2,t/2)],[new Xa(0,t),new Xa(e/2,t/2)],[new Xa(e,0),new Xa(e/2,t/2)]];return[[new Xa(n*i,n*i),new Xa(e-n*i,t-n*i)],[new Xa(n*i,t-n*i),new Xa(e-n*i,n*i)]]}(e.w,e.h,t,e.dash);case"check-box":return function(e,t){var n=.82*Math.min(e,t),r=(e-n)/2,i=(t-n)/2;return[[new Xa(r+.25*n,i+.52*n),new Xa(r+.45*n,i+.82*n)],[new Xa(r+.45*n,i+.82*n),new Xa(r+.82*n,i+.22*n)]]}(e.w,e.h);default:return}}z(vh,"type","geo");var yh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("pointing",t)})),z(_t(e),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),z(_t(e),"onKeyUp",(function(t){if("Enter"===t.key){var n=e.editor.onlySelectedShape;n&&e.editor.isShapeOfType(n,vh)&&(e.editor.mark("editing shape"),e.editor.setEditingId(n.id),e.editor.setSelectedTool("select.editing_shape",Ce(Ce({},t),{},{target:"shape",shape:n})))}})),z(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return L(n)}(If);z(yh,"id","idle");var bh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onPointerMove",(function(t){if(e.editor.inputs.isDragging){var n=e.editor.inputs.originPagePoint,r=Wi();e.editor.mark("creating"),e.editor.createShapes([{id:r,type:"geo",x:n.x,y:n.y,props:{w:1,h:1,geo:e.editor.getStyleForNextShape(Go)}}]),e.editor.select(r),e.editor.setSelectedTool("select.resizing",Ce(Ce({},t),{},{target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"}))}})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onInterrupt",(function(){e.cancel()})),e}return L(n,[{key:"complete",value:function(){var e=this.editor.inputs.originPagePoint,t=Wi();this.editor.mark("creating"),this.editor.createShapes([{id:t,type:"geo",x:e.x,y:e.y,props:{geo:this.editor.getStyleForNextShape(Go),w:1,h:1}}]);var n=this.editor.getShapeById(t);if(n){var r="star"===n.props.geo?function(e,t,n){var r=Qa/e/2,i=2*Math.floor(e/4),o=2*e-i,a=2*Math.floor(e/2),s=Math.cos(i*r-Ga)*t/2,u=Math.cos(o*r-Ga)*t/2,l=Math.sin(0*r-Ga)*n/2,c=Math.sin(a*r-Ga)*n/2;return new ks(0,0,s-u,c-l)}(5,200,200):new ks(0,0,200,200),i=this.editor.getDeltaInParentSpace(n,r.center);this.editor.select(t),this.editor.updateShapes([{id:n.id,type:"geo",x:n.x-i.x,y:n.y-i.y,props:{geo:this.editor.getStyleForNextShape(Go),w:r.width,h:r.height}}]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setSelectedTool("select",{})}}},{key:"cancel",value:function(){this.parent.transition("idle",{})}}]),n}(If);z(bh,"id","pointing");var wh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",vh),e}return L(n)}(If);z(wh,"id","geo"),z(wh,"initial","idle"),z(wh,"children",(function(){return[yh,bh]}));var xh=Ef("geo",{util:vh,props:Qo,migrations:ra,tool:wh}),kh=Ef("group",{util:Hp,props:{},migrations:ia}),Sh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",Mp),z(_t(e),"onExit",(function(){e.children.drawing.initialShape=void 0})),e}return L(n)}(If);z(Sh,"id","highlight"),z(Sh,"initial","idle"),z(Sh,"children",(function(){return[Rp,Dp]}));var _h=Ef("highlight",{util:Mp,props:oa,migrations:aa,tool:Sh});function Ph(e){var t=Va();return _e("isCropping",(function(){return t.croppingId===e}),[t,e])}var Eh=function(){var e=Fa(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new Image;r.onload=function(){return e(r)},r.onerror=function(){return n(new Error("Failed to load image"))},r.crossOrigin="anonymous",r.src=t})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ch=function(){var e=Fa(Na().mark((function e(t){var n,r,i;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Eh(t);case 2:if(n=e.sent,(r=document.createElement("canvas")).width=n.width,r.height=n.height,i=r.getContext("2d")){e.next=9;break}return e.abrupt("return");case 9:return i.drawImage(n,0,0),e.abrupt("return",r.toDataURL());case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Ih(e){return Th.apply(this,arguments)}function Th(){return(Th=Fa(Na().mark((function e(t){var n,r;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.blob();case 5:return r=e.sent,e.abrupt("return",new Promise((function(e,t){var n=new FileReader;n.onloadend=function(){return e(n.result)},n.onerror=t,n.readAsDataURL(r)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Mh=function(e){Et(r,e);var n=Tt(r);function r(){var e;M(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return z(_t(e=n.call.apply(n,[this].concat(i))),"isAspectRatioLocked",(function(){return!0})),z(_t(e),"canCrop",(function(){return!0})),z(_t(e),"onDoubleClick",(function(t){var n=t.props.assetId?e.editor.getAssetById(t.props.assetId):void 0;n&&(n.props.src&&"mimeType"in n.props&&"image/gif"===n.props.mimeType&&e.editor.updateShapes([{type:"image",id:t.id,props:{playing:!t.props.playing}}]))})),z(_t(e),"onDoubleClickEdge",(function(t){var n=t.props;if(n&&e.editor.croppingId===t.id){var r=We(n.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},i=1/(r.bottomRight.x-r.topLeft.x)*t.props.w,o=1/(r.bottomRight.y-r.topLeft.y)*t.props.h,a=new Xa(r.topLeft.x*i,r.topLeft.y*o).rot(t.rotation),s={id:t.id,type:t.type,x:t.x-a.x,y:t.y-a.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:i,h:o}};e.editor.updateShapes([s])}})),e}return L(r,[{key:"getDefaultProps",value:function(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}},{key:"component",value:function(e){var n,r,i=this,o=jh(e),a=Ph(e.id),s=pu(),u=G((0,t.useState)(""),2),l=u[0],c=u[1],d=e.props,f=d.w,p=d.h,h=e.props.assetId?this.editor.getAssetById(e.props.assetId):void 0;if("bookmark"===(null===h||void 0===h?void 0:h.type))throw Error("Bookmark assets can't be rendered as images");var v=_e("onlySelectedShape",(function(){var t;return e.id===(null===(t=i.editor.onlySelectedShape)||void 0===t?void 0:t.id)}),[this.editor])&&a&&this.editor.isInAny("select.crop","select.cropping","select.pointing_crop_handle"),g=s&&((null===h||void 0===h||null===(n=h.props.mimeType)||void 0===n?void 0:n.includes("video"))||(null===h||void 0===h||null===(r=h.props.mimeType)||void 0===r?void 0:r.includes("gif")));return(0,t.useEffect)((function(){if(null!==h&&void 0!==h&&h.props.src&&"mimeType"in h.props&&"image/gif"===(null===h||void 0===h?void 0:h.props.mimeType)){var e=!1,t=function(){var t=Fa(Na().mark((function t(){var n;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ch(h.props.src);case 2:if(n=t.sent,!e){t.next=5;break}return t.abrupt("return");case 5:n&&c(n);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!0}}}),[s,null===h||void 0===h?void 0:h.props]),(0,za.jsxs)(za.Fragment,{children:[(null===h||void 0===h?void 0:h.props.src)&&v&&(0,za.jsx)("div",{style:o,children:(0,za.jsx)("div",{className:"tl-image tl-image-".concat(e.id,"-crop"),style:{opacity:.1,backgroundImage:"url(".concat(!e.props.playing||g?l:h.props.src,")")},draggable:!1})}),(0,za.jsx)(zc,{id:e.id,style:{overflow:"hidden"},children:(0,za.jsxs)("div",{className:"tl-image-container",style:o,children:[null!==h&&void 0!==h&&h.props.src?(0,za.jsx)("div",{className:"tl-image tl-image-".concat(e.id),style:{backgroundImage:"url(".concat(!e.props.playing||g?l:h.props.src,")")},draggable:!1}):(0,za.jsx)("g",{transform:"translate(".concat((f-38)/2,", ").concat((p-38)/2,")"),children:(0,za.jsx)(Zu,{})}),(null===h||void 0===h?void 0:h.props.isAnimated)&&!e.props.playing&&(0,za.jsx)("div",{className:"tl-image__tg",children:"GIF"})]})}),"url"in e.props&&e.props.url&&(0,za.jsx)(hp,{url:e.props.url,zoomLevel:this.editor.zoomLevel})]})}},{key:"indicator",value:function(e){return Ph(e.id)?null:(0,za.jsx)("rect",{width:ys(e.props.w),height:ys(e.props.h)})}},{key:"toSvg",value:function(){var e=Fa(Na().mark((function e(t){var n,r,i,o,a,s,u,l,c,d,f;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.createElementNS("http://www.w3.org/2000/svg","g"),r=t.props.assetId?this.editor.getAssetById(t.props.assetId):null,!(i=(null===r||void 0===r?void 0:r.props.src)||"")||!i.startsWith("http")){e.next=10;break}return e.next=6,Ih(i);case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0="";case 9:i=e.t0;case 10:return(o=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttributeNS("http://www.w3.org/1999/xlink","href",i),a=jh(t),s=t.props.crop,a&&s?(u=a.transform,l=a.width,c=a.height,d=[new Xa(s.topLeft.x*l,s.topLeft.y*c),new Xa(s.bottomRight.x*l,s.topLeft.y*c),new Xa(s.bottomRight.x*l,s.bottomRight.y*c),new Xa(s.topLeft.x*l,s.bottomRight.y*c)],(f=document.createElementNS("http://www.w3.org/2000/svg","g")).style.clipPath="polygon(".concat(d.map((function(e){return"".concat(e.x,"px ").concat(e.y,"px")})).join(","),")"),o.setAttribute("width",l.toString()),o.setAttribute("height",c.toString()),o.style.transform=u,f.appendChild(o),n.appendChild(f)):(o.setAttribute("width",t.props.w.toString()),o.setAttribute("height",t.props.h.toString()),n.appendChild(o)),e.abrupt("return",n);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(Vc);function jh(e){var t=e.props.crop,n=null===t||void 0===t?void 0:t.topLeft;if(n){var r=1/(t.bottomRight.x-t.topLeft.x)*e.props.w,i=1/(t.bottomRight.y-t.topLeft.y)*e.props.h,o=-n.x*r,a=-n.y*i;return{transform:"translate(".concat(o,"px, ").concat(a,"px)"),width:r,height:i}}}z(Mh,"type","image");var Ah=Ef("image",{util:Mh,props:ca,migrations:fa});function Oh(e){for(var t=e.segments,n=[],r=0,i=t.length;r<i;r++){var o=t[r].lut,a=o.length-1;r>0?n.push(Xa.Lrp(o[0],o[1],.25)):n.push(o[0]);for(var s=1;s<a;s++)n.push(o[s]);r<i-1?n.push(Xa.Lrp(o[a-1],o[a],.75)):n.push(o[a])}return n}function Lh(e){return{size:e,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function zh(e,t,n){return Ds(Oh(t),Lh(n))}function Dh(e,t,n){var r=function(e,t,n){var r=Lh(n);return Os(Bs(zh(0,t,n),r),r)}(0,t,n);return bu(r)}function Rh(e,t,n,r){switch(e.props.dash){case"draw":return function(e){e.shape;var t=e.strokeWidth,n=e.spline,r=e.color,i=Dh(0,n,t),o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("stroke-width","0"),o.setAttribute("stroke","none"),o.setAttribute("fill",r),o.setAttribute("d",i),o}({shape:e,strokeWidth:r,spline:t,color:n});case"solid":return function(e){var t=e.strokeWidth,n=e.spline,r=e.color,i=n.path,o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("stroke-width",t.toString()),o.setAttribute("stroke",r),o.setAttribute("fill","none"),o.setAttribute("d",i),o}({strokeWidth:r,spline:t,color:n});default:return function(e){var t=e.dash,n=e.strokeWidth,r=e.spline,i=e.color,o=r.segments,a=document.createElementNS("http://www.w3.org/2000/svg","g");return a.setAttribute("stroke",i),a.setAttribute("stroke-width",n.toString()),o.forEach((function(e,r){var i=document.createElementNS("http://www.w3.org/2000/svg","path"),s=jf(e.length,n,{style:t,start:r>0?"outset":"none",end:r<o.length-1?"outset":"none"}),u=s.strokeDasharray,l=s.strokeDashoffset;i.setAttribute("stroke-dasharray",u.toString()),i.setAttribute("stroke-dashoffset",l.toString()),i.setAttribute("d",e.path),i.setAttribute("fill","none"),a.appendChild(i)})),a}({strokeWidth:r,spline:t,dash:e.props.dash,color:n})}}var Nh=new Yc,Bh=new Yc,Fh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"hideResizeHandles",(function(){return!0})),z(_t(e),"hideRotateHandle",(function(){return!0})),z(_t(e),"hideSelectionBoundsBg",(function(){return!0})),z(_t(e),"hideSelectionBoundsFg",(function(){return!0})),z(_t(e),"isClosed",(function(){return!1})),z(_t(e),"onResize",(function(e,t){var n=t.scaleX,r=t.scaleY,i=We(e.props.handles);return Object.values(e.props.handles).forEach((function(e){var t=e.id,o=e.x,a=e.y;i[t].x=o*n,i[t].y=a*r})),{props:{handles:i}}})),z(_t(e),"onHandleChange",(function(e,t){var n=t.handle,r=We(e);switch(n.id){case"start":case"end":r.props.handles[n.id]=Ce(Ce({},r.props.handles[n.id]),{},{x:n.x,y:n.y});break;default:var i="handle:"+n.index,o=e.props.handles[i];r.props.handles[i]=o?Ce(Ce({},o),{},{x:n.x,y:n.y}):{id:i,type:"vertex",canBind:!1,index:n.index,x:n.x,y:n.y}}return r})),e}return L(n,[{key:"getDefaultProps",value:function(){return{dash:"draw",size:"m",color:"black",spline:"line",handles:{start:{id:"start",type:"vertex",canBind:!1,index:"a1",x:0,y:0},end:{id:"end",type:"vertex",canBind:!1,index:"a2",x:0,y:0}}}}},{key:"getBounds",value:function(e){return Uh(e).bounds}},{key:"getHandles",value:function(e){return Bh.get(e.props,(function(){for(var t=e.props.handles,n=Uh(e),r=Object.values(t).sort(T),i=r.slice(),o=0;o<n.segments.length;o++){var a=n.segments[o].midPoint,s=E(r[o].index,r[o+1].index);i.push({id:"mid-".concat(o),type:"create",index:s,x:a.x,y:a.y})}return i.sort(T)}))}},{key:"getOutline",value:function(e){return Oh(Uh(e))}},{key:"getOutlineSegments",value:function(e){var t=Uh(e);return"cubic"===e.props.spline?t.segments.map((function(e){return e.lut})):t.segments.map((function(e){return[e.getPoint(0),e.getPoint(1)]}))}},{key:"hitTestPoint",value:function(e,t){var n=this.editor.zoomLevel,r=Gc[e.props.size]/n;return function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=t.length,i=1;i<r;i++){var o=t[i-1],a=t[i];if(Xa.DistanceToLineSegment(o,a,e)<n)return!0}return!1}(t,this.editor.getOutline(e),r)}},{key:"hitTestLineSegment",value:function(e,t,n){return null!==Ks(t,n,this.editor.getOutline(e))}},{key:"component",value:function(e){var t=Af(),n=wp(),r=Uh(e),i=Gc[e.props.size],o=e.props,a=o.dash,s=o.color;if("line"===e.props.spline){if("solid"===a){var u=r.points,l="M"+u[0]+"L"+u.slice(1);return(0,za.jsxs)(Mf,{id:e.id,children:[(0,za.jsx)(Of,{d:l,fill:"none",color:s}),(0,za.jsx)("path",{d:l,stroke:t[s].solid,strokeWidth:i,fill:"none"})]})}if("dashed"===a||"dotted"===a){var c=r.points,d="M"+c[0]+"L"+c.slice(1);return(0,za.jsxs)(Mf,{id:e.id,children:[(0,za.jsx)(Of,{d:d,fill:"none",color:s}),(0,za.jsx)("g",{stroke:t[s].solid,strokeWidth:i,children:r.segments.map((function(e,t){var n=jf(e.length,i,{style:a,start:t>0?"outset":"none",end:t<r.segments.length-1?"outset":"none"}),o=n.strokeDasharray,s=n.strokeDashoffset;return(0,za.jsx)("path",{strokeDasharray:o,strokeDashoffset:s,d:e.path,fill:"none"},t)}))})]})}if("draw"===a){var f=r.points,p=G(Js(e.id,f,i),2),h=p[0],v=p[1];return(0,za.jsxs)(Mf,{id:e.id,children:[(0,za.jsx)(Of,{d:h,fill:"none",color:s}),(0,za.jsx)("path",{d:v,stroke:t[s].solid,strokeWidth:i,fill:"none"})]})}}if("cubic"===e.props.spline){var g=r.path;if("solid"===a||"draw"===a&&n)return(0,za.jsxs)(Mf,{id:e.id,children:[(0,za.jsx)(Of,{d:g,fill:"none",color:s}),(0,za.jsx)("path",{strokeWidth:i,stroke:t[s].solid,fill:"none",d:g})]});if("dashed"===a||"dotted"===a)return(0,za.jsxs)(Mf,{id:e.id,children:[(0,za.jsx)(Of,{d:g,fill:"none",color:s}),(0,za.jsx)("g",{stroke:t[s].solid,strokeWidth:i,children:r.segments.map((function(e,t){var n=jf(e.length,i,{style:a,start:t>0?"outset":"none",end:t<r.segments.length-1?"outset":"none"}),o=n.strokeDasharray,s=n.strokeDashoffset;return(0,za.jsx)("path",{strokeDasharray:o,strokeDashoffset:s,d:e.path,fill:"none"},t)}))})]});if("draw"===a)return(0,za.jsxs)(Mf,{id:e.id,children:[(0,za.jsx)(Of,{d:g,fill:"none",color:s}),(0,za.jsx)("path",{d:Dh(0,r,i),strokeWidth:1,stroke:t[s].solid,fill:t[s].solid})]})}}},{key:"indicator",value:function(e){var t,n=Gc[e.props.size],r=Uh(e),i=e.props.dash;if("line"===e.props.spline){var o=r.points;if("solid"===i||"dotted"===i||"dashed"===i)t="M"+o[0]+"L"+o.slice(1);else t=G(Js(e.id,o,n),1)[0]}else t=function(e,t,n){return"draw"===e.props.dash?wu(zh(0,t,n)):t.path}(e,r,n);return(0,za.jsx)("path",{d:t})}},{key:"toSvg",value:function(e){var t=eo(this.editor)[e.props.color].solid;return Rh(e,Uh(e),t,Gc[e.props.size])}}]),n}(Uc);function Uh(e){return Nh.get(e.props,(function(){var t=e.props,n=t.spline,r=t.handles,i=Object.values(r).sort(T).map(Xa.From);switch(n){case"cubic":return new Is(i,2===i.length?2:1.2,20);case"line":return new js(i)}}))}z(Fh,"type","line");var Kh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shapeId",""),z(_t(e),"onEnter",(function(t){e.shapeId=t.shapeId,e.editor.setCursor({type:"cross"})})),z(_t(e),"onPointerDown",(function(){e.parent.transition("pointing",{shapeId:e.shapeId})})),z(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return L(n)}(If);z(Kh,"id","idle");var Vh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shape",{}),z(_t(e),"markPointId",""),z(_t(e),"onEnter",(function(t){var n=e.editor.inputs,r=n.currentPagePoint;e.markPointId=e.editor.mark("creating");var i=!1;if(t.shapeId){var o=e.editor.getShapeById(t.shapeId);o&&(i=!0,e.shape=o)}if(n.shiftKey&&i){var a=e.editor.getHandles(e.shape);if(!a)return;var s,u,l,c=a.filter((function(e){return"vertex"===e.type})).sort(T),d=c[c.length-1],f=Ms.applyToPoint(e.editor.getParentTransform(e.shape),new Xa(e.shape.x,e.shape.y));2===c.length&&1===c[1].x&&1===c[1].y?(s=c[1].index,u=c[1].id,l=Ce(Ce({},c[1]),{},{x:r.x-f.x,y:r.y-f.y})):(u="handle:"+(s=C(d.index)),l={x:r.x-f.x,y:r.y-f.y,index:s,canBind:!1,type:"vertex",id:u});var p=it(e.shape.props.handles);p[l.id]=l,e.editor.updateShapes([{id:e.shape.id,type:e.shape.type,props:{handles:p}}])}else{var h=Wi();e.editor.createShapes([{id:h,type:"line",x:r.x,y:r.y}]),e.editor.select(h),e.shape=e.editor.getShapeById(h)}})),z(_t(e),"onPointerMove",(function(){if(e.shape&&e.editor.inputs.isDragging){var t=e.editor.getHandles(e.shape);if(!t)throw e.editor.bailToMark("creating"),Error("No handles found");e.editor.setSelectedTool("select.dragging_handle",{shape:e.shape,isCreating:!0,handle:Me(t),onInteractionEnd:"line"})}})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onInterrupt",(function(){e.parent.transition("idle",{}),e.editor.bailToMark("creating"),e.editor.snaps.clear()})),e}return L(n,[{key:"complete",value:function(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}},{key:"cancel",value:function(){this.editor.bailToMark(this.markPointId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}}]),n}(If);z(Vh,"id","pointing");var Wh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",Fh),e}return L(n)}(If);z(Wh,"id","line"),z(Wh,"initial","idle"),z(Wh,"children",(function(){return[Kh,Vh]}));var Hh=Ef("line",{util:Fh,props:va,migrations:ga,tool:Wh}),Yh=200,Xh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"canEdit",(function(){return!0})),z(_t(e),"hideResizeHandles",(function(){return!0})),z(_t(e),"hideSelectionBoundsBg",(function(){return!0})),z(_t(e),"hideSelectionBoundsFg",(function(){return!0})),z(_t(e),"onBeforeCreate",(function(t){return qh(e.editor,t,t.props.growY)})),z(_t(e),"onBeforeUpdate",(function(t,n){if(t.props.text!==n.props.text||t.props.font!==n.props.font||t.props.size!==n.props.size)return qh(e.editor,n,t.props.growY)})),z(_t(e),"onEditEnd",(function(t){var n=t.id,r=t.type,i=t.props.text;i.trimEnd()!==t.props.text&&e.editor.updateShapes([{id:n,type:r,props:{text:i.trimEnd()}}])})),e}return L(n,[{key:"getDefaultProps",value:function(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,url:""}}},{key:"getHeight",value:function(e){return Yh+e.props.growY}},{key:"getBounds",value:function(e){var t=this.getHeight(e);return new ks(0,0,Yh,t)}},{key:"getOutline",value:function(e){return this.editor.getBounds(e).corners}},{key:"getCenter",value:function(e){return new Xa(100,this.getHeight(e)/2)}},{key:"component",value:function(e){var t=e.id,n=e.type,r=e.props,i=r.color,o=r.font,a=r.size,s=r.align,u=r.text,l=r.verticalAlign,c=Af(),d="black"===i?"yellow":i;return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)("div",{style:{position:"absolute",width:Yh,height:this.getHeight(e)},children:(0,za.jsxs)("div",{className:"tl-note__container tl-hitarea-fill",style:{color:c[d].solid,backgroundColor:c[d].solid},children:[(0,za.jsx)("div",{className:"tl-note__scrim"}),(0,za.jsx)(Zp,{id:t,type:n,font:o,size:a,align:s,verticalAlign:l,text:u,labelColor:"black",wrap:!0})]})}),"url"in e.props&&e.props.url&&(0,za.jsx)(hp,{url:e.props.url,zoomLevel:this.editor.zoomLevel})]})}},{key:"indicator",value:function(e){return(0,za.jsx)("rect",{rx:"7",width:ys(Yh),height:ys(this.getHeight(e))})}},{key:"toSvg",value:function(e,t){t.addExportDef(td(e.props.font));var n=eo(this.editor),r=this.getBounds(e),i=document.createElementNS("http://www.w3.org/2000/svg","g"),o="black"===e.props.color?"yellow":e.props.color,a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("rx","10"),a.setAttribute("width",Yh.toString()),a.setAttribute("height",r.height.toString()),a.setAttribute("fill",n[o].solid),a.setAttribute("stroke",n[o].solid),a.setAttribute("stroke-width","1"),i.appendChild(a);var s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("rx","10"),s.setAttribute("width",Yh.toString()),s.setAttribute("height",r.height.toString()),s.setAttribute("fill",n.background),s.setAttribute("opacity",".28"),i.appendChild(s);var u=Qp({editor:this.editor,shape:e,font:co[e.props.font],bounds:r});return u.setAttribute("fill",n.text),u.setAttribute("stroke","none"),i.appendChild(u),i}}]),n}(Uc);function qh(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e.textMeasure.measureText(t.props.text,Ce(Ce({},$c),{},{fontFamily:ed[t.props.font],fontSize:Zc[t.props.size],width:"166px"})).h+34,i=null;if(r>Yh?i=r-Yh:n&&(i=0),null!==i)return Ce(Ce({},t),{},{props:Ce(Ce({},t.props),{},{growY:i})})}z(Xh,"type","note");var $h=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("pointing",t)})),z(_t(e),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),z(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return L(n)}(If);z($h,"id","idle");var Gh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"dragged",!1),z(_t(e),"info",{}),z(_t(e),"wasFocusedOnEnter",!1),z(_t(e),"markPointId","creating"),z(_t(e),"onEnter",(function(){e.wasFocusedOnEnter=!e.editor.isMenuOpen})),z(_t(e),"onPointerMove",(function(t){if(e.editor.inputs.isDragging){e.editor.mark(e.markPointId);var n=e.createShape();if(!n)return;e.editor.setSelectedTool("select.translating",Ce(Ce({},t),{},{target:"shape",shape:n,isCreating:!0,editAfterComplete:!0,onInteractionEnd:"note"}))}})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onInterrupt",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),e}return L(n,[{key:"complete",value:function(){if(this.wasFocusedOnEnter){this.editor.mark(this.markPointId);var e=this.createShape();if(this.editor.instanceState.isToolLocked)this.parent.transition("idle",{});else{if(!e)return;this.editor.setEditingId(e.id),this.editor.setSelectedTool("select.editing_shape",Ce(Ce({},this.info),{},{target:"shape",shape:e}))}}}},{key:"cancel",value:function(){this.editor.bailToMark(this.markPointId),this.parent.transition("idle",this.info)}},{key:"createShape",value:function(){var e=this.editor.inputs.originPagePoint,t=Wi();this.editor.createShapes([{id:t,type:"note",x:e.x,y:e.y}],!0);var n=this.editor.getShapeById(t),r=this.editor.getBounds(n);return this.editor.updateShapes([{id:t,type:"note",x:n.x-r.width/2,y:n.y-r.height/2}]),this.editor.getShapeById(t)}}]),n}(If);z(Gh,"id","pointing");var Qh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",Xh),e}return L(n)}(If);z(Qh,"id","note"),z(Qh,"initial","idle"),z(Qh,"children",(function(){return[$h,Gh]}));var Zh=Ef("note",{util:Xh,props:ba,migrations:Sa,tool:Qh}),Jh=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onPointerEnter",(function(t){switch(t.target){case"canvas":break;case"shape":var n=e.editor,r=n.selectedIds,i=n.focusLayerId,o=e.editor.getOutermostSelectableShape(t.shape,(function(e){return!r.includes(e.id)}));o.id!==i&&e.editor.isShapeOfType(o,gd)&&e.editor.setHoveredId(o.id)}})),z(_t(e),"onPointerLeave",(function(t){if("shape"===t.target)e.editor.setHoveredId(null)})),z(_t(e),"onPointerDown",(function(t){var n=e.editor.hoveredId;if(n){var r=e.editor.getShapeById(n);if(e.editor.isShapeOfType(r,gd))return void requestAnimationFrame((function(){e.editor.setSelectedIds([r.id]),e.editor.setEditingId(r.id),e.editor.setSelectedTool("select.editing_shape",Ce(Ce({},t),{},{target:"shape",shape:r}))}))}e.parent.transition("pointing",t)})),z(_t(e),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),z(_t(e),"onKeyDown",(function(t){if("Enter"===t.key){var n=e.editor.selectedShapes[0];n&&e.editor.isShapeOfType(n,vh)&&(e.editor.setSelectedTool("select"),e.editor.setEditingId(n.id),e.editor.root.current.value.transition("editing_shape",Ce(Ce({},t),{},{target:"shape",shape:n})))}})),z(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return L(n)}(If);z(Jh,"id","idle");var ev=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shape",void 0),z(_t(e),"onExit",(function(){e.editor.setHintingIds([])})),z(_t(e),"onPointerMove",(function(t){if(e.editor.inputs.isDragging){var n=e.editor.inputs.originPagePoint,r=Wi();if(e.editor.mark("creating"),e.editor.createShapes([{id:r,type:"text",x:n.x,y:n.y,props:{text:"",autoSize:!1,w:20}}]),e.editor.select(r),e.shape=e.editor.getShapeById(r),!e.shape)return;e.editor.setSelectedTool("select.resizing",Ce(Ce({},t),{},{target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:1,y:1},editAfterComplete:!0,onInteractionEnd:"text"}))}})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onComplete",(function(){e.cancel()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onInterrupt",(function(){e.cancel()})),e}return L(n,[{key:"complete",value:function(){var e;this.editor.mark("creating text shape");var t=Wi(),n=this.editor.inputs.currentPagePoint,r=n.x,i=n.y;this.editor.createShapes([{id:t,type:"text",x:r,y:i,props:{text:"",autoSize:!0}}],!0),this.editor.setEditingId(t),this.editor.setSelectedTool("select"),null===(e=this.editor.root.current.value)||void 0===e||e.transition("editing_shape",{})}},{key:"cancel",value:function(){this.parent.transition("idle",{}),this.editor.bailToMark("creating")}}]),n}(If);z(ev,"id","pointing");var tv=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",gd),e}return L(n)}(If);z(tv,"id","text"),z(tv,"initial","idle"),z(tv,"children",(function(){return[Jh,ev]}));var nv=Ef("text",{util:gd,props:_a,migrations:Ea,tool:tv}),rv=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"canEdit",(function(){return!0})),z(_t(e),"isAspectRatioLocked",(function(){return!0})),e}return L(n,[{key:"getDefaultProps",value:function(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}},{key:"component",value:function(e){return(0,za.jsx)(ov,{shape:e,videoUtil:this})}},{key:"indicator",value:function(e){return(0,za.jsx)("rect",{width:ys(e.props.w),height:ys(e.props.h)})}},{key:"toSvg",value:function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g"),n=document.createElementNS("http://www.w3.org/2000/svg","image");return n.setAttributeNS("http://www.w3.org/1999/xlink","href",function(e){var t=e.split(":")[1],n=document.querySelector(".tl-video-shape-".concat(t));if(n){var r=document.createElement("canvas");return r.width=n.videoWidth,r.height=n.videoHeight,r.getContext("2d").drawImage(n,0,0),r.toDataURL("image/png")}throw new Error("Video with id "+t+" not found")}(e.id)),n.setAttribute("width",e.props.w.toString()),n.setAttribute("height",e.props.h.toString()),t.appendChild(n),t}}]),n}(Vc);z(rv,"type","video");var iv,ov=ke((function(e){var n=e.shape,r=e.videoUtil,i=r.editor.getBounds(n).w*r.editor.zoomLevel>=110,o=n.props.assetId?r.editor.getAssetById(n.props.assetId):null,a=n.props,s=a.w,u=a.h,l=a.time,c=a.playing,d=Dc(n.id),f=pu(),p=t.useRef(null),h=t.useCallback((function(e){var t=e.currentTarget;r.editor.updateShapes([{type:"video",id:n.id,props:{playing:!0,time:t.currentTime}}])}),[n.id,r.editor]),v=t.useCallback((function(e){var t=e.currentTarget;r.editor.updateShapes([{type:"video",id:n.id,props:{playing:!1,time:t.currentTime}}])}),[n.id,r.editor]),g=t.useCallback((function(e){var t=e.currentTarget;d&&r.editor.updateShapes([{type:"video",id:n.id,props:{time:t.currentTime}}])}),[d,n.id,r.editor]),m=G(t.useState(!1),2),y=m[0],b=m[1],w=t.useCallback((function(e){var t=e.currentTarget;l!==t.currentTime&&(t.currentTime=l),c||t.pause(),b(!0)}),[c,l]);return t.useEffect((function(){var e=p.current;e&&y&&!d&&l!==e.currentTime&&(e.currentTime=l)}),[d,y,l]),t.useEffect((function(){if(f){var e=p.current;e.pause(),e.currentTime=0}}),[p,f]),(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(zc,{id:n.id,children:(0,za.jsx)("div",{className:"tl-counter-scaled",children:null!==o&&void 0!==o&&o.props.src?(0,za.jsx)("video",{ref:p,className:"tl-video tl-video-shape-".concat(n.id.split(":")[1]," tl-hitarea-stroke"),width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:d&&i,onPlay:h,onPause:v,onTimeUpdate:g,onLoadedData:w,hidden:!y,children:(0,za.jsx)("source",{src:o.props.src})}):(0,za.jsx)("g",{transform:"translate(".concat((s-38)/2,", ").concat((u-38)/2,")"),children:(0,za.jsx)(Zu,{})})})}),"url"in n.props&&n.props.url&&(0,za.jsx)(hp,{url:n.props.url,zoomLevel:r.editor.zoomLevel})]})})),av=Ef("video",{util:rv,props:Ia,migrations:Ma}),sv=[kh,Fp,bp,Ah,nv],uv=[Bp,xh,Hh,Zh,Gp,fp,_h,av],lv=new Set(sv.map((function(e){return e.type})));function cv(e){var t,n=[].concat(sv),r=new Set,i=J(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(lv.has(o.type))throw new Error('Shape type "'.concat(o.type,'" is a core shapes type and cannot be overridden'));if(r.has(o.type))throw new Error('Shape type "'.concat(o.type,'" is defined more than once'));n.push(o),r.add(o.type)}}catch(a){i.e(a)}finally{i.f()}return n}function dv(e,t){if(!t)return!1;switch(e.type){case"mixed":return"mixed"===t.type;case"shared":return"shared"===t.type&&e.value===t.value;default:throw Oe(e)}}iv=Symbol.iterator;var fv=function(e){Et(n,e);var t=Tt(n);function n(){return M(this,n),t.apply(this,arguments)}return L(n,[{key:"set",value:function(e,t){this.map.set(e,t)}},{key:"applyValue",value:function(e,t){var n=this.get(e);if(n)switch(n.type){case"mixed":return;case"shared":return void(n.value!==t&&this.set(e,{type:"mixed"}));default:Oe(n,"type")}else this.set(e,{type:"shared",value:t})}}]),n}(function(){function e(t){M(this,e),z(this,"map",void 0),this.map=new Map(t)}return L(e,[{key:"get",value:function(e){return this.map.get(e)}},{key:"getAsKnownValue",value:function(e){var t=this.get(e);if(t&&"mixed"!==t.type)return t.value}},{key:"size",get:function(){return this.map.size}},{key:"equals",value:function(e){if(this.size!==e.size)return!1;var t,n=new Set,r=J(this);try{for(r.s();!(t=r.n()).done;){var i=G(t.value,2),o=i[0];if(!dv(i[1],e.get(o)))return!1;n.add(o)}}catch(d){r.e(d)}finally{r.f()}var a,s=J(e);try{for(s.s();!(a=s.n()).done;){var u=G(a.value,2),l=u[0],c=u[1];if(!n.has(l)&&!dv(c,this.get(l)))return!1}}catch(d){s.e(d)}finally{s.f()}return!0}},{key:"keys",value:function(){return this.map.keys()}},{key:"values",value:function(){return this.map.values()}},{key:"entries",value:function(){return this.map.entries()}},{key:iv,value:function(){return this.map[Symbol.iterator]()}}]),e}());function pv(e,t){for(var n=0;e[t+n];)n+=e[t+n]+1;return n+1}function hv(e){var t,n,r=new Uint8Array(e),i=0,o=0;if(!function(e){return"GIF"===new TextDecoder("ascii").decode(e.slice(0,3))}(e))return!1;for(t=128&r[10],n=7&r[10],i+=6,i+=7,i+=t?3*Math.pow(2,n+1):0;o<2&&i<r.length;)switch(r[i]){case 44:o+=1,t=128&r[i+9],n=7&r[i+9],i+=10,i+=t?3*Math.pow(2,n+1):0,i+=pv(r,i+1)+1;break;case 33:i+=2,i+=pv(r,i);break;default:i=r.length}return o>1}var vv=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!==typeof Int32Array&&(vv=new Int32Array(vv));var gv=function(e,t){for(var n=0===t?0:-1^~~t,r=0;r<e.length;r++)n=vv[255&(n^e[r])]^n>>>8;return-1^n};function mv(e,t){return 137===e.getUint8(t+0)&&80===e.getUint8(t+1)&&78===e.getUint8(t+2)&&71===e.getUint8(t+3)&&13===e.getUint8(t+4)&&10===e.getUint8(t+5)&&26===e.getUint8(t+6)&&10===e.getUint8(t+7)}function yv(e,t){return[String.fromCharCode(e.getUint8(t)),String.fromCharCode(e.getUint8(t+1)),String.fromCharCode(e.getUint8(t+2)),String.fromCharCode(e.getUint8(t+3))].join("")}var bv=4,wv=4;function xv(e,t){return{ppux:e.getUint32(t),ppuy:e.getUint32(t+4),unit:e.getUint8(t+4)}}function kv(e,t){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={};if(!mv(e,t))throw new Error("Not a PNG");for(t+=8;t<=e.buffer.byteLength;){var r=t,i=e.getInt32(t),o=yv(e,t+=4);if("IDAT"===o&&n[o])t+=i+bv+wv;else{if("IEND"===o)break;n[o]={start:r,dataOffset:t+4,size:i},t+=i+bv+wv}}return n}(e);return n[t]}function Sv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=46,i=0,o=kv(e,"pHYs");o&&(r=o.start,i=o.size);var a=kv(e,"IDAT");a&&(r=a.start,i=0);var s=new ArrayBuffer(21),u=new DataView(s);u.setUint32(0,9),u.setUint8(4,"p".charCodeAt(0)),u.setUint8(5,"H".charCodeAt(0)),u.setUint8(6,"Y".charCodeAt(0)),u.setUint8(7,"s".charCodeAt(0));var l=2835.5;u.setInt32(8,l*t),u.setInt32(12,l*t),u.setInt8(16,1);var c=new Uint8Array(s.slice(4,17));u.setInt32(17,gv(c));var d=e.buffer.slice(0,r),f=e.buffer.slice(r+i);return new Blob([d,s,f],n)}var _v=["image/jpeg","image/png","image/gif","image/svg+xml"],Pv=["video/mp4","video/quicktime"],Ev=_v.concat(Pv).join(", "),Cv=function(e){return _v.includes(e)};function Iv(e){return Tv.apply(this,arguments)}function Tv(){return Tv=Fa(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){var r=document.createElement("video");r.onloadeddata=function(){return e({w:r.videoWidth,h:r.videoHeight})},r.onerror=function(e){console.error(e),n(new Error("Could not get video size"))},r.crossOrigin="anonymous",r.src=t}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Tv.apply(this,arguments)}function Mv(e){return jv.apply(this,arguments)}function jv(){return(jv=Fa(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(t).then((function(e){return e.arrayBuffer()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Av(e){return Ov.apply(this,arguments)}function Ov(){return(Ov=Fa(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){var r=new Image;r.onload=Fa(Na().mark((function n(){var i,o,a,s,u;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Mv(t);case 3:if(i=n.sent,!mv(o=new DataView(i),0)){n.next=13;break}if(!(a=kv(o,"pHYs"))){n.next=13;break}if(0!==(s=xv(o,a.dataOffset)).unit||s.ppux!==s.ppuy){n.next=13;break}return u=Math.round(s.ppux/2834.5),e({w:r.width/u,h:r.height/u}),n.abrupt("return");case 13:e({w:r.width,h:r.height}),n.next=20;break;case 16:n.prev=16,n.t0=n.catch(0),console.error(n.t0),e({w:r.width,h:r.height});case 20:case"end":return n.stop()}}),n,null,[[0,16]])}))),r.onerror=function(e){console.error(e),n(new Error("Could not get image size"))},r.crossOrigin="anonymous",r.src=t}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Lv(e,t,n){return zv.apply(this,arguments)}function zv(){return(zv=Fa(Na().mark((function e(t,n,r){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){var i=new Image;i.onload=function(){var t=document.createElement("canvas"),o=t.getContext("2d");if(o){t.width=2*n,t.height=2*r,o.drawImage(i,0,0,t.width,t.height);var a=t.toDataURL();e(a)}},i.crossOrigin="anonymous",i.src=t}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Dv(e){return Rv.apply(this,arguments)}function Rv(){return(Rv=Fa(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("image/gif"!==t.type){e.next=4;break}return e.next=3,new Promise((function(e,n){var r=new FileReader;r.onerror=function(){return n(r.error)},r.onload=function(){e({isAnimated:!!r.result&&hv(r.result)})},r.readAsArrayBuffer(t)}));case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",{isAnimated:!Cv(t.type)});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nv(e,t){var n=e.w/t.w,r=e.h/t.h;return n<=1&&r<=1?e:n>r?{w:e.w/n,h:e.h/n}:{w:e.w/r,h:e.h/r}}function Bv(e,t,n){return fetch(e).then((function(e){return e.arrayBuffer()})).then((function(e){return new File([e],t,{type:n})}))}function Fv(e){var t=e.editor,n=t.selectionRotation,r=t.selectionPageCenter,i=t.inputs.originPagePoint,o=t.selectedShapes;return r?{selectionPageCenter:r,initialCursorAngle:r.angle(i),initialSelectionRotation:n,shapeSnapshots:o.map((function(e){return{shape:it(e),initialPagePoint:t.getPagePointById(e.id)}}))}:null}function Uv(e){var t=e.delta,n=e.editor,r=e.snapshot,i=e.stage,o=r.selectionPageCenter,a=r.shapeSnapshots;n.updateShapes(a.map((function(e){var r=e.shape,i=e.initialPagePoint,a=Vi(r.parentId)?n.getPageTransformById(r.parentId):Ms.Identity(),s=Xa.RotWith(i,o,t),u=Ms.applyToPoint(Ms.Inverse(a),s),l=is(r.rotation+t);return{id:r.id,type:r.type,x:u.x,y:u.y,rotation:l}})));var s=[];a.forEach((function(e){var t,r=e.shape,o=n.getShapeById(r.id);if(o){var a=n.getShapeUtil(r);if("start"===i||"one-off"===i){var u,l=null===(u=a.onRotateStart)||void 0===u?void 0:u.call(a,r);l&&s.push(l)}var c=null===(t=a.onRotate)||void 0===t?void 0:t.call(a,r,o);if(c&&s.push(c),"end"===i||"one-off"===i){var d,f=null===(d=a.onRotateEnd)||void 0===d?void 0:d.call(a,r,o);f&&s.push(f)}}})),s.length>0&&n.updateShapes(s)}var Kv,Vv,Wv=function(e,t,n){for(;!Rn(n.parentId);){var r=e.get(n.parentId);if(!r)return!1;n=r}return n.parentId===t},Hv=function(){function e(t){var n=this;M(this,e),z(this,"_clickId",""),z(this,"_clickTimeout",void 0),z(this,"_clickScreenPoint",void 0),z(this,"_previousScreenPoint",void 0),z(this,"_getClickTimeout",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:of();n._clickId=t,clearTimeout(n._clickTimeout),n._clickTimeout=setTimeout((function(){if(n._clickState===e&&n._clickId===t){switch(n._clickState){case"pendingTriple":n.editor.dispatch(Ce(Ce({},n.lastPointerInfo),{},{type:"click",name:"double_click",phase:"settle"}));break;case"pendingQuadruple":n.editor.dispatch(Ce(Ce({},n.lastPointerInfo),{},{type:"click",name:"triple_click",phase:"settle"}));break;case"pendingOverflow":n.editor.dispatch(Ce(Ce({},n.lastPointerInfo),{},{type:"click",name:"quadruple_click",phase:"settle"}))}n._clickState="idle"}}),"idle"===e||"pendingDouble"===e?450:200)})),z(this,"_clickState","idle"),z(this,"lastPointerInfo",{}),z(this,"transformPointerDownEvent",(function(e){if(!n._clickState)return e;switch(n._clickScreenPoint=Xa.From(e.point),n._previousScreenPoint&&n._previousScreenPoint.dist(n._clickScreenPoint)>40&&(n._clickState="idle"),n._previousScreenPoint=n._clickScreenPoint,n.lastPointerInfo=e,n._clickState){case"idle":return n._clickState="pendingDouble",n._clickTimeout=n._getClickTimeout(n._clickState),e;case"pendingDouble":return n._clickState="pendingTriple",n._clickTimeout=n._getClickTimeout(n._clickState),Ce(Ce({},e),{},{type:"click",name:"double_click",phase:"down"});case"pendingTriple":return n._clickState="pendingQuadruple",n._clickTimeout=n._getClickTimeout(n._clickState),Ce(Ce({},e),{},{type:"click",name:"triple_click",phase:"down"});case"pendingQuadruple":return n._clickState="pendingOverflow",n._clickTimeout=n._getClickTimeout(n._clickState),Ce(Ce({},e),{},{type:"click",name:"quadruple_click",phase:"down"});case"pendingOverflow":return n._clickState="overflow",n._clickTimeout=n._getClickTimeout(n._clickState),e;default:return n._clickTimeout=n._getClickTimeout(n._clickState),e}})),z(this,"transformPointerUpEvent",(function(e){if(!n._clickState)return e;switch(n._clickScreenPoint=Xa.From(e.point),n._clickState){case"pendingTriple":return Ce(Ce({},n.lastPointerInfo),{},{type:"click",name:"double_click",phase:"up"});case"pendingQuadruple":return Ce(Ce({},n.lastPointerInfo),{},{type:"click",name:"triple_click",phase:"up"});case"pendingOverflow":return Ce(Ce({},n.lastPointerInfo),{},{type:"click",name:"quadruple_click",phase:"up"});default:return e}})),z(this,"cancelDoubleClickTimeout",(function(){n._clickTimeout=clearTimeout(n._clickTimeout),n._clickState="idle"})),z(this,"handleMove",(function(){"idle"!==n._clickState&&n._clickScreenPoint&&n._clickScreenPoint.dist(n.editor.inputs.currentScreenPoint)>(n.editor.isCoarsePointer?6:4)&&n.cancelDoubleClickTimeout()})),this.editor=t}return L(e,[{key:"clickState",get:function(){return this._clickState}}]),e}(),Yv=function(){function e(t){var n=this;M(this,e),z(this,"handleContent",function(){var e=Fa(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="text"===e.t0?3:"files"===e.t0?6:"embed"===e.t0?9:"svg-text"===e.t0?12:"url"===e.t0?15:18;break;case 3:return e.next=5,n.handleText(n.editor,t);case 5:case 8:case 11:case 14:case 17:return e.abrupt("return",e.sent);case 6:return e.next=8,n.handleFiles(n.editor,t);case 9:return e.next=11,n.handleEmbed(n.editor,t);case 12:return e.next=14,n.handleSvgText(n.editor,t);case 15:return e.next=17,n.handleUrl(n.editor,t);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),z(this,"handleUrl",function(){var e=Fa(Na().mark((function e(t,r){var i,o,a,s,u,l,c;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.point,o=r.url,!(a=Fc(o))){e.next=4;break}return e.abrupt("return",n.handleEmbed(t,{type:"embed",url:a.url,point:i,embed:a.definition}));case 4:if(s=null!==i&&void 0!==i?i:t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter,u=Mi.createId(Be(o)),l=t.getAssetById(u),c=!1,l){e.next=13;break}return c=!0,e.next=12,n.createAssetFromUrl(t,o);case 12:l=e.sent;case 13:t.batch((function(){c&&t.createAssets([l]),n.createShapesForAssets(t,[l],s)}));case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.editor=t}return L(e,[{key:"handleSvgText",value:function(){var e=Fa(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.point,i=n.text,o=null!==r&&void 0!==r?r:t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter,a=(new DOMParser).parseFromString(i,"image/svg+xml").querySelector("svg")){e.next=5;break}throw new Error("No <svg/> element present");case 5:return s=parseFloat(a.getAttribute("width")||"0"),u=parseFloat(a.getAttribute("height")||"0"),s&&u||(document.body.appendChild(a),l=a.getBoundingClientRect(),document.body.removeChild(a),s=l.width,u=l.height),e.next=10,this.createAssetFromFile(t,new File([i],"asset.svg",{type:"image/svg+xml"}));case 10:c=e.sent,this.createShapesForAssets(t,[c],o);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleEmbed",value:function(){var e=Fa(Na().mark((function e(t,n){var r,i,o,a,s,u,l;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.point,i=n.url,o=n.embed,a=null!==r&&void 0!==r?r:t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter,s=o.width,u=o.height,l={id:Wi(),type:"embed",x:a.x-(s||450)/2,y:a.y-(u||450)/2,props:{w:s,h:u,url:i}},t.createShapes([l],!0);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleFiles",value:function(){var e=Fa(Na().mark((function e(t,n){var r,i,o,a,s,u=this;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.point,i=n.files,o=null!==r&&void 0!==r?r:t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter,a=new Xa(o.x,o.y),s=[],e.next=6,Promise.all(i.map(function(){var e=Fa(Na().mark((function e(n,r){var i;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.type){e.next=2;break}throw new Error("No mime type");case 2:if(_v.concat(Pv).includes(n.type)){e.next=5;break}return console.warn("".concat(n.name," not loaded - Extension not allowed.")),e.abrupt("return",null);case 5:return e.prev=5,e.next=8,u.createAssetFromFile(t,n);case 8:if(i=e.sent){e.next=11;break}throw Error("Could not create an asset");case 11:s[r]=i,e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(5),console.error(e.t0),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t,n){return e.apply(this,arguments)}}()));case 6:this.createShapesForAssets(t,Te(s),a);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleText",value:function(){var e=Fa(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f,p,h,v,g;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.point,i=n.text,o=null!==r&&void 0!==r?r:t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter,a=t.getShapeUtil(gd).getDefaultProps(),s=Gv($v(qv(i))),d="middle",f=s.split("\n").length>1,p=Xv.test(s),f&&(d=f?p?"end":"start":"middle"),h=t.textMeasure.measureText(s,Ce(Ce({},$c),{},{fontFamily:ed[a.font],fontSize:Qc[a.size],width:"fit-content"})),v=Math.min(f?.9*t.viewportPageBounds.width:920,Math.max(200,.9*t.viewportPageBounds.width)),h.w>v?(g=t.textMeasure.measureText(s,Ce(Ce({},$c),{},{fontFamily:ed[a.font],fontSize:Qc[a.size],width:v+"px"})),u=g.w,l=g.h,c=!1,d=p?"end":"start"):(u=h.w,l=h.h,c=!0),o.y-l/2<t.viewportPageBounds.minY+40&&(o.y=t.viewportPageBounds.minY+40+l/2),t.createShapes([{id:Wi(),type:"text",x:o.x-u/2,y:o.y-l/2,props:{text:s,align:d,autoSize:c,w:u}}]);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createShapesForAssets",value:function(){var e=Fa(Na().mark((function e(t,n,r){var i,o,a,s,u;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.length){e.next=2;break}return e.abrupt("return");case 2:i=Xa.From(r),o=[],a=J(n),e.prev=5,a.s();case 7:if((s=a.n()).done){e.next=22;break}u=s.value,e.t0=u.type,e.next="bookmark"===e.t0?12:"image"===e.t0?15:"video"===e.t0?18:20;break;case 12:return o.push({id:Wi(),type:"bookmark",x:i.x-150,y:i.y-160,opacity:1,props:{assetId:u.id,url:u.props.src}}),i.x+=300,e.abrupt("break",20);case 15:return o.push({id:Wi(),type:"image",x:i.x-u.props.w/2,y:i.y-u.props.h/2,opacity:1,props:{assetId:u.id,w:u.props.w,h:u.props.h}}),i.x+=u.props.w,e.abrupt("break",20);case 18:o.push({id:Wi(),type:"video",x:i.x-u.props.w/2,y:i.y-u.props.h/2,opacity:1,props:{assetId:u.id,w:u.props.w,h:u.props.h}}),i.x+=u.props.w;case 20:e.next=7;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(5),a.e(e.t1);case 27:return e.prev=27,a.f(),e.finish(27);case 30:t.batch((function(){var e=n.filter((function(e){return!t.getAssetById(e.id)}));e.length&&t.createAssets(e),t.createShapes(o,!0);var i=t.viewportPageBounds,a=t.selectedPageBounds;if(a){var s=a.center.sub(r);t.updateShapes(o.map((function(e){return{id:e.id,type:e.type,x:e.x-s.x,y:e.y-s.y}})))}(a=t.selectedPageBounds)&&!i.contains(a)&&t.zoomToSelection()}));case 31:case"end":return e.stop()}}),e,null,[[5,24,27,30]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"createAssetFromFile",value:function(){var e=Fa(Na().mark((function e(t,n){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){var r=new FileReader;r.onerror=function(){return t(r.error)},r.onload=Fa(Na().mark((function t(){var i,o,a,s,u,l,c,d;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.result,o=Cv(n.type),a=o?Av:Iv,"video/quicktime"===n.type&&i.includes("video/quicktime")&&(i=i.replace("video/quicktime","video/mp4")),t.next=6,a(i);case 6:if(s=t.sent,(u=Nv(s,{w:1e3,h:1e3}))===s||"image/jpeg"!==n.type&&"image/png"!==n.type){t.next=12;break}return t.next=11,Lv(i,u.w,u.h);case 11:i=t.sent;case 12:return l=Mi.createId(Be(i)),t.next=15,Dv(n);case 15:c=t.sent,d={id:l,type:o?"image":"video",typeName:"asset",props:{name:n.name,src:i,w:u.w,h:u.h,mimeType:n.type,isAnimated:c.isAnimated},meta:{}},e(d);case 18:case"end":return t.stop()}}),t)}))),r.readAsDataURL(n)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createAssetFromUrl",value:function(){var e=Fa(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(n,{method:"GET",mode:"no-cors"});case 3:return c=e.sent,e.next=6,c.text();case 6:d=e.sent,f=(new DOMParser).parseFromString(d,"text/html"),r={image:null!==(i=null===(o=f.head.querySelector('meta[property="og:image"]'))||void 0===o?void 0:o.getAttribute("content"))&&void 0!==i?i:"",title:null!==(a=null===(s=f.head.querySelector('meta[property="og:title"]'))||void 0===s?void 0:s.getAttribute("content"))&&void 0!==a?a:hu(n,32),description:null!==(u=null===(l=f.head.querySelector('meta[property="og:description"]'))||void 0===l?void 0:l.getAttribute("content"))&&void 0!==u?u:""},e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),r={image:"",title:hu(n,32),description:""};case 15:return e.abrupt("return",{id:Mi.createId(Be(n)),typeName:"asset",type:"bookmark",props:{src:n,description:r.description,image:r.image,title:r.title},meta:{}});case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),Xv=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function qv(e){return e.replace(/\t/g,dd)}function $v(e){for(var t=e.split("\n");0===t[0].trim().length;)t.shift();var n,r=1/0,i=J(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.trim().length>0){var a=o.length-o.trimStart().length;r=Math.min(r,a)}}}catch(s){i.e(s)}finally{i.f()}return t.map((function(e){return e.slice(r)})).join("\n")}function Gv(e){return e.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}function Qv(e){if(e){for(var t=Zv;e.length;)t=t.push(e.pop());return t}return Zv}Kv=Symbol.iterator;var Zv=new(function(){function e(){M(this,e),z(this,"length",0),z(this,"head",null),z(this,"tail",this)}return L(e,[{key:"push",value:function(e){return new Jv(e,this)}},{key:"toArray",value:function(){return K}},{key:Kv,value:function(){return{next:function(){return{value:void 0,done:!0}}}}}]),e}());Vv=Symbol.iterator;var Jv=function(){function e(t,n){M(this,e),z(this,"length",void 0),this.head=t,this.tail=n,this.length=n.length+1}return L(e,[{key:"push",value:function(t){return new e(t,this)}},{key:"toArray",value:function(){return Array.from(this)}},{key:Vv,value:function(){var e=this;return{next:function(){if(e.length){var t=e.head;return e=e.tail,{value:t,done:!1}}return{value:void 0,done:!0}}}}}]),e}(),eg=function(){function e(t,n,r){var i=this;M(this,e),z(this,"_undos",ue("HistoryManager.undos",Qv())),z(this,"_redos",ue("HistoryManager.redos",Qv())),z(this,"_batchDepth",0),z(this,"_commands",{}),z(this,"createCommand",(function(e,t,n){if(i._commands[e])throw new Error("Duplicate command: ".concat(e));i._commands[e]=n;return function r(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];if(!i._batchDepth)return i.batch((function(){return r.apply(void 0,a)})),i.ctx;var u=t.apply(void 0,a);if(!u)return i.ctx;var l=u.data,c=u.ephemeral,d=u.squashing,f=u.preservesRedoStack;if(i.ignoringUpdates((function(e,t){return n.do(l),{undos:e,redos:t}})),!c){var p=i._undos.value.head;d&&p&&"command"===p.type&&p.name===e&&p.preservesRedoStack===f?i._undos.update((function(e){return e.tail.push(Ce(Ce({},p),{},{id:of(),data:n.squash(p.data,l)}))})):i._undos.update((function(t){return t.push({type:"command",name:e,data:l,id:of(),preservesRedoStack:f})})),u.preservesRedoStack||i._redos.set(Qv()),i.ctx.emit("change-history",{reason:"push"})}return i.ctx}})),z(this,"batch",(function(e){try{i._batchDepth++,1===i._batchDepth?ae((function(){var t,n,r=null===(t=i._undos.value.head)||void 0===t?void 0:t.id;e(),r!==(null===(n=i._undos.value.head)||void 0===n?void 0:n.id)&&i.onBatchComplete()})):e()}catch(t){throw i.annotateError(t),t}finally{i._batchDepth--}return i})),z(this,"ignoringUpdates",(function(e){var t=i._undos.value,n=i._redos.value;i._undos.set(Qv()),i._redos.set(Qv());try{var r=ae((function(){return e(t,n)}));t=r.undos,n=r.redos}finally{i._undos.set(t),i._redos.set(n)}})),z(this,"_undo",(function(e){var t=e.pushToRedoStack,n=e.toMark,r=void 0===n?void 0:n;return i.ignoringUpdates((function(e,n){if(0===e.length)return{undos:e,redos:n};for(;"STOP"===(null===(o=e.head)||void 0===o?void 0:o.type);){var o,a=e.head;if(e=e.tail,t&&(n=n.push(a)),a.id===r)return i.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:r}),{undos:e,redos:n}}if(0===e.length)return i.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:r}),{undos:e,redos:n};for(;e.head;){var s=e.head;if(e=e.tail,t&&(n=n.push(s)),"STOP"===s.type){if(s.onUndo&&(!r||s.id===r))return i.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:r}),{undos:e,redos:n}}else i._commands[s.name].undo(s.data)}return i.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:r}),{undos:e,redos:n}})),i})),z(this,"undo",(function(){return i._undo({pushToRedoStack:!0}),i})),z(this,"redo",(function(){return i.ignoringUpdates((function(e,t){if(0===t.length)return{undos:e,redos:t};for(;"STOP"===(null===(n=t.head)||void 0===n?void 0:n.type);){var n;e=e.push(t.head),t=t.tail}if(0===t.length)return i.ctx.emit("change-history",{reason:"redo"}),{undos:e,redos:t};for(;t.head;){var r=t.head;if(e=e.push(t.head),t=t.tail,"STOP"===r.type){if(r.onRedo)break}else{var o=i._commands[r.name];o.redo?o.redo(r.data):o.do(r.data)}}return i.ctx.emit("change-history",{reason:"redo"}),{undos:e,redos:t}})),i})),z(this,"bail",(function(){return i._undo({pushToRedoStack:!1}),i})),z(this,"bailToMark",(function(e){return i._undo({pushToRedoStack:!1,toMark:e}),i})),z(this,"mark",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:of(),t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=i._undos.value.head;return r&&"STOP"===r.type&&r.id===e&&r.onUndo===t&&r.onRedo===n?r.id:(i._undos.update((function(r){return r.push({type:"STOP",id:e,onUndo:t,onRedo:n})})),i.ctx.emit("mark-history",{id:e}),e)})),this.ctx=t,this.onBatchComplete=n,this.annotateError=r}return L(e,[{key:"numUndos",get:function(){return this._undos.value.length}},{key:"numRedos",get:function(){return this._redos.value.length}},{key:"clear",value:function(){this._undos.set(Qv()),this._redos.set(Qv())}}]),e}(),tg=Object.defineProperty,ng=Object.getOwnPropertyDescriptor,rg=function(e,t,n,r){for(var i,o=r>1?void 0:r?ng(t,n):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(r?i(t,n,o):i(o))||o);return r&&o&&tg(t,n,o),o},ig=function(e){return Math.round(e*Math.pow(10,8))/Math.pow(10,8)};function og(e,t,n,r,i,o){if(o>20)return[];var a=e.filter((function(e){return("forward"===r?e.startNode.id===t:e.endNode.id===t)&&ig(e.length)===ig(n)&&vs(e.breadthIntersection[0],e.breadthIntersection[1],i[0],i[1])}));if(0===a.length)return[];var s,l=new Set,c=J(a);try{for(c.s();!(s=c.n()).done;){var d=s.value,f="forward"===r?d.endNode.id:d.startNode.id;l.has(f)||(l.add(f),a.push.apply(a,u(og(e,f,n,r,vs(d.breadthIntersection[0],d.breadthIntersection[1],i[0],i[1]),o+1))))}}catch(p){c.e(p)}finally{c.f()}return a}var ag=function(){function e(t){M(this,e),z(this,"_snapLines",ue("snapLines",void 0)),this.editor=t}return L(e,[{key:"lines",get:function(){var e;return null!==(e=this._snapLines.value)&&void 0!==e?e:K}},{key:"clear",value:function(){this.lines.length&&this._snapLines.set(void 0)}},{key:"setLines",value:function(e){this._snapLines.set(e)}},{key:"snapPointsCache",get:function(){var e=this;return this.editor.store.createComputedCache("snapPoints",(function(t){var n=e.editor.getPageTransformById(t.id);if(n)return e.editor.getShapeUtil(t).snapPoints(t).map((function(e,r){var i=Ms.applyToPoint(n,e);return{x:i.x,y:i.y,id:"".concat(t.id,":").concat(r)}}))}))}},{key:"snapThreshold",get:function(){return 8/this.editor.zoomLevel}},{key:"snappableShapes",get:function(){var e,t=this.editor,n=t.selectedIds,r=t.renderingBounds,i=[];return function e(o){var a,s=J(t.getSortedChildIds(o));try{for(s.s();!(a=s.n()).done;){var u=a.value;if(!n.includes(u)){var l=t.getShapeById(u);if(l){var c=t.getShapeUtil(l);if(c.canSnap(l)){var d=t.getPageBoundsById(u);d&&r.includes(d)&&(t.isShapeOfType(l,Hp)?e(u):i.push({id:u,pageBounds:d,isClosed:c.isClosed(l)}))}}}}}catch(f){s.e(f)}finally{s.f()}}(null!==(e=this.currentCommonAncestor)&&void 0!==e?e:t.currentPageId),i}},{key:"currentCommonAncestor",get:function(){return this.editor.findCommonAncestor(this.editor.selectedShapes)}},{key:"snappablePoints",get:function(){var e=this.snappableShapes,t=this.snapPointsCache,n=[];return e.forEach((function(e){var r=t.get(e.id);r&&n.push.apply(n,u(r))})),n}},{key:"visibleGaps",get:function(){for(var e,t,n=[],r=[],i=this.snappableShapes.sort((function(e,t){return e.pageBounds.minX-t.pageBounds.minX})),o=0;o<i.length;o++){e=i[o];for(var a=o+1;a<i.length;a++)t=i[a],e.pageBounds.maxX<t.pageBounds.minX&&hs(e.pageBounds.minY,e.pageBounds.maxY,t.pageBounds.minY,t.pageBounds.maxY)&&n.push({startNode:e,endNode:t,startEdge:[new Xa(e.pageBounds.maxX,e.pageBounds.minY),new Xa(e.pageBounds.maxX,e.pageBounds.maxY)],endEdge:[new Xa(t.pageBounds.minX,t.pageBounds.minY),new Xa(t.pageBounds.minX,t.pageBounds.maxY)],length:t.pageBounds.minX-e.pageBounds.maxX,breadthIntersection:vs(e.pageBounds.minY,e.pageBounds.maxY,t.pageBounds.minY,t.pageBounds.maxY)})}for(var s=i.sort((function(e,t){return e.pageBounds.minY-t.pageBounds.minY})),u=0;u<s.length;u++){e=s[u];for(var l=u+1;l<s.length;l++)t=s[l],e.pageBounds.maxY<t.pageBounds.minY&&hs(e.pageBounds.minX,e.pageBounds.maxX,t.pageBounds.minX,t.pageBounds.maxX)&&r.push({startNode:e,endNode:t,startEdge:[new Xa(e.pageBounds.minX,e.pageBounds.maxY),new Xa(e.pageBounds.maxX,e.pageBounds.maxY)],endEdge:[new Xa(t.pageBounds.minX,t.pageBounds.minY),new Xa(t.pageBounds.maxX,t.pageBounds.minY)],length:t.pageBounds.minY-e.pageBounds.maxY,breadthIntersection:vs(e.pageBounds.minX,e.pageBounds.maxX,t.pageBounds.minX,t.pageBounds.maxX)})}return{horizontal:n,vertical:r}}},{key:"snapTranslate",value:function(e){var t,n,r,i,o=e.lockedAxis,a=e.initialSelectionPageBounds,s=e.initialSelectionSnapPoints,l=e.dragDelta,c=this.snappablePoints,d=this.snapThreshold,f=a.clone().translate(l),p=s.map((function(e,t){var n=e.x,r=e.y;return{id:"selection:"+t,x:n+l.x,y:r+l.y}})),h=c,v=[],g=[],m=new Xa(d,d);this.collectPointSnaps({minOffset:m,nearestSnapsX:v,nearestSnapsY:g,otherNodeSnapPoints:h,selectionSnapPoints:p}),this.collectGapSnaps({selectionPageBounds:f,nearestSnapsX:v,nearestSnapsY:g,minOffset:m});var y=new Xa("x"===o?0:null!==(t=null===(n=v[0])||void 0===n?void 0:n.nudge)&&void 0!==t?t:0,"y"===o?0:null!==(r=null===(i=g[0])||void 0===i?void 0:i.nudge)&&void 0!==r?r:0);m.x=0,m.y=0,v.length=0,g.length=0,p.forEach((function(e){e.x+=y.x,e.y+=y.y})),f.translate(y),this.collectPointSnaps({minOffset:m,nearestSnapsX:v,nearestSnapsY:g,otherNodeSnapPoints:h,selectionSnapPoints:p}),this.collectGapSnaps({selectionPageBounds:f,nearestSnapsX:v,nearestSnapsY:g,minOffset:m});var b=this.getPointSnapLines({nearestSnapsX:v,nearestSnapsY:g}),w=this.getGapSnapLines({selectionPageBounds:f,nearestSnapsX:v,nearestSnapsY:g});return this._snapLines.set([].concat(u(w),u(b))),{nudge:y}}},{key:"outlinesInPageSpace",get:function(){var e=this;return this.snappableShapes.map((function(t){var n=t.id,r=t.isClosed,i=We(e.editor.getOutlineById(n));r&&i.push(i[0]);var o=e.editor.getPageTransformById(n);if(!o)throw Error("No page transform");return Ms.applyToPoints(o,i)}))}},{key:"getSnappingHandleDelta",value:function(e){var t,n,r,i,o,a=e.handlePoint,s=e.additionalSegments,l=this.outlinesInPageSpace,c=this.snapThreshold,d=null,f=J([].concat(u(l),u(s)));try{for(f.s();!(o=f.n()).done;)for(var p=o.value,h=0;h<p.length-1;h++)t=p[h],n=p[h+1],r=Xa.NearestPointOnLineSegment(t,n,a),i=Xa.Dist(a,r),isNaN(i)||i<c&&(c=i,d=r)}catch(v){f.e(v)}finally{f.f()}return d?(this._snapLines.set([{id:of(),type:"points",points:[d]}]),Xa.Sub(d,a)):null}},{key:"snapResize",value:function(e){var t,n,r,i,o=e.initialSelectionPageBounds,a=e.dragDelta,s=e.handle,l=e.isAspectRatioLocked,c=e.isResizingFromCenter,d=this.snapThreshold,f=ks.Resize(o,s,c?2*a.x:a.x,c?2*a.y:a.y,l),p=f.box,h=f.scaleX,v=f.scaleY,g=s;h<0&&(g=function(e){switch(e){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return e}}(g)),v<0&&(g=function(e){switch(e){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return e}}(g)),c&&(p.center=o.center);var m="top"===g||"bottom"===g,y="left"===g||"right"===g,b=sg(g,p),w=this.snappablePoints,x=[],k=[],S=new Xa(d,d);this.collectPointSnaps({minOffset:S,nearestSnapsX:x,nearestSnapsY:k,otherNodeSnapPoints:w,selectionSnapPoints:b});var _,P=new Xa(m?0:null!==(t=null===(n=x[0])||void 0===n?void 0:n.nudge)&&void 0!==t?t:0,y?0:null!==(r=null===(i=k[0])||void 0===i?void 0:i.nudge)&&void 0!==r?r:0);if(l&&("top_left"===(_=g)||"top_right"===_||"bottom_right"===_||"bottom_left"===_)&&0!==P.len()){var E=x.length&&k.length?Math.abs(P.x)<Math.abs(P.y)?"x":"y":x.length?"x":"y",C=o.aspectRatio;"x"===E?(k.length=0,P.y=P.x/C,"bottom_left"!==g&&"top_right"!==g||(P.y=-P.y)):(x.length=0,P.x=P.y*C,"bottom_left"!==g&&"top_right"!==g||(P.x=-P.x))}var I=Xa.Add(a,P),T=ks.Resize(o,s,c?2*I.x:I.x,c?2*I.y:I.y,l).box;c&&(T.center=o.center);var M=sg("any",T);x.length=0,k.length=0,S.x=0,S.y=0,this.collectPointSnaps({minOffset:S,nearestSnapsX:x,nearestSnapsY:k,otherNodeSnapPoints:w,selectionSnapPoints:M});var j=this.getPointSnapLines({nearestSnapsX:x,nearestSnapsY:k});return this._snapLines.set(u(j)),{nudge:P}}},{key:"collectPointSnaps",value:function(e){var t,n=e.selectionSnapPoints,r=e.otherNodeSnapPoints,i=e.minOffset,o=e.nearestSnapsX,a=e.nearestSnapsY,s=J(n);try{for(s.s();!(t=s.n()).done;){var u,l=t.value,c=J(r);try{for(c.s();!(u=c.n()).done;){var d=u.value,f=Xa.Sub(l,d),p=Math.abs(f.x),h=Math.abs(f.y);ig(p)<=ig(i.x)&&(ig(p)<ig(i.x)&&(o.length=0),o.push({type:"points",points:{thisPoint:l,otherPoint:d},nudge:d.x-l.x}),i.x=p),ig(h)<=ig(i.y)&&(ig(h)<ig(i.y)&&(a.length=0),a.push({type:"points",points:{thisPoint:l,otherPoint:d},nudge:d.y-l.y}),i.y=h)}}catch(v){c.e(v)}finally{c.f()}}}catch(v){s.e(v)}finally{s.f()}}},{key:"collectGapSnaps",value:function(e){var t,n=e.selectionPageBounds,r=e.minOffset,i=e.nearestSnapsX,o=e.nearestSnapsY,a=this.visibleGaps,s=a.horizontal,u=a.vertical,l=J(s);try{for(l.s();!(t=l.n()).done;){var c=t.value;if(hs(c.breadthIntersection[0],c.breadthIntersection[1],n.minY,n.maxY)){var d=c.startEdge[0].x+c.length/2-n.center.x;if(c.length>n.width&&ig(Math.abs(d))<=ig(r.x)){ig(Math.abs(d))<ig(r.x)&&(i.length=0),r.x=Math.abs(d);var f={type:"gap_center",gap:c,nudge:d},p=i.find((function(e){return"gap_center"===e.type})),h=p&&vs(c.breadthIntersection[0],c.breadthIntersection[1],p.gap.breadthIntersection[0],p.gap.breadthIntersection[1]);p&&p.gap.length>c.length&&h?i[i.indexOf(p)]=f:p&&h||i.push(f)}var v=c.startNode.pageBounds.minX-c.length-n.maxX;ig(Math.abs(v))<=ig(r.x)&&(ig(Math.abs(v))<ig(r.x)&&(i.length=0),r.x=Math.abs(v),i.push({type:"gap_duplicate",gap:c,protrusionDirection:"left",nudge:v}));var g=c.endNode.pageBounds.maxX+c.length-n.minX;ig(Math.abs(g))<=ig(r.x)&&(ig(Math.abs(g))<ig(r.x)&&(i.length=0),r.x=Math.abs(g),i.push({type:"gap_duplicate",gap:c,protrusionDirection:"right",nudge:g}))}}}catch(E){l.e(E)}finally{l.f()}var m,y=J(u);try{for(y.s();!(m=y.n()).done;){var b=m.value;if(hs(b.breadthIntersection[0],b.breadthIntersection[1],n.minX,n.maxX)){var w=b.startEdge[0].y+b.length/2-n.center.y;if(b.length>n.height&&ig(Math.abs(w))<=ig(r.y)){ig(Math.abs(w))<ig(r.y)&&(o.length=0),r.y=Math.abs(w);var x={type:"gap_center",gap:b,nudge:w},k=o.find((function(e){return"gap_center"===e.type})),S=k&&hs(k.gap.breadthIntersection[0],k.gap.breadthIntersection[1],b.breadthIntersection[0],b.breadthIntersection[1]);k&&k.gap.length>b.length&&S?o[o.indexOf(k)]=x:k&&S||o.push(x)}else{var _=b.startNode.pageBounds.minY-b.length-n.maxY;ig(Math.abs(_))<=ig(r.y)&&(ig(Math.abs(_))<ig(r.y)&&(o.length=0),r.y=Math.abs(_),o.push({type:"gap_duplicate",gap:b,protrusionDirection:"top",nudge:_}));var P=b.endNode.pageBounds.maxY+b.length-n.minY;ig(Math.abs(P))<=ig(r.y)&&(ig(Math.abs(P))<ig(r.y)&&(o.length=0),r.y=Math.abs(P),o.push({type:"gap_duplicate",gap:b,protrusionDirection:"bottom",nudge:P}))}}}}catch(E){y.e(E)}finally{y.f()}}},{key:"getPointSnapLines",value:function(e){var t=e.nearestSnapsX,n=e.nearestSnapsY,r={},i={};if(t.length>0){var o,a=J(t);try{for(a.s();!(o=a.n()).done;){var s=o.value;if("points"===s.type){var u=ig(s.points.otherPoint.x);r[u]||(r[u]=[]),r[u].push(s.points)}}}catch(p){a.e(p)}finally{a.f()}}if(n.length>0){var l,c=J(n);try{for(c.s();!(l=c.n()).done;){var d=l.value;if("points"===d.type){var f=ig(d.points.otherPoint.y);i[f]||(i[f]=[]),i[f].push(d.points)}}}catch(p){c.e(p)}finally{c.f()}}return Object.values(r).concat(Object.values(i)).map((function(e){return{id:of(),type:"points",points:Ie(e.map((function(e){return Xa.From(e.otherPoint)})).concat(e.map((function(e){return Xa.From(e.thisPoint)}))),(function(e,t){return e.equals(t)}))}}))}},{key:"getGapSnapLines",value:function(e){var t=e.selectionPageBounds,n=e.nearestSnapsX,r=e.nearestSnapsY,i=this.visibleGaps,o=i.vertical,a=i.horizontal,s={top:t.sides[0],right:t.sides[1],bottom:[t.corners[3],t.corners[2]],left:[t.corners[0],t.corners[3]]},l=[];if(n.length>0){var c,d=J(n);try{var f=function(){var e=c.value;if("points"===e.type)return 1;var n=e.gap,r=n.breadthIntersection,i=n.startEdge,o=n.startNode,d=n.endNode,f=n.length,p=n.endEdge;switch(e.type){case"gap_center":var h=(f-t.width)/2,v=vs(r[0],r[1],t.minY,t.maxY);l.push({type:"gaps",direction:"horizontal",id:of(),gaps:[].concat(u(og(a,o.id,h,"backward",v,0)),[{startEdge:i,endEdge:s.left},{startEdge:s.right,endEdge:p}],u(og(a,d.id,h,"forward",v,0)))});break;case"gap_duplicate":var g=vs(r[0],r[1],t.minY,t.maxY);l.push({type:"gaps",direction:"horizontal",id:of(),gaps:"left"===e.protrusionDirection?[{startEdge:s.right,endEdge:i.map((function(e){return e.clone().addXY(-o.pageBounds.width,0)}))},{startEdge:i,endEdge:p}].concat(u(og(a,d.id,f,"forward",g,0))):[].concat(u(og(a,o.id,f,"backward",g,0)),[{startEdge:i,endEdge:p},{startEdge:p.map((function(t){return t.clone().addXY(e.gap.endNode.pageBounds.width,0)})),endEdge:s.left}])})}};for(d.s();!(c=d.n()).done;)f()}catch(g){d.e(g)}finally{d.f()}}if(r.length>0){var p,h=J(r);try{var v=function(){var e=p.value;if("points"===e.type)return 1;var n=e.gap,r=n.breadthIntersection,i=n.startEdge,a=n.startNode,c=n.endNode,d=n.length,f=n.endEdge;switch(e.type){case"gap_center":var h=(d-t.height)/2,v=vs(r[0],r[1],t.minX,t.maxX);l.push({type:"gaps",direction:"vertical",id:of(),gaps:[].concat(u(og(o,a.id,h,"backward",v,0)),[{startEdge:i,endEdge:s.top},{startEdge:s.bottom,endEdge:f}],u(og(o,e.gap.endNode.id,h,"forward",v,0)))});break;case"gap_duplicate":var g=vs(r[0],r[1],t.minX,t.maxX);l.push({type:"gaps",direction:"vertical",id:of(),gaps:"top"===e.protrusionDirection?[{startEdge:s.bottom,endEdge:i.map((function(e){return e.clone().addXY(0,-a.pageBounds.height)}))},{startEdge:i,endEdge:f}].concat(u(og(o,c.id,d,"forward",g,0))):[].concat(u(og(o,a.id,d,"backward",g,0)),[{startEdge:i,endEdge:f},{startEdge:f.map((function(e){return e.clone().addXY(0,c.pageBounds.height)})),endEdge:s.top}])})}};for(h.s();!(p=h.n()).done;)v()}catch(g){h.e(g)}finally{h.f()}}return function(e){e.sort((function(e,t){return t.gaps.length-e.gaps.length}));for(var t=e.length-1;t>0;t--)for(var n=e[t],r=function(){var r=e[i];if(r.direction===n.direction&&n.gaps.every((function(e){return r.gaps.some((function(t){return ig(e.startEdge[0].x)===ig(t.startEdge[0].x)&&ig(e.startEdge[0].y)===ig(t.startEdge[0].y)&&ig(e.startEdge[1].x)===ig(t.startEdge[1].x)&&ig(e.startEdge[1].y)===ig(t.startEdge[1].y)}))&&r.gaps.some((function(t){return ig(e.endEdge[0].x)===ig(t.endEdge[0].x)&&ig(e.endEdge[0].y)===ig(t.endEdge[0].y)&&ig(e.endEdge[1].x)===ig(t.endEdge[1].x)&&ig(e.endEdge[1].y)===ig(t.endEdge[1].y)}))})))return e.splice(t,1),1},i=t-1;i>=0&&!r();i--);}(l),l}}]),e}();function sg(e,t){var n=t.minX,r=t.maxX,i=t.minY,o=t.maxY,a=[];switch(e){case"top":case"left":case"top_left":case"any":a.push({id:"top_left",handle:"top_left",x:n,y:i})}switch(e){case"top":case"right":case"top_right":case"any":a.push({id:"top_right",handle:"top_right",x:r,y:i})}switch(e){case"bottom":case"right":case"bottom_right":case"any":a.push({id:"bottom_right",handle:"bottom_right",x:r,y:o})}switch(e){case"bottom":case"left":case"bottom_left":case"any":a.push({id:"bottom_left",handle:"bottom_left",x:n,y:o})}return a}rg([ve],ag.prototype,"snapPointsCache",1),rg([ve],ag.prototype,"snapThreshold",1),rg([ve],ag.prototype,"snappableShapes",1),rg([ve],ag.prototype,"currentCommonAncestor",1),rg([ve],ag.prototype,"snappablePoints",1),rg([ve],ag.prototype,"visibleGaps",1),rg([ve],ag.prototype,"outlinesInPageSpace",1);var ug={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},lg=/\s/,cg=function(){function e(t){var n=this;M(this,e),z(this,"measureText",(function(e,t){var r,i=n.getTextElement();i.setAttribute("dir","ltr"),i.style.setProperty("font-family",t.fontFamily),i.style.setProperty("font-style",t.fontStyle),i.style.setProperty("font-weight",t.fontWeight),i.style.setProperty("font-size",t.fontSize+"px"),i.style.setProperty("line-height",t.lineHeight*t.fontSize+"px"),i.style.setProperty("width",t.width),i.style.setProperty("min-width",null!==(r=t.minWidth)&&void 0!==r?r:null),i.style.setProperty("max-width",t.maxWidth),i.style.setProperty("padding",t.padding),i.textContent=fd.normalizeTextForDom(e);var o=i.getBoundingClientRect();return{x:0,y:0,w:o.width,h:o.height}})),this.editor=t}return L(e,[{key:"getTextElement",value:function(){var e=document.querySelector(".tl-text-measure");null===e||void 0===e||e.remove();var t=document.createElement("div");return this.editor.getContainer().appendChild(t),t.id="__textMeasure_".concat(of()),t.classList.add("tl-text"),t.classList.add("tl-text-measure"),t.tabIndex=-1,t}},{key:"measureElementTextNodeSpans",value:function(e){var t,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).shouldTruncateToFirstLine,r=void 0!==n&&n,i=[],o=e.getBoundingClientRect(),a=-o.left,s=-o.top,u=new Range,l=e.childNodes[0],c=0,d=null,f=null,p=0,h=!1,v=J(e.childNodes);try{for(v.s();!(t=v.n()).done;){var g,m=t.value;if(m.nodeType===Node.TEXT_NODE){var y,b=J(null!==(g=m.textContent)&&void 0!==g?g:"");try{for(b.s();!(y=b.n()).done;){var w=y.value;u.setStart(l,c),u.setEnd(l,c+w.length);var x=u.getClientRects(),k=x[x.length-1],S=k.top+s,_=k.left+a,P=k.right+a,E=lg.test(w);if(E===f&&S===p&&d)d.box.w=P-d.box.x,d.text+=w;else{if(d){if(r&&S!==p){h=!0;break}i.push(d)}d={box:{x:_,y:S,w:k.width,h:k.height},text:w}}f=E,p=S,c+=w.length}}catch(C){b.e(C)}finally{b.f()}}}}catch(C){v.e(C)}finally{v.f()}return d&&i.push(d),{spans:i,didTruncate:h}}},{key:"measureTextSpans",value:function(e,t){var n="truncate-ellipsis"===t.overflow||"truncate-clip"===t.overflow,r=this.getTextElement(),i=Math.ceil(t.width-2*t.padding);r.style.setProperty("width","".concat(i,"px")),r.style.setProperty("height","min-content"),r.style.setProperty("dir","ltr"),r.style.setProperty("font-size","".concat(t.fontSize,"px")),r.style.setProperty("font-family",t.fontFamily),r.style.setProperty("font-weight",t.fontWeight),r.style.setProperty("line-height","".concat(t.lineHeight*t.fontSize,"px")),r.style.setProperty("text-align",ug[t.textAlign]),n&&(r.style.setProperty("overflow-wrap","anywhere"),r.style.setProperty("word-break","break-all")),r.textContent=e;var o=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:n}),a=o.spans,s=o.didTruncate;if("truncate-ellipsis"===t.overflow&&s){r.textContent="\u2026";var u=Math.ceil(this.measureElementTextNodeSpans(r).spans[0].box.w);r.style.setProperty("width","".concat(i-u,"px")),r.textContent=e;var l=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:!0}).spans,c=l[l.length-1];return l.push({text:"\u2026",box:{x:Math.min(c.box.x+c.box.w,t.width-t.padding-u),y:c.box.y,w:u,h:c.box.h}}),l}return r.remove(),a}}]),e}(),dg=L((function e(t){var n=this;M(this,e),z(this,"raf",void 0),z(this,"isPaused",!0),z(this,"last",0),z(this,"t",0),z(this,"start",(function(){n.isPaused=!1,cancelAnimationFrame(n.raf),n.raf=requestAnimationFrame(n.tick),n.last=Date.now()})),z(this,"tick",(function(){if(!n.isPaused){var e=Date.now(),t=e-n.last;n.last=e,n.t+=t,n.editor.emit("frame",t),n.t<16||(n.t-=16,n.updatePointerVelocity(t),n.editor.emit("tick",t)),n.raf=requestAnimationFrame(n.tick)}})),z(this,"dispose",(function(){n.isPaused=!0,cancelAnimationFrame(n.raf)})),z(this,"prevPoint",new Xa),z(this,"updatePointerVelocity",(function(e){var t=n.prevPoint,r=n.editor.inputs,i=r.currentScreenPoint,o=r.pointerVelocity;if(0!==e){var a=Xa.Sub(i,t);n.prevPoint=i.clone();var s=a.len(),u=s?a.div(s):new Xa(0,0),l=o.clone().lrp(u.mul(s/e),.5);Math.abs(l.x)<.01&&(l.x=0),Math.abs(l.y)<.01&&(l.y=0),o.equals(l)||(n.editor.inputs.pointerVelocity=l)}})),this.editor=t,this.editor.disposables.add(this.dispose),this.start()})),fg=function(){function e(t){var n=this;M(this,e),z(this,"updateUserPreferences",(function(e){n.user.setUserPreferences(Ce(Ce({},n.user.userPreferences.value),e))})),this.user=t}return L(e,[{key:"userPreferences",get:function(){return this.user.userPreferences}},{key:"isDarkMode",get:function(){return this.user.userPreferences.value.isDarkMode}},{key:"animationSpeed",get:function(){return this.user.userPreferences.value.animationSpeed}},{key:"id",get:function(){return this.user.userPreferences.value.id}},{key:"name",get:function(){return this.user.userPreferences.value.name}},{key:"locale",get:function(){return this.user.userPreferences.value.locale}},{key:"color",get:function(){return this.user.userPreferences.value.color}},{key:"isSnapMode",get:function(){return this.user.userPreferences.value.isSnapMode}}]),e}(),pg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"brush",new ks),z(_t(e),"initialSelectedIds",[]),z(_t(e),"excludedShapeIds",new Set),z(_t(e),"initialStartShape",null),z(_t(e),"onEnter",(function(t){var n=e.editor.inputs,r=n.altKey,i=n.currentPagePoint;r?e.parent.transition("scribble_brushing",t):(e.excludedShapeIds=new Set(e.editor.shapesArray.filter((function(t){return e.editor.isShapeOfType(t,Hp)||e.editor.isShapeOrAncestorLocked(t)})).map((function(e){return e.id}))),e.info=t,e.initialSelectedIds=e.editor.selectedIds.slice(),e.initialStartShape=e.editor.getShapesAtPoint(i)[0],e.onPointerMove())})),z(_t(e),"onExit",(function(){e.initialSelectedIds=[],e.editor.setBrush(null)})),z(_t(e),"onPointerMove",(function(){e.hitTestShapes()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onCancel",(function(t){e.editor.setSelectedIds(e.initialSelectedIds,!0),e.parent.transition("idle",t)})),z(_t(e),"onKeyDown",(function(t){e.editor.inputs.altKey?e.parent.transition("scribble_brushing",t):e.hitTestShapes()})),z(_t(e),"onKeyUp",(function(){e.hitTestShapes()})),z(_t(e),"onInterrupt",(function(){e.editor.setBrush(null)})),e}return L(n,[{key:"complete",value:function(){this.parent.transition("idle",{})}},{key:"hitTestShapes",value:function(){var e=this.editor,t=e.currentPageId,n=e.shapesArray,r=e.inputs,i=r.originPagePoint,o=r.currentPagePoint,a=r.shiftKey,s=r.ctrlKey;this.brush.setTo(ks.FromPoints([i,o]));var u,l,c,d,f,p,h,v=new Set(a?this.initialSelectedIds:[]),g=this.brush.corners,m=this.excludedShapeIds;e:for(var y=0,b=n.length;y<b;y++)if(c=n[y],!m.has(c.id)&&!v.has(c.id)&&(f=this.editor.getPageBounds(c)))if(this.brush.contains(f))this.handleHit(c,o,t,v,g);else if(!s&&!this.editor.isShapeOfType(c,qp)&&this.brush.collides(f)){if(d=this.editor.getShapeUtil(c),!(p=this.editor.getPageTransform(c)))continue e;h=Ms.applyToPoints(Ms.Inverse(p),g);t:for(var w=0;w<h.length;w++)if(u=h[w],l=h[(w+1)%h.length],d.hitTestLineSegment(c,u,l)){this.handleHit(c,o,t,v,g);break t}}this.editor.setBrush(Ce({},this.brush.toJson())),this.editor.setSelectedIds(Array.from(v),!0)}},{key:"handleHit",value:function(e,t,n,r,i){if(e.parentId!==n){var o=this.editor.getOutermostSelectableShape(e),a=this.editor.getPageMaskById(o.id);a&&null!==function(e,t){for(var n,r,i=0,o=e.length;i<o;i++){n=e[i],r=e[(i+1)%o];for(var a=0,s=t.length;a<s;a++)if(Xs(n,r,t[a],t[(a+1)%s]))return!0}return!1}(a,i)&&!ms(t,a)||r.add(o.id)}else r.add(e.id)}}]),n}(If);function hg(e,t,n){if(!t)throw Error("Needs to translate a cropped shape!");var r=t.props.crop;if(r){var i=e.inputs.shiftKey?Math.abs(n.x)<Math.abs(n.y)?"x":"y":null;"x"===i?n.x=0:"y"===i&&(n.y=0),n.rot(-t.rotation);var o=1/(r.bottomRight.x-r.topLeft.x)*t.props.w,a=1/(r.bottomRight.y-r.topLeft.y)*t.props.h,s=r.bottomRight.y-r.topLeft.y,u=r.bottomRight.x-r.topLeft.x,l=We(r);return l.topLeft.x=Math.min(1-u,Math.max(0,l.topLeft.x-n.x/o)),l.topLeft.y=Math.min(1-s,Math.max(0,l.topLeft.y-n.y/a)),l.bottomRight.x=l.topLeft.x+u,l.bottomRight.y=l.topLeft.y+s,{id:t.id,type:t.type,props:{crop:l}}}}z(pg,"id","brushing");var vg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.editor.setCursor({type:"default"});var t=e.editor.onlySelectedShape;e.editor.on("change-history",e.cleanupCroppingState),e.editor.mark("crop"),t&&e.editor.setCroppingId(t.id)})),z(_t(e),"onExit",(function(){e.editor.setCursor({type:"default"}),e.editor.off("change-history",e.cleanupCroppingState)})),z(_t(e),"onCancel",(function(){e.editor.setCroppingId(null),e.editor.setSelectedTool("select.idle",{})})),z(_t(e),"onPointerDown",(function(t){if(!e.editor.isMenuOpen){if(t.ctrlKey)return e.editor.setCroppingId(null),void e.editor.setSelectedTool("select.brushing",t);switch(t.target){case"canvas":e.cancel();break;case"shape":if(t.shape.id===e.editor.croppingId)return void e.editor.setSelectedTool("select.crop.pointing_crop",t);var n;null!==(n=e.editor.getShapeUtil(t.shape))&&void 0!==n&&n.canCrop(t.shape)?(e.editor.setCroppingId(t.shape.id),e.editor.setSelectedIds([t.shape.id]),e.editor.setSelectedTool("select.crop.pointing_crop",t)):e.cancel();break;case"selection":switch(t.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":e.editor.setSelectedTool("select.pointing_rotate_handle",Ce(Ce({},t),{},{onInteractionEnd:"select.crop"}));break;case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":e.editor.setSelectedTool("select.pointing_crop_handle",Ce(Ce({},t),{},{onInteractionEnd:"select.crop"}));break;default:e.cancel()}}}})),z(_t(e),"onDoubleClick",(function(t){if("up"===t.phase&&e.editor.croppingId){var n=e.editor.getShapeById(e.editor.croppingId);if(n){var r,i=e.editor.getShapeUtil(n);if(i)if("selection"===t.target)null===(r=i.onDoubleClickEdge)||void 0===r||r.call(i,n)}}})),z(_t(e),"onKeyDown",(function(){e.nudgeCroppingImage(!1)})),z(_t(e),"onKeyRepeat",(function(){e.nudgeCroppingImage(!0)})),z(_t(e),"onKeyUp",(function(t){if("Enter"===t.code)e.editor.setCroppingId(null),e.editor.setSelectedTool("select.idle",{})})),z(_t(e),"cleanupCroppingState",(function(){e.editor.croppingId||e.editor.setSelectedTool("select.idle",{})})),e}return L(n,[{key:"cancel",value:function(){this.editor.setCroppingId(null),this.editor.setSelectedTool("select.idle",{})}},{key:"nudgeCroppingImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.editor.inputs.keys,n=t.has("ShiftLeft"),r=new Xa(0,0);if(t.has("ArrowLeft")&&(r.x+=1),t.has("ArrowRight")&&(r.x-=1),t.has("ArrowUp")&&(r.y+=1),t.has("ArrowDown")&&(r.y-=1),!r.equals(new Xa(0,0))){n&&r.mul(10);var i=this.editor.getShapeById(this.editor.croppingId);if(i){var o=hg(this.editor,i,r);o&&(e||this.editor.mark("translate crop"),this.editor.updateShapes([o]))}}}}]),n}(If);z(vg,"id","idle");var gg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onCancel",(function(){e.editor.setSelectedTool("select.crop.idle",{})})),z(_t(e),"onPointerMove",(function(t){e.editor.inputs.isDragging&&e.editor.setSelectedTool("select.crop.translating_crop",t)})),z(_t(e),"onPointerUp",(function(t){e.editor.setSelectedTool("select.crop.idle",t)})),e}return L(n)}(If);z(gg,"id","pointing_crop");var mg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"markId","translating crop"),z(_t(e),"snapshot",{}),z(_t(e),"onEnter",(function(t){e.info=t,e.snapshot=e.createSnapshot(),e.editor.mark(e.markId),e.editor.setCursor({type:"move"}),e.updateShapes()})),z(_t(e),"onExit",(function(){e.editor.setCursor({type:"default"})})),z(_t(e),"onPointerMove",(function(){e.updateShapes()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onKeyDown",(function(t){switch(t.key){case"Alt":case"Shift":return void e.updateShapes()}})),z(_t(e),"onKeyUp",(function(t){switch(t.key){case"Enter":return void e.complete();case"Alt":case"Shift":e.updateShapes()}})),e}return L(n,[{key:"complete",value:function(){this.updateShapes(),this.editor.setSelectedTool("select.crop.idle",this.info)}},{key:"cancel",value:function(){this.editor.bailToMark(this.markId),this.editor.setSelectedTool("select.crop.idle",this.info)}},{key:"createSnapshot",value:function(){return{shape:this.editor.onlySelectedShape}}},{key:"updateShapes",value:function(){var e=this.snapshot.shape;if(e){var t=this.editor.inputs,n=t.originPagePoint,r=t.currentPagePoint.clone().sub(n),i=hg(this.editor,e,r);i&&this.editor.updateShapes([i],!0)}}}]),n}(If);z(mg,"id","translating_crop");var yg=function(e){Et(n,e);var t=Tt(n);function n(){return M(this,n),t.apply(this,arguments)}return L(n)}(If);z(yg,"id","crop"),z(yg,"initial","idle"),z(yg,"children",(function(){return[vg,mg,gg]}));var bg={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"},wg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"onEnter",(function(t){e.info=t,e.updateCursor()})),z(_t(e),"onPointerMove",(function(){e.editor.inputs.isDragging&&e.parent.transition("resizing",e.info)})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.cancel()})),z(_t(e),"onInterrupt",(function(){e.cancel()})),e}return L(n,[{key:"updateCursor",value:function(){var e=this.editor.selectedShapes,t=bg[this.info.handle];this.editor.setCursor({type:t,rotation:1===e.length?e[0].rotation:0})}},{key:"complete",value:function(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}}]),n}(If);z(wg,"id","pointing_resize_handle");var xg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"markId",""),z(_t(e),"snapshot",{}),z(_t(e),"onEnter",(function(t){e.info=t,e.markId=e.editor.mark("cropping"),e.snapshot=e.createSnapshot(),e.updateShapes()})),z(_t(e),"onPointerMove",(function(){e.updateShapes()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"getDefaultCrop",(function(){return{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}}})),e}return L(n,[{key:"updateCursor",value:function(){var e=this.editor.selectedShapes[0];if(e){var t=bg[this.info.handle];this.editor.setCursor({type:t,rotation:e.rotation})}}},{key:"updateShapes",value:function(){var e,t=this.snapshot,n=t.shape,r=t.cursorHandleOffset;if(n&&this.editor.getShapeUtil(Mh)){var i=n.props,o=this.editor.inputs.currentPagePoint.clone().sub(r),a=this.editor.inputs.originPagePoint.clone().sub(r),s=o.clone().sub(a).rot(-n.rotation),u=null!==(e=i.crop)&&void 0!==e?e:this.getDefaultCrop(),l=We(u),c=new Xa(n.x,n.y),d=new Xa(0,0),f=1/(u.bottomRight.x-u.topLeft.x)*i.w,p=1/(u.bottomRight.y-u.topLeft.y)*i.h,h=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":if(p<8)break;h=!0,l.topLeft.y=l.topLeft.y+s.y/p,p*(l.bottomRight.y-l.topLeft.y)<8?(l.topLeft.y=l.bottomRight.y-8/p,d.y=(l.topLeft.y-u.topLeft.y)*p):l.topLeft.y<=0?(l.topLeft.y=0,d.y=(l.topLeft.y-u.topLeft.y)*p):d.y=s.y;break;case"bottom":case"bottom_left":case"bottom_right":if(p<8)break;h=!0,l.bottomRight.y=Math.min(1,l.bottomRight.y+s.y/p),p*(l.bottomRight.y-l.topLeft.y)<8&&(l.bottomRight.y=l.topLeft.y+8/p)}switch(this.info.handle){case"left":case"top_left":case"bottom_left":if(f<8)break;h=!0,l.topLeft.x=l.topLeft.x+s.x/f,f*(l.bottomRight.x-l.topLeft.x)<8?(l.topLeft.x=l.bottomRight.x-8/f,d.x=(l.topLeft.x-u.topLeft.x)*f):l.topLeft.x<=0?(l.topLeft.x=0,d.x=(l.topLeft.x-u.topLeft.x)*f):d.x=s.x;break;case"right":case"top_right":case"bottom_right":if(f<8)break;h=!0,l.bottomRight.x=Math.min(1,l.bottomRight.x+s.x/f),f*(l.bottomRight.x-l.topLeft.x)<8&&(l.bottomRight.x=l.topLeft.x+8/f)}if(h){c.add(d.rot(n.rotation));var v={id:n.id,type:n.type,x:c.x,y:c.y,props:{crop:l,w:(l.bottomRight.x-l.topLeft.x)*f,h:(l.bottomRight.y-l.topLeft.y)*p}};this.editor.updateShapes([v],!0),this.updateCursor()}}}},{key:"complete",value:function(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}},{key:"cancel",value:function(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}},{key:"createSnapshot",value:function(){var e=this.editor,t=e.selectionRotation,n=e.inputs.originPagePoint,r=this.editor.onlySelectedShape,i=this.editor.selectionBounds,o=Xa.RotWith(i.getHandlePoint(this.info.handle),i.point,t);return{shape:r,cursorHandleOffset:Xa.Sub(n,o)}}}]),n}(If);z(xg,"id","cropping");var kg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"shapeId",""),z(_t(e),"initialHandle",{}),z(_t(e),"initialAdjacentHandle",null),z(_t(e),"markId",""),z(_t(e),"initialPageTransform",void 0),z(_t(e),"initialPageRotation",void 0),z(_t(e),"info",{}),z(_t(e),"isPrecise",!1),z(_t(e),"isPreciseId",null),z(_t(e),"pointingId",null),z(_t(e),"onEnter",(function(t){var n=t.shape,r=t.isCreating,i=t.handle;e.info=t,e.shapeId=n.id,e.markId=r?"creating":e.editor.mark("dragging handle"),e.initialHandle=We(i),e.initialPageTransform=e.editor.getPageTransform(n),e.initialPageRotation=e.editor.getPageRotation(n),e.editor.setCursor({type:r?"cross":"grabbing",rotation:0});var o=e.editor.getHandles(n).sort(T),a=o.findIndex((function(e){return e.id===t.handle.id}));e.initialAdjacentHandle=null;for(var s=a+1;s<o.length;s++){var u=o[s];if("vertex"===u.type&&"middle"!==u.id&&u.id!==t.handle.id){e.initialAdjacentHandle=u;break}}if(!e.initialAdjacentHandle)for(var l=o.length-1;l>=0;l--){var c=o[l];if("vertex"===c.type&&"middle"!==c.id&&c.id!==t.handle.id){e.initialAdjacentHandle=c;break}}var d=n.props[t.handle.id];e.isPrecise=!1,"binding"===(null===d||void 0===d?void 0:d.type)&&(e.editor.setHintingIds([d.boundShapeId]),e.isPrecise=!Xa.Equals(d.normalizedAnchor,{x:.5,y:.5}),e.isPrecise?e.isPreciseId=d.boundShapeId:e.resetExactTimeout()),e.update()})),z(_t(e),"exactTimeout",-1),z(_t(e),"onPointerMove",(function(){e.update()})),z(_t(e),"onKeyDown",(function(){e.update()})),z(_t(e),"onKeyUp",(function(){e.update()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onExit",(function(){e.editor.setHintingIds([]),e.editor.snaps.clear(),e.editor.setCursor({type:"default"})})),e}return L(n,[{key:"resetExactTimeout",value:function(){var e=this;-1!==this.exactTimeout&&this.clearExactTimeout(),this.exactTimeout=setTimeout((function(){e.isActive&&!e.isPrecise&&(e.isPrecise=!0,e.isPreciseId=e.pointingId,e.update()),e.exactTimeout=-1}),750)}},{key:"clearExactTimeout",value:function(){-1!==this.exactTimeout&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}},{key:"complete",value:function(){this.editor.snaps.clear();var e=this.info.onInteractionEnd;this.editor.instanceState.isToolLocked&&e?this.editor.setSelectedTool(e,{shapeId:this.shapeId}):this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.editor.bailToMark(this.markId),this.editor.snaps.clear();var e=this.info.onInteractionEnd;e?this.editor.setSelectedTool(e,{shapeId:this.shapeId}):this.parent.transition("idle",{})}},{key:"update",value:function(){var e,t=this.editor,n=this.shapeId,r=this.initialHandle,i=this.initialPageRotation,o=this.initialAdjacentHandle,a=t.isSnapMode,s=t.hintingIds,u=t.snaps,l=t.inputs,c=l.currentPagePoint,d=l.originPagePoint,f=l.shiftKey,p=l.ctrlKey,h=l.altKey,v=l.pointerVelocity,g=t.getShapeById(n);if(g){var m=t.getShapeUtil(g),y=c.clone().sub(d).rot(-i).add(r);if(f&&o&&"middle"!==r.id){var b=Xa.Angle(o,y),w=ls(b,24)-b;y=Xa.RotWith(y,o,w)}if(t.snaps.clear(),a?!p:p){var x=t.getPageTransformById(g.id);if(!x)throw Error("Expected a page transform");var k=m.getOutlineSegments(g).map((function(e){return Ms.applyToPoints(x,e)})),S=t.getHandles(g).filter((function(e){return"vertex"===e.type})).sort(T).findIndex((function(e){var t=e.index;return r.index===t}));k.splice(S-1,2);var _=u.getSnappingHandleDelta({additionalSegments:k,handlePoint:Ms.applyToPoint(x,y)});_&&y.add(t.getDeltaInShapeSpace(g,_))}var P=null===(e=m.onHandleChange)||void 0===e?void 0:e.call(m,g,{handle:Ce(Ce({},r),{},{x:y.x,y:y.y}),isPrecise:this.isPrecise||h}),E=Ce(Ce({},g),P);if(r.canBind){var C=E.props[r.id];"binding"===(null===C||void 0===C?void 0:C.type)?s[0]!==C.boundShapeId&&(t.setHintingIds([C.boundShapeId]),this.pointingId=C.boundShapeId,this.isPrecise=v.len()<.5||h,this.isPreciseId=this.isPrecise?C.boundShapeId:null,this.resetExactTimeout()):s.length>0&&(t.setHintingIds([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}P&&t.updateShapes([E],!0)}}}]),n}(If);z(kg,"id","dragging_handle");var Sg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onPointerEnter",(function(t){if("shape"===t.target){var n=e.editor,r=n.selectedIds,i=n.focusLayerId,o=e.editor.getOutermostSelectableShape(t.shape,(function(e){return!r.includes(e.id)}));o.id!==i&&e.editor.setHoveredId(o.id)}})),z(_t(e),"onPointerLeave",(function(t){if("shape"===t.target)e.editor.setHoveredId(null)})),z(_t(e),"onExit",(function(){var t;if(e.editor.pageState.editingId){var n=e.editor.pageState.editingId;if(n){e.editor.setEditingId(null);var r=e.editor.getShapeById(n),i=e.editor.getShapeUtil(r);null===(t=i.onEditEnd)||void 0===t||t.call(i,r)}}})),z(_t(e),"onPointerDown",(function(t){var n,r;if("shape"===t.target){var i=t.shape,o=e.editor.pageState.editingId;if(o){if(i.id===o)return;var a=e.editor.getShapeById(o);if(a){var s,u,l=e.editor.getShapeUtil(a);null===(s=l.onEditEnd)||void 0===s||s.call(l,a);var c=e.editor.getShapeUtil(i);if(i.type===a.type&&null!==(u=c.canEdit)&&void 0!==u&&u.call(c,i)&&!e.editor.isShapeOrAncestorLocked(i))return e.editor.setEditingId(i.id),e.editor.setHoveredId(i.id),void e.editor.setSelectedIds([i.id])}}}e.parent.transition("idle",t),null===(n=e.parent.current.value)||void 0===n||null===(r=n.onPointerDown)||void 0===r||r.call(n,t)})),z(_t(e),"onComplete",(function(t){e.parent.transition("idle",t)})),z(_t(e),"onCancel",(function(t){e.parent.transition("idle",t)})),e}return L(n)}(If);z(Sg,"id","editing_shape");var _g=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"isDarwin",window.navigator.userAgent.toLowerCase().indexOf("mac")>-1),z(_t(e),"onPointerEnter",(function(t){switch(t.target){case"canvas":break;case"shape":var n=e.editor,r=n.selectedIds,i=n.focusLayerId,o=e.editor.getOutermostSelectableShape(t.shape,(function(e){return!r.includes(e.id)}));if(o.id!==i&&e.editor.setHoveredId(o.id),tu.debugCursors.value){if("geo"!==o.type)break;var a=o.props.text;try{e.editor.setCursor({type:a})}catch(ej){console.error("Cursor type not recognized: '".concat(a,"'")),e.editor.setCursor({type:"default"})}}}})),z(_t(e),"onPointerLeave",(function(t){if("shape"===t.target)e.editor.setHoveredId(null)})),z(_t(e),"onPointerDown",(function(t){if(!e.editor.isMenuOpen){var n=e.shouldEnterCropMode(t,!0);if(t.ctrlKey&&!n)return"shape"===t.target&&e.isDarwin&&e.editor.inputs.keys.has("ControlLeft")&&!e.editor.isShapeOrAncestorLocked(t.shape)?void e.parent.transition("pointing_shape",t):void e.parent.transition("brushing",t);switch(t.target){case"canvas":e.parent.transition("pointing_canvas",t);break;case"shape":if(e.editor.isShapeOrAncestorLocked(t.shape))break;e.parent.transition("pointing_shape",t);break;case"handle":if(e.editor.isReadOnly)break;e.editor.inputs.altKey?e.parent.transition("pointing_shape",t):e.parent.transition("pointing_handle",t);break;case"selection":switch(t.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":e.parent.transition("pointing_rotate_handle",t);break;case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":n?e.parent.transition("pointing_crop_handle",t):e.parent.transition("pointing_resize_handle",t);break;default:e.parent.transition("pointing_selection",t)}}}})),z(_t(e),"onDoubleClick",(function(t){if("up"===t.phase)switch(t.target){case"canvas":if(e.editor.isReadOnly)break;e.handleDoubleClickOnCanvas(t);break;case"selection":if(e.editor.isReadOnly)break;var n=e.editor.onlySelectedShape;if(n){var r=e.editor.getShapeUtil(n);if("right"===t.handle||"left"===t.handle||"top"===t.handle||"bottom"===t.handle){var i,o=null===(i=r.onDoubleClickEdge)||void 0===i?void 0:i.call(r,n);if(o)return e.editor.mark("double click edge"),void e.editor.updateShapes([o])}if(r.canCrop(n)&&!e.editor.isShapeOrAncestorLocked(n))return void e.parent.transition("crop",t);e.shouldStartEditingShape(n)&&e.startEditingShape(n,t)}break;case"shape":var a=t.shape,s=e.editor.getShapeUtil(a);if("video"!==a.type&&"embed"!==a.type&&e.editor.isReadOnly)break;if(s.onDoubleClick){var u,l,c=null===(u=s.onDoubleClick)||void 0===u?void 0:u.call(s,a);if(c)return void e.editor.updateShapes([c]);if(s.canCrop(a)&&!e.editor.isShapeOrAncestorLocked(a))return e.editor.mark("select and crop"),e.editor.select(null===(l=t.shape)||void 0===l?void 0:l.id),void e.parent.transition("crop",t)}e.shouldStartEditingShape(a)?e.startEditingShape(a,t):e.handleDoubleClickOnCanvas(t);break;case"handle":var d;if(e.editor.isReadOnly)break;var f=t.shape,p=t.handle,h=e.editor.getShapeUtil(f),v=null===(d=h.onDoubleClickHandle)||void 0===d?void 0:d.call(h,f,p);v?e.editor.updateShapes([v]):e.shouldStartEditingShape(f)&&e.startEditingShape(f,t)}})),z(_t(e),"onRightClick",(function(t){switch(t.target){case"canvas":e.editor.selectNone();break;case"shape":var n=e.editor.pageState.selectedIds,r=t.shape,i=e.editor.getOutermostSelectableShape(r,(function(t){return!e.editor.isSelected(t.id)}));n.includes(i.id)||(e.editor.mark("selecting shape"),e.editor.setSelectedIds([i.id]))}})),z(_t(e),"onEnter",(function(){e.editor.setHoveredId(null),e.editor.setCursor({type:"default"})})),z(_t(e),"onCancel",(function(){e.editor.focusLayerId!==e.editor.currentPageId&&e.editor.selectedIds.length>0?e.editor.popFocusLayer():(e.editor.mark("clearing selection"),e.editor.selectNone())})),z(_t(e),"onKeyDown",(function(t){switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":e.nudgeSelectedShapes(!1)}})),z(_t(e),"onKeyRepeat",(function(t){switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":e.nudgeSelectedShapes(!0)}})),z(_t(e),"onKeyUp",(function(t){if(e.editor.isReadOnly){if("Enter"===t.code)if(e.shouldStartEditingShape()&&e.editor.onlySelectedShape)return void e.startEditingShape(e.editor.onlySelectedShape,Ce(Ce({},t),{},{target:"shape",shape:e.editor.onlySelectedShape}))}else if("Enter"===t.code){var n=e.editor.selectedShapes;if(n.every((function(t){return e.editor.isShapeOfType(t,Hp)})))return void e.editor.setSelectedIds(n.flatMap((function(t){return e.editor.getSortedChildIds(t.id)})));if(e.shouldStartEditingShape()&&e.editor.onlySelectedShape)return void e.startEditingShape(e.editor.onlySelectedShape,Ce(Ce({},t),{},{target:"shape",shape:e.editor.onlySelectedShape}));e.shouldEnterCropMode(t,!1)&&e.parent.transition("crop",t)}})),e}return L(n,[{key:"shouldStartEditingShape",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editor.onlySelectedShape;return!!e&&((!this.editor.isShapeOrAncestorLocked(e)||"embed"===e.type)&&this.editor.getShapeUtil(e).canEdit(e))}},{key:"shouldEnterCropMode",value:function(e,t){var n=this.editor.onlySelectedShape;if(!n)return!1;if(this.editor.isShapeOrAncestorLocked(n))return!1;var r=this.editor.getShapeUtil(n);return t?r.canCrop(n)&&e.ctrlKey:r.canCrop(n)}},{key:"startEditingShape",value:function(e,t){this.editor.isShapeOrAncestorLocked(e)&&"embed"!==e.type||(this.editor.mark("editing shape"),this.editor.setEditingId(e.id),this.parent.transition("editing_shape",t))}},{key:"handleDoubleClickOnCanvas",value:function(e){this.editor.mark("creating text shape");var t=Wi(),n=this.editor.inputs.currentPagePoint,r=n.x,i=n.y;this.editor.createShapes([{id:t,type:"text",x:r,y:i,props:{text:"",autoSize:!0}}]);var o=this.editor.getShapeById(t);if(o){var a=this.editor.getBounds(o);this.editor.updateShapes([{id:t,type:"text",x:o.x-a.width/2,y:o.y-a.height/2}]),this.editor.setEditingId(t),this.editor.select(t),this.parent.transition("editing_shape",e)}}},{key:"nudgeSelectedShapes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.editor.inputs.keys,n=t.has("ShiftLeft"),r=new Xa(0,0);t.has("ArrowLeft")&&(r.x-=1),t.has("ArrowRight")&&(r.x+=1),t.has("ArrowUp")&&(r.y-=1),t.has("ArrowDown")&&(r.y+=1),r.equals(new Xa(0,0))||(e||this.editor.mark("nudge shapes"),this.editor.nudgeShapes(this.editor.selectedIds,r,n))}}]),n}(If);z(_g,"id","idle");var Pg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.editor.inputs.shiftKey||e.editor.selectedIds.length>0&&(e.editor.mark("selecting none"),e.editor.selectNone())})),z(_t(e),"onPointerMove",(function(t){e.editor.inputs.isDragging&&e.parent.transition("brushing",t)})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onInterrupt",(function(){e.parent.transition("idle",{})})),e}return L(n,[{key:"_clickWasInsideFocusedGroup",value:function(){var e=this.editor,t=e.focusLayerId,n=e.inputs;if(!Vi(t))return!1;var r=this.editor.getShapeById(t);if(!r)return!1;var i=this.editor.getPointInShapeSpace(r,n.currentPagePoint);return this.editor.getShapeUtil(r).hitTestPoint(r,i)}},{key:"complete",value:function(){this.editor.inputs.shiftKey||(this.editor.selectNone(),this._clickWasInsideFocusedGroup()||this.editor.setFocusLayer(null)),this.parent.transition("idle",{})}}]),n}(If);z(Pg,"id","pointing_canvas");var Eg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"onEnter",(function(t){e.info=t;var n=e.editor.selectedShapes[0];n&&(e.updateCursor(n),e.editor.setCroppingId(n.id))})),z(_t(e),"onPointerMove",(function(){e.editor.inputs.isDragging&&e.parent.transition("cropping",Ce(Ce({},e.info),{},{onInteractionEnd:e.info.onInteractionEnd}))})),z(_t(e),"onPointerUp",(function(){e.info.onInteractionEnd?e.editor.setSelectedTool(e.info.onInteractionEnd,e.info):(e.editor.setCroppingId(null),e.parent.transition("idle",{}))})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.cancel()})),z(_t(e),"onInterrupt",(function(){e.cancel()})),e}return L(n,[{key:"updateCursor",value:function(e){var t=bg[this.info.handle];this.editor.setCursor({type:t,rotation:e.rotation})}},{key:"cancel",value:function(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}}]),n}(If);z(Eg,"id","pointing_crop_handle");var Cg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"onEnter",(function(t){e.info=t;var n=t.shape.props[t.handle.id];"binding"===(null===n||void 0===n?void 0:n.type)&&e.editor.setHintingIds([n.boundShapeId]),e.editor.setCursor({type:"grabbing"})})),z(_t(e),"onExit",(function(){e.editor.setHintingIds([]),e.editor.setCursor({type:"default"})})),z(_t(e),"onPointerUp",(function(){e.parent.transition("idle",e.info)})),z(_t(e),"onPointerMove",(function(){e.editor.inputs.isDragging&&e.parent.transition("dragging_handle",e.info)})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.cancel()})),z(_t(e),"onInterrupt",(function(){e.cancel()})),e}return L(n,[{key:"cancel",value:function(){this.parent.transition("idle",{})}}]),n}(If);z(Cg,"id","pointing_handle");var Ig=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"onEnter",(function(t){e.info=t,e.updateCursor()})),z(_t(e),"onPointerMove",(function(){e.editor.inputs.isDragging&&e.parent.transition("rotating",e.info)})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.cancel()})),z(_t(e),"onInterrupt",(function(){e.cancel()})),e}return L(n,[{key:"updateCursor",value:function(){var e=this.editor.selectionRotation;this.editor.setCursor({type:bg[this.info.handle],rotation:e})}},{key:"complete",value:function(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}}]),n}(If);z(Ig,"id","pointing_rotate_handle");var Tg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"onEnter",(function(t){e.info=t})),z(_t(e),"onPointerUp",(function(t){e.editor.selectNone(),e.parent.transition("idle",t)})),z(_t(e),"onPointerMove",(function(t){if(e.editor.inputs.isDragging){if(e.editor.isReadOnly)return;e.parent.transition("translating",t)}})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.cancel()})),z(_t(e),"onInterrupt",(function(){e.cancel()})),e}return L(n,[{key:"cancel",value:function(){this.parent.transition("idle",{})}}]),n}(If);z(Tg,"id","pointing_selection");var Mg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"eventTargetShape",{}),z(_t(e),"selectingShape",{}),z(_t(e),"didSelectOnEnter",!1),z(_t(e),"onEnter",(function(t){var n;if(e.eventTargetShape=t.shape,e.selectingShape=e.editor.getOutermostSelectableShape(t.shape),e.editor.getShapeUtil(t.shape).onClick||e.selectingShape.id===e.editor.focusLayerId)e.didSelectOnEnter=!1;else{var r=e.editor.isWithinSelection(e.selectingShape.id),i=e.editor.selectedIds.length>1&&(null===(n=e.editor.selectionBounds)||void 0===n?void 0:n.containsPoint(e.editor.inputs.currentPagePoint));if(e.didSelectOnEnter=!r&&e.selectingShape.id!==e.editor.focusLayerId&&!i,e.didSelectOnEnter){var o=e.editor,a=o.inputs,s=o.selectedIds,l=e.editor.getParentShape(t.shape);l&&e.editor.isShapeOfType(l,Hp)&&e.editor.cancelDoubleClick(),a.shiftKey&&!a.altKey?s.includes(e.selectingShape.id)||(e.editor.mark("shift selecting shape"),e.editor.setSelectedIds([].concat(u(s),[e.selectingShape.id]))):(e.editor.mark("selecting shape"),e.editor.setSelectedIds([e.selectingShape.id]))}}})),z(_t(e),"onPointerUp",(function(t){var n=t.shape;if(n){var r=e.editor.getShapeUtil(n);if(r.onClick){var i,o=null===(i=r.onClick)||void 0===i?void 0:i.call(r,n);if(o)return e.editor.updateShapes([o]),void e.parent.transition("idle",t)}}if(e.didSelectOnEnter||e.selectingShape.id===e.editor.focusLayerId)e.selectingShape.id===e.editor.focusLayerId&&(e.editor.selectedIds.length>0?e.editor.setSelectedIds([]):e.editor.popFocusLayer());else{e.editor.mark("selecting shape (pointer up)");var a=e.editor.getOutermostSelectableShape(e.eventTargetShape,(function(t){return!e.editor.isSelected(t.id)}));if(e.editor.selectedIds.includes(a.id))e.editor.setSelectedIds(e.editor.inputs.shiftKey?e.editor.selectedIds.filter((function(t){return t!==e.selectingShape.id})):[e.selectingShape.id]);else if(e.editor.inputs.shiftKey){var s=e.editor.getAncestors(a);e.editor.setSelectedIds([].concat(u(e.editor.selectedIds.filter((function(e){return!s.find((function(t){return t.id===e}))}))),[a.id]))}else e.editor.setSelectedIds([a.id])}e.parent.transition("idle",t)})),z(_t(e),"onPointerMove",(function(t){if(e.editor.inputs.isDragging){if(e.editor.isReadOnly)return;e.parent.transition("translating",t)}})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.cancel()})),z(_t(e),"onInterrupt",(function(){e.cancel()})),e}return L(n,[{key:"cancel",value:function(){this.parent.transition("idle",{})}}]),n}(If);z(Mg,"id","pointing_shape");var jg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"markId",""),z(_t(e),"creationCursorOffset",{x:0,y:0}),z(_t(e),"editAfterComplete",!1),z(_t(e),"snapshot",{}),z(_t(e),"onEnter",(function(t){var n=t.isCreating,r=void 0!==n&&n,i=t.editAfterComplete,o=void 0!==i&&i,a=t.creationCursorOffset,s=void 0===a?{x:0,y:0}:a;e.info=t,e.editAfterComplete=o,e.creationCursorOffset=s,t.isCreating&&e.editor.setCursor({type:"cross",rotation:0}),e.snapshot=e._createSnapshot(),e.markId=r?"creating":e.editor.mark("starting resizing"),e.handleResizeStart(),e.updateShapes()})),z(_t(e),"onPointerMove",(function(){e.updateShapes()})),z(_t(e),"onKeyDown",(function(){e.updateShapes()})),z(_t(e),"onKeyUp",(function(){e.updateShapes()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onExit",(function(){e.editor.snaps.clear()})),z(_t(e),"_createSnapshot",(function(){var t=e.editor,n=t.selectedIds,r=t.selectionRotation,i=t.inputs.originPagePoint,o=e.editor.selectionBounds,a=Xa.RotWith(o.getHandlePoint(e.info.handle),o.point,r),s=Xa.Sub(i,a),l=new Map;n.forEach((function(t){var r=e.editor.getShapeById(t);if(r){if(l.set(r.id,e._createShapeSnapshot(r)),e.editor.isShapeOfType(r,qp)&&1===n.length)return;e.editor.visitDescendants(r.id,(function(t){var n=e.editor.getShapeById(t);if(n&&(l.set(n.id,e._createShapeSnapshot(n)),e.editor.isShapeOfType(n,qp)))return!1}))}}));var c=!u(l.values()).some((function(e){return!cs(e.pageRotation,r)||e.isAspectRatioLocked}));return{shapeSnapshots:l,selectionBounds:o,cursorHandleOffset:s,selectionRotation:r,selectedIds:n,canShapesDeform:c,initialSelectionPageBounds:e.editor.selectedPageBounds}})),z(_t(e),"_createShapeSnapshot",(function(t){var n=e.editor.getPageTransform(t),r=e.editor.getShapeUtil(t);return{shape:t,bounds:e.editor.getBounds(t),pageTransform:n,pageRotation:Ms.Decompose(n).rotation,isAspectRatioLocked:r.isAspectRatioLocked(t)}})),e}return L(n,[{key:"cancel",value:function(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}},{key:"complete",value:function(){if(this.handleResizeEnd(),this.editAfterComplete&&this.editor.onlySelectedShape)return this.editor.setEditingId(this.editor.onlySelectedShape.id),this.editor.setSelectedTool("select"),void this.editor.root.current.value.transition("editing_shape",{});this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}},{key:"handleResizeStart",value:function(){var e=this,t=this.snapshot.shapeSnapshots,n=[];t.forEach((function(t){var r,i=t.shape,o=e.editor.getShapeUtil(i),a=null===(r=o.onResizeStart)||void 0===r?void 0:r.call(o,i);a&&n.push(a)})),n.length>0&&this.editor.updateShapes(n)}},{key:"handleResizeEnd",value:function(){var e=this,t=this.snapshot.shapeSnapshots,n=[];t.forEach((function(t){var r,i=t.shape,o=e.editor.getShapeById(i.id),a=e.editor.getShapeUtil(i),s=null===(r=a.onResizeEnd)||void 0===r?void 0:r.call(a,i,o);s&&n.push(s)})),n.length>0&&this.editor.updateShapes(n)}},{key:"updateShapes",value:function(){var e=this.editor.inputs,t=e.altKey,n=e.shiftKey,r=this.snapshot,i=r.shapeSnapshots,o=r.selectionBounds,a=r.cursorHandleOffset,s=r.selectedIds,u=r.selectionRotation,l=r.canShapesDeform,c=n||!l,d=this.editor.inputs.ctrlKey,f=this.editor.inputs.currentPagePoint.clone().sub(a).sub(this.creationCursorOffset),p=this.editor.inputs.originPagePoint.clone().sub(a);this.editor.isGridMode&&!d&&f.snapToGrid(this.editor.gridSize);var h=this.info.handle,v=Og(h,Math.PI);if(this.editor.snaps.clear(),(this.editor.isSnapMode?!d:d)&&u%Ga===0){var g=this.editor.snaps.snapResize({dragDelta:Xa.Sub(f,p),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:Og(h,u),isAspectRatioLocked:c,isResizingFromCenter:t}).nudge;f.add(g)}var m=Xa.RotWith(t?o.center:o.getHandlePoint(v),o.point,u),y=Xa.Sub(f,m).rot(-u),b=Xa.Sub(p,m).rot(-u),w=Xa.DivV(y,b);Number.isFinite(w.x)||(w.x=1),Number.isFinite(w.y)||(w.y=1);var x="top"===h||"bottom"===h,k="left"===h||"right"===h;c?k?w.y=Math.abs(w.x):x?w.x=Math.abs(w.y):Math.abs(w.x)>Math.abs(w.y)?w.y=Math.abs(w.x)*(w.y<0?-1:1):w.x=Math.abs(w.y)*(w.x<0?-1:1):(x&&(w.x=1),k&&(w.y=1)),this.info.isCreating||this.updateCursor({dragHandle:h,isFlippedX:w.x<0,isFlippedY:w.y<0,rotation:u});var S,_=J(i.keys());try{for(_.s();!(S=_.n()).done;){var P=S.value,E=i.get(P);this.editor.resizeShape(P,w,{initialBounds:E.bounds,dragHandle:h,initialPageTransform:E.pageTransform,initialShape:E.shape,mode:1===s.length&&P===s[0]?"resize_bounds":"scale_shape",scaleOrigin:m,scaleAxisRotation:u})}}catch(C){_.e(C)}finally{_.f()}}},{key:"updateCursor",value:function(e){var t=e.dragHandle,n=e.isFlippedX,r=e.isFlippedY,i=e.rotation,o=Ce({},this.editor.cursor);switch(t){case"top_left":case"bottom_right":o.type="nwse-resize",n!==r&&(o.type="nesw-resize");break;case"top_right":case"bottom_left":o.type="nesw-resize",n!==r&&(o.type="nwse-resize")}o.rotation=i,this.editor.setCursor(o)}}]),n}(If);z(jg,"id","resizing");var Ag=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function Og(e,t){t%=Qa;var n=Math.round(t/($a/4)),r=Ag.indexOf(e);return Ag[(r+n)%Ag.length]}var Lg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"snapshot",{}),z(_t(e),"info",{}),z(_t(e),"markId",""),z(_t(e),"onEnter",(function(t){e.info=t,e.markId=e.editor.mark("rotate start");var n=Fv({editor:e.editor});if(!n)return e.parent.transition("idle",e.info);e.snapshot=n,e.handleStart()})),z(_t(e),"onExit",(function(){e.editor.setCursor({type:"none"}),e.snapshot={}})),z(_t(e),"onPointerMove",(function(){e.update()})),z(_t(e),"onKeyDown",(function(){e.update()})),z(_t(e),"onKeyUp",(function(){e.update()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"update",(function(){var t=e._getRotationFromPointerPosition({snapToNearestDegree:!1});Uv({editor:e.editor,delta:t,snapshot:e.snapshot,stage:"update"}),e.editor.setCursor({type:bg[e.info.handle],rotation:t+e.snapshot.initialSelectionRotation})})),z(_t(e),"cancel",(function(){e.editor.bailToMark(e.markId),e.info.onInteractionEnd?e.editor.setSelectedTool(e.info.onInteractionEnd,e.info):e.parent.transition("idle",e.info)})),z(_t(e),"complete",(function(){Uv({editor:e.editor,delta:e._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:e.snapshot,stage:"end"}),e.info.onInteractionEnd?e.editor.setSelectedTool(e.info.onInteractionEnd,e.info):e.parent.transition("idle",e.info)})),e}return L(n,[{key:"handleStart",value:function(){var e=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Uv({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.setCursor({type:bg[this.info.handle],rotation:e+this.snapshot.initialSelectionRotation})}},{key:"_getRotationFromPointerPosition",value:function(e){var t=e.snapToNearestDegree,n=this.editor,r=n.selectionPageCenter,i=n.inputs,o=i.shiftKey,a=i.currentPagePoint,s=this.snapshot,u=s.initialCursorAngle,l=s.initialSelectionRotation;if(!r)return l;var c=l+(r.angle(a)-u);if(o)c=ls(c,24);else if(t&&(c=Math.round(c/Za)*Za,this.editor.isCoarsePointer)){var d=ls(c,4),f=ss(c,d);Math.abs(f)<function(e){return e*$a/180}(5)&&(c=d)}return c-l}}]),n}(If);z(Lg,"id","rotating");var zg=function(){function e(t){var n=this;M(this,e),z(this,"state",void 0),z(this,"points",void 0),z(this,"size",void 0),z(this,"color",void 0),z(this,"opacity",void 0),z(this,"delay",void 0),z(this,"timeoutMs",0),z(this,"delayRemaining",0),z(this,"onUpdate",void 0),z(this,"onComplete",void 0),z(this,"prev",null),z(this,"next",null),z(this,"resume",(function(){n.state="active"})),z(this,"pause",(function(){n.state="starting"})),z(this,"stop",(function(){n.delayRemaining=Math.min(n.delayRemaining,200),n.state="stopping"})),z(this,"addPoint",(function(e,t){var r=n.prev,i={x:e,y:t,z:.5};r&&Xa.Dist(r,i)<1||(n.next=i)})),z(this,"tick",(function(e){n.timeoutMs+=e,n.delayRemaining>0&&(n.delayRemaining=Math.max(0,n.delayRemaining-e)),n.timeoutMs>=16&&(n.timeoutMs=0);var t=n.timeoutMs,r=n.state,i=n.prev,o=n.next,a=n.points;switch(r){case"active":o&&o!==i?(n.prev=o,a.push(o),0===n.delayRemaining&&a.length>8&&a.shift(),n.updateScribble()):0===t&&(a.length>1?(a.shift(),n.updateScribble()):n.delayRemaining=n.delay);break;case"stopping":if(0===n.delayRemaining&&0===t){if(1===a.length)return n.state="paused",void n.onComplete();n.size*=.9,a.shift(),n.updateScribble()}}}));var r=t.size,i=void 0===r?20:r,o=t.color,a=void 0===o?"accent":o,s=t.opacity,u=void 0===s?.8:s,l=t.delay,c=void 0===l?0:l,d=t.onComplete,f=t.onUpdate;this.onUpdate=f,this.onComplete=d,this.size=i,this.color=a,this.delay=c,this.opacity=u,this.points=[],this.state="starting",this.prev=null,this.next=null,this.delayRemaining=this.delay,this.resume()}return L(e,[{key:"getScribble",value:function(){return{state:this.state,size:this.size,color:this.color,opacity:this.opacity,delay:this.delay,points:u(this.points)}}},{key:"updateScribble",value:function(){this.onUpdate(this.getScribble())}}]),e}(),Dg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"hits",new Set),z(_t(e),"size",0),z(_t(e),"scribble",{}),z(_t(e),"initialSelectedIds",new Set),z(_t(e),"newlySelectedIds",new Set),z(_t(e),"onEnter",(function(){e.initialSelectedIds=new Set(e.editor.inputs.shiftKey?e.editor.selectedIds:[]),e.newlySelectedIds=new Set,e.size=0,e.hits.clear(),e.startScribble(),e.updateBrushSelection(),requestAnimationFrame((function(){e.editor.setBrush(null)}))})),z(_t(e),"onExit",(function(){e.editor.setErasingIds([]),e.scribble.stop()})),z(_t(e),"onPointerMove",(function(){e.updateBrushSelection()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onKeyDown",(function(){e.updateBrushSelection()})),z(_t(e),"onKeyUp",(function(){e.editor.inputs.altKey?e.updateBrushSelection():e.parent.transition("brushing",{})})),z(_t(e),"startScribble",(function(){var t;e.scribble.tick&&e.editor.off("tick",null===(t=e.scribble)||void 0===t?void 0:t.tick);e.scribble=new zg({onUpdate:e.onScribbleUpdate,onComplete:e.onScribbleComplete,color:"selection-stroke",opacity:.32,size:12}),e.editor.on("tick",e.scribble.tick)})),z(_t(e),"pushPointToScribble",(function(){var t=e.editor.inputs.currentPagePoint,n=t.x,r=t.y;e.scribble.addPoint(n,r)})),z(_t(e),"onScribbleUpdate",(function(t){e.editor.setScribble(t)})),z(_t(e),"onScribbleComplete",(function(){e.editor.off("tick",e.scribble.tick),e.editor.setScribble(null)})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.complete()})),e}return L(n,[{key:"updateBrushSelection",value:function(){var e=this.editor,t=e.shapesArray,n=e.inputs,r=n.originPagePoint,i=n.previousPagePoint,o=n.currentPagePoint;this.pushPointToScribble();for(var a,s,l=t,c=0,d=l.length;c<d;c++)if(a=l[c],s=this.editor.getShapeUtil(a),!(this.editor.isShapeOfType(a,Hp)||this.newlySelectedIds.has(a.id)||this.editor.isShapeOfType(a,qp)&&s.hitTestPoint(a,this.editor.getPointInShapeSpace(a,r))||this.editor.isShapeOrAncestorLocked(a))&&s.hitTestLineSegment(a,this.editor.getPointInShapeSpace(a,i),this.editor.getPointInShapeSpace(a,o))){var f=this.editor.getOutermostSelectableShape(a),p=this.editor.getPageMaskById(f.id);if(p)if(null!==Ks(i,o,p))if(!ms(o,p))continue;this.newlySelectedIds.add(f.id)}this.editor.setSelectedIds(u(new Set([].concat(u(this.newlySelectedIds),u(this.initialSelectedIds)))),!0)}},{key:"complete",value:function(){this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.editor.setSelectedIds(u(this.initialSelectedIds),!0),this.parent.transition("idle",{})}}]),n}(If);z(Dg,"id","scribble_brushing");var Rg=function(){function e(t){var n=this;M(this,e),z(this,"prevDroppingShapeId",null),z(this,"currDroppingShapeId",null),z(this,"droppingNodeTimer",null),z(this,"dispose",(function(){n.clear()})),this.editor=t,t.disposables.add(this.dispose)}return L(e,[{key:"updateDroppingNode",value:function(e,t){if(null===this.droppingNodeTimer){var n,r,i=this.editor.inputs.currentPagePoint;this.currDroppingShapeId=null!==(n=null===(r=this.editor.getDroppingShape(i,e))||void 0===r?void 0:r.id)&&void 0!==n?n:null,this.setDragTimer(e,1e3,t)}else this.editor.inputs.pointerVelocity.len()>.5&&(clearInterval(this.droppingNodeTimer),this.setDragTimer(e,100,t))}},{key:"setDragTimer",value:function(e,t,n){var r=this;this.droppingNodeTimer=setTimeout((function(){r.editor.batch((function(){r.handleDrag(e,n)})),r.droppingNodeTimer=null}),t)}},{key:"handleDrag",value:function(e,t){var n,r,i=this,o=this.editor.inputs.currentPagePoint;e=Te(e.map((function(e){return i.editor.getShapeById(e.id)})));var a=null!==(n=null===(r=this.editor.getDroppingShape(o,e))||void 0===r?void 0:r.id)&&void 0!==n?n:null;a!==this.currDroppingShapeId&&(this.prevDroppingShapeId=this.currDroppingShapeId,this.currDroppingShapeId=a);var s=this.prevDroppingShapeId;if(a!==s){var u,l,c=s&&this.editor.getShapeById(s),d=a&&this.editor.getShapeById(a);if(this.prevDroppingShapeId=this.currDroppingShapeId,c)null===(u=(l=this.editor.getShapeUtil(c)).onDragShapesOut)||void 0===u||u.call(l,c,e);if(d){var f,p,h=null===(f=(p=this.editor.getShapeUtil(d)).onDragShapesOver)||void 0===f?void 0:f.call(p,d,e);h&&h.shouldHint&&this.editor.setHintingIds([d.id])}else this.editor.setHintingIds([]);null===t||void 0===t||t()}}},{key:"dropShapes",value:function(e){var t=this.currDroppingShapeId;if(this.handleDrag(e),t){var n,r,i=this.editor.getShapeById(t);if(!i)return;null===(n=(r=this.editor.getShapeUtil(i)).onDropShapesOver)||void 0===n||n.call(r,i,e)}}},{key:"clear",value:function(){this.prevDroppingShapeId=null,this.currDroppingShapeId=null,null!==this.droppingNodeTimer&&clearInterval(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingIds([])}}]),e}(),Ng=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"selectionSnapshot",{}),z(_t(e),"snapshot",{}),z(_t(e),"markId",""),z(_t(e),"isCloning",!1),z(_t(e),"isCreating",!1),z(_t(e),"editAfterComplete",!1),z(_t(e),"dragAndDropManager",new Rg(e.editor)),z(_t(e),"onEnter",(function(t){var n=t.isCreating,r=void 0!==n&&n,i=t.editAfterComplete,o=void 0!==i&&i;e.info=t,e.isCreating=r,e.editAfterComplete=o,e.markId=r?"creating":e.editor.mark("translating"),e.handleEnter(t),e.editor.on("tick",e.updateParent)})),z(_t(e),"updateParent",(function(){var t=_t(e).snapshot;e.dragAndDropManager.updateDroppingNode(t.movingShapes,e.updateParentTransforms)})),z(_t(e),"onExit",(function(){e.editor.off("tick",e.updateParent),e.selectionSnapshot={},e.snapshot={},e.editor.snaps.clear(),e.editor.setCursor({type:"default"}),e.dragAndDropManager.clear()})),z(_t(e),"onPointerMove",(function(){e.updateShapes()})),z(_t(e),"onKeyDown",(function(){!e.editor.inputs.altKey||e.isCloning?e.updateShapes():e.startCloning()})),z(_t(e),"onKeyUp",(function(){e.editor.inputs.altKey||!e.isCloning?e.updateShapes():e.stopCloning()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"updateParentTransforms",(function(){var t=_t(e),n=t.editor,r=t.snapshot.shapeSnapshots,i=[];r.forEach((function(e){var t=n.getShapeById(e.shape.id);if(!t)return null;i.push(t);var r=Rn(t.parentId)?null:Ms.Inverse(n.getPageTransformById(t.parentId));e.parentTransform=r}))})),e}return L(n,[{key:"reset",value:function(){this.editor.bailToMark(this.markId)}},{key:"startCloning",value:function(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId=this.editor.mark("translating"),this.editor.duplicateShapes(),this.snapshot=Bg(this.editor),this.handleStart(),this.updateShapes())}},{key:"stopCloning",value:function(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId=this.editor.mark("translating"),this.updateShapes()}},{key:"complete",value:function(){if(this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),this.handleEnd(),this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd)this.editor.setSelectedTool(this.info.onInteractionEnd);else if(this.editAfterComplete){var e=this.editor.onlySelectedShape;e&&(this.editor.setEditingId(e.id),this.editor.setSelectedTool("select"),this.editor.root.current.value.transition("editing_shape",{}))}else this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.reset(),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}},{key:"handleEnter",value:function(e){this.isCloning=!1,this.info=e,this.editor.setCursor({type:"move"}),this.selectionSnapshot=Bg(this.editor),this.isCreating||!this.editor.inputs.altKey?(this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes()):this.startCloning()}},{key:"handleStart",value:function(){var e=this,t=this.snapshot.movingShapes,n=[];t.forEach((function(t){var r,i=e.editor.getShapeUtil(t),o=null===(r=i.onTranslateStart)||void 0===r?void 0:r.call(i,t);o&&n.push(o)})),n.length>0&&this.editor.updateShapes(n)}},{key:"handleEnd",value:function(){var e=this,t=this.snapshot.movingShapes,n=[];t.forEach((function(t){var r,i=e.editor.getShapeById(t.id),o=e.editor.getShapeUtil(t),a=null===(r=o.onTranslateEnd)||void 0===r?void 0:r.call(o,t,i);a&&n.push(a)})),n.length>0&&this.editor.updateShapes(n)}},{key:"handleChange",value:function(){var e=this,t=this.snapshot.movingShapes,n=[];t.forEach((function(t){var r,i=e.editor.getShapeById(t.id),o=e.editor.getShapeUtil(t),a=null===(r=o.onTranslate)||void 0===r?void 0:r.call(o,t,i);a&&n.push(a)})),n.length>0&&this.editor.updateShapes(n)}},{key:"updateShapes",value:function(){var e=this.snapshot;this.dragAndDropManager.updateDroppingNode(e.movingShapes,this.updateParentTransforms),function(e){var t=e.editor,n=e.shapeSnapshots,r=e.averagePagePoint,i=e.initialSelectionPageBounds,o=e.initialSelectionSnapPoints,a=t.inputs,s=t.isGridMode,u=t.gridSize,l=Xa.Sub(a.currentPagePoint,a.originPagePoint),c=t.inputs.shiftKey?Math.abs(l.x)<Math.abs(l.y)?"x":"y":null;"x"===c?l.x=0:"y"===c&&(l.y=0);if(t.snaps.clear(),(t.isSnapMode?!a.ctrlKey:a.ctrlKey)&&t.inputs.pointerVelocity.len()<.5){var d=t.snaps.snapTranslate({dragDelta:l,initialSelectionPageBounds:i,lockedAxis:c,initialSelectionSnapPoints:o}).nudge;l.add(d)}var f=Xa.Add(r,l);s&&!a.ctrlKey&&f.snapToGrid(u);var p=Xa.Sub(f,r);t.updateShapes(Te(n.map((function(e){var t=e.shape,n=e.pagePoint,r=e.parentTransform,i=Xa.Add(n,p),o=r?Ms.applyToPoint(r,i):i;return{id:t.id,type:t.type,x:o.x,y:o.y}}))),!0)}({editor:this.editor,shapeSnapshots:e.shapeSnapshots,averagePagePoint:e.averagePagePoint,initialSelectionPageBounds:e.initialPageBounds,initialSelectionSnapPoints:e.initialSnapPoints}),this.handleChange()}}]),n}(If);function Bg(e){var t=[],n=[],r=Te(e.selectedIds.map((function(r){var i=e.getShapeById(r);if(!i)return null;t.push(i);var o=e.getPagePointById(r);return o?(n.push(o),{shape:i,pagePoint:o,parentTransform:Dn.isId(i.parentId)?null:Ms.Inverse(e.getPageTransformById(i.parentId))}):null})));return{averagePagePoint:Xa.Average(n),movingShapes:t,shapeSnapshots:r,initialPageBounds:e.selectedPageBounds,initialSnapPoints:1===e.selectedIds.length?e.snaps.snapPointsCache.get(e.selectedIds[0]):e.selectedPageBounds?e.selectedPageBounds.snapPoints.map((function(e,t){return{id:"selection:"+t,x:e.x,y:e.y}})):[]}}z(Ng,"id","translating");var Fg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onExit",(function(){e.editor.pageState.editingId&&e.editor.setEditingId(null)})),e}return L(n)}(If);z(Fg,"id","select"),z(Fg,"initial","idle"),z(Fg,"children",(function(){return[yg,xg,_g,Pg,Mg,Ng,pg,Dg,Eg,Tg,wg,Sg,jg,Lg,Ig,Cg,kg]}));var Ug=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"onEnter",(function(t){e.info=t})),z(_t(e),"onPointerDown",(function(){e.parent.transition("pointing",e.info)})),e}return L(n)}(If);z(Ug,"id","idle");var Kg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"onEnter",(function(t){e.info=t})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onPointerMove",(function(){e.editor.inputs.isDragging&&e.parent.transition("zoom_brushing",e.info)})),z(_t(e),"onCancel",(function(){e.cancel()})),e}return L(n,[{key:"complete",value:function(){var e=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(e,{duration:220}):this.editor.zoomIn(e,{duration:220}),this.parent.transition("idle",this.info)}},{key:"cancel",value:function(){this.parent.transition("idle",this.info)}}]),n}(If);z(Kg,"id","pointing");var Vg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"zoomBrush",new ks),z(_t(e),"onEnter",(function(t){e.info=t,e.update()})),z(_t(e),"onExit",(function(){e.editor.setZoomBrush(null)})),z(_t(e),"onPointerMove",(function(){e.update()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),e}return L(n,[{key:"update",value:function(){var e=this.editor.inputs,t=e.originPagePoint,n=e.currentPagePoint;this.zoomBrush.setTo(ks.FromPoints([t,n])),this.editor.setZoomBrush(this.zoomBrush.toJson())}},{key:"cancel",value:function(){this.parent.transition("idle",this.info)}},{key:"complete",value:function(){var e=this.zoomBrush,t=8/this.editor.zoomLevel;if(e.width<t&&e.height<t){var n=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(n,{duration:220}):this.editor.zoomIn(n,{duration:220})}else{var r=this.editor.inputs.altKey?this.editor.zoomLevel/2:void 0;this.editor.zoomToBounds(e.x,e.y,e.width,e.height,r,{duration:220})}this.parent.transition("idle",this.info)}}]),n}(If);z(Vg,"id","zoom_brushing");var Wg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"onEnter",(function(t){e.info=t,e.updateCursor()})),z(_t(e),"onExit",(function(){e.editor.setZoomBrush(null),e.editor.setCursor({type:"default"})})),z(_t(e),"onKeyDown",(function(){e.updateCursor()})),z(_t(e),"onKeyUp",(function(t){e.updateCursor(),"KeyZ"===t.code&&e.complete()})),z(_t(e),"onInterrupt",(function(){e.complete()})),e}return L(n,[{key:"updateCursor",value:function(){this.editor.inputs.altKey?this.editor.setCursor({type:"zoom-out"}):this.editor.setCursor({type:"zoom-in"})}},{key:"complete",value:function(){this.info.onInteractionEnd&&"select"!==this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("select",{})}}]),n}(If);z(Wg,"id","zoom"),z(Wg,"initial","idle"),z(Wg,"children",(function(){return[Ug,Vg,Kg]}));var Hg=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onKeyDown",(function(t){if("KeyZ"===t.code)if(!t.shiftKey&&!t.ctrlKey){var n,r=e.current.value;r&&"idle"===(null===(n=r.current.value)||void 0===n?void 0:n.id)&&e.editor.setSelectedTool("zoom",Ce(Ce({},t),{},{onInteractionEnd:r.id}))}})),e}return L(n)}(If);z(Hg,"id","root"),z(Hg,"initial","select"),z(Hg,"children",(function(){return[Fg,Wg]}));var Yg,Xg,qg=Object.defineProperty,$g=Object.getOwnPropertyDescriptor,Gg=function(e,t,n,r){for(var i,o=r>1?void 0:r?$g(t,n):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(r?i(t,n,o):i(o))||o);return r&&o&&qg(t,n,o),o},Qg=function(e){Et(n,e);var t=Tt(n);function n(e){var r,i=e.store,o=e.user,a=e.shapes,s=e.tools,l=e.getContainer;M(this,n),z(_t(r=t.call(this)),"store",void 0),z(_t(r),"root",void 0),z(_t(r),"disposables",new Set),z(_t(r),"_tickManager",new dg(_t(r))),z(_t(r),"_updateDepth",0),z(_t(r),"snaps",new ag(_t(r))),z(_t(r),"user",void 0),z(_t(r),"textMeasure",void 0),z(_t(r),"isSafari",void 0),z(_t(r),"isIos",void 0),z(_t(r),"isChromeForIos",void 0),z(_t(r),"getContainer",void 0),z(_t(r),"history",new eg(_t(r),(function(){return r._complete()}),(function(e){r.annotateError(e,{origin:"history.batch",willCrashApp:!0}),r.crash(e)}))),z(_t(r),"shapeUtils",void 0),z(_t(r),"_invalidParents",new Set),z(_t(r),"_crashingError",null),z(_t(r),"_canMoveCamera",ue("can move camera",!0)),z(_t(r),"_isFocused",ue("_isFocused",!1)),z(_t(r),"_dpr",ue("devicePixelRatio","undefined"===typeof window?1:window.devicePixelRatio)),z(_t(r),"_isCoarsePointer",ue("isCoarsePointer",!1)),z(_t(r),"_openMenus",ue("open-menus",[])),z(_t(r),"_isChangingStyle",ue("isChangingStyle",!1)),z(_t(r),"_isChangingStyleTimeout",-1),z(_t(r),"_isPenMode",ue("isPenMode",!1)),z(_t(r),"_isReadOnly",ue("isReadOnly",!1)),z(_t(r),"_updateInstanceState",r.history.createCommand("updateTabState",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=r.instanceState;return{data:{prev:i,next:Ce(Ce({},i),e)},squashing:n,ephemeral:t}}),{do:function(e){var t=e.next;r.store.put([t])},undo:function(e){var t=e.prev;r.store.put([t])},squash:function(e,t){return{prev:e.prev,next:t.next}}})),z(_t(r),"_setInstancePageState",r.history.createCommand("setInstancePageState",(function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{data:{prev:r.store.get(null!==(t=e.id)&&void 0!==t?t:r.pageState.id),partial:e},ephemeral:n}}),{do:function(e){var t=e.prev,n=e.partial;r.store.update(t.id,(function(e){return Ce(Ce({},e),n)}))},undo:function(e){var t=e.prev;r.store.update(t.id,(function(){return t}))}})),z(_t(r),"_setSelectedIds",r.history.createCommand("setSelectedIds",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=r.pageState.selectedIds,i=new Set(r.pageState.selectedIds);return e.length===i.size&&e.every((function(e){return i.has(e)}))?null:{data:{ids:e,prevSelectedIds:n},squashing:t,preservesRedoStack:!0}}),{do:function(e){var t=e.ids;r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{selectedIds:t})}))},undo:function(e){var t=e.prevSelectedIds;r.store.update(r.pageState.id,(function(){return Ce(Ce({},r.pageState),{},{selectedIds:t})}))},squash:function(e,t){return{ids:t.ids,prevSelectedIds:e.prevSelectedIds}}})),z(_t(r),"_setFocusLayer",r.history.createCommand("setFocusLayer",(function(e){if(null!==e||r.canUndo)return{data:{prev:r.pageState.focusLayerId,next:e},preservesRedoStack:!0,squashing:!0}}),{do:function(e){var t=e.next;r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{focusLayerId:t})}))},undo:function(e){var t=e.prev;r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{focusLayerId:t})}))},squash:function(e,t){return{prev:e.prev,next:t.next}}})),z(_t(r),"_willSetInitialBounds",!0),z(_t(r),"_viewportAnimation",null),z(_t(r),"_cameraState",ue("camera state","idle")),z(_t(r),"_cameraStateTimeoutRemaining",0),z(_t(r),"_lastUpdateRenderingBoundsTimestamp",Date.now()),z(_t(r),"_decayCameraStateTimeout",(function(e){r._cameraStateTimeoutRemaining-=e,r._cameraStateTimeoutRemaining<=0&&(r.off("tick",r._decayCameraStateTimeout),r._cameraState.set("idle"),r.updateRenderingBounds())})),z(_t(r),"_tickCameraState",(function(){r._cameraStateTimeoutRemaining=64;var e=Date.now();"idle"===r._cameraState.__unsafe__getWithoutCapture()?(r._lastUpdateRenderingBoundsTimestamp=e,r._cameraState.set("moving"),r.on("tick",r._decayCameraStateTimeout)):e-r._lastUpdateRenderingBoundsTimestamp>620&&r.updateRenderingBounds()})),z(_t(r),"_renderingBounds",ue("rendering viewport",new ks)),z(_t(r),"_renderingBoundsExpanded",ue("rendering viewport expanded",new ks)),z(_t(r),"_currentPageShapeIds",void 0),z(_t(r),"_setCurrentPageId",r.history.createCommand("setCurrentPage",(function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).stopFollowing,n=void 0===t||t;if(r.store.has(e))return n&&r.instanceState.followingUserId&&r.stopFollowingUser(),{data:{toId:e,fromId:r.currentPageId},squashing:!0,preservesRedoStack:!0};console.error("Tried to set the current page id to a page that doesn't exist.")}),{do:function(e){var t=e.toId;if(r.store.has(t)){if(!r.getPageStateByPageId(t)){var n=kn.create({id:kn.createId(t)});r.store.put([n,Lr.create({id:Lr.createId(t),pageId:t})])}r.store.put([Ce(Ce({},r.instanceState),{},{currentPageId:t})]),r.updateRenderingBounds()}},undo:function(e){var t=e.fromId;r.store.has(t)&&(r.store.put([Ce(Ce({},r.instanceState),{},{currentPageId:t})]),r.updateRenderingBounds())},squash:function(e,t){var n=e.fromId;return{toId:t.toId,fromId:n}}})),z(_t(r),"_updatePage",r.history.createCommand("updatePage",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(r.isReadOnly)return null;var n=r.getPageById(e.id);return n?{data:{prev:n,partial:e},squashing:t}:null}),{do:function(e){var t=e.partial;r.store.update(t.id,(function(e){return Ce(Ce({},e),t)}))},undo:function(e){var t=e.prev,n=e.partial;r.store.update(n.id,(function(){return t}))},squash:function(e,t){return{prev:Ce(Ce({},e.prev),t.prev),partial:t.partial}}})),z(_t(r),"_createPage",r.history.createCommand("createPage",(function(e){var t,n,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dn.createId(),a=arguments.length>2?arguments[2]:void 0;if(r.isReadOnly)return null;if(r.pages.length>=40)return null;var s=r.pages,u=null!==(t=null!==a&&void 0!==a?a:null===(n=s[s.length-1])||void 0===n?void 0:n.index)&&void 0!==t?t:"a1",l=null===(i=s[s.findIndex((function(e){return e.index===u}))+1])||void 0===i?void 0:i.index;e=function(e,t){for(var n=e,r=new Set(t);r.has(n);){var i;n=null!==(i=/^.*(\d+)$/.exec(n))&&void 0!==i&&i[1]?n.replace(/(\d+)(?=\D?)$/,(function(e){return(+e+1).toString()})):"".concat(n," 1")}return n}(e,s.map((function(e){return e.name})));var c=Dn.create({id:o,name:e,index:l&&u!==l?E(u,l):C(u),meta:{}}),d=kn.create({id:kn.createId(c.id)}),f=Lr.create({id:Lr.createId(c.id),pageId:c.id});return{data:{prevSelectedPageId:r.currentPageId,newPage:c,newTabPageState:f,newCamera:d}}}),{do:function(e){var t=e.newPage,n=e.newTabPageState,i=e.newCamera;r.store.put([t,i,n,Ce(Ce({},r.instanceState),{},{currentPageId:t.id})]),r.updateRenderingBounds()},undo:function(e){var t=e.newPage,n=e.prevSelectedPageId,i=e.newTabPageState,o=e.newCamera;1!==r.pages.length&&(r.store.remove([i.id,t.id,o.id]),r.store.has(n)&&r.currentPageId!==n&&r.store.put([Ce(Ce({},r.instanceState),{},{currentPageId:n})]),r.updateRenderingBounds())}})),z(_t(r),"_deletePage",r.history.createCommand("delete_page",(function(e){if(r.isReadOnly)return null;var t=_t(r).pages;if(1===t.length)return null;var n=r.getPageById(e),i=r._pageStates.value.filter((function(t){return t.pageId===e}));if(!n)return null;if(e===r.currentPageId){var o,a=t.findIndex((function(t){return t.id===e})),s=null!==(o=t[a-1])&&void 0!==o?o:t[a+1];r.setCurrentPageId(s.id)}return{data:{id:e,deletedPage:n,deletedPageStates:i}}}),{do:function(e){var t=e.deletedPage,n=e.deletedPageStates,i=_t(r).pages;if(1!==i.length){if(t.id===r.currentPageId){var o,a=i.findIndex((function(e){return e.id===t.id})),s=null!==(o=i[a-1])&&void 0!==o?o:i[a+1];r.setCurrentPageId(s.id)}r.store.remove(n.map((function(e){return e.id}))),r.store.remove([t.id]),r.updateRenderingBounds()}},undo:function(e){var t=e.deletedPage,n=e.deletedPageStates;r.store.put([t]),r.store.put(n),r.updateRenderingBounds()}})),z(_t(r),"_createAssets",r.history.createCommand("createAssets",(function(e){return r.isReadOnly||e.length<=0?null:{data:{assets:e}}}),{do:function(e){var t=e.assets;r.store.put(t)},undo:function(e){var t=e.assets;r.store.remove(t.map((function(e){return e.id})))}})),z(_t(r),"_deleteAssets",r.history.createCommand("deleteAssets",(function(e){if(!r.isReadOnly&&!(e.length<=0)){var t=Te(e.map((function(e){return r.store.get(e)})));return{data:{ids:e,prev:t}}}}),{do:function(e){var t=e.ids;r.store.remove(t)},undo:function(e){var t=e.prev;r.store.put(t)}})),z(_t(r),"_updateAssets",r.history.createCommand("updateAssets",(function(e){if(!r.isReadOnly&&!(e.length<=0)){return{data:{snapshots:{},assets:e}}}}),{do:function(e){var t=e.assets,n=e.snapshots;r.store.put(t.map((function(e){var t=r.store.get(e.id);return n[e.id]=t,Ce(Ce({},t),e)})))},undo:function(e){var t=e.snapshots;r.store.put(Object.values(t))}})),z(_t(r),"_parentIdsToChildIds",void 0),z(_t(r),"_childIdsCache",new Yc),z(_t(r),"_createShapes",r.history.createCommand("createShapes",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(r.isReadOnly)return null;if(e.length<=0)return null;var n=_t(r),i=n.currentPageShapeIds,o=n.selectedIds,a=t?o:void 0,s=e.length+i.size>ju;s&&Zg(_t(r));var u=s?e.slice(0,ju-i.size):e;return 0===u.length?null:{data:{currentPageId:r.currentPageId,createdIds:e.map((function(e){return e.id})),prevSelectedIds:a,partials:u,select:t}}}),{do:function(e){var t=e.createdIds,n=e.partials,i=e.select,o=_t(r).focusLayerId;n=n.map((function(e){if(!e.parentId||!r.store.get(e.parentId)&&!n.find((function(t){return t.id===e.parentId}))){var t,i;e=Ce({},e);var a=r.getParentIdForNewShapeAtPoint({x:null!==(t=e.x)&&void 0!==t?t:0,y:null!==(i=e.y)&&void 0!==i?i:0},e.type);if(e.parentId=a,Vi(a)){var s,u,l,c=r.getPointInShapeSpace(r.getShapeById(a),{x:null!==(s=e.x)&&void 0!==s?s:0,y:null!==(u=e.y)&&void 0!==u?u:0});e.x=c.x,e.y=c.y,e.rotation=-r.getPageRotationById(a)+(null!==(l=e.rotation)&&void 0!==l?l:0)}return e.parentId===e.id&&(e.parentId=o),e}return e}));var a,s=new Map,u=[],l=J(n);try{for(l.s();!(a=l.n()).done;){var c,d,f,p,h=a.value,v=r.getShapeUtil(h),g=h.index;if(!g){var m,y=null!==(m=h.parentId)&&void 0!==m?m:o;s.has(y)||s.set(y,r.getHighestIndexForParent(y)),g=s.get(y),s.set(y,C(g))}var b,w=v.getDefaultProps(),x=J(v.styleProps);try{for(x.s();!(b=x.n()).done;){var k=G(b.value,2),S=k[0];w[k[1]]=r.getStyleForNextShape(S)}}catch(E){x.e(E)}finally{x.f()}var _=r.store.schema.types.shape.create(Ce(Ce({},h),{},{index:g,opacity:null!==(c=h.opacity)&&void 0!==c?c:r.instanceState.opacityForNextShape,parentId:null!==(d=h.parentId)&&void 0!==d?d:o,props:"props"in h?Ce(Ce({},w),h.props):w}));if(void 0===_.index)throw Error("no index!");var P=null===(f=(p=r.getShapeUtil(_)).onBeforeCreate)||void 0===f?void 0:f.call(p,_);P&&(_=P),u.push(_)}}catch(E){l.e(E)}finally{l.f()}u.forEach((function(e){e.meta=r.getInitialMetaForShape(e)})),r.store.put(u),i&&r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{selectedIds:t})}))},undo:function(e){var t=e.createdIds,n=e.prevSelectedIds;r.store.remove(t),n&&r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{selectedIds:n})}))}})),z(_t(r),"animatingShapes",new Map),z(_t(r),"_updateShapes",r.history.createCommand("updateShapes",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(r.isReadOnly)return null;var n=Te(e),i=Object.fromEntries(Te(n.map((function(e){var t=e.id;return r.getShapeById(t)}))).map((function(e){return[e.id,e]})));if(n.length<=0)return null;var o=Te(n.map((function(e){var t,n=i[e.id];if(!n)return null;for(var r=null,o=0,a=Object.entries(e);o<a.length;o++){var s=G(a[o],2),u=s[0],l=s[1];if(void 0!==l)switch(u){case"id":case"type":continue;default:if(l!==n[u])if(r||(r=Ce({},n)),"props"===u){for(var c=Ce({},n.props),d=0,f=Object.entries(l);d<f.length;d++){var p=G(f[d],2),h=p[0],v=p[1];void 0!==v&&(c[h]=v)}r.props=c}else if("meta"===u){for(var g=Ce({},n.meta),m=0,y=Object.entries(l);m<y.length;m++){var b=G(y[m],2),w=b[0],x=b[1];void 0!==x&&(g[w]=x)}r.meta=g}else r[u]=l}}return null!==(t=r)&&void 0!==t?t:n}))),a=Object.fromEntries(o.map((function(e){return[e.id,e]})));return{data:{snapshots:i,updates:a},squashing:t}}),{do:function(e){for(var t=e.updates,n=Object.values(t),i=0;i<n.length;i++){var o,a,s=n[i],u=r.store.get(s.id);if(u){var l=null===(o=(a=r.getShapeUtil(s)).onBeforeUpdate)||void 0===o?void 0:o.call(a,u,s);l&&(n[i]=l)}}r.store.put(n)},undo:function(e){var t=e.snapshots;r.store.put(Object.values(t))},squash:function(e,t){return{snapshots:Ce(Ce({},t.snapshots),e.snapshots),updates:Ce(Ce({},e.updates),t.updates)}}})),z(_t(r),"_deleteShapes",r.history.createCommand("delete_shapes",(function(e){if(r.isReadOnly)return null;if(0===e.length)return null;var t,n=u(r.pageState.selectedIds),i=new Set(e),o=J(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;r.visitDescendants(a,(function(e){i.add(e)}))}}catch(f){o.e(f)}finally{o.f()}var s=u(i),l=r._arrowBindingsIndex.value,c=Te(s.flatMap((function(e){var t=r.getShapeById(e),n=l[e];return n&&n.length>0?n.map((function(e){var t=e.arrowId;return r.getShapeById(t)})).concat(t):t}))),d=n.filter((function(e){return!i.has(e)}));return{data:{deletedIds:s,snapshots:c,prevSelectedIds:n,postSelectedIds:d}}}),{do:function(e){var t=e.deletedIds,n=e.postSelectedIds;r.store.remove(t),r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{selectedIds:n})}))},undo:function(e){var t=e.snapshots,n=e.prevSelectedIds;r.store.put(t),r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{selectedIds:n})}))}})),z(_t(r),"_selectionSharedStyles",ve("_selectionSharedStyles",(function(){var e,t=_t(r).selectedShapes,n=new fv,i=J(t);try{for(i.s();!(e=i.n()).done;){var o=e.value;r._extractSharedStyles(o,n)}}catch(a){i.e(a)}finally{i.f()}return n}))),z(_t(r),"externalContentManager",new Yv(_t(r))),z(_t(r),"inputs",{originPagePoint:new Xa,originScreenPoint:new Xa,previousPagePoint:new Xa,previousScreenPoint:new Xa,currentPagePoint:new Xa,currentScreenPoint:new Xa,keys:new Set,buttons:new Set,isPen:!1,shiftKey:!1,ctrlKey:!1,altKey:!1,isDragging:!1,isPointing:!1,isPinching:!1,isEditing:!1,isPanning:!1,pointerVelocity:new Xa}),z(_t(r),"_clickManager",new Hv(_t(r))),z(_t(r),"_prevCursor","default"),z(_t(r),"_shiftKeyTimeout",-1),z(_t(r),"_setShiftKeyTimeout",(function(){r.inputs.shiftKey=!1,r.dispatch({type:"keyboard",name:"key_up",key:"Shift",shiftKey:r.inputs.shiftKey,ctrlKey:r.inputs.ctrlKey,altKey:r.inputs.altKey,code:"ShiftLeft"})})),z(_t(r),"_altKeyTimeout",-1),z(_t(r),"_setAltKeyTimeout",(function(){r.inputs.altKey=!1,r.dispatch({type:"keyboard",name:"key_up",key:"Alt",shiftKey:r.inputs.shiftKey,ctrlKey:r.inputs.ctrlKey,altKey:r.inputs.altKey,code:"AltLeft"})})),z(_t(r),"_ctrlKeyTimeout",-1),z(_t(r),"_setCtrlKeyTimeout",(function(){r.inputs.ctrlKey=!1,r.dispatch({type:"keyboard",name:"key_up",key:"Ctrl",shiftKey:r.inputs.shiftKey,ctrlKey:r.inputs.ctrlKey,altKey:r.inputs.altKey,code:"ControlLeft"})})),z(_t(r),"_restoreToolId","select"),z(_t(r),"_pinchStart",1),z(_t(r),"_didPinch",!1),z(_t(r),"_selectedIdsAtPointerDown",[]),z(_t(r),"capturedPointerId",null),r.store=i,r.user=new fg(null!==o&&void 0!==o?o:_f()),r.getContainer=null!==l&&void 0!==l?l:function(){return document.body},r.textMeasure=new cg(_t(r)),r.root=new Hg(_t(r));var c,d=cv(a),f=new Set(Object.keys(i.schema.types.shape.migrations.subTypeMigrations)),p=J(d);try{for(p.s();!(c=p.n()).done;){var h=c.value;if(!f.has(h.type))throw Error('Editor and store have different shapes: "'.concat(h.type,'" was passed into the editor but not the schema'));f.delete(h.type)}}catch(B){p.e(B)}finally{p.f()}if(f.size>0)throw Error('Editor and store have different shapes: "'.concat(u(f)[0],'" is present in the store schema but not provided to the editor'));var v,g={},m=new Map,y=J(d);try{for(y.s();!(v=y.n()).done;){var b=v.value,w=b.util,x=b.props,k=Hi(null!==x&&void 0!==x?x:{});g[w.type]=new w(_t(r),w.type,k);var S,_=J(k.keys());try{for(_.s();!(S=_.n()).done;){var P=S.value;if(m.has(P.id)){if(m.get(P.id)!==P)throw Error('Multiple style props with id "'.concat(P.id,'" in use. Style prop IDs must be unique.'))}else m.set(P.id,P)}}catch(B){_.e(B)}finally{_.f()}}}catch(B){y.e(B)}finally{y.f()}r.shapeUtils=g;var I,T=J(d);try{for(T.s();!(I=T.n()).done;){var j=I.value.tool;if(j){if(Ke(r.root.children,j.id))throw Error("Can't override tool with id \"".concat(j.id,'"'));r.root.children[j.id]=new j(_t(r))}}}catch(B){T.e(B)}finally{T.f()}var A,O=J(s);try{for(O.s();!(A=O.n()).done;){var L=A.value;if(Ke(r.root.children,L.id))throw Error("Can't override tool with id \"".concat(L.id,'"'));r.root.children[L.id]=new L(_t(r))}}catch(B){O.e(B)}finally{O.f()}"undefined"!==typeof window&&"navigator"in window?(r.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),r.isChromeForIos=/crios.*safari/i.test(navigator.userAgent)):(r.isSafari=!1,r.isIos=!1,r.isChromeForIos=!1),r.store.onBeforeDelete=function(e){"shape"===e.typeName?r._shapeWillBeDeleted(e):"page"===e.typeName&&r._pageWillBeDeleted(e)},r.store.onAfterChange=function(e,t){r._updateDepth++,r._updateDepth>1e3&&console.error("[onAfterChange] Maximum update depth exceeded, bailing out."),"shape"===e.typeName&&"shape"===t.typeName?r._shapeDidChange(e,t):"instance_page_state"===e.typeName&&"instance_page_state"===t.typeName&&r._pageStateDidChange(e,t),r._updateDepth--},r.store.onAfterCreate=function(e){if("shape"===e.typeName&&r.isShapeOfType(e,op)&&r._arrowDidUpdate(e),"page"===e.typeName){var t=kn.createId(e.id),n=Lr.createId(e.id);r.store.has(t)||r.store.put([kn.create({id:t})]),r.store.has(n)||r.store.put([Lr.create({id:n,pageId:e.id})])}},r._currentPageShapeIds=function(e,t){var n=e.query.ids("shape"),r=null;function i(){var i=t();return r=i,new Set(u(n.value).filter((function(t){return Wv(e,i,e.get(t))})))}return ve("_shapeIdsInCurrentPage",(function(n,o){if(ce(n))return i();var a=t();if(a!==r)return i();var s=e.history.getDiffSince(o);if(s===Q)return i();var u,l=new Pe(n),c=J(s);try{for(c.s();!(u=c.n()).done;){for(var d=u.value,f=0,p=Object.values(d.added);f<p.length;f++){var h=p[f];Ki(h)&&Wv(e,a,h)&&l.add(h.id)}for(var v=0,g=Object.values(d.updated);v<g.length;v++){var m=G(g[v],2),y=(m[0],m[1]);Ki(y)&&(Wv(e,a,y)?l.add(y.id):l.remove(y.id))}for(var b=0,w=Object.keys(d.removed);b<w.length;b++){var x=w[b];Vi(x)&&l.remove(x)}}}catch(B){c.e(B)}finally{c.f()}var k=l.get();return k?fe(k.value,k.diff):n}))}(r.store,(function(){return r.currentPageId})),r._parentIdsToChildIds=function(e){var t=e.query.ids("shape");function n(){var n={};return t.value.forEach((function(t){var r=e.get(t);n[r.parentId]||(n[r.parentId]=[]),n[r.parentId].push([t,r.index])})),Object.values(n).forEach((function(e){return e.sort((function(e,t){return e[1]<t[1]?-1:1}))})),n}return ve("parentsToChildrenWithIndexes",(function(t,r){var i;if(ce(t))return n();var o=e.history.getDiffSince(r);if(o===Q)return n();if(0===o.length)return t;for(var a,s=null,l=function(e){s||(s=Ce({},t)),s[e]?s[e]===t[e]&&(s[e]=u(s[e])):s[e]=[]},c=new Set,d=0,f=o.length;d<f;d++){a=o[d];for(var p=0,h=Object.values(a.added);p<h.length;p++){var v=h[p];Ki(v)&&(l(v.parentId),s[v.parentId].push([v.id,v.index]),c.add(s[v.parentId]))}for(var g=function(){var e=G(y[m],2),t=e[0],n=e[1];if(!Ki(n))return 0;if(!Ki(t))return 0;if(t.parentId!==n.parentId)l(t.parentId),l(n.parentId),s[t.parentId].splice(s[t.parentId].findIndex((function(e){return e[0]===n.id})),1),s[n.parentId].push([n.id,n.index]),c.add(s[n.parentId]);else if(t.index!==n.index){l(n.parentId);var r=s[n.parentId].findIndex((function(e){return e[0]===n.id}));s[n.parentId][r]=[n.id,n.index],c.add(s[n.parentId])}},m=0,y=Object.values(a.updated);m<y.length;m++)g();for(var b=function(){var e=x[w];if(!Ki(e))return 1;l(e.parentId),s[e.parentId].splice(s[e.parentId].findIndex((function(t){return t[0]===e.id})),1)},w=0,x=Object.values(a.removed);w<x.length;w++)b()}var k,S=J(c);try{for(S.s();!(k=S.n()).done;)k.value.sort((function(e,t){return e[1]<t[1]?-1:1}))}catch(B){S.e(B)}finally{S.f()}return null!==(i=s)&&void 0!==i?i:t}))}(r.store),r.disposables.add(r.store.listen((function(e){r.emit("change",e)})));var D=r.getContainer(),R=function(){r._isFocused.set(!0)},N=function(){r._isFocused.set(!1)};return D.addEventListener("focusin",R),D.addEventListener("focus",R),D.addEventListener("focusout",N),D.addEventListener("blur",N),r.disposables.add((function(){D.removeEventListener("focusin",R),D.removeEventListener("focus",R),D.removeEventListener("focusout",N),D.removeEventListener("blur",N)})),r.store.ensureStoreIsUsable(),r.setPageState({editingId:null,hoveredId:null,erasingIds:[]},!0),r.root.enter(void 0,"initial"),r.instanceState.followingUserId&&r.stopFollowingUser(),r.updateRenderingBounds(),requestAnimationFrame((function(){r._tickManager.start()})),r}return L(n,[{key:"dispose",value:function(){this.disposables.forEach((function(e){return e()})),this.disposables.clear()}},{key:"undo",value:function(){return this.history.undo()}},{key:"canUndo",get:function(){return this.history.numUndos>0}},{key:"redo",value:function(){return this.history.redo(),this}},{key:"canRedo",get:function(){return this.history.numRedos>0}},{key:"mark",value:function(e,t,n){return this.history.mark(e,t,n)}},{key:"bail",value:function(){return this.history.bail(),this}},{key:"bailToMark",value:function(e){return this.history.bailToMark(e),this}},{key:"batch",value:function(e){return this.history.batch(e),this}},{key:"getShapeUtil",value:function(e){var t=Ve(this.shapeUtils,e.type);return Le(t,'No shape util found for type "'.concat(e.type,'"')),"prototype"in e&&e.prototype instanceof Uc&&Le(t instanceof e,'Shape util found for type "'.concat(e.type,'" is not an instance of the provided constructor')),t}},{key:"_arrowBindingsIndex",get:function(){return function(e){var t=e.store,n=t.query.filterHistory("shape"),r=t.query.records("shape",(function(){return{type:{eq:"arrow"}}}));function i(){var e,t={},n=J(r.value);try{for(n.s();!(e=n.n()).done;){var i=e.value,o=i.props,a=o.start,s=o.end;if("binding"===a.type){var u=t[a.boundShapeId];u?u.push({arrowId:i.id,handleId:"start"}):t[a.boundShapeId]=[{arrowId:i.id,handleId:"start"}]}if("binding"===s.type){var l=t[s.boundShapeId];l?l.push({arrowId:i.id,handleId:"end"}):t[s.boundShapeId]=[{arrowId:i.id,handleId:"end"}]}}}catch(c){n.e(c)}finally{n.f()}return t}return ve("arrowBindingsIndex",(function(t,r){var o;if(ce(t))return i();var a=t,s=n.getDiffSince(r);if(s===Q)return i();var l=void 0;function c(e){l||(l=Ce({},a)),l[e]?l[e]===a[e]&&(l[e]=u(l[e])):l[e]=[]}function d(e,t,n){c(e),l[e]=l[e].filter((function(e){return e.arrowId!==t||e.handleId!==n})),0===l[e].length&&delete l[e]}function f(e,t,n){c(e),l[e].push({arrowId:t,handleId:n})}var p,h=J(s);try{for(h.s();!(p=h.n()).done;){for(var v=p.value,g=0,m=Object.values(v.added);g<m.length;g++){var y=m[g];if(e.isShapeOfType(y,op)){var b=y.props,w=b.start,x=b.end;"binding"===w.type&&f(w.boundShapeId,y.id,"start"),"binding"===x.type&&f(x.boundShapeId,y.id,"end")}}for(var k=0,S=Object.values(v.updated);k<S.length;k++){var _=G(S[k],2),P=_[0],E=_[1];if(e.isShapeOfType(P,op)&&e.isShapeOfType(E,op))for(var C=0,I=["start","end"];C<I.length;C++){var T=I[C],M=P.props[T],j=E.props[T];"binding"===M.type&&"point"===j.type?d(M.boundShapeId,P.id,T):"point"===M.type&&"binding"===j.type?f(j.boundShapeId,E.id,T):"binding"===M.type&&"binding"===j.type&&M.boundShapeId!==j.boundShapeId&&(d(M.boundShapeId,P.id,T),f(j.boundShapeId,E.id,T))}}for(var A=0,O=Object.values(v.removed);A<O.length;A++){var L=O[A];if(e.isShapeOfType(L,op)){var z=L.props,D=z.start,R=z.end;"binding"===D.type&&d(D.boundShapeId,L.id,"start"),"binding"===R.type&&d(R.boundShapeId,L.id,"end")}}}}catch(N){h.e(N)}finally{h.f()}return null!==(o=l)&&void 0!==o?o:a}))}(this)}},{key:"getArrowsBoundTo",value:function(e){return this._arrowBindingsIndex.value[e]||K}},{key:"_reparentArrow",value:function(e){var t=this,n=this.getShapeById(e);if(n){var r=n.props,i=r.start,o=r.end,a="binding"===i.type?this.getShapeById(i.boundShapeId):void 0,s="binding"===o.type?this.getShapeById(o.boundShapeId):void 0,u=this.getAncestorPageId(n);if(u){var l;if(a&&s){var c;l=null!==(c=this.findCommonAncestor([a,s]))&&void 0!==c?c:u}else{if(!a&&!s)return;l=u}l&&l!==n.parentId&&this.reparentShapesById([e],l);var d=this.getShapeById(e);if(!d)throw Error("no reparented arrow");var f,p,h=this.getShapeNearestSibling(d,a),v=this.getShapeNearestSibling(d,s);if(h&&v)f=h.index>v.index?h:v;else if(h&&!v)f=h;else{if(!v||h)return;f=v}var g=this.getSortedChildIds(f.parentId).map((function(e){return t.getShapeById(e)})).filter((function(e){return e.index>f.index}));if(g.length){var m=g.find((function(e){return"arrow"!==e.type}));if(d.index>f.index&&(!m||d.index<m.index))return;p=E(f.index,g[0].index)}else p=C(f.index);p!==d.index&&this.updateShapes([{id:e,type:"arrow",index:p}])}}}},{key:"_unbindArrowTerminal",value:function(e,t){var n=Kf(this,e)[t],r=n.x,i=n.y;this.store.put([Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},z({},t,{type:"point",x:r,y:i}))})])}},{key:"_allPageStates",get:function(){return this.store.query.records("instance_page_state")}},{key:"_shapeWillBeDeleted",value:function(e){var t=this;e.parentId&&Vi(e.parentId)&&this._invalidParents.add(e.parentId);var n=this._arrowBindingsIndex.value[e.id];if(null!==n&&void 0!==n&&n.length){var r,i=J(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.arrowId,s=o.handleId,u=this.getShapeById(a);u&&this._unbindArrowTerminal(u,s)}}catch(f){i.e(f)}finally{i.f()}}var l=this._allPageStates.value,c=new Set([e.id]),d=Te(l.map((function(e){return t._cleanupInstancePageState(e,c)})));d.length&&this.store.put(d)}},{key:"_arrowDidUpdate",value:function(e){for(var t=0,n=["start","end"];t<n.length;t++){var r=n[t],i=e.props[r];if("binding"===i.type){var o=this.getShapeById(i.boundShapeId),a=this.getAncestorPageId(e)===this.getAncestorPageId(o);o&&a||this._unbindArrowTerminal(e,r)}}this._reparentArrow(e.id)}},{key:"_complete",value:function(){var e,t=J(this._invalidParents);try{for(t.s();!(e=t.n()).done;){var n,r=e.value;this._invalidParents.delete(r);var i=this.getShapeById(r);if(i){var o=this.getShapeUtil(i),a=null===(n=o.onChildrenChange)||void 0===n?void 0:n.call(o,i);null!==a&&void 0!==a&&a.length&&this.updateShapes(a,!0)}}}catch(s){t.e(s)}finally{t.f()}this.emit("update")}},{key:"_shapeDidChange",value:function(e,t){var n=this;if(this.isShapeOfType(t,op)&&this._arrowDidUpdate(t),e.parentId!==t.parentId){var r=function(e){var t=n._arrowBindingsIndex.value[e];if(null!==t&&void 0!==t&&t.length){var r,i=J(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;n._reparentArrow(o.arrowId)}}catch(a){i.e(a)}finally{i.f()}}};r(t.id),this.visitDescendants(t.id,r)}if(e.parentId!==t.parentId&&Rn(t.parentId)){var i=new Set([e.id]);this.visitDescendants(e.id,(function(e){i.add(e)}));var o,a=J(this._allPageStates.value);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(s.pageId!==t.parentId){var u=this._cleanupInstancePageState(s,i);u&&this.store.put([u])}}}catch(l){a.e(l)}finally{a.f()}}e.parentId&&Vi(e.parentId)&&this._invalidParents.add(e.parentId),t.parentId!==e.parentId&&Vi(t.parentId)&&this._invalidParents.add(t.parentId)}},{key:"_pageStateDidChange",value:function(e,t){var n=this;if((null===e||void 0===e?void 0:e.selectedIds)!==(null===t||void 0===t?void 0:t.selectedIds)){var r=t.selectedIds.filter((function(e){for(var r,i=null===(r=n.getShapeById(e))||void 0===r?void 0:r.parentId;Vi(i);){var o;if(t.selectedIds.includes(i))return!1;i=null===(o=n.getShapeById(i))||void 0===o?void 0:o.parentId}return!0})),i=0===r.length?null===t||void 0===t?void 0:t.focusLayerId:this.findCommonAncestor(Te(r.map((function(e){return n.getShapeById(e)}))),(function(e){return n.isShapeOfType(e,Hp)}));r.length===t.selectedIds.length&&i==t.focusLayerId||this.store.put([Ce(Ce({},t),{},{selectedIds:r,focusLayerId:null!==i&&void 0!==i?i:null})])}}},{key:"_pageWillBeDeleted",value:function(e){var t;if(this.instanceState.currentPageId===e.id){var n=null===(t=this.pages.find((function(t){return t.id!==e.id})))||void 0===t?void 0:t.id;if(n){this.store.put([Ce(Ce({},this.instanceState),{},{currentPageId:n})]);var r=kn.createId(e.id),i=Lr.createId(e.id);this.store.remove([r,i])}}}},{key:"annotateError",value:function(e,t){var n=t.origin,r=t.willCrashApp,i=t.tags,o=t.extras,a=this.createErrorAnnotations(n,r);Ne(e,{tags:Ce(Ce({},a.tags),i),extras:Ce(Ce({},a.extras),o)}),r&&this.store.markAsPossiblyCorrupted()}},{key:"createErrorAnnotations",value:function(e,t){try{return{tags:{origin:e,willCrashApp:t},extras:{activeStateNode:this.root.path.value,selectedShapes:this.selectedShapes,editingShape:this.editingId?this.getShapeById(this.editingId):void 0,inputs:this.inputs}}}catch(n){return{tags:{origin:e,willCrashApp:t},extras:{}}}}},{key:"crashingError",get:function(){return this._crashingError}},{key:"crash",value:function(e){this._crashingError=e,this.store.markAsPossiblyCorrupted(),this.emit("crash",{error:e})}},{key:"isIn",value:function(e){for(var t=e.split(".").reverse(),n=this.root;t.length>0;){var r=t.pop();if(!r)return!0;var i=n.current.value;if((null===i||void 0===i?void 0:i.id)!==r)return!1;if(0===t.length)return!0;n=i}return!1}},{key:"isInAny",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.some((function(t){return e.isIn(t)}))}},{key:"currentToolId",get:function(){var e,t=this.root.current.value,n=null===t||void 0===t?void 0:t.id;if("select"===n||"zoom"===n){var r,i,o=null===t||void 0===t?void 0:t.current.value;n=null!==(r=null===o||void 0===o||null===(i=o.info)||void 0===i?void 0:i.onInteractionEnd)&&void 0!==r?r:"select"}return null!==(e=n)&&void 0!==e?e:"select"}},{key:"setSelectedTool",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.root.transition(e,t),this}},{key:"getStateDescendant",value:function(e){for(var t=e.split(".").reverse(),n=this.root;t.length>0;){var r,i=t.pop();if(!i)return n;var o=null===(r=n.children)||void 0===r?void 0:r[i];if(!o)return;n=o}return n}},{key:"blur",value:function(){return this.complete(),this.getContainer().blur(),this._isFocused.set(!1),this}},{key:"focus",value:function(){return this.getContainer().focus(),this._isFocused.set(!0),this}},{key:"canMoveCamera",get:function(){return this._canMoveCamera.value},set:function(e){this._canMoveCamera.set(e)}},{key:"isFocused",get:function(){return this._isFocused.value}},{key:"devicePixelRatio",get:function(){return this._dpr.value}},{key:"setDevicePixelRatio",value:function(e){return this._dpr.set(e),this}},{key:"isCoarsePointer",get:function(){return this._isCoarsePointer.value},set:function(e){this._isCoarsePointer.set(e)}},{key:"openMenus",get:function(){return this._openMenus.value}},{key:"addOpenMenu",value:function(e){var t=new Set(this.openMenus);return t.has(e)||(t.add(e),this._openMenus.set(u(t))),this}},{key:"deleteOpenMenu",value:function(e){var t=new Set(this.openMenus);return t.has(e)&&(t.delete(e),this._openMenus.set(u(t))),this}},{key:"isMenuOpen",get:function(){return this.openMenus.length>0}},{key:"isChangingStyle",get:function(){return this._isChangingStyle.value},set:function(e){var t=this;this._isChangingStyle.set(e),clearTimeout(this._isChangingStyleTimeout),e&&(this._isChangingStyleTimeout=setTimeout((function(){return t.isChangingStyle=!1}),2e3))}},{key:"isPenMode",get:function(){return this._isPenMode.value}},{key:"setPenMode",value:function(e){return e!==this.isPenMode&&this._isPenMode.set(e),this}},{key:"setReadOnly",value:function(e){return this._isReadOnly.set(e),e&&this.setSelectedTool("hand"),this}},{key:"isReadOnly",get:function(){return this._isReadOnly.value}},{key:"documentSettings",get:function(){return this.store.get(ri)}},{key:"updateDocumentSettings",value:function(e){this.store.put([Ce(Ce({},this.documentSettings),e)])}},{key:"gridSize",get:function(){return this.documentSettings.gridSize}},{key:"projectName",get:function(){return this.documentSettings.name}},{key:"setProjectName",value:function(e){this.updateDocumentSettings({name:e})}},{key:"locale",get:function(){return this.user.locale}},{key:"setLocale",value:function(e){this.user.updateUserPreferences({locale:e})}},{key:"isSnapMode",get:function(){return this.user.isSnapMode}},{key:"setSnapMode",value:function(e){return e!==this.isSnapMode&&this.user.updateUserPreferences({isSnapMode:e}),this}},{key:"isDarkMode",get:function(){return this.user.isDarkMode}},{key:"setDarkMode",value:function(e){return e!==this.isDarkMode&&this.user.updateUserPreferences({isDarkMode:e}),this}},{key:"animationSpeed",get:function(){return this.user.animationSpeed}},{key:"setAnimationSpeed",value:function(e){return e!==this.animationSpeed&&this.user.updateUserPreferences({animationSpeed:e}),this}},{key:"instanceState",get:function(){return this.store.get(kr)}},{key:"cursor",get:function(){return this.instanceState.cursor}},{key:"brush",get:function(){return this.instanceState.brush}},{key:"setBrush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e||this.brush?(this.updateInstanceState({brush:e},!0),this):this}},{key:"zoomBrush",get:function(){return this.instanceState.zoomBrush}},{key:"setZoomBrush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e||this.zoomBrush?(this.updateInstanceState({zoomBrush:e},!0),this):this}},{key:"scribble",get:function(){return this.instanceState.scribble}},{key:"setScribble",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.updateInstanceState({scribble:e},!0),this}},{key:"isFocusMode",get:function(){return this.instanceState.isFocusMode}},{key:"setFocusMode",value:function(e){return e!==this.isFocusMode&&this.updateInstanceState({isFocusMode:e},!0),this}},{key:"isToolLocked",get:function(){return this.instanceState.isToolLocked}},{key:"setToolLocked",value:function(e){return e!==this.isToolLocked&&this.updateInstanceState({isToolLocked:e},!0),this}},{key:"isGridMode",get:function(){return this.instanceState.isGridMode}},{key:"setGridMode",value:function(e){return e!==this.isGridMode&&this.updateInstanceState({isGridMode:e},!0),this}},{key:"updateInstanceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this._updateInstanceState(e,t,n),this}},{key:"setCursor",value:function(e){var t=this.cursor,n=Ce(Ce({},t),{},{rotation:0},e);return t.type===n.type&&t.rotation===n.rotation&&t.color===n.color||this.updateInstanceState({cursor:n},!0),this}},{key:"_pageStates",get:function(){return this.store.query.records("instance_page_state")}},{key:"getPageStateByPageId",value:function(e){return this._pageStates.value.find((function(t){return t.pageId===e}))}},{key:"pageStateId",get:function(){return Lr.createId(this.currentPageId)}},{key:"pageState",get:function(){return this.store.get(this.pageStateId)}},{key:"setPageState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._setInstancePageState(e,t)}},{key:"selectedIds",get:function(){return this.pageState.selectedIds}},{key:"selectedIdsSet",get:function(){return new Set(this.selectedIds)}},{key:"setSelectedIds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._setSelectedIds(e,t),this}},{key:"isSelected",value:function(e){return this.selectedIdsSet.has(e)}},{key:"isWithinSelection",value:function(e){var t=this,n=this.getShapeById(e);return!!n&&(!!this.isSelected(e)||!!this.findAncestor(n,(function(e){return t.isSelected(e.id)})))}},{key:"select",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.setSelectedIds(t),this}},{key:"deselect",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this.selectedIds;return r.length>0&&t.length>0&&this.setSelectedIds(r.filter((function(e){return!t.includes(e)}))),this}},{key:"selectAll",value:function(){var e=this.getSortedChildIds(this.currentPageId);return e.length<=0||this.setSelectedIds(this._getUnlockedShapeIds(e)),this}},{key:"selectNone",value:function(){return this.selectedIds.length>0&&this.setSelectedIds([]),this}},{key:"selectedShapes",get:function(){var e=this;return Te(this.pageState.selectedIds.map((function(t){return e.store.get(t)})))}},{key:"onlySelectedShape",get:function(){var e=this.selectedShapes;return 1===e.length?e[0]:null}},{key:"selectedPageBounds",get:function(){var e=this,t=this.pageState.selectedIds;return 0===t.length?null:ks.Common(Te(t.map((function(t){return e.getPageBoundsById(t)}))))}},{key:"selectionRotation",get:function(){var e=this,t=this.selectedIds;if(0===t.length)return 0;if(1===t.length)return this.getPageRotationById(this.selectedIds[0]);var n=t.map((function(t){return e.getPageRotationById(t)%(Math.PI/2)}));return n.every((function(e){return Math.abs(e-n[0])<Math.PI/180}))?this.getPageRotationById(t[0]):0}},{key:"selectionBounds",get:function(){var e=this,t=this.selectedIds;if(0!==t.length){var n=this.selectionRotation;if(0===n)return this.selectedPageBounds;if(1===t.length){var r=this.getBounds(this.getShapeById(t[0])).clone();return r.point=Ms.applyToPoint(this.getPageTransformById(t[0]),r.point),r}var i=this.selectedIds.flatMap((function(t){var n=e.getPageTransformById(t);return n?e.getOutlineById(t).map((function(e){return Ms.applyToPoint(n,e)})):[]})).map((function(e){return Xa.Rot(e,-n)})),o=ks.FromPoints(i);return o.point=o.point.rot(n),o}}},{key:"selectionPageCenter",get:function(){var e=this.selectionBounds,t=this.selectionRotation;return e?Xa.RotWith(e.center,e.point,t):null}},{key:"focusLayerId",get:function(){var e;return null!==(e=this.pageState.focusLayerId)&&void 0!==e?e:this.currentPageId}},{key:"focusLayerShape",get:function(){var e=this.pageState.focusLayerId;if(e)return this.getShapeById(e)}},{key:"popFocusLayer",value:function(){var e=this,t=this.pageState.focusLayerId,n=t&&this.getShapeById(t);if(n){var r,i=this.findAncestor(n,(function(t){return e.isShapeOfType(t,Hp)}));this.setFocusLayer(null!==(r=null===i||void 0===i?void 0:i.id)&&void 0!==r?r:null),this.select(n.id)}else this.setFocusLayer(null),this.selectNone();return this}},{key:"setFocusLayer",value:function(e){return this._setFocusLayer(e),this}},{key:"editingId",get:function(){return this.pageState.editingId}},{key:"setEditingId",value:function(e){if(e){if(e!==this.editingId){var t=this.getShapeById(e),n=this.getShapeUtil(t);t&&n.canEdit(t)&&this.setPageState({editingId:e,hoveredId:null},!1)}}else this.setPageState({editingId:null});return this}},{key:"editingShape",get:function(){var e;return this.editingId&&null!==(e=this.getShapeById(this.editingId))&&void 0!==e?e:null}},{key:"hoveredId",get:function(){return this.pageState.hoveredId}},{key:"setHoveredId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e===this.pageState.hoveredId||this.setPageState({hoveredId:e},!0),this}},{key:"hoveredShape",get:function(){var e;return this.hoveredId&&null!==(e=this.getShapeById(this.hoveredId))&&void 0!==e?e:null}},{key:"hintingIds",get:function(){return this.pageState.hintingIds}},{key:"setHintingIds",value:function(e){return this.store.update(this.pageState.id,(function(t){return Ce(Ce({},t),{},{hintingIds:Ie(e)})})),this}},{key:"erasingIds",get:function(){return this.pageState.erasingIds}},{key:"erasingIdsSet",get:function(){return new Set(this.erasingIds)}},{key:"setErasingIds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.erasingIdsSet;return e.length===t.size&&e.every((function(e){return t.has(e)}))||this.setPageState({erasingIds:e},!0),this}},{key:"croppingId",get:function(){return this.pageState.croppingId}},{key:"setCroppingId",value:function(e){if(e!==this.croppingId)if(e){var t=this.getShapeById(e),n=this.getShapeUtil(t);t&&n.canCrop(t)&&this.setPageState({croppingId:e,hoveredId:null})}else this.setPageState({croppingId:null}),this.isInAny("select.crop","select.pointing_crop_handle","select.cropping")&&this.setSelectedTool("select.idle");return this}},{key:"_cleanupInstancePageState",value:function(e,t){var n=null,r=e.selectedIds.filter((function(e){return!t.has(e)}));r.length!==e.selectedIds.length&&(n||(n=Ce({},e)),n.selectedIds=r);var i=e.erasingIds.filter((function(e){return!t.has(e)}));i.length!==e.erasingIds.length&&(n||(n=Ce({},e)),n.erasingIds=i),e.hoveredId&&t.has(e.hoveredId)&&(n||(n=Ce({},e)),n.hoveredId=null),e.editingId&&t.has(e.editingId)&&(n||(n=Ce({},e)),n.editingId=null);var o=e.hintingIds.filter((function(e){return!t.has(e)}));return o.length!==e.hintingIds.length&&(n||(n=Ce({},e)),n.hintingIds=o),e.focusLayerId&&t.has(e.focusLayerId)&&(n||(n=Ce({},e)),n.focusLayerId=null),n}},{key:"cameraId",get:function(){return kn.createId(this.currentPageId)}},{key:"camera",get:function(){return this.store.get(this.cameraId)}},{key:"zoomLevel",get:function(){return this.camera.z}},{key:"_setCamera",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.camera.z,i=this.camera;if(i.x===e&&i.y===t&&i.z===r)return this;var o=Ce(Ce({},i),{},{x:e,y:t,z:r});return this.batch((function(){var e;n.store.put([o]);var t=n.inputs.currentScreenPoint;n.dispatch({type:"pointer",target:"canvas",name:"pointer_move",point:t,pointerId:Vu,ctrlKey:n.inputs.ctrlKey,altKey:n.inputs.altKey,shiftKey:n.inputs.shiftKey,button:0,isPen:null!==(e=n.isPenMode)&&void 0!==e&&e}),n._tickCameraState()})),this}},{key:"setCamera",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.camera.z,r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).stopFollowing,i=void 0===r||r;return this.stopCameraAnimation(),i&&this.instanceState.followingUserId&&this.stopFollowingUser(),e=Number.isNaN(e)?0:e,t=Number.isNaN(t)?0:t,n=Number.isNaN(n)?1:n,this._setCamera(e,t,n),this}},{key:"animateCamera",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.camera.z,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Nu;e=Number.isNaN(e)?0:e,t=Number.isNaN(t)?0:t,n=Number.isNaN(n)?1:n;var i=this.viewportScreenBounds,o=i.width,a=i.height,s=new ks(-e,-t,o/n,a/n);return this._animateToViewport(s,r)}},{key:"centerOnPoint",value:function(e,t,n){if(!this.canMoveCamera)return this;var r=this.viewportPageBounds,i=r.width,o=r.height,a=this.camera;return null!==n&&void 0!==n&&n.duration?this.animateCamera(-(e-i/2),-(t-o/2),a.z,n):this.setCamera(-(e-i/2),-(t-o/2),a.z),this}},{key:"zoomToContent",value:function(){var e,t=null!==(e=this.selectedPageBounds)&&void 0!==e?e:this.allShapesCommonBounds;return t&&this.zoomToBounds(t.minX,t.minY,t.width,t.height,Math.min(1,this.zoomLevel),{duration:220}),this}},{key:"zoomToFit",value:function(e){var t=this;if(!this.canMoveCamera)return this;var n=u(this.currentPageShapeIds);if(n.length<=0)return this;var r=ks.Common(Te(n.map((function(e){return t.getPageBoundsById(e)}))));return this.zoomToBounds(r.minX,r.minY,r.width,r.height,void 0,e),this}},{key:"resetZoom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.viewportScreenCenter,t=arguments.length>1?arguments[1]:void 0;if(!this.canMoveCamera)return this;var n=this.camera,r=n.x,i=n.y,o=n.z,a=e.x,s=e.y;return null!==t&&void 0!==t&&t.duration?this.animateCamera(r+(a/1-a)-(a/o-a),i+(s/1-s)-(s/o-s),1,t):this.setCamera(r+(a/1-a)-(a/o-a),i+(s/1-s)-(s/o-s),1),this}},{key:"zoomIn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.viewportScreenCenter,t=arguments.length>1?arguments[1]:void 0;if(!this.canMoveCamera)return this;for(var n=this.camera,r=n.x,i=n.y,o=n.z,a=zu,s=1;s<Ou.length;s++){var u=Ou[s];if(!(u-o<=(u-Ou[s-1])/2)){a=u;break}}var l=e.x,c=e.y;return null!==t&&void 0!==t&&t.duration?this.animateCamera(r+(l/a-l)-(l/o-l),i+(c/a-c)-(c/o-c),a,t):this.setCamera(r+(l/a-l)-(l/o-l),i+(c/a-c)-(c/o-c),a),this}},{key:"zoomOut",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.viewportScreenCenter,t=arguments.length>1?arguments[1]:void 0;if(!this.canMoveCamera)return this;for(var n=this.camera,r=n.x,i=n.y,o=n.z,a=Lu,s=Ou.length-1;s>0;s--){var u=Ou[s-1],l=Ou[s];if(!(l-o>=(l-u)/2)){a=u;break}}var c=e.x,d=e.y;return null!==t&&void 0!==t&&t.duration?this.animateCamera(r+(c/a-c)-(c/o-c),i+(d/a-d)-(d/o-d),a,t):this.setCamera(r+(c/a-c)-(c/o-c),i+(d/a-d)-(d/o-d),a),this}},{key:"zoomToSelection",value:function(e){var t=this;if(!this.canMoveCamera)return this;var n=this.selectedIds;if(n.length<=0)return this;var r=ks.Common(Te(n.map((function(e){return t.getPageBoundsById(e)}))));return this.zoomToBounds(r.minX,r.minY,r.width,r.height,Math.max(1,this.camera.z),e),this}},{key:"panZoomIntoView",value:function(e,t){var n=this;if(!this.canMoveCamera)return this;if(e.length<=0)return this;var r=ks.Common(Te(e.map((function(e){return n.getPageBoundsById(e)})))),i=this.viewportPageBounds;if(i.h<r.h||i.w<r.w)return this.zoomToBounds(r.minX,r.minY,r.width,r.height,this.camera.z,t),this;var o=this.viewportPageBounds.clone().expandBy(-32/this.zoomLevel),a=0,s=0;o.maxY<r.maxY?s=o.maxY-r.maxY:o.minY>r.minY&&(s=o.minY-r.minY),o.maxX<r.maxX?a=o.maxX-r.maxX:o.minX>r.minX&&(a=o.minX-r.minX);var u=this.camera;return null!==t&&void 0!==t&&t.duration?this.animateCamera(u.x+a,u.y+s,u.z,t):this.setCamera(u.x+a,u.y+s,u.z),this}},{key:"zoomToBounds",value:function(e,t,n,r,i,o){if(!this.canMoveCamera)return this;var a=this.viewportScreenBounds,s=Math.min(256,.28*a.width),u=es(Math.min((a.width-s)/n,(a.height-s)/r),Lu,zu);return void 0!==i&&(u=Math.min(i,u)),null!==o&&void 0!==o&&o.duration?this.animateCamera(-e+(a.width-n*u)/2/u,-t+(a.height-r*u)/2/u,u,o):this.setCamera(-e+(a.width-n*u)/2/u,-t+(a.height-r*u)/2/u,u),this}},{key:"pan",value:function(e,t,n){var r;if(!this.canMoveCamera)return this;var i=this.camera,o=i.x,a=i.y,s=i.z,u=new Xa(e,t).div(s);return null!==(r=null===n||void 0===n?void 0:n.duration)&&void 0!==r&&r?this.animateCamera(o+u.x,a+u.y,s,n):(this.setCamera(o+u.x,a+u.y,s),this)}},{key:"stopCameraAnimation",value:function(){return this.emit("stop-camera-animation"),this}},{key:"_animateViewport",value:function(e){var t=this;if(this._viewportAnimation){var n=function e(){t.removeListener("tick",t._animateViewport),t.removeListener("stop-camera-animation",e),t._viewportAnimation=null};this.once("stop-camera-animation",n),this._viewportAnimation.elapsed+=e;var r=this._viewportAnimation,i=r.elapsed,o=r.easing,a=r.duration,s=r.start,u=r.end;if(i>a){var l=this.viewportScreenBounds.width/u.width,c=-u.x,d=-u.y;return this._setCamera(c,d,l),void n()}var f=o(1-(a-i)/a),p=s.minX+(u.minX-s.minX)*f,h=s.minY+(u.minY-s.minY)*f,v=s.maxX+(u.maxX-s.maxX)*f,g=s.maxY+(u.maxY-s.maxY)*f,m=new ks(p,h,v-p,g-h),y=this.viewportScreenBounds.width/m.width,b=-m.x,w=-m.y;this._setCamera(b,w,y)}}},{key:"_animateToViewport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.duration,r=void 0===n?0:n,i=t.easing,o=void 0===i?Ya.easeInOutCubic:i,a=this.animationSpeed,s=this.viewportPageBounds;return this.stopCameraAnimation(),this.instanceState.followingUserId&&this.stopFollowingUser(),0===r||0===a?this._setCamera(-e.x,-e.y,this.viewportScreenBounds.width/e.width):(this._viewportAnimation={elapsed:0,duration:r/a,easing:o,start:s.clone(),end:e},this.addListener("tick",this._animateViewport),this)}},{key:"slideCamera",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.canMoveCamera)return this;if(this.stopCameraAnimation(),0!==this.animationSpeed){var n=t.speed,r=t.friction,i=t.direction,o=t.speedThreshold,a=void 0===o?.01:o,s=Math.min(n,1),u=function t(){e.removeListener("tick",l),e.removeListener("stop-camera-animation",t)};this.once("stop-camera-animation",u);var l=function(t){var n=e.camera,o=n.x,l=n.y,c=n.z,d=i.clone().mul(s*t/c);(s*=1-r)<a?u():e._setCamera(o+d.x,l+d.y,c)};return this.addListener("tick",l),this}}},{key:"animateToUser",value:function(e){var t=this,n=u(this.store.query.records("instance_presence",(function(){return{userId:{eq:e}}})).value).sort((function(e,t){return e.lastActivityTimestamp-t.lastActivityTimestamp})).pop();n&&this.batch((function(){null!==t.instanceState.followingUserId&&t.stopFollowingUser();var r=n.currentPageId===t.currentPageId;r||t.setCurrentPageId(n.currentPageId);var i=r?{duration:500}:void 0,o=n.cursor;t.centerOnPoint(o.x,o.y,i);var a=t.instanceState.highlightedUserIds;t.updateInstanceState({highlightedUserIds:[].concat(u(a),[e])}),setTimeout((function(){var n=u(t.instanceState.highlightedUserIds),r=n.indexOf(e);r<0||(n.splice(r,1),t.updateInstanceState({highlightedUserIds:n}))}),Ku)}))}},{key:"animateToShape",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nu;if(!this.canMoveCamera)return this;var n=this.viewportScreenBounds.clone().expandBy(-32),r=n.width/n.height,i=this.getPageBoundsById(e);if(!i)return this;var o=i.width/i.height,a=i.clone(),s=i.width/n.width;return a.width+=(n.minX+n.maxX)*s,a.height+=(n.minY+n.maxY)*s,a.x-=n.minX*s,a.y-=n.minY*s,o>r?(a.height=i.width/r,a.y-=(a.height-i.height)/2):(a.width=i.height*r,a.x-=(a.width-i.width)/2),this._animateToViewport(a,t)}},{key:"updateViewportScreenBounds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.getContainer();if(!t)return this;var n=t.getBoundingClientRect(),r=new ks(0,0,Math.max(n.width,1),Math.max(n.height,1)),i=r.equals(this.viewportScreenBounds),o=this._willSetInitialBounds;if(i)this._willSetInitialBounds=!1;else if(o)this._willSetInitialBounds=!1,this.updateInstanceState({screenBounds:r.toJson()},!0,!0);else{var a=this.zoomLevel;if(e){var s=this.viewportPageCenter;this.updateInstanceState({screenBounds:r.toJson()},!0,!0);var u=this.viewportPageCenter;this.instanceState.followingUserId||this.pan((u.x-s.x)*a,(u.y-s.y)*a)}else{var l=this.screenToPage(0,0);this.updateInstanceState({screenBounds:r.toJson()},!0,!0);var c=this.screenToPage(0,0);this.instanceState.followingUserId||this.pan((c.x-l.x)*a,(c.y-l.y)*a)}}this._tickCameraState(),this.updateRenderingBounds();var d=this.editingId;return d&&this.panZoomIntoView([d]),this}},{key:"viewportScreenBounds",get:function(){var e=this.instanceState.screenBounds,t=e.x,n=e.y,r=e.w,i=e.h;return new ks(t,n,r,i)}},{key:"viewportScreenCenter",get:function(){return this.viewportScreenBounds.center}},{key:"viewportPageBounds",get:function(){var e=this.viewportScreenBounds,t=e.x,n=e.y,r=e.w,i=e.h,o=this.screenToPage(t,n),a=this.screenToPage(t+r,n+i);return new ks(o.x,o.y,a.x-o.x,a.y-o.y)}},{key:"viewportPageCenter",get:function(){return this.viewportPageBounds.center}},{key:"screenToPage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.camera,i=this.store.unsafeGetWithoutCapture(kr).screenBounds,o=r.x,a=r.y,s=r.z,u=void 0===s?1:s;return{x:(e-i.x)/u-o,y:(t-i.y)/u-a,z:n}}},{key:"pageToScreen",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.camera,i=r.x,o=r.y,a=r.z,s=void 0===a?1:a;return{x:e+i*s,y:t+o*s,z:n}}},{key:"startFollowingUser",value:function(e){var t=this,n=this.store.query.records("instance_presence",(function(){return{userId:{eq:e}}})),r=this.user.id;if(r||console.warn("You should set the userId for the current instance before following a user"),!n.value.some((function(e){return e.followingUserId===r}))){ae((function(){t.stopFollowingUser(),t.updateInstanceState({followingUserId:e},!0)}));var i=!1,o=function(){var e=u(n.value).sort((function(e,t){return e.lastActivityTimestamp-t.lastActivityTimestamp})).pop();if(e){var o=e.currentPageId===t.currentPageId,a=o?.5:1;o||t.setCurrentPageId(e.currentPageId,{stopFollowing:!1});var s=t.viewportPageBounds,l=s.center,c=s.width,d=s.height,f=ks.From(e.screenBounds),p=f.width/e.camera.z,h=f.height/e.camera.z,v=new Xa(p/2-e.camera.x,h/2-e.camera.y),g=c+(p-c)*a,m=d+(h-d)*a,y=e.followingUserId===r?d/m:Math.min(c/g,d/m),b=es(t.camera.z*y,Lu,zu),w=t.viewportScreenBounds.w/b,x=t.viewportScreenBounds.h/b,k=v.sub(l),S=Xa.Add(l,Xa.Mul(k,a)),_=Xa.Sub(S,l).len(),P=Math.abs(b-t.camera.z);_<.1&&P<.005?i=!0:i&&_<.2&&P<.05||(i=!1,t.stopCameraAnimation(),t.setCamera(-(S.x-w/2),-(S.y-x/2),b,{stopFollowing:!1}))}else t.stopFollowingUser()};return this.once("stop-following",(function e(){t.removeListener("frame",o),t.removeListener("stop-following",e)})),this.addListener("frame",o),this}}},{key:"stopFollowingUser",value:function(){return this.updateInstanceState({followingUserId:null},!0),this.emit("stop-following"),this}},{key:"cameraState",get:function(){return this._cameraState.value}},{key:"computeUnorderedRenderingShapes",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.renderingBounds,o=r.renderingBoundsExpanded,a=r.erasingIdsSet,s=r.editingId,u=[],l=ju,c=0,d=function e(t,r,d){var f,p;if(Dn.isId(t)){var h,v=J(n.getSortedChildIds(t));try{for(v.s();!(h=v.n()).done;){e(h.value,r,d)}}catch(E){v.e(E)}finally{v.f()}}else{var g=n.getShapeById(t);if(g){var m=g.opacity*r,y=!1;!d&&null!==a&&void 0!==a&&a.has(t)&&(y=!0,m*=.32);var b=n.getMaskedPageBoundsById(t),w=!!b&&(null===(f=null===i||void 0===i?void 0:i.includes(b))||void 0===f||f),x=!b||(null===(p=s!==t&&!(null!==o&&void 0!==o&&o.includes(b)))||void 0===p||p);u.push({id:t,index:l,backgroundIndex:c,opacity:m,isCulled:x,isInViewport:w,maskedPageBounds:b}),l+=1,c+=1;var k=n.getSortedChildIds(t);if(k.length){var S=null;n.getShapeUtil(g).providesBackgroundForChildren(g)&&(S=c,c=l,l+=ju);var _,P=J(k);try{for(P.s();!(_=P.n()).done;){e(_.value,m,d||y)}}catch(E){P.e(E)}finally{P.f()}null!==S&&(c=S)}}}},f=J(e);try{for(f.s();!(t=f.n()).done;){d(t.value,1,!1)}}catch(p){f.e(p)}finally{f.f()}return u}},{key:"renderingShapes",get:function(){return this.computeUnorderedRenderingShapes([this.currentPageId],{renderingBounds:this.renderingBounds,renderingBoundsExpanded:this.renderingBoundsExpanded,erasingIdsSet:this.erasingIdsSet,editingId:this.editingId}).sort(nt)}},{key:"renderingBounds",get:function(){return this._renderingBounds.value}},{key:"renderingBoundsExpanded",get:function(){return this._renderingBoundsExpanded.value}},{key:"updateRenderingBounds",value:function(){var e=this.viewportPageBounds;return e.equals(this._renderingBounds.__unsafe__getWithoutCapture())||(this._renderingBounds.set(e.clone()),this._renderingBoundsExpanded.set(e.clone().expandBy(100/this.zoomLevel))),this}},{key:"_pages",get:function(){return this.store.query.records("page")}},{key:"pages",get:function(){return this._pages.value.sort(T)}},{key:"currentPage",get:function(){var e=this.getPageById(this.currentPageId);if(!e)throw Error("No current page (id ".concat(this.currentPageId,", ").concat(this.pages.length," pages))"));return e}},{key:"currentPageId",get:function(){return this.instanceState.currentPageId}},{key:"getPageById",value:function(e){return this.store.get(e)}},{key:"getPageInfoById",value:function(e){return this.store.get(e)}},{key:"currentPageShapeIds",get:function(){return this._currentPageShapeIds.value}},{key:"getShapeIdsInPage",value:function(e){var t=this.store.query.exec("shape",{parentId:{eq:e}});return this.getShapeAndDescendantIds(t.map((function(e){return e.id})))}},{key:"setCurrentPageId",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).stopFollowing,n=void 0===t||t;return this._setCurrentPageId(e,{stopFollowing:n}),this}},{key:"updatePage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._updatePage(e,t),this}},{key:"createPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dn.createId(),n=arguments.length>2?arguments[2]:void 0;return this._createPage(e,t,n),this}},{key:"duplicatePage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentPageId,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dn.createId();if(this.pages.length>=40)return this;var r=this.getPageById(t);if(!r)return this;var i=Ce({},this.camera),o=this.getContent(this.getSortedChildIds(r.id));return this.batch((function(){if(e.createPage(r.name+" Copy",n,r.index),e.setCurrentPageId(n),e.setCamera(i.x,i.y,i.z),o)return e.putContent(o)})),this}},{key:"renamePage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.isReadOnly||this.updatePage({id:e,name:t},n),this}},{key:"deletePage",value:function(e){this._deletePage(e)}},{key:"_assets",get:function(){return this.store.query.records("asset")}},{key:"assets",get:function(){return this._assets.value}},{key:"createAssets",value:function(e){return this._createAssets(e),this}},{key:"deleteAssets",value:function(e){return this._deleteAssets(e),this}},{key:"updateAssets",value:function(e){return this._updateAssets(e),this}},{key:"getAssetBySrc",value:function(e){return this.assets.find((function(t){return t.props.src===e}))}},{key:"getAssetById",value:function(e){return this.store.get(e)}},{key:"_boundsCache",get:function(){var e=this;return this.store.createComputedCache("bounds",(function(t){return e.getShapeUtil(t).getBounds(t)}))}},{key:"getBounds",value:function(e){var t,n=null!==(t=this._boundsCache.get(e.id))&&void 0!==t?t:new ks;return 0===n.width||0===n.height?new ks(n.x,n.y,Math.max(n.width,1),Math.max(n.height,1)):n}},{key:"getBoundsById",value:function(e){return this.getBounds(this.getShapeById(e))}},{key:"_outlineCache",get:function(){var e=this;return this.store.createComputedCache("outline",(function(t){return e.getShapeUtil(t).getOutline(t)}))}},{key:"getOutline",value:function(e){var t;return null!==(t=this._outlineCache.get(e.id))&&void 0!==t?t:K}},{key:"getOutlineById",value:function(e){return this.getOutline(this.getShapeById(e))}},{key:"_outlineSegmentsCache",get:function(){var e=this;return this.store.createComputedCache("outline-segments",(function(t){return e.getShapeUtil(t).getOutlineSegments(t)}))}},{key:"getOutlineSegments",value:function(e){var t;return null!==(t=this._outlineSegmentsCache.get(e.id))&&void 0!==t?t:K}},{key:"getOutlineSegmentsById",value:function(e){return this.getOutlineSegments(this.getShapeById(e))}},{key:"handlesCache",get:function(){var e=this;return this.store.createComputedCache("handles",(function(t){var n,r;return null===(n=(r=e.getShapeUtil(t)).getHandles)||void 0===n?void 0:n.call(r,t)}))}},{key:"getHandlesById",value:function(e){return this.handlesCache.get(e)}},{key:"getHandles",value:function(e){return this.getHandlesById(e.id)}},{key:"getTransform",value:function(e){return Ms.Compose(Ms.Translate(e.x,e.y),Ms.Rotate(e.rotation))}},{key:"_pageTransformCache",get:function(){var e=this;return this.store.createComputedCache("pageTransformCache",(function(t){var n;if(Rn(t.parentId))return e.getTransform(t);var r=null!==(n=e._pageTransformCache.get(t.parentId))&&void 0!==n?n:Ms.Identity();return Ms.Compose(r,e.getTransform(t))}))}},{key:"getParentTransform",value:function(e){var t;return Rn(e.parentId)?Ms.Identity():null!==(t=this._pageTransformCache.get(e.parentId))&&void 0!==t?t:Ms.Identity()}},{key:"getPageTransform",value:function(e){return this.getPageTransformById(e.id)}},{key:"getPageTransformById",value:function(e){return this._pageTransformCache.get(e)}},{key:"getPagePointById",value:function(e){var t=this.getPageTransformById(e);if(t)return Ms.applyToPoint(t,new Xa)}},{key:"getPageCenter",value:function(e){var t=this.getPageTransformById(e.id);if(!t)return null;var n=this.getShapeUtil(e).center(e);return Ms.applyToPoint(t,n)}},{key:"getPageCenterById",value:function(e){var t=this.getShapeById(e);return this.getPageCenter(t)}},{key:"getPageRotation",value:function(e){return this.getPageRotationById(e.id)}},{key:"getPageRotationById",value:function(e){var t=this.getPageTransformById(e);return t?Ms.Decompose(t).rotation:0}},{key:"_pageBoundsCache",get:function(){var e=this;return this.store.createComputedCache("pageBoundsCache",(function(t){var n=e._pageTransformCache.get(t.id);return n?ks.FromPoints(Ms.applyToPoints(n,e.getOutline(t))):new ks}))}},{key:"getPageBounds",value:function(e){return this.getPageBoundsById(e.id)}},{key:"getPageBoundsById",value:function(e){return this._pageBoundsCache.get(e)}},{key:"_clipPathCache",get:function(){var e=this;return this.store.createComputedCache("clipPathCache",(function(t){var n=e._pageMaskCache.get(t.id);if(n){var r=e._pageTransformCache.get(t.id);if(r){if(0===n.length)return"polygon(0px 0px, 0px 0px, 0px 0px)";var i=Ms.applyToPoints(Ms.Inverse(r),n);return"polygon(".concat(i.map((function(e){return"".concat(e.x,"px ").concat(e.y,"px")})).join(","),")")}}}))}},{key:"getClipPathById",value:function(e){return this._clipPathCache.get(e)}},{key:"_pageMaskCache",get:function(){var e=this;return this.store.createComputedCache("pageMaskCache",(function(t){if(!Rn(t.parentId)){var n=e.getAncestorsById(t.id).filter((function(t){return e.isShapeOfType(t,qp)}));if(0!==n.length){var r=n.map((function(t){return Ms.applyToPoints(e._pageTransformCache.get(t.id),e.getOutline(t))})).reduce((function(e,t){var n;return t&&e&&null!==(n=qs(e,t))&&void 0!==n?n:void 0}));return r}}}))}},{key:"getPageMaskById",value:function(e){return this._pageMaskCache.get(e)}},{key:"getMaskedPageBounds",value:function(e){return this.getMaskedPageBoundsById(e.id)}},{key:"getMaskedPageBoundsById",value:function(e){var t=this._pageBoundsCache.get(e);if(t){var n=this._pageMaskCache.get(e);if(n){var r=qs(n,t.corners);if(!r)return;return ks.FromPoints(r)}return t}}},{key:"getAncestors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.parentId;if(Rn(n))return t.reverse(),t;var r=this.store.get(n);return r?(t.push(r),this.getAncestors(r,t)):t}},{key:"getAncestorsById",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.getShapeById(e);return n?this.getAncestors(n,t):t}},{key:"findAncestor",value:function(e,t){var n=e.parentId;if(!Rn(n)){var r=this.getShapeById(n);return r?t(r)?r:this.findAncestor(r,t):void 0}}},{key:"hasAncestor",value:function(e,t){return!!e&&(e.parentId===t||this.hasAncestor(this.getParentShape(e),t))}},{key:"findCommonAncestor",value:function(e,t){var n=this;if(0!==e.length){if(1===e.length){var r,i=e[0].parentId;if(Rn(i))return;return t?null===(r=this.findAncestor(e[0],t))||void 0===r?void 0:r.id:i}for(var o=d(e),a=o[0],s=o.slice(1),u=this.getParentShape(a);u;)if(!t||t(u)){if(s.every((function(e){return n.hasAncestor(e,u.id)})))return u.id;u=this.getParentShape(u)}else u=this.getParentShape(u)}}},{key:"isShapeOrAncestorLocked",value:function(e){return void 0!==e&&(!!e.isLocked||this.isShapeOrAncestorLocked(this.getParentShape(e)))}},{key:"allShapesCommonBounds",get:function(){var e=this,t=null;return this.currentPageShapeIds.forEach((function(n){var r=e.getMaskedPageBoundsById(n);r&&(t?t.expand(r):t=r.clone())})),t}},{key:"getPageCorners",value:function(e){var t=this.getAncestors(e),n=this.getBounds(e).corners,r=Ms.Compose.apply(Ms,u(t.flatMap((function(e){return[Ms.Translate(e.x,e.y),Ms.Rotate(e.rotation)]}))).concat([Ms.Translate(e.x,e.y),Ms.Rotate(e.rotation,0,0)]));return Ms.applyToPoints(r,n)}},{key:"isPointInShape",value:function(e,t){var n=this.getShapeUtil(t),r=this._pageMaskCache.get(t.id);if(r&&!ms(e,r))return!1;return n.hitTestPoint(t,this.getPointInShapeSpace(t,e))}},{key:"getShapesAtPoint",value:function(e){var t=this;return this.shapesArray.filter((function(n){var r=t._pageMaskCache.get(n.id);return r?ms(e,r):t.getShapeUtil(n).hitTestPoint(n,t.getPointInShapeSpace(n,e))}))}},{key:"getPointInShapeSpace",value:function(e,t){return Ms.applyToPoint(Ms.Inverse(this.getPageTransform(e)),t)}},{key:"getPointInParentSpace",value:function(e,t){var n=this.getShapeById(e);if(!n)return new Xa(0,0);if(Rn(n.parentId))return Xa.From(t);var r=this.getPageTransformById(n.parentId);return r?Ms.applyToPoint(Ms.Inverse(r),t):Xa.From(t)}},{key:"getDeltaInShapeSpace",value:function(e,t){var n=this.getPageTransform(e);return n?Xa.Rot(t,-Ms.Decompose(n).rotation):Xa.From(t)}},{key:"getDeltaInParentSpace",value:function(e,t){if(Rn(e.parentId))return Xa.From(t);var n=this.getShapeById(e.parentId);return n?this.getDeltaInShapeSpace(n,t):Xa.From(t)}},{key:"getParentsMappedToChildren",value:function(e){var t=this,n=e.map((function(e){return t.store.get(e)})),r=new Map;return n.forEach((function(e){var t;r.has(e.parentId)||r.set(e.parentId,new Set),null===(t=r.get(e.parentId))||void 0===t||t.add(e)})),r}},{key:"shapesArray",get:function(){var e=this;return Array.from(this.currentPageShapeIds,(function(t){return e.store.get(t)}))}},{key:"sortedShapesArray",get:function(){var e=this,t=new Set(this.shapesArray.sort(T)),n=[];function r(e){n.push(e),t.delete(e),t.forEach((function(t){t.parentId===e.id&&r(t)}))}return t.forEach((function(t){Ki(e.getShapeById(t.parentId))||r(t)})),n}},{key:"isShapeOfType",value:function(e,t){return e.type===t.type}},{key:"getShapeById",value:function(e){if(Vi(e))return this.store.get(e)}},{key:"getParentShape",value:function(e){if(void 0!==e&&Vi(e.parentId))return this.store.get(e.parentId)}},{key:"getShapeNearestSibling",value:function(e,t){if(t)return t.parentId===e.parentId?t:this.findAncestor(t,(function(t){return t.parentId===e.parentId}))}},{key:"isShapeInPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentPageId,n=!1;if(e.parentId===t)n=!0;else{var r=this.getShapeById(e.parentId);e:for(;r;){if(r.parentId===t){n=!0;break e}r=this.getShapeById(r.parentId)}}return n}},{key:"getAncestorPageId",value:function(e){if(void 0!==e)return Rn(e.parentId)?e.parentId:this.getAncestorPageId(this.getShapeById(e.parentId))}},{key:"reparentShapesById",value:function(e,t,n){var r,i=this,o=[],a=Rn(t)?Ms.Identity():this.getPageTransformById(t),s=a.decompose().rotation,u=[],l=Te(this.getSortedChildIds(t).map((function(e){return i.getShapeById(e)})));if(n){var c=l.find((function(e){return e.index===n}));if(c){var d=l[l.indexOf(c)+1];u=d?_(n,d.index,e.length):P(n,e.length)}else{var f=l.sort(T).find((function(e){return e.index>n}));u=f?_(n,f.index,e.length):P(n,e.length)}}else{var p=l.length&&l[l.length-1];u=p?P(p.index,e.length):I(e.length)}for(var h=0;h<e.length;h++){r=e[h];var v=this.getShapeById(r),g=this.getPagePointById(r);if(v&&g){var m=Ms.applyToPoint(Ms.Inverse(a),g),y=this.getPageRotation(v)-s;o.push({id:v.id,type:v.type,parentId:t,x:m.x,y:m.y,rotation:y,index:u[h]})}}return this.updateShapes(o),this}},{key:"getHighestIndexForParent",value:function(e){var t=this._parentIdsToChildIds.value[e];return t&&0!==t.length?C(t[t.length-1][1]):"a1"}},{key:"getSortedChildIds",value:function(e){var t=this._parentIdsToChildIds.value[e];return t?this._childIdsCache.get(t,(function(){return t.map((function(e){return G(e,1)[0]}))})):K}},{key:"visitDescendants",value:function(e,t){var n,r=J(this.getSortedChildIds(e));try{for(r.s();!(n=r.n()).done;){var i=n.value;!1!==t(i)&&this.visitDescendants(i,t)}}catch(o){r.e(o)}finally{r.f()}}},{key:"getShapeAndDescendantIds",value:function(e){for(var t=new Set,n=u(e);n.length>0;){var r=n.pop();if(!r)break;t.has(r)||(t.add(r),this.getSortedChildIds(r).forEach((function(e){n.push(e)})))}return t}},{key:"getParentIdForNewShapeAtPoint",value:function(e,t){for(var n=this.sortedShapesArray,r=n.length-1;r>=0;r--){var i=n[r],o=this.getShapeUtil(i);if(o.canReceiveNewChildrenOfType(i,t)){var a=this.getMaskedPageBoundsById(i.id);if(a&&a.containsPoint(e)&&o.hitTestPoint(i,this.getPointInShapeSpace(i,e)))return i.id}}return this.focusLayerId}},{key:"getDroppingShape",value:function(e){for(var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=this.sortedShapesArray,o=function(){var t=i[a];if(r.find((function(e){return e.id===t.id||n.hasAncestor(t,e.id)})))return 0;var o=n.getShapeUtil(t);if(!o.canDropShapes(t,r))return 0;var s=n.getMaskedPageBoundsById(t.id);return s&&s.containsPoint(e)&&o.hitTestPoint(t,n.getPointInShapeSpace(t,e))?{v:t}:void 0},a=i.length-1;a>=0;a--)if(0!==(t=o())&&t)return t.v}},{key:"getOutermostSelectableShape",value:function(e,t){for(var n=e,r=e;r;){var i;if(!this.isShapeOfType(r,Hp)||this.focusLayerId===r.id||this.hasAncestor(this.focusLayerShape,r.id)||null!==(i=null===t||void 0===t?void 0:t(r))&&void 0!==i&&!i){if(this.focusLayerId===r.id)break}else n=r;r=this.getParentShape(r)}return n}},{key:"rotateShapesBy",value:function(e,t){if(e.length<=0)return this;var n=Fv({editor:this});return n?(Uv({delta:t,snapshot:n,editor:this,stage:"one-off"}),this):this}},{key:"nudgeShapes",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e.length<=0)return this;var i,o=this.isGridMode?n?5*this.gridSize:this.gridSize:n?10:1,a=Xa.Mul(t,o),s=[],u=J(e);try{for(u.s();!(i=u.n()).done;){var l,c,d=i.value,f=this.getShapeById(d);if(!f)throw Error("Could not find a shape with the id ".concat(d,"."));var p=this.getDeltaInParentSpace(f,a),h=null===(l=(c=this.getShapeUtil(f)).onTranslateStart)||void 0===l?void 0:l.call(c,f);s.push(h?Ce(Ce({},h),{},{x:f.x+p.x,y:f.y+p.y}):{id:d,x:f.x+p.x,y:f.y+p.y,type:f.type})}}catch(v){u.e(v)}finally{u.f()}return this.updateShapes(s,r),this}},{key:"duplicateShapes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIds,n=arguments.length>1?arguments[1]:void 0;if(t.length<=0)return this;for(var r=new Set(t),i=[],o=u(t);o.length>0;){var a=o.pop();if(!a)break;i.push(a),this.getSortedChildIds(a).forEach((function(e){return o.push(e)}))}i.reverse();var s=new Map(i.map((function(e){return[e,Wi()]}))),l=Te(i.map((function(t){var i,o=e.getShapeById(t);if(!o)return null;var a=s.get(t),u=0,l=0;if(n&&r.has(t)){var c=e.getParentTransform(o),d=new Xa(n.x,n.y).rot(-Ms.Decompose(c).rotation);u=d.x,l=d.y}var f=null!==(i=o.parentId)&&void 0!==i?i:e.currentPageId,p=e.getSortedChildIds(f),h=p.indexOf(o.id),v=p[h+1],g=v?e.getShapeById(v):null,m=g?E(o.index,g.index):C(o.index),y=We(o);if(e.isShapeOfType(o,op)&&e.isShapeOfType(y,op)){var b=e.getShapeUtil(op).getArrowInfo(o),w=void 0,x=void 0;if("binding"===o.props.start.type&&!(w=s.get(o.props.start.boundShapeId)))if(null!==b&&void 0!==b&&b.isValid){var k=b.start.point,S=k.x,_=k.y;y.props.start={type:"point",x:S,y:_}}else{var P=Kf(e,o).start;y.props.start={type:"point",x:P.x,y:P.y}}if("binding"===o.props.end.type&&!(x=s.get(o.props.end.boundShapeId)))if(null!==b&&void 0!==b&&b.isValid){var I=b.end.point,T=I.x,M=I.y;y.props.end={type:"point",x:T,y:M}}else{var j=Kf(e,o).end;y.props.start={type:"point",x:j.x,y:j.y}}var A=Bf(y)?Hf(e,y):Gf(e,y);if(null!==b&&void 0!==b&&b.isValid&&null!==A&&void 0!==A&&A.isValid&&!Bf(o)){var O=Xa.Med(b.start.handle,b.end.handle),L=Xa.Dist(b.middle,O),z=Xa.Dist(A.middle,O);y.props.bend<0?y.props.bend+=z-L:y.props.bend-=z-L}"binding"===y.props.start.type&&w&&(y.props.start.boundShapeId=w),"binding"===y.props.end.type&&x&&(y.props.end.boundShapeId=x)}return y=Ce(Ce({},y),{},{id:a,x:o.x+u,y:o.y+l,index:m})})));return l.forEach((function(e){Vi(e.parentId)&&s.has(e.parentId)&&(e.parentId=s.get(e.parentId))})),this.history.batch((function(){var t=l.length+e.currentPageShapeIds.size>ju;t&&Zg(e);var r=t?l.slice(0,ju-e.currentPageShapeIds.size):l,i=r.map((function(e){return e.id}));if(e.createShapes(r),e.setSelectedIds(i),void 0!==n){var o=e.viewportPageBounds,a=e.selectedPageBounds;a&&!o.contains(a)&&e.centerOnPoint(a.center.x,a.center.y,{duration:Au})}})),this}},{key:"moveShapesToPage",value:function(e,t){var n=this;if(0===e.length)return this;if(this.isReadOnly)return this;var r=this.currentPageId;if(t===r)return this;if(!this.store.has(t))return this;var i=this.getContent(e);if(!i)return this;if(this.getShapeIdsInPage(t).size+i.shapes.length>ju)return Zg(this,t),this;var o=this.camera.z;return this.history.batch((function(){n.deleteShapes(e),n.setCurrentPageId(t),n.setFocusLayer(null),n.selectNone(),n.putContent(i,{select:!0,preserveIds:!0,preservePosition:!0});var r=n.selectionBounds.center,a=r.x,s=r.y;n.setCamera(n.camera.x,n.camera.y,o),n.centerOnPoint(a,s)})),this}},{key:"toggleLock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIds;if(this.isReadOnly||0===e.length)return this;var t,n=!0,r=!0,i=[],o=J(e);try{for(o.s();!(t=o.n()).done;){var a=t.value,s=this.getShapeById(a);s&&(i.push(s),s.isLocked?r=!1:n=!1)}}catch(u){o.e(u)}finally{o.f()}return r?(this.updateShapes(i.map((function(e){return{id:e.id,type:e.type,isLocked:!0}}))),this.setSelectedIds([])):n?this.updateShapes(i.map((function(e){return{id:e.id,type:e.type,isLocked:!1}}))):this.updateShapes(i.map((function(e){return{id:e.id,type:e.type,isLocked:!0}}))),this}},{key:"reorderShapes",value:function(e,t){var n=this;if(this.isReadOnly)return this;if(0===t.length)return this;var r=this.getParentsMappedToChildren(t),i=[];switch(e){case"toBack":r.forEach((function(e,t){var r=Te(n.getSortedChildIds(t).map((function(e){return n.getShapeById(e)})));if(e.size!==r.length){var o,a,s,u=J(r);try{for(u.s();!(s=u.n()).done;){var l=s.value;if(!e.has(l)){a=l.index;break}e.delete(l),o=l.index}}catch(d){u.e(d)}finally{u.f()}if(0!==e.size){var c=_(o,a,e.size);Array.from(e.values()).sort(T).forEach((function(e,t){return i.push({id:e.id,type:e.type,index:c[t]})}))}}}));break;case"toFront":r.forEach((function(e,t){var r=Te(n.getSortedChildIds(t).map((function(e){return n.getShapeById(e)}))),o=r.length;if(e.size!==o){for(var a,s,u=o-1;u>-1;u--){var l=r[u];if(!e.has(l)){a=l.index;break}e.delete(l),s=l.index}if(0!==e.size){var c=_(a,s,e.size);Array.from(e.values()).sort(T).forEach((function(e,t){return i.push({id:e.id,type:e.type,index:c[t]})}))}}}));break;case"forward":r.forEach((function(e,t){var r=Te(n.getSortedChildIds(t).map((function(e){return n.getShapeById(e)}))),o=r.length;if(e.size!==o)for(var a,s=new Set(Array.from(e).map((function(e){return r.indexOf(e)}))),u=-1,l=!1,c=0;c<o;c++){var d=s.has(c);if(!l&&d)l=!0,u=c,void 0;else if(l&&!d){var f;l=!1,a=c-u;for(var p=_(r[c].index,null===(f=r[c+1])||void 0===f?void 0:f.index,a),h=0;h<a;h++){var v=r[u+h];i.push({id:v.id,type:v.type,index:p[h]})}}}}));break;case"backward":r.forEach((function(e,t){var r=Te(n.getSortedChildIds(t).map((function(e){return n.getShapeById(e)}))),o=r.length;if(e.size!==o)for(var a,s=new Set(Array.from(e).map((function(e){return r.indexOf(e)}))),u=-1,l=!1,c=o-1;c>-1;c--){var d=s.has(c);if(!l&&d)l=!0,u=c;else if(l&&!d){var f;l=!1,a=u-c;for(var p=_(null===(f=r[c-1])||void 0===f?void 0:f.index,r[c].index,a),h=0;h<a;h++){var v=r[c+h+1];i.push({id:v.id,type:v.type,index:p[h]})}}}}))}return this.updateShapes(i),this}},{key:"sendToBack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pageState.selectedIds;return this.reorderShapes("toBack",e),this}},{key:"sendBackward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pageState.selectedIds;return this.reorderShapes("backward",e),this}},{key:"bringForward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pageState.selectedIds;return this.reorderShapes("forward",e),this}},{key:"bringToFront",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pageState.selectedIds;return this.reorderShapes("toFront",e),this}},{key:"flipShapes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selectedIds;if(this.isReadOnly)return this;var r=Te(n.map((function(e){return t.getShapeById(e)})));if(!r.length)return this;r=Te(r.map((function(e){return t.isShapeOfType(e,Hp)?t.getSortedChildIds(e.id).map((function(e){return t.getShapeById(e)})):e})).flat());var i=ks.Common(Te(r.map((function(e){return t.getPageBounds(e)})))).center;return this.batch((function(){var n,o=J(r);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=t.getBounds(a),u=t.getPageTransformById(a.id);u&&t.resizeShape(a.id,{x:"horizontal"===e?-1:1,y:"vertical"===e?-1:1},{initialBounds:s,initialPageTransform:u,initialShape:a,mode:"scale_shape",scaleOrigin:i,scaleAxisRotation:0})}}catch(l){o.e(l)}finally{o.f()}})),this}},{key:"stackShapes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pageState.selectedIds,r=arguments.length>2?arguments[2]:void 0;if(this.isReadOnly)return this;var i=Te(n.map((function(e){return t.getShapeById(e)}))).filter((function(e){return!!e&&(!t.isShapeOfType(e,op)||"binding"!==e.props.start.type&&"binding"!==e.props.end.type)})),o=i.length;if(void 0===r&&o<3||o<2)return this;var a,s,u,l,c,d=Object.fromEntries(i.map((function(e){return[e.id,t.getPageBounds(e)]})));if("horizontal"===e?(a="x",s="minX",u="maxX",l="width"):(a="y",s="minY",u="maxY",l="height"),void 0===r){var f=[];i.sort((function(e,t){return d[e.id][s]-d[t.id][s]}));for(var p=function(){var e=i[h],t=i[h+1],n=d[e.id],r=d[t.id][s]-n[u],o=f.find((function(e){return e.gap===r}));o?o.count++:f.push({gap:r,count:1})},h=0;h<o-1;h++)p();var v=0;f.forEach((function(e){e.count>v&&(v=e.count,c=e.gap)})),1===v&&(c=Math.max(0,f.reduce((function(e,t){return e+t.gap*t.count}),0)/(o-1)))}else c=r;var g=[],m=d[i[0].id][u];return i.forEach((function(e,n){var r,i;if(0!==n){var o={x:0,y:0};o[a]=m+c-d[e.id][a];var s=t.getParentShape(e),u=s?Xa.Rot(o,-t.getPageRotation(s)):o,f=null===(r=(i=t.getShapeUtil(e)).onTranslateStart)||void 0===r?void 0:r.call(i,e);g.push(f?Ce(Ce({},f),{},z({},a,e[a]+u[a])):z({id:e.id,type:e.type},a,e[a]+u[a])),m+=d[e.id][l]+c}})),this.updateShapes(g),this}},{key:"packShapes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pageState.selectedIds,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;if(this.isReadOnly)return this;if(t.length<2)return this;for(var r,i,o=Te(t.map((function(t){return e.getShapeById(t)})).filter((function(t){return!!t&&(!e.isShapeOfType(t,op)||"binding"!==t.props.start.type&&"binding"!==t.props.end.type)}))),a={},s={},u=0,l=0;l<o.length;l++)r=o[l],i=this.getPageBounds(r),a[r.id]=i,s[r.id]=i.clone(),u+=i.width*i.height;var c=ks.Common(Te(Object.values(a))),d=c.width;o.sort((function(e,t){return a[t.id].height-a[e.id].height}));for(var f,p,h=Math.max(Math.ceil(Math.sqrt(u/.95)),d),v=[new ks(c.x,c.y,h,1/0)],g=0,m=0,y=0;y<o.length;y++){i=s[(r=o[y]).id];for(var b=v.length-1;b>=0;b--)if(f=v[b],!(i.width>f.width||i.height>f.height)){i.x=f.x,i.y=f.y,m=Math.max(m,i.maxY),g=Math.max(g,i.maxX),i.width===f.width&&i.height===f.height?(p=v.pop(),b<v.length&&(v[b]=p)):i.height===f.height?(f.x+=i.width+n,f.width-=i.width+n):i.width===f.width?(f.y+=i.height+n,f.height-=i.height+n):(v.push(new ks(f.x+(i.width+n),f.y,f.width-(i.width+n),i.height)),f.y+=i.height+n,f.height-=i.height+n);break}}for(var w,x=ks.Common(Object.values(s)),k=Xa.Sub(c.center,x.center),S=[],_=0;_<o.length;_++){var P,E;r=o[_],i=a[r.id],w=s[r.id];var C=this.getDeltaInParentSpace(r,Xa.Sub(w.point,i.point).add(k)),I={id:r.id,type:r.type,x:r.x+C.x,y:r.y+C.y},T=null===(P=(E=this.getShapeUtil(r)).onTranslateStart)||void 0===P?void 0:P.call(E,Ce(Ce({},r),I));T?S.push(Ce(Ce({},I),T)):S.push(I)}return S.length&&this.updateShapes(S),this}},{key:"alignShapes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pageState.selectedIds;if(this.isReadOnly)return this;if(n.length<2)return this;var r=Te(n.map((function(e){return t.getShapeById(e)}))),i=Object.fromEntries(r.map((function(e){return[e.id,t.getPageBounds(e)]}))),o=ks.Common(Te(Object.values(i))),a=[];return r.forEach((function(n){var r,s,u=i[n.id];if(u){var l={x:0,y:0};switch(e){case"top":l.y=o.minY-u.minY;break;case"center-vertical":l.y=o.midY-u.minY-u.height/2;break;case"bottom":l.y=o.maxY-u.minY-u.height;break;case"left":l.x=o.minX-u.minX;break;case"center-horizontal":l.x=o.midX-u.minX-u.width/2;break;case"right":l.x=o.maxX-u.minX-u.width}var c=t.getParentShape(n),d=c?Xa.Rot(l,-t.getPageRotation(c)):l,f=null===(r=(s=t.getShapeUtil(n)).onTranslateStart)||void 0===r?void 0:r.call(s,n);a.push(f?Ce(Ce({},f),{},{x:n.x+d.x,y:n.y+d.y}):{id:n.id,type:n.type,x:n.x+d.x,y:n.y+d.y})}})),this.updateShapes(a),this}},{key:"distributeShapes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pageState.selectedIds;if(this.isReadOnly)return this;if(n.length<3)return this;var r,i,o,a,s,u=n.length,l=Te(n.map((function(e){return t.getShapeById(e)}))),c=Object.fromEntries(l.map((function(e){return[e.id,t.getPageBounds(e)]})));"horizontal"===e?(r="x",i="minX",o="maxX",a="midX",s="width"):(r="y",i="minY",o="maxY",a="midY",s="height");var d=[],f=l.sort((function(e,t){return c[e.id][i]-c[t.id][i]}))[0],p=l.sort((function(e,t){return c[t.id][o]-c[e.id][o]}))[0],h=c[f.id][a],v=(c[p.id][a]-h)/(u-1),g=h+v;return l.filter((function(e){return e!==f&&e!==p})).sort((function(e,t){return c[e.id][a]-c[t.id][a]})).forEach((function(e,n){var i,o,a={x:0,y:0};a[r]=g+v*n-c[e.id][s]/2-c[e.id][r];var u=t.getParentShape(e),l=u?Xa.Rot(a,-t.getPageRotation(u)):a,f=null===(i=(o=t.getShapeUtil(e)).onTranslateStart)||void 0===i?void 0:i.call(o,e);d.push(f?Ce(Ce({},f),{},z({},r,e[r]+l[r])):z({id:e.id,type:e.type},r,e[r]+l[r]))})),this.updateShapes(d),this}},{key:"stretchShapes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pageState.selectedIds;if(this.isReadOnly)return this;if(n.length<2)return this;var r=Te(n.map((function(e){return t.getShapeById(e)}))),i=Object.fromEntries(r.map((function(e){return[e.id,t.getBounds(e)]}))),o=Object.fromEntries(r.map((function(e){return[e.id,t.getPageBounds(e)]}))),a=ks.Common(Te(Object.values(o)));switch(e){case"vertical":this.batch((function(){var e,n=J(r);try{for(n.s();!(e=n.n()).done;){var s=e.value;if(!(t.getPageRotation(s)%Qa)){var u=i[s.id],l=o[s.id],c=t.getDeltaInParentSpace(s,new Xa(0,a.minY-l.minY)),d=Xa.Add(c,s),f=d.x,p=d.y;t.updateShapes([{id:s.id,type:s.type,x:f,y:p}],!0);var h=new Xa(1,a.height/l.height);t.resizeShape(s.id,h,{initialBounds:u,scaleOrigin:new Xa(l.center.x,a.minY),scaleAxisRotation:0})}}}catch(v){n.e(v)}finally{n.f()}}));break;case"horizontal":this.batch((function(){var e,n=J(r);try{for(n.s();!(e=n.n()).done;){var s=e.value,u=i[s.id],l=o[s.id];if(!(t.getPageRotation(s)%Qa)){var c=t.getDeltaInParentSpace(s,new Xa(a.minX-l.minX,0)),d=Xa.Add(c,s),f=d.x,p=d.y;t.updateShapes([{id:s.id,type:s.type,x:f,y:p}],!0);var h=new Xa(a.width/l.width,1);t.resizeShape(s.id,h,{initialBounds:u,scaleOrigin:new Xa(a.minX,l.center.y),scaleAxisRotation:0})}}}catch(v){n.e(v)}finally{n.f()}}))}return this.updateShapes([]),this}},{key:"resizeShape",value:function(e,t){var n,r,i,o,a,s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isReadOnly)return this;Number.isFinite(t.x)||(t=new Xa(1,t.y)),Number.isFinite(t.y)||(t=new Xa(t.x,1));var l=null!==(n=u.initialShape)&&void 0!==n?n:this.getShapeById(e);if(!l)return this;var c=null!==(r=u.scaleOrigin)&&void 0!==r?r:null===(i=this.getPageBoundsById(e))||void 0===i?void 0:i.center;if(!c)return this;var d=this.getPageRotationById(e);if(null==d)return this;var f=null!==(o=u.scaleAxisRotation)&&void 0!==o?o:d,p=null!==(a=u.initialPageTransform)&&void 0!==a?a:this.getPageTransformById(e);if(!p)return this;var h=null!==(s=u.initialBounds)&&void 0!==s?s:this.getBoundsById(e);if(!h)return this;if(!cs(d,f))return this._resizeUnalignedShape(e,t,Ce(Ce({},u),{},{initialBounds:h,scaleOrigin:c,scaleAxisRotation:f,initialPageTransform:p,initialShape:l}));var v=this.getShapeUtil(l);if(v.isAspectRatioLocked(l)&&(t=Math.abs(t.x)>Math.abs(t.y)?new Xa(t.x,Math.sign(t.y)*Math.abs(t.x)):new Xa(Math.sign(t.x)*Math.abs(t.y),t.y)),v.onResize&&v.canResize(l)){var g,m,y=this._scalePagePoint(Ms.applyToPoint(p,new Xa(0,0)),c,t,f),b=this.getPointInParentSpace(l.id,y),w=new Xa(t.x,t.y),x=ns((d-f)%Math.PI,0);w.x=x?t.x:t.y,w.y=x?t.y:t.x;var k=Ms.applyToPoint(p,new Xa),S=this.getPointInParentSpace(l.id,k),_=S.x,P=S.y;this.updateShapes([Ce({id:e,type:l.type,x:b.x,y:b.y},v.onResize(Ce(Ce({},l),{},{x:_,y:P}),{newPoint:b,handle:null!==(g=u.dragHandle)&&void 0!==g?g:"bottom_right",mode:null!==(m=u.mode)&&void 0!==m?m:"scale_shape",scaleX:w.x,scaleY:w.y,initialBounds:h,initialShape:l}))],!0)}else{var E=Ms.applyToPoint(p,h.center),C=this._scalePagePoint(E,c,t,f),I=this.getPointInParentSpace(l.id,E),T=this.getPointInParentSpace(l.id,C),M=Xa.Sub(T,I);this.updateShapes([{id:e,type:l.type,x:l.x+M.x,y:l.y+M.y}],!0)}return this}},{key:"_resizeUnalignedShape",value:function(e,t,n){var r=n.initialShape.type,i=new Xa(t.x,t.y);if(Math.abs(t.x)>Math.abs(t.y)?i.x=Math.sign(t.x)*Math.abs(t.y):i.y=Math.sign(t.y)*Math.abs(t.x),this.resizeShape(e,i,{initialShape:n.initialShape,initialBounds:n.initialBounds}),Math.sign(t.x)*Math.sign(t.y)<0){var o=Ms.Decompose(n.initialPageTransform).rotation;o-=2*o,this.updateShapes([{id:e,type:r,rotation:o}],!0)}var a=Ms.applyToPoint(n.initialPageTransform,n.initialBounds.center),s=this._scalePagePoint(a,n.scaleOrigin,t,n.scaleAxisRotation),u=this.getPageCenterById(e),l=this.getPagePointById(e);if(!u||!l)return this;var c=Xa.Sub(s,u),d=Xa.Add(l,c),f=this.getPointInParentSpace(e,d),p=f.x,h=f.y;return this.updateShapes([{id:e,type:r,x:p,y:h}],!0),this}},{key:"_scalePagePoint",value:function(e,t,n,r){var i=Xa.RotWith(e,t,-r).sub(t),o=Xa.MulV(i,n);return Xa.Add(o,t).rotWith(t,r)}},{key:"getInitialMetaForShape",value:function(e){return{}}},{key:"createShapes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._createShapes(e,t),this}},{key:"animateShapes",value:function(e){var t,n,r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.duration,a=void 0===o?500:o,s=i.ease,u=void 0===s?Ya.linear:s,l=of(),c=a,d=[];e.forEach((function(e){if(e){var t={partial:e,values:[]},n=r.getShapeById(e.id);if(n){for(var i=0,o=["x","y","rotation"];i<o.length;i++){var a=o[i];void 0!==e[a]&&n[a]!==e[a]&&t.values.push({prop:a,from:n[a],to:e[a]})}d.push(t),r.animatingShapes.set(n.id,l)}}}));return this.addListener("tick",(function i(o){if((c-=o)<0){var s=r.animatingShapes,f=e.filter((function(e){return e&&s.get(e.id)===l}));return f.length&&r.updateShapes(f,!1),void r.removeListener("tick",i)}t=u(1-c/a);var p=r.animatingShapes;try{for(var h=[],v=0;v<d.length;v++)n=d[v],p.get(n.partial.id)===l&&h.push(Ce({id:n.partial.id,type:n.partial.type},n.values.reduce((function(e,n){var r=n.prop,i=n.from,o=n.to;return e[r]=i+(o-i)*t,e}),{})));r._updateShapes(h,!0)}catch(ej){}})),this}},{key:"groupShapes",value:function(){var e,t,n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIds,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wi();if(this.isReadOnly)return this;if(r.length<=1)return this;var o=Te(this._getUnlockedShapeIds(r).map((function(e){return n.getShapeById(e)}))),a=o.sort(T).map((function(e){return e.id})),s=ks.Common(Te(o.map((function(e){return n.getPageBounds(e)})))).point,u=s.x,l=s.y,c=null!==(e=this.findCommonAncestor(o))&&void 0!==e?e:this.currentPageId;if("select"!==this.currentToolId)return this;this.isIn("select.idle")||this.cancel();var d=o.filter((function(e){return e.parentId===c})).sort(T),f=null===(t=d[d.length-1])||void 0===t?void 0:t.index;return this.batch((function(){n.createShapes([{id:i,type:"group",parentId:c,index:f,x:u,y:l,opacity:1,props:{}}]),n.reparentShapesById(a,i),n.select(i)})),this}},{key:"ungroupShapes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIds;if(this.isReadOnly)return this;if(0===t.length)return this;if("select"!==this.currentToolId)return this;this.isIn("select.idle")||this.cancel();var n=new Set,r=Te(t.map((function(t){return e.getShapeById(t)}))),i=[];return r.forEach((function(t){e.isShapeOfType(t,Hp)?i.push(t):n.add(t.id)})),0===i.length||this.batch((function(){for(var t,r=0,o=i.length;r<o;r++){t=i[r];for(var a=e.getSortedChildIds(t.id),s=0,l=a.length;s<l;s++)n.add(a[s]);e.reparentShapesById(a,t.parentId,t.index)}e.deleteShapes(i.map((function(e){return e.id}))),e.select.apply(e,u(n))})),this}},{key:"updateShapes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Te(e);return this.animatingShapes.size>0&&r.forEach((function(e){return t.animatingShapes.delete(e.id)})),r=r.filter((function(e){var n=t.getShapeById(e.id);return!!n&&!(t.isShapeOrAncestorLocked(n)&&!Object.hasOwn(e,"isLocked"))})),this._updateShapes(r,n),this}},{key:"_getUnlockedShapeIds",value:function(e){var t=this;return e.filter((function(e){var n;return!(null!==(n=t.getShapeById(e))&&void 0!==n&&n.isLocked)}))}},{key:"deleteShapes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIds;return this._deleteShapes(this._getUnlockedShapeIds(e)),this}},{key:"_extractSharedStyles",value:function(e,t){if(this.isShapeOfType(e,Hp)){var n=this._parentIdsToChildIds.value[e.id];if(!n)return;for(var r=0,i=n.length;r<i;r++)this._extractSharedStyles(this.getShapeById(n[r][0]),t)}else{var o,a=J(this.getShapeUtil(e).styleProps);try{for(a.s();!(o=a.n()).done;){var s=G(o.value,2),u=s[0],l=s[1];t.applyValue(u,Ve(e.props,l))}}catch(c){a.e(c)}finally{a.f()}}}},{key:"_stylesForNextShape",get:function(){return this.instanceState.stylesForNextShape}},{key:"getStyleForNextShape",value:function(e){var t=this._stylesForNextShape[e.id];return void 0===t?e.defaultValue:t}},{key:"getShapeStyleIfExists",value:function(e,t){var n=this.getShapeUtil(e).styleProps.get(t);if(void 0!==n)return Ve(e.props,n)}},{key:"sharedStyles",get:function(){if(this.isIn("select")&&this.selectedIds.length>0)return this._selectionSharedStyles.value;var e=this.root.current.value,t=new fv;if(e.shapeType){var n,r=J(this.getShapeUtil(e.shapeType).styleProps.keys());try{for(r.s();!(n=r.n()).done;){var i=n.value;t.applyValue(i,this.getStyleForNextShape(i))}}catch(o){r.e(o)}finally{r.f()}}return t}},{key:"sharedOpacity",get:function(){var e=this;if(this.isIn("select")&&this.selectedIds.length>0){var t,n=[],r=function t(r){var i=e.getShapeById(r);if(i)if(e.isShapeOfType(i,Hp)){var o,a=J(e.getSortedChildIds(i.id));try{for(a.s();!(o=a.n()).done;){t(o.value)}}catch(s){a.e(s)}finally{a.f()}}else n.push(i)},i=J(this.selectedIds);try{for(i.s();!(t=i.n()).done;){r(t.value)}}catch(l){i.e(l)}finally{i.f()}for(var o=null,a=0,s=n;a<s.length;a++){var u=s[a];if(null===o)o=u.opacity;else if(o!==u.opacity)return{type:"mixed"}}if(null!==o)return{type:"shared",value:o}}return{type:"shared",value:this.instanceState.opacityForNextShape}}},{key:"setOpacity",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.history.batch((function(){if(t.isIn("select")){var i=t.pageState.selectedIds,o=[],a=function e(n){var r=t.getShapeById(n);if(r)if(t.isShapeOfType(r,Hp)){var i,a=J(t.getSortedChildIds(n));try{for(a.s();!(i=a.n()).done;){e(i.value)}}catch(s){a.e(s)}finally{a.f()}}else o.push(r)};if(i.length>0){var s,u=J(i);try{for(u.s();!(s=u.n()).done;){a(s.value)}}catch(l){u.e(l)}finally{u.f()}t.updateShapes(o.map((function(t){return{id:t.id,type:t.type,opacity:e}})),n)}}t.updateInstanceState({opacityForNextShape:e},n,r)})),this}},{key:"setStyle",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.history.batch((function(){if(n.isIn("select")){var o=n.pageState.selectedIds;if(o.length>0){var a,s=[],u=function r(i){var o=n.getShapeById(i);if(o)if(n.isShapeOfType(o,Hp)){var a,u=J(n.getSortedChildIds(i));try{for(u.s();!(a=u.n()).done;){r(a.value)}}catch(f){u.e(f)}finally{u.f()}}else{var l=n.getShapeUtil(o),c=l.styleProps.get(e);if(c){var d={id:o.id,type:o.type,props:z({},c,t)};s.push({util:l,originalShape:o,updatePartial:d})}}},l=J(o);try{for(l.s();!(a=l.n()).done;){u(a.value)}}catch(c){l.e(c)}finally{l.f()}n.updateShapes(s.map((function(e){return e.updatePartial})),r)}}n.updateInstanceState({stylesForNextShape:Ce(Ce({},n._stylesForNextShape),{},z({},e.id,t))},r,i)})),this}},{key:"getContent",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIds;if(t&&0!==t.length){var n={},r=Ie(t.map((function(t){return e.getShapeById(t)})).sort(T).flatMap((function(t){var n=[t];return e.visitDescendants(t.id,(function(t){n.push(e.getShapeById(t))})),n})));r=r.map((function(t){if(n[t.id]=e.getPageTransformById(t.id),t=it(t),e.isShapeOfType(t,op)){var i="binding"===t.props.start.type?t.props.start.boundShapeId:void 0,o="binding"===t.props.end.type?t.props.end.boundShapeId:void 0,a=e.getShapeUtil(op).getArrowInfo(t);if("binding"===t.props.start.type&&!r.some((function(e){return e.id===i})))if(null!==a&&void 0!==a&&a.isValid){var s=a.start.point,u=s.x,l=s.y;t.props.start={type:"point",x:u,y:l}}else{var c=Kf(e,t).start;t.props.start={type:"point",x:c.x,y:c.y}}if("binding"===t.props.end.type&&!r.some((function(e){return e.id===o})))if(null!==a&&void 0!==a&&a.isValid){var d=a.end.point,f=d.x,p=d.y;t.props.end={type:"point",x:f,y:p}}else{var h=Kf(e,t).end;t.props.end={type:"point",x:h.x,y:h.y}}var v=Bf(t)?Hf(e,t):Gf(e,t);if(null!==a&&void 0!==a&&a.isValid&&null!==v&&void 0!==v&&v.isValid&&!Bf(t)){var g=Xa.Med(a.start.handle,a.end.handle),m=Xa.Dist(a.middle,g),y=Xa.Dist(v.middle,g);t.props.bend<0?t.props.bend+=y-m:t.props.bend-=y-m}return t}return t}));var i=[];r.forEach((function(t){if(void 0===r.find((function(e){return e.id===t.parentId}))){var n=e.getPagePointById(t.id),o=e.getPageRotationById(t.id);t.x=n.x,t.y=n.y,t.rotation=o,t.parentId=e.currentPageId,i.push(t.id)}}));var o=new Set;return r.forEach((function(e){"assetId"in e.props&&null!==e.props.assetId&&o.add(e.props.assetId)})),{shapes:r,rootShapeIds:i,schema:this.store.schema.serialize(),assets:Te(Array.from(o).map((function(t){return e.getAssetById(t)})))}}}},{key:"putContent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.isReadOnly)return this;if(!e.schema)throw Error("Could not put content: content is missing a schema.");var r,i=n.select,o=void 0!==i&&i,a=n.preserveIds,s=void 0!==a&&a,u=n.preservePosition,l=void 0!==u&&u,c=n.point,d=void 0===c?void 0:c,f=this.currentPageId,p=e.assets,h=e.shapes,v=e.rootShapeIds,g=new Map(h.map((function(e){return[e.id,Wi()]}))),m=this.currentPageId,y=1/0,b=[],w=J(this.selectedShapes);try{for(w.s();!(r=w.n()).done;){var x=r.value;if(0===y)break;var k=this.isShapeOfType(x,qp),S=this.getAncestors(x);k&&S.push(x);var _=k?S.length+1:S.length;if(_<y)y=_,b=S,m=k?x.id:x.parentId;else if(_===y){if(b.length!==S.length)throw Error("Ancestors: ".concat(b.length," !== ").concat(S.length));if(0===b.length){m=f;break}m=f;for(var P=0;P<b.length&&S[P]===b[P];P++)m=S[P].id}}}catch(U){w.e(U)}finally{w.f()}var E=!1;if(!Rn(m)){var I=this.getShapeById(m);if(I)if(this.viewportPageBounds.includes(this.getPageBounds(I))){if(1===v.length){var T=h.find((function(e){return e.id===v[0]}));this.isShapeOfType(I,qp)&&this.isShapeOfType(T,qp)&&T.props.w===(null===I||void 0===I?void 0:I.props.w)&&T.props.h===(null===I||void 0===I?void 0:I.props.h)&&(E=!0)}}else m=f;else m=f}E||(E=g.has(m)),E&&(m=this.getShapeById(m).parentId);var M=this.getHighestIndexForParent(m),j=[],A=h.map((function(e){var n;if(s)n=We(e),g.set(e.id,e.id);else{var r=g.get(e.id);n=We(Ce(Ce({},e),{},{id:r}))}if(v.includes(e.id)&&(n.parentId=f,j.push(n)),g.has(n.parentId)?n.parentId=g.get(e.parentId):(v.push(n.id),n.index=M,M=C(M)),t.isShapeOfType(n,op)){if("binding"===n.props.start.type){var i=g.get(n.props.start.boundShapeId);n.props.start=i?Ce(Ce({},n.props.start),{},{boundShapeId:i}):{type:"point",x:0,y:0}}if("binding"===n.props.end.type){var o=g.get(n.props.end.boundShapeId);n.props.end=o?Ce(Ce({},n.props.end),{},{boundShapeId:o}):{type:"point",x:0,y:0}}}return n}));if(A.length+this.currentPageShapeIds.size>ju)return Zg(this),this;var O=[];if(p){for(var L=0;L<p.length;L++){var z=p[L],D=this.store.schema.migratePersistedRecord(z,e.schema);if("success"!==D.type)throw Error("Could not put content: could not migrate content for asset:\n".concat(JSON.stringify(z,null,2)));p[L]=D.value}var R=[];O=p.filter((function(e){return!t.store.has(e.id)})).map((function(e){var t;"image"!==e.type&&"video"!==e.type||(e.props.src&&null!==(t=e.props.src)&&void 0!==t&&t.startsWith("data:image")?(R.push(it(e)),e.props.src=null):R.push(it(e)));return e})),Promise.allSettled(R.map(function(){var e=Fa(Na().mark((function e(n){var r,i,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bv(n.props.src,n.props.name,null!==(r=n.props.mimeType)&&void 0!==r?r:"image/png");case 2:return i=e.sent,e.next=5,t.externalContentManager.createAssetFromFile(t,i);case 5:return o=e.sent,e.abrupt("return",[n,o]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(e){t.updateAssets(Te(e.map((function(e){return"fulfilled"===e.status?Ce(Ce({},e.value[1]),{},{id:e.value[0].id}):void 0}))))}))}for(var N=0;N<A.length;N++){var B=A[N],F=this.store.schema.migratePersistedRecord(B,e.schema);if("success"!==F.type)throw Error("Could not put content: could not migrate content for shape:\n".concat(JSON.stringify(B,null,2)));A[N]=F.value}return this.batch((function(){O.length>0&&t.createAssets(O),t.createShapes(A,o),m!==f&&t.reparentShapesById(j.map((function(e){return e.id})),m);var e=A.map((function(e){return t.getShapeById(e.id)})),n=ks.Common(e.map((function(e){return t.getPageBounds(e)})));if(void 0===d)if(Rn(m)){var r=t.viewportPageBounds;d=l||r.includes(ks.From(n))?n.center:r.center}else{var i=t.getShapeById(m),a=t.getShapeUtil(i);d=a.center(i)}if(1===j.length){var s=j[0];if(t.isShapeOfType(s,qp))for(;t.getShapesAtPoint(d).some((function(e){return t.isShapeOfType(e,qp)&&e.props.w===s.props.w&&e.props.h===s.props.h}));)d.x+=n.w+16}t.updateShapes(j.map((function(e){var t,r,i=(null!==(t=e.x)&&void 0!==t?t:0)-(n.x+n.w/2),o=(null!==(r=e.y)&&void 0!==r?r:0)-(n.y+n.h/2);return{id:e.id,type:e.type,x:d.x+i,y:d.y+o}})))})),this}},{key:"replaceStoreContentsWithRecordsForOtherDocument",value:function(e){var t=this;ae((function(){t.store.clear();var n=G(function(e,t){var n,r=[],i=[],o=J(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;t(a)?r.push(a):i.push(a)}}catch(s){o.e(s)}finally{o.f()}return[r,i]}(e,(function(e){return"shape"===e.typeName})),2),r=n[0],i=n[1];t.store.put(i,"initialize"),t.store.ensureStoreIsUsable(),t.store.put(r,"initialize"),t.history.clear(),t.updateViewportScreenBounds(),t.updateRenderingBounds();var o=t.allShapesCommonBounds;o&&t.zoomToBounds(o.minX,o.minY,o.width,o.height,1)}))}},{key:"putExternalContent",value:function(){var e=Fa(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.externalContentManager.handleContent(t);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSvg",value:function(){var e=Fa(Na().mark((function e(){var t,n,r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T,M,j=this,A=arguments;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=A.length>0&&void 0!==A[0]?A[0]:this.selectedIds.length?this.selectedIds:Object.keys(this.currentPageShapeIds),n=A.length>1&&void 0!==A[1]?A[1]:{},0!==t.length){e.next=4;break}return e.abrupt("return");case 4:if(window.document){e.next=6;break}throw Error("No document");case 6:r=n.scale,i=void 0===r?1:r,o=n.background,a=void 0!==o&&o,s=n.padding,u=void 0===s?32:s,l=n.preserveAspectRatio,c=void 0!==l&&l,d=eo(this),f=this.getShapeAndDescendantIds(t),p=this.computeUnorderedRenderingShapes([this.currentPageId]).filter((function(e){var t=e.id;return f.has(t)})),h=null,v=J(p),e.prev=12,v.s();case 14:if((g=v.n()).done){e.next=21;break}if(m=g.value.maskedPageBounds){e.next=18;break}return e.abrupt("continue",19);case 18:h?h.union(m):h=m.clone();case 19:e.next=14;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(12),v.e(e.t0);case 26:return e.prev=26,v.f(),e.finish(26);case 29:if(h){e.next=31;break}return e.abrupt("return");case 31:(y=1===t.length&&this.isShapeOfType(this.getShapeById(t[0]),qp)?t[0]:null)||h.expandBy(u),b=h.width*i,w=h.height*i,x=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),c&&x.setAttribute("preserveAspectRatio",c),x.setAttribute("direction","ltr"),x.setAttribute("width",b+""),x.setAttribute("height",w+""),x.setAttribute("viewBox","".concat(h.minX," ").concat(h.minY," ").concat(h.width," ").concat(h.height)),x.setAttribute("stroke-linecap","round"),x.setAttribute("stroke-linejoin","round"),a?y?x.style.setProperty("background",d.solid):x.style.setProperty("background-color",d.background):x.style.setProperty("background-color","transparent");try{null===(k=(S=document.body).focus)||void 0===k||k.call(S)}catch(ej){}return _=window.document.createElementNS("http://www.w3.org/2000/svg","defs"),x.append(_),P=new Map,E={addExportDef:function(e){if(!P.has(e.key)){var t=Fa(Na().mark((function t(){var n,r,i,o,a;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getElement();case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:r=document.createComment("def: ".concat(e.key)),_.appendChild(r),i=J(Array.isArray(n)?n:[n]);try{for(i.s();!(o=i.n()).done;)a=o.value,_.appendChild(a)}catch(s){i.e(s)}finally{i.f()}case 9:case"end":return t.stop()}}),t)})))();P.set(e.key,t)}}},e.next=51,Promise.all(p.map(function(){var e=Fa(Na().mark((function e(t){var n,r,i,o,a,s,u,l,c,f,p,h,v,g,m,b,w,x,k,S,P,C,I,T,M,A;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=t.id,l=t.opacity,c=t.index,f=t.backgroundIndex,u!==y){e.next=3;break}return e.abrupt("return",[]);case 3:if(p=j.getShapeById(u),!j.isShapeOfType(p,Hp)){e.next=6;break}return e.abrupt("return",[]);case 6:return h=j.getShapeUtil(p),e.next=9,null===(n=h.toSvg)||void 0===n?void 0:n.call(h,p,E);case 9:return v=e.sent,e.next=12,null===(r=h.toBackgroundSvg)||void 0===r?void 0:r.call(h,p,E);case 12:return g=e.sent,v&&((m=document.createElementNS("http://www.w3.org/2000/svg","g")).appendChild(v),v=m),g&&((b=document.createElementNS("http://www.w3.org/2000/svg","g")).appendChild(g),g=b),v||g||(w=j.getPageBounds(p),(x=window.document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("width",w.width+""),x.setAttribute("height",w.height+""),x.setAttribute("fill",d.solid),x.setAttribute("stroke",d.grey.pattern),x.setAttribute("stroke-width","1"),v=x),k=j.getPageTransform(p).toCssString(),"scale"in p.props&&1!==p.props.scale&&(k="".concat(k," scale(").concat(p.props.scale,", ").concat(p.props.scale,")")),null===(i=v)||void 0===i||i.setAttribute("transform",k),null===(o=g)||void 0===o||o.setAttribute("transform",k),null===(a=v)||void 0===a||a.setAttribute("opacity",l+""),null===(s=g)||void 0===s||s.setAttribute("opacity",l+""),(S=j.getPageMaskById(p.id))&&(P=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),_.appendChild(P),C=rf(),P.id=C,(I=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","M".concat(S.map((function(e){var t=e.x,n=e.y;return"".concat(t,",").concat(n)})).join("L"),"Z")),P.appendChild(I),v&&((T=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("clip-path","url(#".concat(C,")")),T.appendChild(v),v=T),g&&((M=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("clip-path","url(#".concat(C,")")),M.appendChild(g),g=M)),A=[],v&&A.push({zIndex:c,element:v}),g&&A.push({zIndex:f,element:g}),e.abrupt("return",A);case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 51:return C=e.sent.flat(),e.next=54,Promise.all(P.values());case 54:I=J(C.sort((function(e,t){return e.zIndex-t.zIndex})));try{for(I.s();!(T=I.n()).done;)M=T.value.element,x.appendChild(M)}catch(O){I.e(O)}finally{I.f()}return e.abrupt("return",x);case 57:case"end":return e.stop()}}),e,this,[[12,23,26,29]])})));return function(){return e.apply(this,arguments)}}()},{key:"_updateInputsFromEvent",value:function(e){var t,n,r=this.inputs,i=r.previousScreenPoint,o=r.previousPagePoint,a=r.currentScreenPoint,s=r.currentPagePoint,u=this.store.unsafeGetWithoutCapture(kr).screenBounds,l=e.point,c=l.x,d=l.y,f=l.z,p=this.camera,h=p.x,v=p.y,g=p.z;i.setTo(a),o.setTo(s),a.set(c,d),s.set((c-u.x)/g-h,(d-u.y)/g-v,null!==f&&void 0!==f?f:.5),this.inputs.isPen="pointer"===e.type&&e.isPen,"pointer_down"===e.name&&this.inputs.pointerVelocity.set(0,0),this.store.put([{id:Fr,typeName:"pointer",x:s.x,y:s.y,lastActivityTimestamp:"pointer"===e.type&&e.pointerId===Vu&&null!==(t=null===(n=this.store.get(Fr))||void 0===n?void 0:n.lastActivityTimestamp)&&void 0!==t?t:Date.now(),meta:{}}])}},{key:"cancel",value:function(){return this.dispatch({type:"misc",name:"cancel"}),this}},{key:"interrupt",value:function(){return this.dispatch({type:"misc",name:"interrupt"}),this}},{key:"complete",value:function(){return this.dispatch({type:"misc",name:"complete"}),this}},{key:"cancelDoubleClick",value:function(){this._clickManager.cancelDoubleClickTimeout()}},{key:"dispatch",value:function(e){var t=this;if(this.crashingError)return this;var n=this.inputs,r=e.type;return this.batch((function(){if("misc"===e.type)return"cancel"!==e.name&&"complete"!==e.name||(t.inputs.isDragging=!1,t.inputs.isPanning&&(t.inputs.isPanning=!1,t.setCursor({type:t._prevCursor}))),void t.root.handleEvent(e);e.shiftKey?(clearInterval(t._shiftKeyTimeout),t._shiftKeyTimeout=-1,n.shiftKey=!0):!e.shiftKey&&n.shiftKey&&-1===t._shiftKeyTimeout&&(t._shiftKeyTimeout=setTimeout(t._setShiftKeyTimeout,150)),e.altKey?(clearInterval(t._altKeyTimeout),t._altKeyTimeout=-1,n.altKey=!0):!e.altKey&&n.altKey&&-1===t._altKeyTimeout&&(t._altKeyTimeout=setTimeout(t._setAltKeyTimeout,150)),e.ctrlKey?(clearInterval(t._ctrlKeyTimeout),t._ctrlKeyTimeout=-1,n.ctrlKey=!0):!e.ctrlKey&&n.ctrlKey&&-1===t._ctrlKeyTimeout&&(t._ctrlKeyTimeout=setTimeout(t._setCtrlKeyTimeout,150));var i=n.originPagePoint,o=n.originScreenPoint,a=n.currentPagePoint,s=n.currentScreenPoint;switch(n.isPointing||(n.isDragging=!1),r){case"pinch":if(!t.canMoveCamera)return;switch(t._updateInputsFromEvent(e),e.name){case"pinch_start":if(n.isPinching)return;return void(n.isEditing||(t._pinchStart=t.camera.z,t._selectedIdsAtPointerDown.length||(t._selectedIdsAtPointerDown=t.selectedIds.slice()),t._didPinch=!0,n.isPinching=!0,t.interrupt()));case"pinch":if(!n.isPinching)return;var u=e.point,l=u.x,c=u.y,d=u.z,f=void 0===d?1:d,p=e.delta,h=p.x,v=p.y,g=t.camera,m=g.x,y=g.y,b=g.z,w=Math.min(zu,Math.max(Lu,f));return void t.setCamera(m+h/b-l/b+l/w,y+v/b-c/b+c/w,w);case"pinch_end":if(!n.isPinching)return t;n.isPinching=!1;var x=t._selectedIdsAtPointerDown;t.setSelectedIds(t._selectedIdsAtPointerDown,!0),t._selectedIdsAtPointerDown=[];var k,S=t.camera,_=S.x,P=S.y,E=S.z;if(E>.9&&E<1.05?k=1:E>.49&&E<.505&&(k=.5),E>t._pinchStart-.1&&E<t._pinchStart+.05&&(k=t._pinchStart),void 0!==k){var C=t.viewportScreenCenter,I=C.x,T=C.y;t.animateCamera(_+(I/k-I)-(I/E-I),P+(T/k-T)-(T/E-T),k,{duration:100})}return void(t._didPinch&&(t._didPinch=!1,requestAnimationFrame((function(){t._didPinch||t.setSelectedIds(x,!0)}))))}case"wheel":if(!t.canMoveCamera)return;if(t.isMenuOpen);else{if(n.ctrlKey){var M,j=t.inputs.currentScreenPoint,A=j.x,O=j.y,L=t.camera,z=L.x,D=L.y,R=L.z,N=Math.min(zu,Math.max(Lu,R+(null!==(M=e.delta.z)&&void 0!==M?M:0)*R));return void t.setCamera(z+(A/N-A)-(A/R-A),D+(O/N-O)-(O/R-O),N)}t.pan(e.delta.x,e.delta.y),!n.isDragging&&n.isPointing&&i.dist(a)>(t.isCoarsePointer?6:4)/t.zoomLevel&&(n.isDragging=!0)}break;case"pointer":if(n.isPinching)return;t._updateInputsFromEvent(e);var B=e.isPen;switch(e.name){case"pointer_down":if(t._selectedIdsAtPointerDown=t.selectedIds.slice(),0===e.button&&(t.capturedPointerId=e.pointerId),n.buttons.add(e.button),n.isPointing=!0,n.isDragging=!1,t.isPenMode){if(!B)return}else B&&t.setPenMode(!0);if(5===e.button?(t._restoreToolId=t.currentToolId,t.complete(),t.setSelectedTool("eraser")):1===e.button&&(t.inputs.isPanning||(t._prevCursor=t.instanceState.cursor.type),t.inputs.isPanning=!0),t.inputs.isPanning)return t.stopCameraAnimation(),t.setCursor({type:"grabbing"}),t;o.setTo(s),i.setTo(a);break;case"pointer_move":if(!B&&t.isPenMode)return;if(t.inputs.isPanning&&t.inputs.isPointing){var F=t.inputs,U=F.currentScreenPoint,K=F.previousScreenPoint,V=Xa.Sub(U,K);return void t.pan(V.x,V.y)}!n.isDragging&&n.isPointing&&i.dist(a)>(t.isCoarsePointer?6:4)/t.zoomLevel&&(n.isDragging=!0);break;case"pointer_up":if(n.buttons.delete(e.button),n.isPointing=!1,n.isDragging=!1,t.isMenuOpen)return;if(!B&&t.isPenMode)return;t.capturedPointerId===e.pointerId&&(t.capturedPointerId=null,e.button=0),n.isPanning?1===e.button?t.inputs.keys.has(" ")?(t.slideCamera({speed:Math.min(2,t.inputs.pointerVelocity.len()),direction:t.inputs.pointerVelocity,friction:Bu}),t.setCursor({type:"grab"})):(n.isPanning=!1,t.slideCamera({speed:Math.min(2,t.inputs.pointerVelocity.len()),direction:t.inputs.pointerVelocity,friction:Bu}),t.setCursor({type:t._prevCursor})):0===e.button&&(t.slideCamera({speed:Math.min(2,t.inputs.pointerVelocity.len()),direction:t.inputs.pointerVelocity,friction:Bu}),t.setCursor({type:"grab"})):5===e.button&&(t.complete(),t.setSelectedTool(t._restoreToolId))}break;case"keyboard":switch("ShiftRight"===e.key&&(e.key="ShiftLeft"),"AltRight"===e.key&&(e.key="AltLeft"),"ControlRight"===e.code&&(e.code="ControlLeft"),e.name){case"key_down":n.keys.add(e.code),e.ctrlKey||"Space"!==e.code||(t.inputs.isPanning||(t._prevCursor=t.instanceState.cursor.type),t.inputs.isPanning=!0,t.setCursor({type:t.inputs.isPointing?"grabbing":"grab"}));break;case"key_up":n.keys.delete(e.code),"Space"!==e.code||t.inputs.buttons.has(1)||(t.inputs.isPanning=!1,t.setCursor({type:t._prevCursor}))}}if("pointer"===e.type&&(1===e.button?e.name="middle_click":2===e.button&&(e.name="right_click"),e.isPen===t.isPenMode))switch(e.name){case"pointer_down":var W=t._clickManager.transformPointerDownEvent(e);if(e.name!==W.name)return t.root.handleEvent(e),t.emit("event",e),t.root.handleEvent(W),void t.emit("event",W);break;case"pointer_up":var H=t._clickManager.transformPointerUpEvent(e);if(e.name!==H.name)return t.root.handleEvent(e),t.emit("event",e),t.root.handleEvent(H),void t.emit("event",H);break;case"pointer_move":t._clickManager.handleMove()}t.root.handleEvent(e),t.emit("event",e)})),this}}]),n}(Pf.EventEmitter);function Zg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.currentPageId,n=e.getPageById(t).name;e.emit("max-shapes",{name:n,pageId:t,count:ju})}Gg([ve],Qg.prototype,"canUndo",1),Gg([ve],Qg.prototype,"canRedo",1),Gg([ve],Qg.prototype,"_arrowBindingsIndex",1),Gg([ve],Qg.prototype,"_allPageStates",1),Gg([ve],Qg.prototype,"devicePixelRatio",1),Gg([ve],Qg.prototype,"openMenus",1),Gg([ve],Qg.prototype,"isMenuOpen",1),Gg([ve],Qg.prototype,"documentSettings",1),Gg([ve],Qg.prototype,"_pageStates",1),Gg([ve],Qg.prototype,"pageStateId",1),Gg([ve],Qg.prototype,"pageState",1),Gg([ve],Qg.prototype,"selectedIds",1),Gg([ve],Qg.prototype,"selectedIdsSet",1),Gg([ve],Qg.prototype,"selectedShapes",1),Gg([ve],Qg.prototype,"onlySelectedShape",1),Gg([ve],Qg.prototype,"selectedPageBounds",1),Gg([ve],Qg.prototype,"selectionRotation",1),Gg([ve],Qg.prototype,"selectionBounds",1),Gg([ve],Qg.prototype,"selectionPageCenter",1),Gg([ve],Qg.prototype,"editingShape",1),Gg([ve],Qg.prototype,"hoveredId",1),Gg([ve],Qg.prototype,"hoveredShape",1),Gg([ve],Qg.prototype,"hintingIds",1),Gg([ve],Qg.prototype,"erasingIds",1),Gg([ve],Qg.prototype,"erasingIdsSet",1),Gg([ve],Qg.prototype,"cameraId",1),Gg([ve],Qg.prototype,"camera",1),Gg([ve],Qg.prototype,"zoomLevel",1),Gg([ve],Qg.prototype,"viewportScreenBounds",1),Gg([ve],Qg.prototype,"viewportScreenCenter",1),Gg([ve],Qg.prototype,"viewportPageBounds",1),Gg([ve],Qg.prototype,"viewportPageCenter",1),Gg([ve],Qg.prototype,"cameraState",1),Gg([ve],Qg.prototype,"renderingShapes",1),Gg([ve],Qg.prototype,"renderingBounds",1),Gg([ve],Qg.prototype,"renderingBoundsExpanded",1),Gg([ve],Qg.prototype,"_pages",1),Gg([ve],Qg.prototype,"pages",1),Gg([ve],Qg.prototype,"_assets",1),Gg([ve],Qg.prototype,"_boundsCache",1),Gg([ve],Qg.prototype,"_outlineCache",1),Gg([ve],Qg.prototype,"_outlineSegmentsCache",1),Gg([ve],Qg.prototype,"handlesCache",1),Gg([ve],Qg.prototype,"_pageTransformCache",1),Gg([ve],Qg.prototype,"_pageBoundsCache",1),Gg([ve],Qg.prototype,"_clipPathCache",1),Gg([ve],Qg.prototype,"_pageMaskCache",1),Gg([ve],Qg.prototype,"allShapesCommonBounds",1),Gg([ve],Qg.prototype,"shapesArray",1),Gg([ve],Qg.prototype,"sortedShapesArray",1),Gg([ve],Qg.prototype,"_stylesForNextShape",1),Gg([ve({isEqual:function(e,t){return e.equals(t)}})],Qg.prototype,"sharedStyles",1),Gg([ve],Qg.prototype,"sharedOpacity",1);var Jg="TLDRAW_TAB_ID_v2",em=globalThis.window;var tm=null!==(Yg=null!==(Xg=null===em||void 0===em?void 0:em[Jg])&&void 0!==Xg?Xg:null===em||void 0===em?void 0:em.sessionStorage[Jg])&&void 0!==Yg?Yg:"TLDRAW_INSTANCE_STATE_V1_"+of();em&&(em[Jg]=tm,em&&(["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(em.navigator.platform)||em.navigator.userAgent.includes("Mac")&&"ontouchend"in document)?em.sessionStorage[Jg]=tm:delete em.sessionStorage[Jg]),null===em||void 0===em||em.addEventListener("beforeunload",(function(){em.sessionStorage[Jg]=tm}));var nm=0,rm=nn({version:Wt,currentPageId:An,isFocusMode:Gt,exportBackground:Gt,isDebugMode:Gt,isToolLocked:Gt,isGridMode:Gt,pageStates:en(nn({pageId:An,camera:nn({x:Wt,y:Wt,z:Wt}),selectedIds:en(_r),focusLayerId:_r.nullable()}))}),im=yt({currentVersion:nm});function om(e,t){var n=function(e){if(!e||"object"!==typeof e)return console.warn("Invalid instance state"),null;if(!("version"in e)||"number"!==typeof e.version)return console.warn("No version in instance state"),null;var t=xt({value:e,fromVersion:e.version,toVersion:nm,migrations:im});if("error"===t.type)return console.warn(t.reason),null;var n=Ce(Ce({},t.value),{},{version:nm});try{rm.validate(n)}catch(ej){return console.warn(ej),null}return n}(t);if(n){var r=e.allRecords().filter((function(e){return"instance_page_state"===e.typeName||"camera"===e.typeName})),i={added:{},updated:{},removed:Ce({},qe(r.map((function(e){return[e.id,e]}))))};e.has(kr)&&(i.removed[kr]=e.get(kr));var o,a={removed:{},updated:{},added:z({},kr,e.schema.types.instance.create({id:kr,currentPageId:n.currentPageId,isDebugMode:n.isDebugMode,isFocusMode:n.isFocusMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,exportBackground:n.exportBackground}))},s=J(n.pageStates);try{for(s.s();!(o=s.n()).done;){var u=o.value,l=kn.createId(u.pageId),c=Lr.createId(u.pageId);a.added[l]=kn.create({id:kn.createId(u.pageId),x:u.camera.x,y:u.camera.y,z:u.camera.z}),a.added[c]=Lr.create({id:Lr.createId(u.pageId),pageId:u.pageId,selectedIds:u.selectedIds,focusLayerId:u.focusLayerId})}}catch(d){s.e(d)}finally{s.f()}ae((function(){e.applyDiff(ht([i,a])),e.ensureStoreIsUsable()}))}}function am(e){for(var t=[],n=0,r=Object.values(e);n<r.length;n++){var i,o=r[n];null!==(i=o.typeName)&&void 0!==i&&i.match(/^(instance.*|pointer|camera)$/)&&t.push(o)}var a=t.filter((function(e){return"instance"===e.typeName&&e.id!==kr}))[0];if(!a)return null;var s={version:nm,currentPageId:a.currentPageId,exportBackground:!!a.exportBackground,isFocusMode:!!a.isFocusMode,isDebugMode:!!a.isDebugMode,isToolLocked:!!a.isToolLocked,isGridMode:!1,pageStates:t.filter((function(e){return"instance_page_state"===e.typeName&&e.instanceId===a.id})).map((function(t){var n,r=null!==(n=e[t.cameraId])&&void 0!==n?n:{x:0,y:0,z:1};return{pageId:t.pageId,camera:{x:r.x,y:r.y,z:r.z},selectedIds:t.selectedIds,focusLayerId:t.focusLayerId}}))};try{return rm.validate(s),s}catch(ej){return null}}var sm,um,lm=function(e,t){return t.some((function(t){return e instanceof t}))};var cm=new WeakMap,dm=new WeakMap,fm=new WeakMap,pm=new WeakMap,hm=new WeakMap;var vm={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return dm.get(e);if("objectStoreNames"===t)return e.objectStoreNames||fm.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ym(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function gm(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(um||(um=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(bm(this),n),ym(cm.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ym(e.apply(bm(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=e.call.apply(e,[bm(this),t].concat(r));return fm.set(o,t.sort?t.sort():[t]),ym(o)}}function mm(e){return"function"===typeof e?gm(e):(e instanceof IDBTransaction&&function(e){if(!dm.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=function(){t(),r()},o=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));dm.set(e,t)}}(e),lm(e,sm||(sm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,vm):e)}function ym(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",o)},i=function(){t(ym(e.result)),r()},o=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return t.then((function(t){t instanceof IDBCursor&&cm.set(t,e)})).catch((function(){})),hm.set(t,e),t}(e);if(pm.has(e))return pm.get(e);var t=mm(e);return t!==e&&(pm.set(e,t),hm.set(t,e)),t}var bm=function(e){return hm.get(e)};function wm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,o=n.blocking,a=n.terminated,s=indexedDB.open(e,t),u=ym(s);return i&&s.addEventListener("upgradeneeded",(function(e){i(ym(s.result),e.oldVersion,e.newVersion,ym(s.transaction),e)})),r&&s.addEventListener("blocked",(function(e){return r(e.oldVersion,e.newVersion,e)})),u.then((function(e){a&&e.addEventListener("close",(function(){return a()})),o&&e.addEventListener("versionchange",(function(e){return o(e.oldVersion,e.newVersion,e)}))})).catch((function(){})),u}function xm(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).blocked,n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(function(e){return t(e.oldVersion,e)})),ym(n).then((function(){}))}var km=["get","getKey","getAll","getAllKeys","count"],Sm=["put","add","delete","clear"],_m=new Map;function Pm(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(_m.get(t))return _m.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=Sm.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||km.includes(n))){var o=function(){var e=Fa(Na().mark((function e(t){var o,a,s,u,l,c,d=arguments;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=this.transaction(t,i?"readwrite":"readonly"),s=a.store,u=d.length,l=new Array(u>1?u-1:0),c=1;c<u;c++)l[c-1]=d[c];return r&&(s=s.index(l.shift())),e.next=6,Promise.all([(o=s)[n].apply(o,l),i&&a.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return _m.set(t,o),o}}}vm=function(e){return Ce(Ce({},e),{},{get:function(t,n,r){return Pm(t,n)||e.get(t,n,r)},has:function(t,n){return!!Pm(t,n)||e.has(t,n)}})}(vm);var Em="TLDRAW_DOCUMENT_v2",Cm="TLDRAW_DB_NAME_INDEX_v2",Im={Records:"records",Schema:"schema",SessionState:"session_state"};function Tm(e,t){return Mm.apply(this,arguments)}function Mm(){return(Mm=Fa(Na().mark((function e(t,n){var r;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Fm(t),e.next=3,wm(t,3,{upgrade:function(e){e.objectStoreNames.contains(Im.Records)||e.createObjectStore(Im.Records),e.objectStoreNames.contains(Im.Schema)||e.createObjectStore(Im.Schema),e.objectStoreNames.contains(Im.SessionState)||e.createObjectStore(Im.SessionState)}});case 3:return r=e.sent,e.prev=4,e.next=7,n(r);case 7:return e.abrupt("return",e.sent);case 8:return e.prev=8,r.close(),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[4,,8,11]])})))).apply(this,arguments)}function jm(e){return Am.apply(this,arguments)}function Am(){return Am=Fa(Na().mark((function e(t){var n,r,i,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.persistenceKey,r=t.sessionId,i=t.didCancel,o=Em+n,Bm().includes(o)){e.next=4;break}return e.abrupt("return",void 0);case 4:return e.next=6,Rm({persistenceKey:n,didCancel:i});case 6:return e.next=8,Tm(o,function(){var e=Fa(Na().mark((function e(t){var n,o,a,s,u,l,c,d,f;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===i||void 0===i||!i()){e.next=2;break}return e.abrupt("return",void 0);case 2:if(o=t.transaction([Im.Records,Im.Schema,Im.SessionState],"readonly"),a=o.objectStore(Im.Records),s=o.objectStore(Im.Schema),u=o.objectStore(Im.SessionState),!r){e.next=21;break}return e.next=9,u.get(r);case 9:if(e.t2=n=e.sent,e.t1=null===e.t2,e.t1){e.next=13;break}e.t1=void 0===n;case 13:if(!e.t1){e.next=17;break}e.t3=void 0,e.next=18;break;case 17:e.t3=n.snapshot;case 18:e.t0=e.t3,e.next=22;break;case 21:e.t0=null;case 22:if(l=e.t0){e.next=28;break}return e.next=26,u.getAll();case 26:d=e.sent,l=null===(c=d.sort((function(e,t){return e.updatedAt-t.updatedAt})).pop())||void 0===c?void 0:c.snapshot;case 28:return e.next=30,a.getAll();case 30:return e.t4=e.sent,e.next=33,s.get(Im.Schema);case 33:if(e.t5=e.sent,e.t6=l,f={records:e.t4,schema:e.t5,sessionStateSnapshot:e.t6},null===i||void 0===i||!i()){e.next=39;break}return o.abort(),e.abrupt("return",void 0);case 39:return e.next=41,o.done;case 41:return e.abrupt("return",f);case 42:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)}))),Am.apply(this,arguments)}function Om(e){return Lm.apply(this,arguments)}function Lm(){return Lm=Fa(Na().mark((function e(t){var n,r,i,o,a,s,u;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.persistenceKey,r=t.schema,i=t.changes,o=t.sessionId,a=t.sessionStateSnapshot,s=t.didCancel,u=Em+n,e.next=4,Tm(u,function(){var e=Fa(Na().mark((function e(t){var n,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.transaction([Im.Records,Im.Schema,Im.SessionState],"readwrite"),u=n.objectStore(Im.Records),l=n.objectStore(Im.Schema),c=n.objectStore(Im.SessionState),d=0,f=Object.entries(i.added);case 5:if(!(d<f.length)){e.next=12;break}return p=G(f[d],2),h=p[0],v=p[1],e.next=9,u.put(v,h);case 9:d++,e.next=5;break;case 12:g=0,m=Object.values(i.updated);case 13:if(!(g<m.length)){e.next=20;break}return y=G(m[g],2),y[0],b=y[1],e.next=17,u.put(b,b.id);case 17:g++,e.next=13;break;case 20:w=0,x=Object.keys(i.removed);case 21:if(!(w<x.length)){e.next=28;break}return k=x[w],e.next=25,u.delete(k);case 25:w++,e.next=21;break;case 28:if(l.put(r.serialize(),Im.Schema),a&&o?c.put({snapshot:a,updatedAt:Date.now(),id:o},o):(a||o)&&console.error("sessionStateSnapshot and instanceId must be provided together"),null===s||void 0===s||!s()){e.next=32;break}return e.abrupt("return",n.abort());case 32:return e.next=34,n.done;case 34:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)}))),Lm.apply(this,arguments)}function zm(e){return Dm.apply(this,arguments)}function Dm(){return Dm=Fa(Na().mark((function e(t){var n,r,i,o,a,s,u;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.persistenceKey,r=t.schema,i=t.snapshot,o=t.sessionId,a=t.sessionStateSnapshot,s=t.didCancel,u=Em+n,e.next=4,Tm(u,function(){var e=Fa(Na().mark((function e(t){var n,u,l,c,d,f,p,h,v;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.transaction([Im.Records,Im.Schema,Im.SessionState],"readwrite"),u=n.objectStore(Im.Records),l=n.objectStore(Im.Schema),c=n.objectStore(Im.SessionState),e.next=6,u.clear();case 6:d=0,f=Object.entries(i);case 7:if(!(d<f.length)){e.next=14;break}return p=G(f[d],2),h=p[0],v=p[1],e.next=11,u.put(v,h);case 11:d++,e.next=7;break;case 14:if(l.put(r.serialize(),Im.Schema),a&&o?c.put({snapshot:a,updatedAt:Date.now(),id:o},o):(a||o)&&console.error("sessionStateSnapshot and instanceId must be provided together"),null===s||void 0===s||!s()){e.next=18;break}return e.abrupt("return",n.abort());case 18:return e.next=20,n.done;case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)}))),Dm.apply(this,arguments)}function Rm(e){return Nm.apply(this,arguments)}function Nm(){return Nm=Fa(Na().mark((function e(t){var n,r;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.persistenceKey,r=t.didCancel,e.next=3,Tm(Em+n,function(){var e=Fa(Na().mark((function e(t){var n,i,o,a,s,u,l;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.transaction([Im.SessionState],"readwrite"),i=n.objectStore(Im.SessionState),e.next=4,i.getAll();case 4:if(o=e.sent.sort((function(e,t){return e.updatedAt-t.updatedAt})),!(o.length<10)){e.next=9;break}return e.next=8,n.done;case 8:return e.abrupt("return");case 9:a=o.slice(0,o.length-10),s=J(a),e.prev=11,s.s();case 13:if((u=s.n()).done){e.next=19;break}return l=u.value.id,e.next=17,i.delete(l);case 17:e.next=13;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(11),s.e(e.t0);case 24:return e.prev=24,s.f(),e.finish(24);case 27:if(null===r||void 0===r||!r()){e.next=29;break}return e.abrupt("return",n.abort());case 29:return e.next=31,n.done;case 31:case"end":return e.stop()}}),e,null,[[11,21,24,27]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)}))),Nm.apply(this,arguments)}function Bm(){var e,t,n=null!==(e=JSON.parse((null===(t=window)||void 0===t?void 0:t.localStorage.getItem(Cm))||"[]"))&&void 0!==e?e:[];return Array.isArray(n)?n:[]}function Fm(e){var t,n=new Set(Bm());n.add(e),null===(t=window)||void 0===t||t.localStorage.setItem(Cm,JSON.stringify(u(n)))}var Um=Symbol("UPDATE_INSTANCE_STATE"),Km="undefined"===typeof BroadcastChannel?function(){function e(t){M(this,e),z(this,"onmessage",void 0)}return L(e,[{key:"postMessage",value:function(e){}},{key:"close",value:function(){}}]),e}():BroadcastChannel,Vm=function(){function e(t,n){var r=this,i=n.persistenceKey,o=n.sessionId,a=void 0===o?tm:o,s=n.onLoad,l=n.onLoadError,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Km("tldraw-tab-sync-".concat(i));M(this,e),z(this,"disposables",new Set),z(this,"diffQueue",[]),z(this,"didDispose",!1),z(this,"shouldDoFullDBWrite",!0),z(this,"isReloading",!1),z(this,"persistenceKey",void 0),z(this,"sessionId",void 0),z(this,"serializedSchema",void 0),z(this,"isDebugging",!1),z(this,"documentTypes",void 0),z(this,"$sessionStateSnapshot",void 0),z(this,"initTime",Date.now()),z(this,"isPersisting",!1),z(this,"didLastWriteError",!1),z(this,"scheduledPersistTimeout",null),this.store=t,this.channel=c,"undefined"!==typeof window&&(window.tlsync=this),this.persistenceKey=i,this.sessionId=a,this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=function(e){var t=e.query.ids("page");return ve("sessionStateSnapshot",(function(){var n=e.get(kr);if(!n)return null;var r=u(t.value);return{version:nm,currentPageId:n.currentPageId,exportBackground:n.exportBackground,isFocusMode:n.isFocusMode,isDebugMode:n.isDebugMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,pageStates:r.map((function(t){var n,r,i,o,a,s=e.get(Lr.createId(t)),u=e.get(kn.createId(t));return{pageId:t,camera:{x:null!==(n=null===u||void 0===u?void 0:u.x)&&void 0!==n?n:0,y:null!==(r=null===u||void 0===u?void 0:u.y)&&void 0!==r?r:0,z:null!==(i=null===u||void 0===u?void 0:u.z)&&void 0!==i?i:1},selectedIds:null!==(o=null===s||void 0===s?void 0:s.selectedIds)&&void 0!==o?o:[],focusLayerId:null!==(a=null===s||void 0===s?void 0:s.focusLayerId)&&void 0!==a?a:null}}))}}))}(this.store),this.disposables.add(t.listen((function(e){var t=e.changes;r.diffQueue.push(t),r.channel.postMessage({type:"diff",storeId:r.store.id,changes:t,schema:r.serializedSchema}),r.schedulePersist()}),{source:"user",scope:"document"})),this.disposables.add(t.listen((function(){r.diffQueue.push(Um),r.schedulePersist()}),{scope:"session"})),this.connect(s,l),this.documentTypes=new Set(Object.values(this.store.schema.types).filter((function(e){return"document"===e.scope})).map((function(e){return e.typeName})))}return L(e,[{key:"debug",value:function(){var e;this.isDebugging&&(e=console).debug.apply(e,arguments)}},{key:"connect",value:function(){var e=Fa(Na().mark((function e(t,n){var r,i,o,a,s,u,l=this;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.debug("connecting"),e.prev=1,e.next=4,jm({persistenceKey:this.persistenceKey,sessionId:this.sessionId,didCancel:function(){return l.didDispose}});case 4:r=e.sent,e.next=13;break;case 7:return e.prev=7,e.t0=e.catch(1),n(e.t0),window.alert("Oops! We could not access your browser's storage\u2014and the app won't work correctly without that. We now need to reload the page and try again.\n\nKeep seeing this message?\n\u2022 If you're using tldraw in a private or \"incognito\" window, try loading tldraw in a regular window or in a different browser."),"undefined"!==typeof window&&window.location.reload(),e.abrupt("return");case 13:if(this.debug("loaded data from store",r,"didDispose",this.didDispose),!this.didDispose){e.next=16;break}return e.abrupt("return");case 16:if(e.prev=16,!r){e.next=27;break}if(a=Object.fromEntries(r.records.map((function(e){return[e.id,e]}))),s=null!==(i=r.sessionStateSnapshot)&&void 0!==i?i:am(a),"error"!==(u=this.store.schema.migrateStoreSnapshot({store:a,schema:null!==(o=r.schema)&&void 0!==o?o:this.store.schema.serializeEarliestVersion()})).type){e.next=25;break}return console.error("failed to migrate store",u),n(new Error("Failed to migrate store: ".concat(u.reason))),e.abrupt("return");case 25:this.store.mergeRemoteChanges((function(){l.store.put(Object.values(u.value).filter((function(e){return l.documentTypes.has(e.typeName)})),"initialize")})),s&&om(this.store,s);case 27:this.channel.onmessage=function(e){var t,r=e.data;l.debug("got message",r);var i,o,a=r,s=St(l.serializedSchema,null!==(t=a.schema)&&void 0!==t?t:l.store.schema.serializeEarliestVersion());return-1===s?Date.now()-l.initTime<5e3?void n(new Error("Schema mismatch, please close other tabs and reload the page")):(l.debug("reloading"),l.isReloading=!0,void(null===(i=window)||void 0===i||null===(i=i.location)||void 0===i||null===(o=i.reload)||void 0===o||o.call(i))):1===s?(l.debug("telling them to reload"),l.channel.postMessage({type:"announce",schema:l.serializedSchema}),l.shouldDoFullDBWrite=!0,void l.persistIfNeeded()):void("diff"===a.type&&(l.debug("applying diff"),ae((function(){l.store.mergeRemoteChanges((function(){l.store.applyDiff(a.changes),l.store.ensureStoreIsUsable()}))}))))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add((function(){l.channel.close()})),t(this),e.next=40;break;case 33:if(e.prev=33,e.t1=e.catch(16),this.debug("error loading data from store",e.t1),!this.didDispose){e.next=38;break}return e.abrupt("return");case 38:return n(e.t1),e.abrupt("return");case 40:case"end":return e.stop()}}),e,this,[[1,7],[16,33]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach((function(e){return e()}))}},{key:"schedulePersist",value:function(){var e=this;this.debug("schedulePersist",this.scheduledPersistTimeout),this.scheduledPersistTimeout||(this.scheduledPersistTimeout=setTimeout((function(){e.scheduledPersistTimeout=null,e.persistIfNeeded()}),this.didLastWriteError?1e4:350))}},{key:"persistIfNeeded",value:function(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),this.isPersisting||this.isReloading||this.store.isPossiblyCorrupted()||(this.shouldDoFullDBWrite||this.diffQueue.length>0)&&this.doPersist()}},{key:"doPersist",value:function(){var e=Fa(Na().mark((function e(){var t,n,r=this;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Le(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start"),t=this.diffQueue,this.diffQueue=[],e.prev=5,!this.shouldDoFullDBWrite){e.next=12;break}return this.shouldDoFullDBWrite=!1,e.next=10,zm({persistenceKey:this.persistenceKey,schema:this.store.schema,snapshot:this.store.serialize(),didCancel:function(){return r.didDispose},sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value});case 10:e.next=15;break;case 12:return n=ht(t.filter((function(e){return e!==Um}))),e.next=15,Om({persistenceKey:this.persistenceKey,changes:n,schema:this.store.schema,didCancel:function(){return r.didDispose},sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value});case 15:this.didLastWriteError=!1,e.next=25;break;case 18:e.prev=18,e.t0=e.catch(5),this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",e.t0),window.alert("Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.\n\nKeep seeing this message?\n\u2022 If you're using tldraw in a private or \"incognito\" window, try loading tldraw in a regular window or in a different browser.\n\u2022 If your hard disk is full, try clearing up some space and then reload the page."),"undefined"!==typeof window&&window.location.reload();case 25:this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist();case 28:case"end":return e.stop()}}),e,this,[[5,18]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Wm=["initialData","defaultName"];function Hm(e){var t,n=e.initialData,r=e.defaultName,i=void 0===r?"":r,o=gt(e,Wm),a="schema"in o?o.schema:Qi({shapes:(t=cv(o.shapes),Object.fromEntries(t.map((function(e){return[e.type,e]}))))});return new pt({schema:a,initialData:n,props:{defaultName:i}})}function Ym(e){var n=G((0,t.useState)((function(){return Hm(e)})),2),r=n[0],i=n[1],o=function(e){var n=(0,t.useRef)(e);return(0,t.useEffect)((function(){n.current=e})),n.current}(e);if(Object.keys(o).some((function(t){return o[t]!==e[t]}))){var a=Hm(e);return i(a),a}return r}var Xm=["persistenceKey","sessionId"];var qm=function(e,n){var r=G((0,t.useState)(2),2),i=r[0],o=r[1];return(0,t.useEffect)((function(){var t=n.url,r=n.style,i=void 0===r?"normal":r,a=n.weight,s=void 0===a?"500":a,u=n.display,l=n.featureSettings,c=n.stretch,d=n.unicodeRange,f=n.variant,p=!1;o(2);var h={style:i,weight:s,display:u,featureSettings:l,stretch:c,unicodeRange:d,variant:f},v=new FontFace(e,"url(".concat(t,")"),h);return v.load().then((function(){p||(document.fonts.add(v),o(0))})).catch((function(e){p||(console.error(e),o(1))})),v.$$_url=t,v.$$_fontface="\n@font-face {\n\tfont-family: ".concat(v.family,";\n\tfont-stretch: ").concat(v.stretch,";\n\tfont-weight: ").concat(v.weight,";\n\tfont-style: ").concat(v.style,';\n\tsrc: url("').concat(t,'") format("woff2")\n}'),function(){document.fonts.delete(v),p=!0}}),[e,n]),i};var $m=!1;if("undefined"!==typeof window){var Gm=window.navigator.userAgent,Qm=!!Gm.match(/iPad/i)||!!Gm.match(/iPhone/i),Zm=!!Gm.match(/WebKit/i);$m=Qm&&Zm&&!Gm.match(/CriOS/i)}var Jm=["store","components"],ey=["store","user"],ty=[],ny=[],ry=(0,t.memo)((function(e){var n,r,i=e.store,o=e.components,a=gt(e,Jm),s=G(t.useState(null),2),u=s[0],l=s[1],c=(0,t.useMemo)((function(){return _f()}),[]),d=void 0===(null===o||void 0===o?void 0:o.ErrorFallback)?nf:null===o||void 0===o?void 0:o.ErrorFallback,f=Ce(Ce({},a),{},{shapes:null!==(n=a.shapes)&&void 0!==n?n:ty,tools:null!==(r=a.tools)&&void 0!==r?r:ny});return(0,za.jsx)("div",{ref:l,draggable:!1,className:"tl-container tl-theme__light",tabIndex:0,children:(0,za.jsx)(rl,{fallback:d,onError:function(e){return Ne(e,{tags:{origin:"react.tldraw-before-app"}})},children:u&&(0,za.jsx)(ku,{container:u,children:(0,za.jsx)(ll,{overrides:o,children:i?i instanceof pt?(0,za.jsx)(ay,Ce(Ce({},f),{},{store:i,user:c})):(0,za.jsx)(oy,Ce(Ce({},f),{},{store:i,user:c})):(0,za.jsx)(iy,Ce(Ce({},f),{},{store:i,user:c}))})})})})}));function iy(e){var n=e.defaultName,r=e.initialData,i=e.shapes,o=e.persistenceKey,a=e.sessionId,s=e.user,u=function(e){var n,r=e.persistenceKey,i=e.sessionId,o=gt(e,Xm),a=G((0,t.useState)(null),2),s=a[0],u=a[1],l=Ym(o);return(0,t.useEffect)((function(){var e=of();if(r){u({id:e,storeWithStatus:{status:"loading"}});var t=function(t){u((function(n){return(null===n||void 0===n?void 0:n.id)===e?{id:e,storeWithStatus:t}:n}))},n=new Vm(l,{sessionId:i,persistenceKey:r,onLoad:function(){t({store:l,status:"synced-local"})},onLoadError:function(e){t({status:"error",error:e})}});return function(){u((function(t){return(null===t||void 0===t?void 0:t.id)===e?null:t})),n.close()}}u({id:e,storeWithStatus:{status:"not-synced",store:l}})}),[r,l,i]),null!==(n=null===s||void 0===s?void 0:s.storeWithStatus)&&void 0!==n?n:{status:"loading"}}({shapes:i,initialData:r,persistenceKey:o,sessionId:a,defaultName:n});return(0,za.jsx)(oy,Ce(Ce({},e),{},{store:u,user:s}))}var oy=(0,t.memo)((function(e){var n=e.store,r=e.user,i=gt(e,ey),o=Su();switch((0,t.useLayoutEffect)((function(){r.userPreferences.value.isDarkMode&&(o.classList.remove("tl-theme__light"),o.classList.add("tl-theme__dark"))}),[o,r.userPreferences.value.isDarkMode]),n.status){case"error":throw n.error;case"loading":return(0,za.jsx)(ly,{children:"Connecting..."})}return(0,za.jsx)(ay,Ce(Ce({},i),{},{store:n.store,user:r}))}));function ay(e){var n=e.onMount,r=e.children,i=e.store,o=e.tools,a=e.shapes,s=e.autoFocus,u=e.user,l=e.assetUrls,c=cl().ErrorFallback,d=Su(),f=G((0,t.useState)(null),2),p=f[0],h=f[1];(0,t.useLayoutEffect)((function(){var e=new Qg({store:i,shapes:a,tools:o,getContainer:function(){return d},user:u});return window.app=e,window.editor=e,h(e),function(){e.dispose()}}),[d,a,o,i,u]),t.useLayoutEffect((function(){p&&s&&p.focus()}),[p,s]);var v=function(e){var n=(0,t.useRef)();return(0,t.useLayoutEffect)((function(){n.current=e})),(0,t.useDebugValue)(e),(0,t.useCallback)((function(){var e=n.current;return Le(e,"fn does not exist"),e.apply(void 0,arguments)}),[])}((function(e){var t=null===n||void 0===n?void 0:n(e);return e.emit("mount"),window.tldrawReady=!0,t}));t.useLayoutEffect((function(){if(p)return null===v||void 0===v?void 0:v(p)}),[p,v]);var g,m=(0,t.useSyncExternalStore)((0,t.useCallback)((function(e){return p?(p.on("crash",e),function(){return p.off("crash",e)}):function(){}}),[p]),(function(){var e;return null!==(e=null===p||void 0===p?void 0:p.crashingError)&&void 0!==e?e:null})),y=function(e){var n=(0,t.useMemo)((function(){return function(e){return{draw:{url:e.fonts.draw},serif:{url:e.fonts.serif},sansSerif:{url:e.fonts.sansSerif},monospace:{url:e.fonts.monospace}}}(e)}),[e]),r=[qm("tldraw_draw",n.draw),qm("tldraw_serif",n.serif),qm("tldraw_sans",n.sansSerif),qm("tldraw_mono",n.monospace)];return{error:r.some((function(e){return 1===e})),done:!r.some((function(e){return 2===e}))}}((g=l,(0,t.useMemo)((function(){return g?{fonts:Object.assign(Ce({},Ra.fonts),Ce({},null===g||void 0===g?void 0:g.fonts))}:Ra}),[g]))),b=y.done;return y.error?(0,za.jsx)(cy,{children:"Could not load assets. Please refresh the page."}):b?p?(0,za.jsx)(rl,{fallback:c,onError:function(e){return p.annotateError(e,{origin:"react.tldraw",willCrashApp:!0})},children:m?(0,za.jsx)(uy,{crashingError:m}):(0,za.jsx)(Ka.Provider,{value:p,children:(0,za.jsx)(sy,{children:r})})}):null:(0,za.jsx)(ly,{children:"Loading assets..."})}function sy(e){var n=e.children;return function(){var e=Va(),n=Su();t.useEffect((function(){var t=function(e){return n.style.setProperty("--tl-zoom",e.toString())},r=De(t,100),i=new ge("useZoomCss",(function(){e.currentPageShapeIds.size<300?t(e.zoomLevel):r(e.zoomLevel)}));return i.attach(),i.execute(),function(){i.detach()}}),[e,n])}(),function(){var e=Va(),t=Su();Se("useCursor",(function(){var n=e.cursor,r=n.type,i=n.rotation,o=n.color;_d.includes(r)?t.style.setProperty("--tl-cursor","var(--tl-cursor-".concat(r,")")):t.style.setProperty("--tl-cursor",Sd(r,i,o))}),[e,t])}(),function(){var e=Va(),n=Su(),r=_e("isDarkMode",(function(){return e.isDarkMode}),[e]),i=_e(tu.forceSrgb);t.useEffect((function(){r?(n.setAttribute("data-color-mode","dark"),n.classList.remove("tl-theme__light"),n.classList.add("tl-theme__dark"),e.setCursor({color:"white"})):(n.setAttribute("data-color-mode","light"),n.classList.remove("tl-theme__dark"),n.classList.add("tl-theme__light"),e.setCursor({color:"black"})),i?n.classList.add("tl-theme__force-sRGB"):n.classList.remove("tl-theme__force-sRGB")}),[e,n,i,r])}(),function(){var e=Va();t.useEffect((function(){if($m)return document.addEventListener("focusout",t),function(){return document.removeEventListener("focusout",t)};function t(t){(t.target instanceof HTMLInputElement&&"text"===t.target.type||t.target instanceof HTMLTextAreaElement)&&e.complete()}}),[e])}(),function(){var e=G((0,t.useState)(0),2),n=(e[0],e[1]);(0,t.useEffect)((function(){return n((function(e){return e+1}))}),[])}(),n}function uy(e){throw e.crashingError}function ly(e){var t=e.children,n=cl().Spinner;return(0,za.jsxs)("div",{className:"tl-loading",children:[n?(0,za.jsx)(n,{}):null,t]})}function cy(e){var t=e.children;return(0,za.jsx)("div",{className:"tl-loading",children:t})}var dy=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),z(_t(e),"scribble",{}),z(_t(e),"markId",""),z(_t(e),"excludedShapeIds",new Set),z(_t(e),"onEnter",(function(t){e.markId=e.editor.mark("erase scribble begin"),e.info=t;var n=e.editor.inputs.originPagePoint;e.excludedShapeIds=new Set(e.editor.shapesArray.filter((function(t){return e.editor.isShapeOrAncestorLocked(t)||(e.editor.isShapeOfType(t,Hp)||e.editor.isShapeOfType(t,qp))&&e.editor.isPointInShape(n,t)})).map((function(e){return e.id}))),e.startScribble(),e.update()})),z(_t(e),"startScribble",(function(){var t;e.scribble.tick&&e.editor.off("tick",null===(t=e.scribble)||void 0===t?void 0:t.tick);e.scribble=new zg({onUpdate:e.onScribbleUpdate,onComplete:e.onScribbleComplete,color:"muted-1",size:12}),e.editor.on("tick",e.scribble.tick)})),z(_t(e),"pushPointToScribble",(function(){var t=e.editor.inputs.currentPagePoint,n=t.x,r=t.y;e.scribble.addPoint(n,r)})),z(_t(e),"onScribbleUpdate",(function(t){e.editor.setScribble(t)})),z(_t(e),"onScribbleComplete",(function(){e.editor.off("tick",e.scribble.tick),e.editor.setScribble(null)})),z(_t(e),"onExit",(function(){e.scribble.stop()})),z(_t(e),"onPointerMove",(function(){e.update()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.complete()})),e}return L(n,[{key:"update",value:function(){var e=this.editor,t=e.shapesArray,n=e.erasingIdsSet,r=e.inputs,i=r.currentPagePoint,o=r.previousPagePoint,a=this.excludedShapeIds;this.pushPointToScribble();var s,l=new Set(n),c=J(t);try{for(c.s();!(s=c.n()).done;){var d=s.value;if(!this.editor.isShapeOfType(d,Hp)){var f=this.editor.getPageMaskById(d.id);if(!f||ms(i,f)){var p=this.editor.getShapeUtil(d),h=this.editor.getPointInShapeSpace(d,o),v=this.editor.getPointInShapeSpace(d,i);p.hitTestLineSegment(d,h,v)&&l.add(this.editor.getOutermostSelectableShape(d).id)}}}}catch(g){c.e(g)}finally{c.f()}this.editor.setErasingIds(u(l).filter((function(e){return!a.has(e)})))}},{key:"complete",value:function(){this.editor.deleteShapes(this.editor.pageState.erasingIds),this.editor.setErasingIds([]),this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.editor.setErasingIds([]),this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}}]),n}(If);z(dy,"id","erasing");var fy=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("pointing",t)})),e}return L(n)}(If);z(fy,"id","idle");var py=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){var t,n=e.editor.inputs,r=new Set,i=r.size,o=J(u(e.editor.sortedShapesArray).reverse());try{for(o.s();!(t=o.n()).done;){var a=t.value;if(e.editor.isPointInShape(n.currentPagePoint,a)){if(e.editor.isShapeOfType(a,Hp))continue;var s=e.editor.getOutermostSelectableShape(a);if(e.editor.isShapeOfType(s,qp)&&r.size>i)break;r.add(s.id)}}}catch(l){o.e(l)}finally{o.f()}e.editor.setErasingIds(u(r))})),z(_t(e),"onPointerMove",(function(t){e.editor.inputs.isDragging&&e.parent.transition("erasing",t)})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onInterrupt",(function(){e.cancel()})),e}return L(n,[{key:"complete",value:function(){var e=this.editor.erasingIds;e.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(e)),this.editor.setErasingIds([]),this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.editor.setErasingIds([]),this.parent.transition("idle",{})}}]),n}(If);z(py,"id","pointing");var hy=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),e}return L(n)}(If);z(hy,"id","eraser"),z(hy,"initial","idle"),z(hy,"children",(function(){return[fy,py,dy]}));var vy=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.update()})),z(_t(e),"onPointerMove",(function(){e.update()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.complete()})),z(_t(e),"onComplete",(function(){e.complete()})),e}return L(n,[{key:"update",value:function(){var e=this.editor.inputs,t=e.currentScreenPoint,n=e.previousScreenPoint,r=Xa.Sub(t,n);(Math.abs(r.x)>0||Math.abs(r.y)>0)&&this.editor.pan(r.x,r.y)}},{key:"complete",value:function(){this.editor.slideCamera({speed:Math.min(2,this.editor.inputs.pointerVelocity.len()),direction:this.editor.inputs.pointerVelocity,friction:Bu}),this.parent.transition("idle",{})}}]),n}(If);z(vy,"id","dragging");var gy=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.editor.setCursor({type:"grab"})})),z(_t(e),"onPointerDown",(function(t){e.parent.transition("pointing",t)})),z(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return L(n)}(If);z(gy,"id","idle");var my=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.editor.stopCameraAnimation(),e.editor.setCursor({type:"grabbing"})})),z(_t(e),"onPointerMove",(function(t){e.editor.inputs.isDragging&&e.parent.transition("dragging",t)})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"onCancel",(function(){e.complete()})),z(_t(e),"onComplete",(function(){e.complete()})),z(_t(e),"onInterrupt",(function(){e.complete()})),e}return L(n,[{key:"complete",value:function(){this.parent.transition("idle",{})}}]),n}(If);z(my,"id","pointing");var yy=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onDoubleClick",(function(t){if("settle"===t.phase){var n=e.editor.inputs.currentScreenPoint;e.editor.zoomIn(n,{duration:220,easing:Ya.easeOutQuint})}})),z(_t(e),"onTripleClick",(function(t){if("settle"===t.phase){var n=e.editor.inputs.currentScreenPoint;e.editor.zoomOut(n,{duration:320,easing:Ya.easeOutQuint})}})),z(_t(e),"onQuadrupleClick",(function(t){if("settle"===t.phase){var n=e.editor,r=n.zoomLevel,i=n.inputs.currentScreenPoint;1===r?e.editor.zoomToFit({duration:400,easing:Ya.easeOutQuint}):e.editor.resetZoom(i,{duration:320,easing:Ya.easeOutQuint})}})),e}return L(n)}(If);z(yy,"id","hand"),z(yy,"initial","idle"),z(yy,"children",(function(){return[gy,my,vy]}));var by=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("lasering",t)})),e}return L(n)}(If);z(by,"id","idle");var wy=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"scribble",{}),z(_t(e),"onEnter",(function(){e.startScribble(),e.pushPointToScribble()})),z(_t(e),"onExit",(function(){e.editor.setErasingIds([]),e.scribble.stop()})),z(_t(e),"onPointerMove",(function(){e.pushPointToScribble()})),z(_t(e),"onPointerUp",(function(){e.complete()})),z(_t(e),"startScribble",(function(){var t;e.scribble.tick&&e.editor.off("tick",null===(t=e.scribble)||void 0===t?void 0:t.tick);e.scribble=new zg({onUpdate:e.onScribbleUpdate,onComplete:e.onScribbleComplete,color:"laser",opacity:.7,size:4,delay:1200}),e.editor.on("tick",e.scribble.tick)})),z(_t(e),"pushPointToScribble",(function(){var t=e.editor.inputs.currentPagePoint,n=t.x,r=t.y;e.scribble.addPoint(n,r)})),z(_t(e),"onScribbleUpdate",(function(t){e.editor.setScribble(t)})),z(_t(e),"onScribbleComplete",(function(){e.editor.off("tick",e.scribble.tick),e.editor.setScribble(null)})),z(_t(e),"onCancel",(function(){e.cancel()})),z(_t(e),"onComplete",(function(){e.complete()})),e}return L(n,[{key:"complete",value:function(){this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.parent.transition("idle",{})}}]),n}(If);z(wy,"id","lasering");var xy=function(e){Et(n,e);var t=Tt(n);function n(){var e;M(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return z(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),e}return L(n)}(If);z(xy,"id","laser"),z(xy,"initial","idle"),z(xy,"children",(function(){return[by,wy]}));var ky=[yy,hy,xy];function Sy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sy(Object(n),!0).forEach((function(t){Py(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Py(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ey(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Cy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Ty(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Iy(e){return function(e){if(Array.isArray(e))return My(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ty(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ty(e,t){if(e){if("string"===typeof e)return My(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?My(e,t):void 0}}function My(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jy(e){var t,n,r=e.sizes.shift(),i=Math.max(Math.ceil(r[0]),1),o=Math.max(Math.ceil(r[1]),1),a=[i-1,o-1,1,1],s=Date.now(),u="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;u?(t=new OffscreenCanvas(1,1),n=new OffscreenCanvas(i,o)):((t=document.createElement("canvas")).width=1,t.height=1,(n=document.createElement("canvas")).width=i,n.height=o);var l=t.getContext("2d"),c=n.getContext("2d");c&&(c.fillRect.apply(c,a),l.drawImage(n,i-1,o-1,1,1,0,0,1,1));var d=l&&0!==l.getImageData(0,0,1,1).data[3],f=Date.now()-s;return[t,n].forEach((function(e){e.height=0,e.width=0})),u?(postMessage({width:i,height:o,benchmark:f,isTestPass:d}),!d&&e.sizes.length&&jy(e)):d?e.onSuccess(i,o,f):(e.onError(i,o,f),e.sizes.length&&jy(e)),d}var Ay=[16384,14188,11402,11180,10836,8192,4096,1],Oy=[8388607,65535,32767,16384,8192,4096,1],Ly=[4194303,65535,32767,16384,8192,4096,1],zy=["onError","onSuccess"],Dy={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},Ry={};function Ny(e){var t=e.width===e.height,n=1===e.height,r=1===e.width,i=[];if(e.width&&e.height)for(var o=e.min||Dy.min,a=e.step||Dy.step,s=Math.max(e.width,e.height);s>=o;){var u=t||n?s:1,l=t||r?s:1;i.push([u,l]),s-=a}else e.sizes.forEach((function(e){var o=t||n?e:1,a=t||r?e:1;i.push([o,a])}));return i}function By(e){var t=window&&"HTMLCanvasElement"in window,n=window&&"OffscreenCanvas"in window,r=Date.now(),i=e.onError,o=e.onSuccess,a=Ey(e,zy),s=null;if(!t)return!1;if(e.useWorker&&n){var u="\n            var canvasTest = ".concat(jy.toString(),";\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),l=new Blob([u],{type:"application/javascript"}),c=URL.createObjectURL(l);s=new Worker(c),URL.revokeObjectURL(c),s.onmessage=function(e){var t=e.data,n=t.width,i=t.height,o=t.benchmark;t.isTestPass?(Ry[r].onSuccess(n,i,o),delete Ry[r]):Ry[r].onError(n,i,o)}}return e.usePromise?new Promise((function(t,n){var u=_y(_y({},e),{},{onError:function(t,r,o){var a;if(0===e.sizes.length)a=!0;else{var s=Cy(e.sizes.slice(-1),1),u=Cy(s[0],2),l=u[0],c=u[1];a=t===l&&r===c}i(t,r,o),a&&n({width:t,height:r,benchmark:o})},onSuccess:function(e,n,r){o(e,n,r),t({width:e,height:n,benchmark:r})}});if(s){var l=u.onError,c=u.onSuccess;Ry[r]={onError:l,onSuccess:c},s.postMessage(a)}else jy(u)})):s?(Ry[r]={onError:i,onSuccess:o},void s.postMessage(a)):jy(e)}var Fy={maxArea:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Ny({width:e.max,height:e.max,min:e.min,step:e.step,sizes:Iy(Ay)});return By(_y(_y(_y({},Dy),e),{},{sizes:t}))},maxHeight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Ny({width:1,height:e.max,min:e.min,step:e.step,sizes:Iy(Oy)});return By(_y(_y(_y({},Dy),e),{},{sizes:t}))},maxWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Ny({width:e.max,height:1,min:e.min,step:e.step,sizes:Iy(Ly)});return By(_y(_y(_y({},Dy),e),{},{sizes:t}))},test:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=_y(_y({},Dy),e);return t.sizes=Iy(t.sizes),t.width&&t.height&&(t.sizes=[[t.width,t.height]]),By(t)}},Uy=null;function Ky(){return Uy||(Uy=function(){return Vy.apply(this,arguments)}()),Uy}function Vy(){return(Vy=Fa(Na().mark((function e(){var t,n,r;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fy.maxWidth({usePromise:!0});case 2:return t=e.sent,e.next=5,Fy.maxHeight({usePromise:!0});case 5:return n=e.sent,e.next=8,Fy.maxArea({usePromise:!0});case 8:return r=e.sent,e.abrupt("return",{maxWidth:t.width,maxHeight:n.height,maxArea:r.width*r.height});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wy(e){var t=e.cloneNode(!0);return e.setAttribute("width",+e.getAttribute("width")+""),e.setAttribute("height",+e.getAttribute("height")+""),(new XMLSerializer).serializeToString(t).replaceAll("&#10;      ","").replaceAll(/((\s|")[0-9]*\.[0-9]{2})([0-9]*)(\b|"|\))/g,"$1")}function Hy(e,t){return Yy.apply(this,arguments)}function Yy(){return Yy=Fa(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f,p,h,v,g;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.type,i=n.quality,o=n.scale,a=+t.getAttribute("width"),s=+t.getAttribute("height"),u=a*o,l=s*o,e.next=7,Xy(t);case 7:return c=e.sent,e.next=10,Ky();case 10:return d=e.sent,a>d.maxWidth&&(u=d.maxWidth,l=u/a*s),s>d.maxHeight&&(l=d.maxHeight,u=l/s*a),u*l>d.maxArea&&(f=Math.sqrt(d.maxArea/(u*l)),u*=f,l*=f),u=Math.floor(u),l=Math.floor(l),p=u/a,e.next=19,new Promise((function(e){var t=new Image;t.crossOrigin="anonymous",t.onload=Fa(Na().mark((function n(){var r,i;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise((function(e){return setTimeout(e,250)}));case 2:r=document.createElement("canvas"),i=r.getContext("2d"),r.width=u,r.height=l,i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.drawImage(t,0,0,u,l),URL.revokeObjectURL(c),e(r);case 11:case"end":return n.stop()}}),n)}))),t.onerror=function(){e(null)},t.src=c}));case 19:if(h=e.sent){e.next=22;break}return e.abrupt("return",null);case 22:return e.next=24,new Promise((function(e){return h.toBlob((function(t){t&&!tu.throwToBlob.value||e(null),e(t)}),"image/"+r,i)}));case 24:if(v=e.sent){e.next=27;break}return e.abrupt("return",null);case 27:return e.t0=DataView,e.next=30,v.arrayBuffer();case 30:return e.t1=e.sent,g=new e.t0(e.t1),e.abrupt("return",Sv(g,p,{type:"image/"+r}));case 33:case"end":return e.stop()}}),e)}))),Yy.apply(this,arguments)}function Xy(e){return qy.apply(this,arguments)}function qy(){return(qy=Fa(Na().mark((function e(t){var n,r,i,o,a,s;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t.cloneNode(!0)).setAttribute("encoding",'UTF-8"'),r=new FileReader,i=Array.from(n.querySelectorAll("image")),o=Na().mark((function e(){var t,n,i,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s[a],!(n=t.getAttribute("xlink:href"))){e.next=13;break}if(n.startsWith("data:")){e.next=13;break}return e.next=6,fetch(n);case 6:return e.next=8,e.sent.blob();case 8:return i=e.sent,e.next=11,new Promise((function(e,t){r.onload=function(){return e(r.result)},r.onerror=function(){return t(r.error)},r.readAsDataURL(i)}));case 11:o=e.sent,t.setAttribute("xlink:href",o);case 13:case"end":return e.stop()}}),e)})),a=0,s=i;case 6:if(!(a<s.length)){e.next=11;break}return e.delegateYield(o(),"t0",8);case 8:a++,e.next=6;break;case 11:return e.abrupt("return",$y(n));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $y(e){var t=(new XMLSerializer).serializeToString(e),n=window.btoa(unescape(encodeURIComponent(t)));return"data:image/svg+xml;base64,".concat(n)}function Gy(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()}function Qy(){return Qy=Fa(Na().mark((function e(){var t,n,r=arguments;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r.length>0&&void 0!==r[0]?r[0]:{}).shouldReload,n=void 0===t||t,sessionStorage.clear(),e.next=4,Promise.all(Bm().map((function(e){return xm(e)})));case 4:localStorage.clear(),n&&window.location.reload();case 6:case"end":return e.stop()}}),e)}))),Qy.apply(this,arguments)}function Zy(){return Zy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zy.apply(this,arguments)}function Jy(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).checkForDefaultPrevented,r=void 0===n||n;return function(n){if(null===e||void 0===e||e(n),!1===r||!n.defaultPrevented)return null===t||void 0===t?void 0:t(n)}}function eb(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.forEach((function(t){return function(e,t){"function"===typeof e?e(t):null!==e&&void 0!==e&&(e.current=t)}(t,e)}))}}function tb(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0,t.useCallback)(eb.apply(void 0,n),n)}"undefined"!==typeof window&&(window.__tldraw__hardReset=function(){return Qy.apply(this,arguments)});var nb=["children"],rb=["scope","children"];function ib(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];var i=function(){var n=r.map((function(e){return(0,t.createContext)(e)}));return function(r){var i=(null===r||void 0===r?void 0:r[e])||n;return(0,t.useMemo)((function(){return z({},"__scope".concat(e),Ce(Ce({},r),{},z({},e,i)))}),[r,i])}};return i.scopeName=e,[function(n,i){var o=(0,t.createContext)(i),a=r.length;function s(n){var r=n.scope,i=n.children,s=gt(n,rb),u=(null===r||void 0===r?void 0:r[e][a])||o,l=(0,t.useMemo)((function(){return s}),Object.values(s));return(0,t.createElement)(u.Provider,{value:l},i)}return r=[].concat(u(r),[i]),s.displayName=n+"Provider",[s,function(r,s){var u=(null===s||void 0===s?void 0:s[e][a])||o,l=(0,t.useContext)(u);if(l)return l;if(void 0!==i)return i;throw new Error("`".concat(r,"` must be used within `").concat(n,"`"))}]},ob.apply(void 0,[i].concat(u(n)))]}function ob(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0];if(1===n.length)return i;var o=function(){var e=n.map((function(e){return{useScope:e(),scopeName:e.scopeName}}));return function(n){var r=e.reduce((function(e,t){var r=t.useScope,i=t.scopeName,o=r(n)["__scope".concat(i)];return Ce(Ce({},e),o)}),{});return(0,t.useMemo)((function(){return z({},"__scope".concat(i.scopeName),r)}),[r])}};return o.scopeName=i.scopeName,o}var ab=Boolean(null===globalThis||void 0===globalThis?void 0:globalThis.document)?t.useLayoutEffect:function(){},sb=r["useId".toString()]||function(){},ub=0;function lb(e){var n=G(t.useState(sb()),2),r=n[0],i=n[1];return ab((function(){e||i((function(e){return null!==e&&void 0!==e?e:String(ub++)}))}),[e]),e||(r?"radix-".concat(r):"")}function cb(e){var n=(0,t.useRef)(e);return(0,t.useEffect)((function(){n.current=e})),(0,t.useMemo)((function(){return function(){for(var e,t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return null===(t=n.current)||void 0===t?void 0:(e=t).call.apply(e,[n].concat(i))}}),[])}function db(e){var n=e.prop,r=e.defaultProp,i=e.onChange,o=void 0===i?function(){}:i,a=function(e){var n=e.defaultProp,r=e.onChange,i=(0,t.useState)(n),o=G(i,1)[0],a=(0,t.useRef)(o),s=cb(r);return(0,t.useEffect)((function(){a.current!==o&&(s(o),a.current=o)}),[o,a,s]),i}({defaultProp:r,onChange:o}),s=G(a,2),u=s[0],l=s[1],c=void 0!==n,d=c?n:u,f=cb(o);return[d,(0,t.useCallback)((function(e){if(c){var t="function"===typeof e?e(n):e;t!==n&&f(t)}else l(e)}),[c,n,l,f])]}var fb=n(4164),pb=["children"],hb=["children"],vb=(0,t.forwardRef)((function(e,n){var r=e.children,i=gt(e,pb),o=t.Children.toArray(r),a=o.find(yb);if(a){var s=a.props.children,u=o.map((function(e){return e===a?t.Children.count(s)>1?t.Children.only(null):(0,t.isValidElement)(s)?s.props.children:null:e}));return(0,t.createElement)(gb,Zy({},i,{ref:n}),(0,t.isValidElement)(s)?(0,t.cloneElement)(s,void 0,u):null)}return(0,t.createElement)(gb,Zy({},i,{ref:n}),r)}));vb.displayName="Slot";var gb=(0,t.forwardRef)((function(e,n){var r=e.children,i=gt(e,hb);return(0,t.isValidElement)(r)?(0,t.cloneElement)(r,Ce(Ce({},function(e,t){var n=Ce({},t),r=function(){var r=e[i],o=t[i];/^on[A-Z]/.test(i)?r&&o?n[i]=function(){o.apply(void 0,arguments),r.apply(void 0,arguments)}:r&&(n[i]=r):"style"===i?n[i]=Ce(Ce({},r),o):"className"===i&&(n[i]=[r,o].filter(Boolean).join(" "))};for(var i in t)r();return Ce(Ce({},e),n)}(i,r.props)),{},{ref:n?eb(n,r.ref):r.ref})):t.Children.count(r)>1?t.Children.only(null):null}));gb.displayName="SlotClone";var mb=function(e){var n=e.children;return(0,t.createElement)(t.Fragment,null,n)};function yb(e){return(0,t.isValidElement)(e)&&e.type===mb}var bb=["asChild"],wb=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((function(e,n){var r=(0,t.forwardRef)((function(e,r){var i=e.asChild,o=gt(e,bb),a=i?vb:n;return(0,t.useEffect)((function(){window[Symbol.for("radix-ui")]=!0}),[]),(0,t.createElement)(a,Zy({},o,{ref:r}))}));return r.displayName="Primitive.".concat(n),Ce(Ce({},e),{},z({},n,r))}),{});function xb(e,t){e&&(0,fb.flushSync)((function(){return e.dispatchEvent(t)}))}var kb,Sb=["disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss"],_b="dismissableLayer.update",Pb="dismissableLayer.pointerDownOutside",Eb="dismissableLayer.focusOutside",Cb=(0,t.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ib=(0,t.forwardRef)((function(e,n){var r,i=e.disableOutsidePointerEvents,o=void 0!==i&&i,a=e.onEscapeKeyDown,s=e.onPointerDownOutside,l=e.onFocusOutside,c=e.onInteractOutside,d=e.onDismiss,f=gt(e,Sb),p=(0,t.useContext)(Cb),h=G((0,t.useState)(null),2),v=h[0],g=h[1],m=null!==(r=null===v||void 0===v?void 0:v.ownerDocument)&&void 0!==r?r:null===globalThis||void 0===globalThis?void 0:globalThis.document,y=G((0,t.useState)({}),2)[1],b=tb(n,(function(e){return g(e)})),w=Array.from(p.layers),x=G(u(p.layersWithOutsidePointerEventsDisabled).slice(-1),1)[0],k=w.indexOf(x),S=v?w.indexOf(v):-1,_=p.layersWithOutsidePointerEventsDisabled.size>0,P=S>=k,E=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,r=cb(e),i=(0,t.useRef)(!1),o=(0,t.useRef)((function(){}));return(0,t.useEffect)((function(){var e=function(e){if(e.target&&!i.current){var t=function(){jb(Pb,r,a,{discrete:!0})},a={originalEvent:e};"touch"===e.pointerType?(n.removeEventListener("click",o.current),o.current=t,n.addEventListener("click",o.current,{once:!0})):t()}else n.removeEventListener("click",o.current);i.current=!1},t=window.setTimeout((function(){n.addEventListener("pointerdown",e)}),0);return function(){window.clearTimeout(t),n.removeEventListener("pointerdown",e),n.removeEventListener("click",o.current)}}),[n,r]),{onPointerDownCapture:function(){return i.current=!0}}}((function(e){var t=e.target,n=u(p.branches).some((function(e){return e.contains(t)}));P&&!n&&(null===s||void 0===s||s(e),null===c||void 0===c||c(e),e.defaultPrevented||null===d||void 0===d||d())}),m),C=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,r=cb(e),i=(0,t.useRef)(!1);return(0,t.useEffect)((function(){var e=function(e){e.target&&!i.current&&jb(Eb,r,{originalEvent:e},{discrete:!1})};return n.addEventListener("focusin",e),function(){return n.removeEventListener("focusin",e)}}),[n,r]),{onFocusCapture:function(){return i.current=!0},onBlurCapture:function(){return i.current=!1}}}((function(e){var t=e.target;u(p.branches).some((function(e){return e.contains(t)}))||(null===l||void 0===l||l(e),null===c||void 0===c||c(e),e.defaultPrevented||null===d||void 0===d||d())}),m);return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,r=cb(e);(0,t.useEffect)((function(){var e=function(e){"Escape"===e.key&&r(e)};return n.addEventListener("keydown",e),function(){return n.removeEventListener("keydown",e)}}),[r,n])}((function(e){S===p.layers.size-1&&(null===a||void 0===a||a(e),!e.defaultPrevented&&d&&(e.preventDefault(),d()))}),m),(0,t.useEffect)((function(){if(v)return o&&(0===p.layersWithOutsidePointerEventsDisabled.size&&(kb=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(v)),p.layers.add(v),Mb(),function(){o&&1===p.layersWithOutsidePointerEventsDisabled.size&&(m.body.style.pointerEvents=kb)}}),[v,m,o,p]),(0,t.useEffect)((function(){return function(){v&&(p.layers.delete(v),p.layersWithOutsidePointerEventsDisabled.delete(v),Mb())}}),[v,p]),(0,t.useEffect)((function(){var e=function(){return y({})};return document.addEventListener(_b,e),function(){return document.removeEventListener(_b,e)}}),[]),(0,t.createElement)(wb.div,Zy({},f,{ref:b,style:Ce({pointerEvents:_?P?"auto":"none":void 0},e.style),onFocusCapture:Jy(e.onFocusCapture,C.onFocusCapture),onBlurCapture:Jy(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Jy(e.onPointerDownCapture,E.onPointerDownCapture)}))})),Tb=(0,t.forwardRef)((function(e,n){var r=(0,t.useContext)(Cb),i=(0,t.useRef)(null),o=tb(n,i);return(0,t.useEffect)((function(){var e=i.current;if(e)return r.branches.add(e),function(){r.branches.delete(e)}}),[r.branches]),(0,t.createElement)(wb.div,Zy({},e,{ref:o}))}));function Mb(){var e=new CustomEvent(_b);document.dispatchEvent(e)}function jb(e,t,n,r){var i=r.discrete,o=n.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),i?xb(o,a):o.dispatchEvent(a)}var Ab=Ib,Ob=Tb,Lb=["loop","trapped","onMountAutoFocus","onUnmountAutoFocus"],zb="focusScope.autoFocusOnMount",Db="focusScope.autoFocusOnUnmount",Rb={bubbles:!1,cancelable:!0},Nb=(0,t.forwardRef)((function(e,n){var r=e.loop,i=void 0!==r&&r,o=e.trapped,a=void 0!==o&&o,s=e.onMountAutoFocus,u=e.onUnmountAutoFocus,l=gt(e,Lb),c=G((0,t.useState)(null),2),d=c[0],f=c[1],p=cb(s),h=cb(u),v=(0,t.useRef)(null),g=tb(n,(function(e){return f(e)})),m=(0,t.useRef)({paused:!1,pause:function(){this.paused=!0},resume:function(){this.paused=!1}}).current;(0,t.useEffect)((function(){if(a){var e=function(e){if(!m.paused&&d){var t=e.target;d.contains(t)?v.current=t:Kb(v.current,{select:!0})}},t=function(e){if(!m.paused&&d){var t=e.relatedTarget;null!==t&&(d.contains(t)||Kb(v.current,{select:!0}))}};document.addEventListener("focusin",e),document.addEventListener("focusout",t);var n=new MutationObserver((function(e){if(document.activeElement===document.body){var t,n=J(e);try{for(n.s();!(t=n.n()).done;){t.value.removedNodes.length>0&&Kb(d)}}catch(r){n.e(r)}finally{n.f()}}}));return d&&n.observe(d,{childList:!0,subtree:!0}),function(){document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),n.disconnect()}}}),[a,d,m.paused]),(0,t.useEffect)((function(){if(d){Vb.add(m);var e=document.activeElement;if(!d.contains(e)){var t=new CustomEvent(zb,Rb);d.addEventListener(zb,p),d.dispatchEvent(t),t.defaultPrevented||(!function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.select,i=void 0!==r&&r,o=document.activeElement,a=J(e);try{for(a.s();!(t=a.n()).done;){if(Kb(t.value,{select:i}),document.activeElement!==o)return}}catch(s){a.e(s)}finally{a.f()}}((n=Bb(d),n.filter((function(e){return"A"!==e.tagName}))),{select:!0}),document.activeElement===e&&Kb(d))}return function(){d.removeEventListener(zb,p),setTimeout((function(){var t=new CustomEvent(Db,Rb);d.addEventListener(Db,h),d.dispatchEvent(t),t.defaultPrevented||Kb(null!==e&&void 0!==e?e:document.body,{select:!0}),d.removeEventListener(Db,h),Vb.remove(m)}),0)}}var n}),[d,p,h,m]);var y=(0,t.useCallback)((function(e){if((i||a)&&!m.paused){var t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,n=document.activeElement;if(t&&n){var r=e.currentTarget,o=function(e){var t=Bb(e),n=Fb(t,e),r=Fb(t.reverse(),e);return[n,r]}(r),s=G(o,2),u=s[0],l=s[1];u&&l?e.shiftKey||n!==l?e.shiftKey&&n===u&&(e.preventDefault(),i&&Kb(l,{select:!0})):(e.preventDefault(),i&&Kb(u,{select:!0})):n===r&&e.preventDefault()}}}),[i,a,m.paused]);return(0,t.createElement)(wb.div,Zy({tabIndex:-1},l,{ref:g,onKeyDown:y}))}));function Bb(e){for(var t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:function(e){var t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});n.nextNode();)t.push(n.currentNode);return t}function Fb(e,t){var n,r=J(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!Ub(i,{upTo:t}))return i}}catch(o){r.e(o)}finally{r.f()}}function Ub(e,t){var n=t.upTo;if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==n&&e===n)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function Kb(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).select,n=void 0!==t&&t;if(e&&e.focus){var r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&n&&e.select()}}var Vb=function(){var e=[];return{add:function(t){var n=e[0];t!==n&&(null===n||void 0===n||n.pause()),(e=Wb(e,t)).unshift(t)},remove:function(t){var n;null===(n=(e=Wb(e,t))[0])||void 0===n||n.resume()}}}();function Wb(e,t){var n=u(e),r=n.indexOf(t);return-1!==r&&n.splice(r,1),n}var Hb=["container"],Yb=(0,t.forwardRef)((function(e,n){var r,i=e.container,o=void 0===i?null===globalThis||void 0===globalThis||null===(r=globalThis.document)||void 0===r?void 0:r.body:i,a=gt(e,Hb);return o?fb.createPortal((0,t.createElement)(wb.div,Zy({},a,{ref:n})),o):null}));var Xb=function(e){var n=e.present,r=e.children,i=function(e){var n=G((0,t.useState)(),2),r=n[0],i=n[1],o=(0,t.useRef)({}),a=(0,t.useRef)(e),s=(0,t.useRef)("none"),u=e?"mounted":"unmounted",l=function(e,n){return(0,t.useReducer)((function(e,t){var r=n[e][t];return null!==r&&void 0!==r?r:e}),e)}(u,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),c=G(l,2),d=c[0],f=c[1];return(0,t.useEffect)((function(){var e=qb(o.current);s.current="mounted"===d?e:"none"}),[d]),ab((function(){var t=o.current,n=a.current;if(n!==e){var r=s.current,i=qb(t);if(e)f("MOUNT");else if("none"===i||"none"===(null===t||void 0===t?void 0:t.display))f("UNMOUNT");else{f(n&&r!==i?"ANIMATION_OUT":"UNMOUNT")}a.current=e}}),[e,f]),ab((function(){if(r){var e=function(e){var t=qb(o.current).includes(e.animationName);e.target===r&&t&&(0,fb.flushSync)((function(){return f("ANIMATION_END")}))},t=function(e){e.target===r&&(s.current=qb(o.current))};return r.addEventListener("animationstart",t),r.addEventListener("animationcancel",e),r.addEventListener("animationend",e),function(){r.removeEventListener("animationstart",t),r.removeEventListener("animationcancel",e),r.removeEventListener("animationend",e)}}f("ANIMATION_END")}),[r,f]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:(0,t.useCallback)((function(e){e&&(o.current=getComputedStyle(e)),i(e)}),[])}}(n),o="function"===typeof r?r({present:i.isPresent}):t.Children.only(r),a=tb(i.ref,o.ref);return"function"===typeof r||i.isPresent?(0,t.cloneElement)(o,{ref:a}):null};function qb(e){return(null===e||void 0===e?void 0:e.animationName)||"none"}Xb.displayName="Presence";var $b=0;function Gb(){(0,t.useEffect)((function(){var e,t,n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(e=n[0])&&void 0!==e?e:Qb()),document.body.insertAdjacentElement("beforeend",null!==(t=n[1])&&void 0!==t?t:Qb()),$b++,function(){1===$b&&document.querySelectorAll("[data-radix-focus-guard]").forEach((function(e){return e.remove()})),$b--}}),[])}function Qb(){var e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var Zb=function(){return Zb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Zb.apply(this,arguments)};function Jb(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;function ew(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}Object.create;"function"===typeof SuppressedError&&SuppressedError;var tw="right-scroll-bar-position",nw="width-before-scroll-bar";function rw(e,n){return function(e,n){var r=(0,t.useState)((function(){return{value:e,callback:n,facade:{get current(){return r.value},set current(e){var t=r.value;t!==e&&(r.value=e,r.callback(e,t))}}}}))[0];return r.callback=n,r.facade}(n||null,(function(t){return e.forEach((function(e){return function(e,t){return"function"===typeof e?e(t):e&&(e.current=t),e}(e,t)}))}))}function iw(e){return e}function ow(e,t){void 0===t&&(t=iw);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(e){var i=t(e,r);return n.push(i),function(){n=n.filter((function(e){return e!==i}))}},assignSyncMedium:function(e){for(r=!0;n.length;){var t=n;n=[],t.forEach(e)}n={push:function(t){return e(t)},filter:function(){return n}}},assignMedium:function(e){r=!0;var t=[];if(n.length){var i=n;n=[],i.forEach(e),t=n}var o=function(){var n=t;t=[],n.forEach(e)},a=function(){return Promise.resolve().then(o)};a(),n={push:function(e){t.push(e),a()},filter:function(e){return t=t.filter(e),n}}}};return i}var aw=function(e){void 0===e&&(e={});var t=ow(null);return t.options=Zb({async:!0,ssr:!1},e),t}(),sw=function(){},uw=t.forwardRef((function(e,n){var r=t.useRef(null),i=t.useState({onScrollCapture:sw,onWheelCapture:sw,onTouchMoveCapture:sw}),o=i[0],a=i[1],s=e.forwardProps,u=e.children,l=e.className,c=e.removeScrollBar,d=e.enabled,f=e.shards,p=e.sideCar,h=e.noIsolation,v=e.inert,g=e.allowPinchZoom,m=e.as,y=void 0===m?"div":m,b=Jb(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),w=p,x=rw([r,n]),k=Zb(Zb({},b),o);return t.createElement(t.Fragment,null,d&&t.createElement(w,{sideCar:aw,removeScrollBar:c,shards:f,noIsolation:h,inert:v,setCallbacks:a,allowPinchZoom:!!g,lockRef:r}),s?t.cloneElement(t.Children.only(u),Zb(Zb({},k),{ref:x})):t.createElement(y,Zb({},k,{className:l,ref:x}),u))}));uw.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},uw.classNames={fullWidth:nw,zeroRight:tw};var lw,cw=function(e){var n=e.sideCar,r=Jb(e,["sideCar"]);if(!n)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=n.read();if(!i)throw new Error("Sidecar medium not found");return t.createElement(i,Zb({},r))};cw.isSideCarExport=!0;function dw(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=lw||n.nc;return t&&e.setAttribute("nonce",t),e}var fw=function(){var e=0,t=null;return{add:function(n){var r,i;0==e&&(t=dw())&&(i=n,(r=t).styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i)),function(e){(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}(t)),e++},remove:function(){! --e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},pw=function(){var e=function(){var e=fw();return function(n,r){t.useEffect((function(){return e.add(n),function(){e.remove()}}),[n&&r])}}();return function(t){var n=t.styles,r=t.dynamic;return e(n,r),null}},hw={left:0,top:0,right:0,gap:0},vw=function(e){return parseInt(e||"",10)||0},gw=function(e){if(void 0===e&&(e="margin"),"undefined"===typeof window)return hw;var t=function(e){var t=window.getComputedStyle(document.body),n=t["padding"===e?"paddingLeft":"marginLeft"],r=t["padding"===e?"paddingTop":"marginTop"],i=t["padding"===e?"paddingRight":"marginRight"];return[vw(n),vw(r),vw(i)]}(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},mw=pw(),yw=function(e,t,n,r){var i=e.left,o=e.top,a=e.right,s=e.gap;return void 0===n&&(n="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(r,";\n   padding-right: ").concat(s,"px ").concat(r,";\n  }\n  body {\n    overflow: hidden ").concat(r,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(r,";"),"margin"===n&&"\n    padding-left: ".concat(i,"px;\n    padding-top: ").concat(o,"px;\n    padding-right: ").concat(a,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(s,"px ").concat(r,";\n    "),"padding"===n&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(tw," {\n    right: ").concat(s,"px ").concat(r,";\n  }\n  \n  .").concat(nw," {\n    margin-right: ").concat(s,"px ").concat(r,";\n  }\n  \n  .").concat(tw," .").concat(tw," {\n    right: 0 ").concat(r,";\n  }\n  \n  .").concat(nw," .").concat(nw," {\n    margin-right: 0 ").concat(r,";\n  }\n  \n  body {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(s,"px;\n  }\n")},bw=function(e){var n=e.noRelative,r=e.noImportant,i=e.gapMode,o=void 0===i?"margin":i,a=t.useMemo((function(){return gw(o)}),[o]);return t.createElement(mw,{styles:yw(a,!n,o,r?"":"!important")})},ww=!1;if("undefined"!==typeof window)try{var xw=Object.defineProperty({},"passive",{get:function(){return ww=!0,!0}});window.addEventListener("test",xw,xw),window.removeEventListener("test",xw,xw)}catch(hD){ww=!1}var kw=!!ww&&{passive:!1},Sw=function(e,t){var n=window.getComputedStyle(e);return"hidden"!==n[t]&&!(n.overflowY===n.overflowX&&!function(e){return"TEXTAREA"===e.tagName}(e)&&"visible"===n[t])},_w=function(e,t){var n=t;do{if("undefined"!==typeof ShadowRoot&&n instanceof ShadowRoot&&(n=n.host),Pw(e,n)){var r=Ew(e,n);if(r[1]>r[2])return!0}n=n.parentNode}while(n&&n!==document.body);return!1},Pw=function(e,t){return"v"===e?function(e){return Sw(e,"overflowY")}(t):function(e){return Sw(e,"overflowX")}(t)},Ew=function(e,t){return"v"===e?[(n=t).scrollTop,n.scrollHeight,n.clientHeight]:function(e){return[e.scrollLeft,e.scrollWidth,e.clientWidth]}(t);var n},Cw=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Iw=function(e){return[e.deltaX,e.deltaY]},Tw=function(e){return e&&"current"in e?e.current:e},Mw=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},jw=0,Aw=[];var Ow,Lw=(Ow=function(e){var n=t.useRef([]),r=t.useRef([0,0]),i=t.useRef(),o=t.useState(jw++)[0],a=t.useState((function(){return pw()}))[0],s=t.useRef(e);t.useEffect((function(){s.current=e}),[e]),t.useEffect((function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var t=ew([e.lockRef.current],(e.shards||[]).map(Tw),!0).filter(Boolean);return t.forEach((function(e){return e.classList.add("allow-interactivity-".concat(o))})),function(){document.body.classList.remove("block-interactivity-".concat(o)),t.forEach((function(e){return e.classList.remove("allow-interactivity-".concat(o))}))}}}),[e.inert,e.lockRef.current,e.shards]);var u=t.useCallback((function(e,t){if("touches"in e&&2===e.touches.length)return!s.current.allowPinchZoom;var n,o=Cw(e),a=r.current,u="deltaX"in e?e.deltaX:a[0]-o[0],l="deltaY"in e?e.deltaY:a[1]-o[1],c=e.target,d=Math.abs(u)>Math.abs(l)?"h":"v";if("touches"in e&&"h"===d&&"range"===c.type)return!1;var f=_w(d,c);if(!f)return!0;if(f?n=d:(n="v"===d?"h":"v",f=_w(d,c)),!f)return!1;if(!i.current&&"changedTouches"in e&&(u||l)&&(i.current=n),!n)return!0;var p=i.current||n;return function(e,t,n,r,i){var o=function(e,t){return"h"===e&&"rtl"===t?-1:1}(e,window.getComputedStyle(t).direction),a=o*r,s=n.target,u=t.contains(s),l=!1,c=a>0,d=0,f=0;do{var p=Ew(e,s),h=p[0],v=p[1]-p[2]-o*h;(h||v)&&Pw(e,s)&&(d+=v,f+=h),s=s.parentNode}while(!u&&s!==document.body||u&&(t.contains(s)||t===s));return(c&&(i&&0===d||!i&&a>d)||!c&&(i&&0===f||!i&&-a>f))&&(l=!0),l}(p,t,e,"h"===p?u:l,!0)}),[]),l=t.useCallback((function(e){var t=e;if(Aw.length&&Aw[Aw.length-1]===a){var r="deltaY"in t?Iw(t):Cw(t),i=n.current.filter((function(e){return e.name===t.type&&e.target===t.target&&function(e,t){return e[0]===t[0]&&e[1]===t[1]}(e.delta,r)}))[0];if(i&&i.should)t.cancelable&&t.preventDefault();else if(!i){var o=(s.current.shards||[]).map(Tw).filter(Boolean).filter((function(e){return e.contains(t.target)}));(o.length>0?u(t,o[0]):!s.current.noIsolation)&&t.cancelable&&t.preventDefault()}}}),[]),c=t.useCallback((function(e,t,r,i){var o={name:e,delta:t,target:r,should:i};n.current.push(o),setTimeout((function(){n.current=n.current.filter((function(e){return e!==o}))}),1)}),[]),d=t.useCallback((function(e){r.current=Cw(e),i.current=void 0}),[]),f=t.useCallback((function(t){c(t.type,Iw(t),t.target,u(t,e.lockRef.current))}),[]),p=t.useCallback((function(t){c(t.type,Cw(t),t.target,u(t,e.lockRef.current))}),[]);t.useEffect((function(){return Aw.push(a),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:p}),document.addEventListener("wheel",l,kw),document.addEventListener("touchmove",l,kw),document.addEventListener("touchstart",d,kw),function(){Aw=Aw.filter((function(e){return e!==a})),document.removeEventListener("wheel",l,kw),document.removeEventListener("touchmove",l,kw),document.removeEventListener("touchstart",d,kw)}}),[]);var h=e.removeScrollBar,v=e.inert;return t.createElement(t.Fragment,null,v?t.createElement(a,{styles:Mw(o)}):null,h?t.createElement(bw,{gapMode:"margin"}):null)},aw.useMedium(Ow),cw),zw=t.forwardRef((function(e,n){return t.createElement(uw,Zb({},e,{ref:n,sideCar:Lw}))}));zw.classNames=uw.classNames;var Dw=zw,Rw=function(e){return"undefined"===typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body},Nw=new WeakMap,Bw=new WeakMap,Fw={},Uw=0,Kw=function e(t){return t&&(t.host||e(t.parentNode))},Vw=function(e,t,n,r){var i=function(e,t){return t.map((function(t){if(e.contains(t))return t;var n=Kw(t);return n&&e.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)})).filter((function(e){return Boolean(e)}))}(t,Array.isArray(e)?e:[e]);Fw[n]||(Fw[n]=new WeakMap);var o=Fw[n],a=[],s=new Set,u=new Set(i);i.forEach((function e(t){t&&!s.has(t)&&(s.add(t),e(t.parentNode))}));return function e(t){t&&!u.has(t)&&Array.prototype.forEach.call(t.children,(function(t){if(s.has(t))e(t);else{var i=t.getAttribute(r),u=null!==i&&"false"!==i,l=(Nw.get(t)||0)+1,c=(o.get(t)||0)+1;Nw.set(t,l),o.set(t,c),a.push(t),1===l&&u&&Bw.set(t,!0),1===c&&t.setAttribute(n,"true"),u||t.setAttribute(r,"true")}}))}(t),s.clear(),Uw++,function(){a.forEach((function(e){var t=Nw.get(e)-1,i=o.get(e)-1;Nw.set(e,t),o.set(e,i),t||(Bw.has(e)||e.removeAttribute(r),Bw.delete(e)),i||e.removeAttribute(n)})),--Uw||(Nw=new WeakMap,Nw=new WeakMap,Bw=new WeakMap,Fw={})}},Ww=function(e,t,n){void 0===n&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),i=t||Rw(e);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),Vw(r,i,n,"aria-hidden")):function(){return null}},Hw=["forceMount"],Yw=["__scopeDialog"],Xw=["forceMount"],qw=["__scopeDialog","trapFocus","onOpenAutoFocus","onCloseAutoFocus"],$w=["__scopeDialog"],Gw=["__scopeDialog"],Qw="Dialog",Zw=G(ib(Qw),2),Jw=Zw[0],ex=(Zw[1],G(Jw(Qw),2)),tx=ex[0],nx=ex[1],rx=function(e){var n=e.__scopeDialog,r=e.children,i=e.open,o=e.defaultOpen,a=e.onOpenChange,s=e.modal,u=void 0===s||s,l=(0,t.useRef)(null),c=(0,t.useRef)(null),d=G(db({prop:i,defaultProp:o,onChange:a}),2),f=d[0],p=void 0!==f&&f,h=d[1];return(0,t.createElement)(tx,{scope:n,triggerRef:l,contentRef:c,contentId:lb(),titleId:lb(),descriptionId:lb(),open:p,onOpenChange:h,onOpenToggle:(0,t.useCallback)((function(){return h((function(e){return!e}))}),[h]),modal:u},r)},ix="DialogPortal",ox=G(Jw(ix,{forceMount:void 0}),2),ax=ox[0],sx=ox[1],ux=function(e){var n=e.__scopeDialog,r=e.forceMount,i=e.children,o=e.container,a=nx(ix,n);return(0,t.createElement)(ax,{scope:n,forceMount:r},t.Children.map(i,(function(e){return(0,t.createElement)(Xb,{present:r||a.open},(0,t.createElement)(Yb,{asChild:!0,container:o},e))})))},lx="DialogOverlay",cx=(0,t.forwardRef)((function(e,n){var r=sx(lx,e.__scopeDialog),i=e.forceMount,o=void 0===i?r.forceMount:i,a=gt(e,Hw),s=nx(lx,e.__scopeDialog);return s.modal?(0,t.createElement)(Xb,{present:o||s.open},(0,t.createElement)(dx,Zy({},a,{ref:n}))):null})),dx=(0,t.forwardRef)((function(e,n){var r=e.__scopeDialog,i=gt(e,Yw),o=nx(lx,r);return(0,t.createElement)(Dw,{as:vb,allowPinchZoom:!0,shards:[o.contentRef]},(0,t.createElement)(wb.div,Zy({"data-state":xx(o.open)},i,{ref:n,style:Ce({pointerEvents:"auto"},i.style)})))})),fx="DialogContent",px=(0,t.forwardRef)((function(e,n){var r=sx(fx,e.__scopeDialog),i=e.forceMount,o=void 0===i?r.forceMount:i,a=gt(e,Xw),s=nx(fx,e.__scopeDialog);return(0,t.createElement)(Xb,{present:o||s.open},s.modal?(0,t.createElement)(hx,Zy({},a,{ref:n})):(0,t.createElement)(vx,Zy({},a,{ref:n})))})),hx=(0,t.forwardRef)((function(e,n){var r=nx(fx,e.__scopeDialog),i=(0,t.useRef)(null),o=tb(n,r.contentRef,i);return(0,t.useEffect)((function(){var e=i.current;if(e)return Ww(e)}),[]),(0,t.createElement)(gx,Zy({},e,{ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Jy(e.onCloseAutoFocus,(function(e){var t;e.preventDefault(),null===(t=r.triggerRef.current)||void 0===t||t.focus()})),onPointerDownOutside:Jy(e.onPointerDownOutside,(function(e){var t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey;(2===t.button||n)&&e.preventDefault()})),onFocusOutside:Jy(e.onFocusOutside,(function(e){return e.preventDefault()}))}))})),vx=(0,t.forwardRef)((function(e,n){var r=nx(fx,e.__scopeDialog),i=(0,t.useRef)(!1),o=(0,t.useRef)(!1);return(0,t.createElement)(gx,Zy({},e,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:function(t){var n,a;(null===(n=e.onCloseAutoFocus)||void 0===n||n.call(e,t),t.defaultPrevented)||(i.current||null===(a=r.triggerRef.current)||void 0===a||a.focus(),t.preventDefault());i.current=!1,o.current=!1},onInteractOutside:function(t){var n,a;null===(n=e.onInteractOutside)||void 0===n||n.call(e,t),t.defaultPrevented||(i.current=!0,"pointerdown"===t.detail.originalEvent.type&&(o.current=!0));var s=t.target;(null===(a=r.triggerRef.current)||void 0===a?void 0:a.contains(s))&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&o.current&&t.preventDefault()}}))})),gx=(0,t.forwardRef)((function(e,n){var r=e.__scopeDialog,i=e.trapFocus,o=e.onOpenAutoFocus,a=e.onCloseAutoFocus,s=gt(e,qw),u=nx(fx,r),l=tb(n,(0,t.useRef)(null));return Gb(),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(Nb,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:o,onUnmountAutoFocus:a},(0,t.createElement)(Ib,Zy({role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":xx(u.open)},s,{ref:l,onDismiss:function(){return u.onOpenChange(!1)}}))),!1)})),mx="DialogTitle",yx=(0,t.forwardRef)((function(e,n){var r=e.__scopeDialog,i=gt(e,$w),o=nx(mx,r);return(0,t.createElement)(wb.h2,Zy({id:o.titleId},i,{ref:n}))})),bx="DialogClose",wx=(0,t.forwardRef)((function(e,n){var r=e.__scopeDialog,i=gt(e,Gw),o=nx(bx,r);return(0,t.createElement)(wb.button,Zy({type:"button"},i,{ref:n,onClick:Jy(e.onClick,(function(){return o.onOpenChange(!1)}))}))}));function xx(e){return e?"open":"closed"}var kx="DialogTitleWarning",Sx=G(function(e,n){var r=(0,t.createContext)(n);function i(e){var n=e.children,i=gt(e,nb),o=(0,t.useMemo)((function(){return i}),Object.values(i));return(0,t.createElement)(r.Provider,{value:o},n)}return i.displayName=e+"Provider",[i,function(i){var o=(0,t.useContext)(r);if(o)return o;if(void 0!==n)return n;throw new Error("`".concat(i,"` must be used within `").concat(e,"`"))}]}(kx,{contentName:fx,titleName:mx,docsSlug:"dialog"}),2),_x=(Sx[0],Sx[1],rx),Px=ux,Ex=cx,Cx=px,Ix=(0,t.createContext)(null);function Tx(e){var t=e.assetUrls,n=e.children;return(0,za.jsx)(Ix.Provider,{value:t,children:n})}function Mx(){var e=(0,t.useContext)(Ix);if(!e)throw new Error("useAssetUrls must be used within an AssetUrlsProvider");return e}var jx={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy share link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy read-only link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to view (but not edit) this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrowheads","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again","cursor-chat.type-to-chat":"Type to chat..."},Ax={locale:"en",label:"English",messages:jx};function Ox(e,t){return Lx.apply(this,arguments)}function Lx(){return Lx=Fa(Na().mark((function e(t,n){var r,i,o,a,s;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n.translations.en);case 2:if(e.sent.ok){e.next=6;break}return console.warn("No main translations found."),e.abrupt("return",Ax);case 6:if("en"!==t){e.next=8;break}return e.abrupt("return",Ax);case 8:if(r=ja.find((function(e){return e.locale===t})),r){e.next=12;break}return console.warn("No translation found for locale ".concat(t)),e.abrupt("return",Ax);case 12:return e.next=14,fetch(n.translations[r.locale]);case 14:return i=e.sent,e.next=17,i.json();case 17:if(o=e.sent){e.next=21;break}return console.warn("No messages found for locale ".concat(t)),e.abrupt("return",Ax);case 21:for(s in a=[],Ax)o[s]||a.push(s);return a.length,e.abrupt("return",{locale:t,label:r.label,messages:Ce(Ce({},Ax.messages),o)});case 25:case"end":return e.stop()}}),e)}))),Lx.apply(this,arguments)}var zx=t.createContext({}),Dx=function(){return t.useContext(zx)},Rx=ke((function(e){var n=e.overrides,r=e.children,i=Va().locale,o=Mx(),a=G(t.useState((function(){return n&&n.en?{locale:"en",label:"English",messages:Ce(Ce({},jx),n.en)}:{locale:"en",label:"English",messages:jx}})),2),s=a[0],u=a[1];return t.useEffect((function(){var e=!1;function t(){return(t=Fa(Na().mark((function t(){var r;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ox(i,o);case 2:(r=t.sent)&&!e&&(n&&n[i]?u(Ce(Ce({},r),{},{messages:Ce(Ce({},r.messages),n[i])})):u(r));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){t.apply(this,arguments)}(),function(){e=!0}}),[o,i,n]),(0,za.jsx)(zx.Provider,{value:s,children:r})}));function Nx(){var e=Dx();return t.useCallback((function(t){var n;return null!==(n=e.messages[t])&&void 0!==n?n:t}),[e])}function Bx(e){return(0,za.jsx)("svg",Ce(Ce({width:16,height:16,viewBox:"0 0 16 16"},e),{},{children:(0,za.jsxs)("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[(0,za.jsx)("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),(0,za.jsx)("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:(0,za.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})}))}var Fx=["small","invertIcon","icon","color","className"],Ux=(0,t.memo)((function(e){var n=e.small,r=e.invertIcon,i=e.icon,o=e.color,a=e.className,s=gt(e,Fx),u=Mx().icons[i],l=(0,t.useRef)(null);return(0,t.useLayoutEffect)((function(){null!==l&&void 0!==l&&l.current&&(l.current.style.webkitMask="url(".concat(u,") center 100% / 100% no-repeat"))}),[l,u]),(0,za.jsx)("div",Ce(Ce({},s),{},{ref:l,className:Ua("tlui-icon",{"tlui-icon__small":n},a),style:{color:o,mask:"url(".concat(u,") center 100% / 100% no-repeat"),transform:r?"scale(-1, 1)":void 0}}))}));var Kx="undefined"!==typeof window&&window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,Vx=Kx?"\u2318":"Ctrl",Wx=Kx?"\u2325":"Alt";function Hx(e){return"\u2014 "+e.split(",")[0].split("").map((function(e){var t=e.replace(/\$/g,Vx).replace(/\?/g,Wx).replace(/!/g,"\u21e7");return t[0].toUpperCase()+t.slice(1)})).join("\u2009")}function Yx(e){var t,n=e.children;return(0,za.jsx)("kbd",{className:"tlui-kbd",children:(t=n,t.split(",")[0].split("").map((function(e){var t=e.replace(/\$/g,Vx).replace(/\?/g,Wx).replace(/!/g,"\u21e7");return t[0].toUpperCase()+t.slice(1)}))).map((function(e,t){return(0,za.jsx)("span",{children:e},t)}))})}var Xx=["label","icon","invertIcon","iconLeft","smallIcon","kbd","isChecked","type","children","spinner"],qx=t.forwardRef((function(e,t){var n,r=e.label,i=e.icon,o=e.invertIcon,a=e.iconLeft,s=e.smallIcon,u=e.kbd,l=e.isChecked,c=void 0!==l&&l,d=e.type,f=void 0===d?"normal":d,p=e.children,h=e.spinner,v=gt(e,Xx),g=Nx(),m=r?g(r):"";return(0,za.jsxs)("button",Ce(Ce({ref:t,draggable:!1,type:"button"},v),{},{title:null!==(n=v.title)&&void 0!==n?n:m,className:Ua("tlui-button","tlui-button__".concat(f),v.className),children:[a&&(0,za.jsx)(Ux,{icon:a,className:"tlui-icon-left",small:!0}),p,r&&(0,za.jsxs)("span",{draggable:!1,children:[m,c&&(0,za.jsx)(Ux,{icon:"check"})]}),u&&(0,za.jsx)(Yx,{children:u}),i&&!h&&(0,za.jsx)(Ux,{icon:i,small:!!r||s,invertIcon:o}),h&&(0,za.jsx)(Bx,{})]}))}));function $x(e){var t=e.className,n=e.children;return(0,za.jsx)("div",{className:Ua("tlui-dialog__header",t),children:n})}function Gx(e){var t=e.className,n=e.children;return(0,za.jsx)(yx,{dir:"ltr",className:Ua("tlui-dialog__header__title",t),children:n})}function Qx(){return(0,za.jsx)("div",{className:"tlui-dialog__header__close",children:(0,za.jsx)(wx,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:(0,za.jsx)(qx,{"aria-label":"Close",onTouchEnd:function(e){return e.target.click()},children:(0,za.jsx)(Ux,{small:!0,icon:"cross-2"})})})})}function Zx(e){var t=e.className,n=e.children,r=e.style;return(0,za.jsx)("div",{className:Ua("tlui-dialog__body",t),style:r,children:n})}function Jx(e){var t=e.className,n=e.children;return(0,za.jsx)("div",{className:Ua("tlui-dialog__footer",t),children:n})}var ek=["scope","children"];function tk(e){var n=e+"CollectionProvider",r=G(ib(n),2),i=r[0],o=r[1],a=G(i(n,{collectionRef:{current:null},itemMap:new Map}),2),s=a[0],u=a[1],l=function(e){var n=e.scope,r=e.children,i=t.useRef(null),o=t.useRef(new Map).current;return t.createElement(s,{scope:n,itemMap:o,collectionRef:i},r)},c=e+"CollectionSlot",d=t.forwardRef((function(e,n){var r=e.scope,i=e.children,o=tb(n,u(c,r).collectionRef);return t.createElement(vb,{ref:o},i)})),f=e+"CollectionItemSlot",p="data-radix-collection-item",h=t.forwardRef((function(e,n){var r,i=e.scope,o=e.children,a=gt(e,ek),s=t.useRef(null),l=tb(n,s),c=u(f,i);return t.useEffect((function(){return c.itemMap.set(s,Ce({ref:s},a)),function(){c.itemMap.delete(s)}})),t.createElement(vb,(z(r={},p,""),z(r,"ref",l),r),o)}));return[{Provider:l,Slot:d,ItemSlot:h},function(n){var r=u(e+"CollectionConsumer",n),i=t.useCallback((function(){var e=r.collectionRef.current;if(!e)return[];var t=Array.from(e.querySelectorAll("[".concat(p,"]"))),n=Array.from(r.itemMap.values()).sort((function(e,n){return t.indexOf(e.ref.current)-t.indexOf(n.ref.current)}));return n}),[r.collectionRef,r.itemMap]);return i},o]}var nk=(0,t.createContext)(void 0);function rk(e){var n=(0,t.useContext)(nk);return e||n||"ltr"}var ik=["top","right","bottom","left"],ok=Math.min,ak=Math.max,sk=Math.round,uk=Math.floor,lk=function(e){return{x:e,y:e}},ck={left:"right",right:"left",bottom:"top",top:"bottom"},dk={start:"end",end:"start"};function fk(e,t,n){return ak(e,ok(t,n))}function pk(e,t){return"function"===typeof e?e(t):e}function hk(e){return e.split("-")[0]}function vk(e){return e.split("-")[1]}function gk(e){return"x"===e?"y":"x"}function mk(e){return"y"===e?"height":"width"}function yk(e){return["top","bottom"].includes(hk(e))?"y":"x"}function bk(e){return gk(yk(e))}function wk(e,t,n){void 0===n&&(n=!1);var r=vk(e),i=bk(e),o=mk(i),a="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[o]>t.floating[o]&&(a=_k(a)),[a,_k(a)]}function xk(e){var t=_k(e);return[kk(e),t,kk(t)]}function kk(e){return e.replace(/start|end/g,(function(e){return dk[e]}))}function Sk(e,t,n,r){var i=vk(e),o=function(e,t,n){var r=["left","right"],i=["right","left"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?["top","bottom"]:["bottom","top"];default:return[]}}(hk(e),"start"===n,r);return i&&(o=o.map((function(e){return e+"-"+i})),t&&(o=o.concat(o.map(kk)))),o}function _k(e){return e.replace(/left|right|bottom|top/g,(function(e){return ck[e]}))}function Pk(e){return"number"!==typeof e?function(e){return Ce({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function Ek(e){return Ce(Ce({},e),{},{top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height})}var Ck=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],Ik=["strategy"],Tk=["mainAxis","crossAxis","limiter"],Mk=["apply"];function jk(e,t,n){var r,i=e.reference,o=e.floating,a=yk(t),s=bk(t),u=mk(s),l=hk(t),c="y"===a,d=i.x+i.width/2-o.width/2,f=i.y+i.height/2-o.height/2,p=i[u]/2-o[u]/2;switch(l){case"top":r={x:d,y:i.y-o.height};break;case"bottom":r={x:d,y:i.y+i.height};break;case"right":r={x:i.x+i.width,y:f};break;case"left":r={x:i.x-o.width,y:f};break;default:r={x:i.x,y:i.y}}switch(vk(t)){case"start":r[s]-=p*(n&&c?-1:1);break;case"end":r[s]+=p*(n&&c?-1:1)}return r}var Ak=function(){var e=Fa(Na().mark((function e(t,n,r){var i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.placement,o=void 0===i?"bottom":i,a=r.strategy,s=void 0===a?"absolute":a,u=r.middleware,l=void 0===u?[]:u,c=r.platform,d=l.filter(Boolean),e.next=4,null==c.isRTL?void 0:c.isRTL(n);case 4:return f=e.sent,e.next=7,c.getElementRects({reference:t,floating:n,strategy:s});case 7:p=e.sent,h=jk(p,o,f),v=h.x,g=h.y,m=o,y={},b=0,w=0;case 13:if(!(w<d.length)){e.next=46;break}return x=d[w],k=x.name,S=x.fn,e.next=17,S({x:v,y:g,initialPlacement:o,placement:m,strategy:s,middlewareData:y,rects:p,platform:c,elements:{reference:t,floating:n}});case 17:if(_=e.sent,P=_.x,E=_.y,C=_.data,I=_.reset,v=null!=P?P:v,g=null!=E?E:g,y=Ce(Ce({},y),{},z({},k,Ce(Ce({},y[k]),C))),!(I&&b<=50)){e.next=43;break}if(b++,"object"!==typeof I){e.next=41;break}if(I.placement&&(m=I.placement),!I.rects){e.next=38;break}if(!0!==I.rects){e.next=36;break}return e.next=33,c.getElementRects({reference:t,floating:n,strategy:s});case 33:e.t0=e.sent,e.next=37;break;case 36:e.t0=I.rects;case 37:p=e.t0;case 38:T=jk(p,m,f),v=T.x,g=T.y;case 41:return w=-1,e.abrupt("continue",43);case 43:w++,e.next=13;break;case 46:return e.abrupt("return",{x:v,y:g,placement:m,strategy:s,middlewareData:y});case 47:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function Ok(e,t){return Lk.apply(this,arguments)}function Lk(){return Lk=Fa(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),i=t.x,o=t.y,a=t.platform,s=t.rects,u=t.elements,l=t.strategy,c=pk(n,t),d=c.boundary,f=void 0===d?"clippingAncestors":d,p=c.rootBoundary,h=void 0===p?"viewport":p,v=c.elementContext,g=void 0===v?"floating":v,m=c.altBoundary,y=void 0!==m&&m,b=c.padding,w=Pk(void 0===b?0:b),x="floating"===g?"reference":"floating",k=u[y?x:g],e.t0=Ek,e.t1=a,e.next=10,null==a.isElement?void 0:a.isElement(k);case 10:if(e.t2=r=e.sent,null==e.t2){e.next=15;break}e.t3=r,e.next=16;break;case 15:e.t3=!0;case 16:if(!e.t3){e.next=20;break}e.t4=k,e.next=26;break;case 20:if(e.t5=k.contextElement,e.t5){e.next=25;break}return e.next=24,null==a.getDocumentElement?void 0:a.getDocumentElement(u.floating);case 24:e.t5=e.sent;case 25:e.t4=e.t5;case 26:return e.t6=e.t4,e.t7=f,e.t8=h,e.t9=l,e.t10={element:e.t6,boundary:e.t7,rootBoundary:e.t8,strategy:e.t9},e.next=33,e.t1.getClippingRect.call(e.t1,e.t10);case 33:return e.t11=e.sent,S=(0,e.t0)(e.t11),_="floating"===g?Ce(Ce({},s.floating),{},{x:i,y:o}):s.reference,e.next=38,null==a.getOffsetParent?void 0:a.getOffsetParent(u.floating);case 38:return P=e.sent,e.next=41,null==a.isElement?void 0:a.isElement(P);case 41:if(!e.sent){e.next=50;break}return e.next=44,null==a.getScale?void 0:a.getScale(P);case 44:if(e.t13=e.sent,e.t13){e.next=47;break}e.t13={x:1,y:1};case 47:e.t12=e.t13,e.next=51;break;case 50:e.t12={x:1,y:1};case 51:if(E=e.t12,e.t14=Ek,!a.convertOffsetParentRelativeRectToViewportRelativeRect){e.next=59;break}return e.next=56,a.convertOffsetParentRelativeRectToViewportRelativeRect({rect:_,offsetParent:P,strategy:l});case 56:e.t15=e.sent,e.next=60;break;case 59:e.t15=_;case 60:return e.t16=e.t15,C=(0,e.t14)(e.t16),e.abrupt("return",{top:(S.top-C.top+w.top)/E.y,bottom:(C.bottom-S.bottom+w.bottom)/E.y,left:(S.left-C.left+w.left)/E.x,right:(C.right-S.right+w.right)/E.x});case 63:case"end":return e.stop()}}),e)}))),Lk.apply(this,arguments)}var zk=function(e){return{name:"arrow",options:e,fn:function(t){return Fa(Na().mark((function n(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T,M,j,A,O,L,D,R,N,B;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.x,a=t.y,s=t.placement,u=t.rects,l=t.platform,c=t.elements,d=t.middlewareData,f=pk(e,t)||{},p=f.element,h=f.padding,v=void 0===h?0:h,null!=p){n.next=4;break}return n.abrupt("return",{});case 4:return g=Pk(v),m={x:o,y:a},y=bk(s),b=mk(y),n.next=10,l.getDimensions(p);case 10:return w=n.sent,k=(x="y"===y)?"top":"left",S=x?"bottom":"right",_=x?"clientHeight":"clientWidth",P=u.reference[b]+u.reference[y]-m[y]-u.floating[b],E=m[y]-u.reference[y],n.next=19,null==l.getOffsetParent?void 0:l.getOffsetParent(p);case 19:if(C=n.sent,I=C?C[_]:0,n.t0=!I,n.t0){n.next=26;break}return n.next=25,null==l.isElement?void 0:l.isElement(C);case 25:n.t0=!n.sent;case 26:if(!n.t0){n.next=28;break}I=c.floating[_]||u.floating[b];case 28:return T=P/2-E/2,M=I/2-w[b]/2-1,j=ok(g[k],M),A=ok(g[S],M),O=j,L=I-w[b]-A,D=I/2-w[b]/2+T,R=fk(O,D,L),N=!d.arrow&&null!=vk(s)&&D!=R&&u.reference[b]/2-(D<O?j:A)-w[b]/2<0,B=N?D<O?D-O:D-L:0,n.abrupt("return",(z(i={},y,m[y]+B),z(i,"data",Ce((z(r={},y,R),z(r,"centerOffset",D-R-B),r),N&&{alignmentOffset:B})),z(i,"reset",N),i));case 39:case"end":return n.stop()}}),n)})))()}}};var Dk=function(e){return void 0===e&&(e={}),{name:"flip",options:e,fn:function(t){return Fa(Na().mark((function n(){var r,i,o,a,s,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T,M,j,A,O,L,z,D,R,N,B,F;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.placement,a=t.middlewareData,s=t.rects,l=t.initialPlacement,c=t.platform,d=t.elements,f=pk(e,t),p=f.mainAxis,h=void 0===p||p,v=f.crossAxis,g=void 0===v||v,m=f.fallbackPlacements,y=f.fallbackStrategy,b=void 0===y?"bestFit":y,w=f.fallbackAxisSideDirection,x=void 0===w?"none":w,k=f.flipAlignment,S=void 0===k||k,_=gt(f,Ck),null==(r=a.arrow)||!r.alignmentOffset){n.next=4;break}return n.abrupt("return",{});case 4:return P=hk(o),E=hk(l)===l,n.next=8,null==c.isRTL?void 0:c.isRTL(d.floating);case 8:return C=n.sent,I=m||(E||!S?[_k(l)]:xk(l)),m||"none"===x||I.push.apply(I,u(Sk(l,S,x,C))),T=[l].concat(u(I)),n.next=14,Ok(t,_);case 14:if(M=n.sent,j=[],A=(null==(i=a.flip)?void 0:i.overflows)||[],h&&j.push(M[P]),g&&(O=wk(o,s,C),j.push(M[O[0]],M[O[1]])),A=[].concat(u(A),[{placement:o,overflows:j}]),j.every((function(e){return e<=0}))){n.next=37;break}if(D=((null==(L=a.flip)?void 0:L.index)||0)+1,!(R=T[D])){n.next=25;break}return n.abrupt("return",{data:{index:D,overflows:A},reset:{placement:R}});case 25:if(N=null==(z=A.filter((function(e){return e.overflows[0]<=0})).sort((function(e,t){return e.overflows[1]-t.overflows[1]}))[0])?void 0:z.placement,N){n.next=35;break}n.t0=b,n.next="bestFit"===n.t0?30:"initialPlacement"===n.t0?33:35;break;case 30:return F=null==(B=A.map((function(e){return[e.placement,e.overflows.filter((function(e){return e>0})).reduce((function(e,t){return e+t}),0)]})).sort((function(e,t){return e[1]-t[1]}))[0])?void 0:B[0],F&&(N=F),n.abrupt("break",35);case 33:return N=l,n.abrupt("break",35);case 35:if(o===N){n.next=37;break}return n.abrupt("return",{reset:{placement:N}});case 37:return n.abrupt("return",{});case 38:case"end":return n.stop()}}),n)})))()}}};function Rk(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Nk(e){return ik.some((function(t){return e[t]>=0}))}var Bk=function(e){return void 0===e&&(e={}),{name:"hide",options:e,fn:function(t){return Fa(Na().mark((function n(){var r,i,o,a,s,u,l,c,d;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=t.rects,i=pk(e,t),o=i.strategy,a=void 0===o?"referenceHidden":o,s=gt(i,Ik),n.t0=a,n.next="referenceHidden"===n.t0?5:"escaped"===n.t0?10:15;break;case 5:return n.next=7,Ok(t,Ce(Ce({},s),{},{elementContext:"reference"}));case 7:return u=n.sent,l=Rk(u,r.reference),n.abrupt("return",{data:{referenceHiddenOffsets:l,referenceHidden:Nk(l)}});case 10:return n.next=12,Ok(t,Ce(Ce({},s),{},{altBoundary:!0}));case 12:return c=n.sent,d=Rk(c,r.floating),n.abrupt("return",{data:{escapedOffsets:d,escaped:Nk(d)}});case 15:return n.abrupt("return",{});case 16:case"end":return n.stop()}}),n)})))()}}};function Fk(e,t){return Uk.apply(this,arguments)}function Uk(){return Uk=Fa(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f,p,h,v,g;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.placement,i=t.platform,o=t.elements,e.next=3,null==i.isRTL?void 0:i.isRTL(o.floating);case 3:return a=e.sent,s=hk(r),u=vk(r),l="y"===yk(r),c=["left","top"].includes(s)?-1:1,d=a&&l?-1:1,f=pk(n,t),p="number"===typeof f?{mainAxis:f,crossAxis:0,alignmentAxis:null}:Ce({mainAxis:0,crossAxis:0,alignmentAxis:null},f),h=p.mainAxis,v=p.crossAxis,g=p.alignmentAxis,u&&"number"===typeof g&&(v="end"===u?-1*g:g),e.abrupt("return",l?{x:v*d,y:h*c}:{x:h*c,y:v*d});case 13:case"end":return e.stop()}}),e)}))),Uk.apply(this,arguments)}var Kk=function(e){return void 0===e&&(e=0),{name:"offset",options:e,fn:function(t){return Fa(Na().mark((function n(){var r,i,o;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.x,i=t.y,n.next=3,Fk(t,e);case 3:return o=n.sent,n.abrupt("return",{x:r+o.x,y:i+o.y,data:o});case 5:case"end":return n.stop()}}),n)})))()}}},Vk=function(e){return void 0===e&&(e={}),{name:"shift",options:e,fn:function(t){return Fa(Na().mark((function n(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.x,o=t.y,a=t.placement,s=pk(e,t),u=s.mainAxis,l=void 0===u||u,c=s.crossAxis,d=void 0!==c&&c,f=s.limiter,p=void 0===f?{fn:function(e){return{x:e.x,y:e.y}}}:f,h=gt(s,Tk),v={x:i,y:o},n.next=5,Ok(t,h);case 5:return g=n.sent,m=yk(hk(a)),y=gk(m),b=v[y],w=v[m],l&&(x="y"===y?"bottom":"right",k=b+g["y"===y?"top":"left"],S=b-g[x],b=fk(k,b,S)),d&&(_="y"===m?"bottom":"right",P=w+g["y"===m?"top":"left"],E=w-g[_],w=fk(P,w,E)),C=p.fn(Ce(Ce({},t),{},(z(r={},y,b),z(r,m,w),r))),n.abrupt("return",Ce(Ce({},C),{},{data:{x:C.x-i,y:C.y-o}}));case 14:case"end":return n.stop()}}),n)})))()}}},Wk=function(e){return void 0===e&&(e={}),{options:e,fn:function(t){var n,r=t.x,i=t.y,o=t.placement,a=t.rects,s=t.middlewareData,u=pk(e,t),l=u.offset,c=void 0===l?0:l,d=u.mainAxis,f=void 0===d||d,p=u.crossAxis,h=void 0===p||p,v={x:r,y:i},g=yk(o),m=gk(g),y=v[m],b=v[g],w=pk(c,t),x="number"===typeof w?{mainAxis:w,crossAxis:0}:Ce({mainAxis:0,crossAxis:0},w);if(f){var k="y"===m?"height":"width",S=a.reference[m]-a.floating[k]+x.mainAxis,_=a.reference[m]+a.reference[k]-x.mainAxis;y<S?y=S:y>_&&(y=_)}if(h){var P,E,C="y"===m?"width":"height",I=["top","left"].includes(hk(o)),T=a.reference[g]-a.floating[C]+(I&&(null==(P=s.offset)?void 0:P[g])||0)+(I?0:x.crossAxis),M=a.reference[g]+a.reference[C]+(I?0:(null==(E=s.offset)?void 0:E[g])||0)-(I?x.crossAxis:0);b<T?b=T:b>M&&(b=M)}return z(n={},m,y),z(n,g,b),n}}},Hk=function(e){return void 0===e&&(e={}),{name:"size",options:e,fn:function(t){return Fa(Na().mark((function n(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T,M,j;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.placement,i=t.rects,o=t.platform,a=t.elements,s=pk(e,t),u=s.apply,l=void 0===u?function(){}:u,c=gt(s,Mk),n.next=4,Ok(t,c);case 4:if(d=n.sent,f=hk(r),p=vk(r),h="y"===yk(r),v=i.floating,g=v.width,m=v.height,"top"!==f&&"bottom"!==f){n.next=28;break}return y=f,n.t0=p,n.next=14,null==o.isRTL?void 0:o.isRTL(a.floating);case 14:if(!n.sent){n.next=18;break}n.t1="start",n.next=19;break;case 18:n.t1="end";case 19:if(n.t2=n.t1,n.t0!==n.t2){n.next=24;break}n.t3="left",n.next=25;break;case 24:n.t3="right";case 25:b=n.t3,n.next=30;break;case 28:b=f,y="end"===p?"top":"bottom";case 30:return w=m-d[y],x=g-d[b],k=!t.middlewareData.shift,S=w,_=x,h?(P=g-d.left-d.right,_=p||k?ok(x,P):P):(E=m-d.top-d.bottom,S=p||k?ok(w,E):E),k&&!p&&(C=ak(d.left,0),I=ak(d.right,0),T=ak(d.top,0),M=ak(d.bottom,0),h?_=g-2*(0!==C||0!==I?C+I:ak(d.left,d.right)):S=m-2*(0!==T||0!==M?T+M:ak(d.top,d.bottom))),n.next=39,l(Ce(Ce({},t),{},{availableWidth:_,availableHeight:S}));case 39:return n.next=41,o.getDimensions(a.floating);case 41:if(j=n.sent,g===j.width&&m===j.height){n.next=44;break}return n.abrupt("return",{reset:{rects:!0}});case 44:return n.abrupt("return",{});case 45:case"end":return n.stop()}}),n)})))()}}};function Yk(e){return $k(e)?(e.nodeName||"").toLowerCase():"#document"}function Xk(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function qk(e){var t;return null==(t=($k(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function $k(e){return e instanceof Node||e instanceof Xk(e).Node}function Gk(e){return e instanceof Element||e instanceof Xk(e).Element}function Qk(e){return e instanceof HTMLElement||e instanceof Xk(e).HTMLElement}function Zk(e){return"undefined"!==typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof Xk(e).ShadowRoot)}function Jk(e){var t=iS(e),n=t.overflow,r=t.overflowX,i=t.overflowY,o=t.display;return/auto|scroll|overlay|hidden|clip/.test(n+i+r)&&!["inline","contents"].includes(o)}function eS(e){return["table","td","th"].includes(Yk(e))}function tS(e){var t=nS(),n=iS(e);return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some((function(e){return(n.willChange||"").includes(e)}))||["paint","layout","strict","content"].some((function(e){return(n.contain||"").includes(e)}))}function nS(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function rS(e){return["html","body","#document"].includes(Yk(e))}function iS(e){return Xk(e).getComputedStyle(e)}function oS(e){return Gk(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function aS(e){if("html"===Yk(e))return e;var t=e.assignedSlot||e.parentNode||Zk(e)&&e.host||qk(e);return Zk(t)?t.host:t}function sS(e){var t=aS(e);return rS(t)?e.ownerDocument?e.ownerDocument.body:e.body:Qk(t)&&Jk(t)?t:sS(t)}function uS(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);var i=sS(e),o=i===(null==(r=e.ownerDocument)?void 0:r.body),a=Xk(i);return o?t.concat(a,a.visualViewport||[],Jk(i)?i:[],a.frameElement&&n?uS(a.frameElement):[]):t.concat(i,uS(i,[],n))}function lS(e){var t=iS(e),n=parseFloat(t.width)||0,r=parseFloat(t.height)||0,i=Qk(e),o=i?e.offsetWidth:n,a=i?e.offsetHeight:r,s=sk(n)!==o||sk(r)!==a;return s&&(n=o,r=a),{width:n,height:r,$:s}}function cS(e){return Gk(e)?e:e.contextElement}function dS(e){var t=cS(e);if(!Qk(t))return lk(1);var n=t.getBoundingClientRect(),r=lS(t),i=r.width,o=r.height,a=r.$,s=(a?sk(n.width):n.width)/i,u=(a?sk(n.height):n.height)/o;return s&&Number.isFinite(s)||(s=1),u&&Number.isFinite(u)||(u=1),{x:s,y:u}}var fS=lk(0);function pS(e){var t=Xk(e);return nS()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:fS}function hS(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);var i=e.getBoundingClientRect(),o=cS(e),a=lk(1);t&&(r?Gk(r)&&(a=dS(r)):a=dS(e));var s=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==Xk(e))&&t}(o,n,r)?pS(o):lk(0),u=(i.left+s.x)/a.x,l=(i.top+s.y)/a.y,c=i.width/a.x,d=i.height/a.y;if(o)for(var f=Xk(o),p=r&&Gk(r)?Xk(r):r,h=f.frameElement;h&&r&&p!==f;){var v=dS(h),g=h.getBoundingClientRect(),m=iS(h),y=g.left+(h.clientLeft+parseFloat(m.paddingLeft))*v.x,b=g.top+(h.clientTop+parseFloat(m.paddingTop))*v.y;u*=v.x,l*=v.y,c*=v.x,d*=v.y,u+=y,l+=b,h=Xk(h).frameElement}return Ek({width:c,height:d,x:u,y:l})}function vS(e){return hS(qk(e)).left+oS(e).scrollLeft}function gS(e,t,n){var r;if("viewport"===t)r=function(e,t){var n=Xk(e),r=qk(e),i=n.visualViewport,o=r.clientWidth,a=r.clientHeight,s=0,u=0;if(i){o=i.width,a=i.height;var l=nS();(!l||l&&"fixed"===t)&&(s=i.offsetLeft,u=i.offsetTop)}return{width:o,height:a,x:s,y:u}}(e,n);else if("document"===t)r=function(e){var t=qk(e),n=oS(e),r=e.ownerDocument.body,i=ak(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=ak(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight),a=-n.scrollLeft+vS(e),s=-n.scrollTop;return"rtl"===iS(r).direction&&(a+=ak(t.clientWidth,r.clientWidth)-i),{width:i,height:o,x:a,y:s}}(qk(e));else if(Gk(t))r=function(e,t){var n=hS(e,!0,"fixed"===t),r=n.top+e.clientTop,i=n.left+e.clientLeft,o=Qk(e)?dS(e):lk(1);return{width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:i*o.x,y:r*o.y}}(t,n);else{var i=pS(e);r=Ce(Ce({},t),{},{x:t.x-i.x,y:t.y-i.y})}return Ek(r)}function mS(e,t){var n=aS(e);return!(n===t||!Gk(n)||rS(n))&&("fixed"===iS(n).position||mS(n,t))}function yS(e,t,n){var r=Qk(t),i=qk(t),o="fixed"===n,a=hS(e,!0,o,t),s={scrollLeft:0,scrollTop:0},u=lk(0);if(r||!r&&!o)if(("body"!==Yk(t)||Jk(i))&&(s=oS(t)),r){var l=hS(t,!0,o,t);u.x=l.x+t.clientLeft,u.y=l.y+t.clientTop}else i&&(u.x=vS(i));return{x:a.left+s.scrollLeft-u.x,y:a.top+s.scrollTop-u.y,width:a.width,height:a.height}}function bS(e,t){return Qk(e)&&"fixed"!==iS(e).position?t?t(e):e.offsetParent:null}function wS(e,t){var n=Xk(e);if(!Qk(e))return n;for(var r=bS(e,t);r&&eS(r)&&"static"===iS(r).position;)r=bS(r,t);return r&&("html"===Yk(r)||"body"===Yk(r)&&"static"===iS(r).position&&!tS(r))?n:r||function(e){for(var t=aS(e);Qk(t)&&!rS(t);){if(tS(t))return t;t=aS(t)}return null}(e)||n}var xS=function(){var e=Fa(Na().mark((function e(t){var n,r,i,o,a;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.reference,r=t.floating,i=t.strategy,o=this.getOffsetParent||wS,a=this.getDimensions,e.t0=yS,e.t1=n,e.next=7,o(r);case 7:return e.t2=e.sent,e.t3=i,e.t4=(0,e.t0)(e.t1,e.t2,e.t3),e.t5=Ce,e.t6={x:0,y:0},e.next=14,a(r);case 14:return e.t7=e.sent,e.t8=(0,e.t5)(e.t6,e.t7),e.abrupt("return",{reference:e.t4,floating:e.t8});case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();var kS={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){var t=e.rect,n=e.offsetParent,r=e.strategy,i=Qk(n),o=qk(n);if(n===o)return t;var a={scrollLeft:0,scrollTop:0},s=lk(1),u=lk(0);if((i||!i&&"fixed"!==r)&&(("body"!==Yk(n)||Jk(o))&&(a=oS(n)),Qk(n))){var l=hS(n);s=dS(n),u.x=l.x+n.clientLeft,u.y=l.y+n.clientTop}return{width:t.width*s.x,height:t.height*s.y,x:t.x*s.x-a.scrollLeft*s.x+u.x,y:t.y*s.y-a.scrollTop*s.y+u.y}},getDocumentElement:qk,getClippingRect:function(e){var t=e.element,n=e.boundary,r=e.rootBoundary,i=e.strategy,o="clippingAncestors"===n?function(e,t){var n=t.get(e);if(n)return n;for(var r=uS(e,[],!1).filter((function(e){return Gk(e)&&"body"!==Yk(e)})),i=null,o="fixed"===iS(e).position,a=o?aS(e):e;Gk(a)&&!rS(a);){var s=iS(a),u=tS(a);u||"fixed"!==s.position||(i=null),(o?!u&&!i:!u&&"static"===s.position&&i&&["absolute","fixed"].includes(i.position)||Jk(a)&&!u&&mS(e,a))?r=r.filter((function(e){return e!==a})):i=s,a=aS(a)}return t.set(e,r),r}(t,this._c):[].concat(n),a=[].concat(u(o),[r]),s=a[0],l=a.reduce((function(e,n){var r=gS(t,n,i);return e.top=ak(r.top,e.top),e.right=ok(r.right,e.right),e.bottom=ok(r.bottom,e.bottom),e.left=ak(r.left,e.left),e}),gS(t,s,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:wS,getElementRects:xS,getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){return lS(e)},getScale:dS,isElement:Gk,isRTL:function(e){return"rtl"===iS(e).direction}};function SS(e,t,n,r){void 0===r&&(r={});var i=r,o=i.ancestorScroll,a=void 0===o||o,s=i.ancestorResize,l=void 0===s||s,c=i.elementResize,d=void 0===c?"function"===typeof ResizeObserver:c,f=i.layoutShift,p=void 0===f?"function"===typeof IntersectionObserver:f,h=i.animationFrame,v=void 0!==h&&h,g=cS(e),m=a||l?[].concat(u(g?uS(g):[]),u(uS(t))):[];m.forEach((function(e){a&&e.addEventListener("scroll",n,{passive:!0}),l&&e.addEventListener("resize",n)}));var y,b=g&&p?function(e,t){var n,r=null,i=qk(e);function o(){clearTimeout(n),r&&r.disconnect(),r=null}return function a(s,u){void 0===s&&(s=!1),void 0===u&&(u=1),o();var l=e.getBoundingClientRect(),c=l.left,d=l.top,f=l.width,p=l.height;if(s||t(),f&&p){var h={rootMargin:-uk(d)+"px "+-uk(i.clientWidth-(c+f))+"px "+-uk(i.clientHeight-(d+p))+"px "+-uk(c)+"px",threshold:ak(0,ok(1,u))||1},v=!0;try{r=new IntersectionObserver(g,Ce(Ce({},h),{},{root:i.ownerDocument}))}catch(ej){r=new IntersectionObserver(g,h)}r.observe(e)}function g(e){var t=e[0].intersectionRatio;if(t!==u){if(!v)return a();t?a(!1,t):n=setTimeout((function(){a(!1,1e-7)}),100)}v=!1}}(!0),o}(g,n):null,w=-1,x=null;d&&(x=new ResizeObserver((function(e){var r=G(e,1)[0];r&&r.target===g&&x&&(x.unobserve(t),cancelAnimationFrame(w),w=requestAnimationFrame((function(){x&&x.observe(t)}))),n()})),g&&!v&&x.observe(g),x.observe(t));var k=v?hS(e):null;return v&&function t(){var r=hS(e);!k||r.x===k.x&&r.y===k.y&&r.width===k.width&&r.height===k.height||n();k=r,y=requestAnimationFrame(t)}(),n(),function(){m.forEach((function(e){a&&e.removeEventListener("scroll",n),l&&e.removeEventListener("resize",n)})),b&&b(),x&&x.disconnect(),x=null,v&&cancelAnimationFrame(y)}}var _S=function(e,t,n){var r=new Map,i=Ce({platform:kS},n),o=Ce(Ce({},i.platform),{},{_c:r});return Ak(e,t,Ce(Ce({},i),{},{platform:o}))},PS=function(e){return{name:"arrow",options:e,fn:function(t){var n,r="function"===typeof e?e(t):e,i=r.element,o=r.padding;return i&&(n=i,{}.hasOwnProperty.call(n,"current"))?null!=i.current?zk({element:i.current,padding:o}).fn(t):{}:i?zk({element:i,padding:o}).fn(t):{}}}},ES="undefined"!==typeof document?t.useLayoutEffect:t.useEffect;function CS(e,t){if(e===t)return!0;if(typeof e!==typeof t)return!1;if("function"===typeof e&&e.toString()===t.toString())return!0;var n,r,i;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((n=e.length)!=t.length)return!1;for(r=n;0!==r--;)if(!CS(e[r],t[r]))return!1;return!0}if((n=(i=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(r=n;0!==r--;)if(!{}.hasOwnProperty.call(t,i[r]))return!1;for(r=n;0!==r--;){var o=i[r];if(("_owner"!==o||!e.$$typeof)&&!CS(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function IS(e){return"undefined"===typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function TS(e,t){var n=IS(e);return Math.round(t*n)/n}function MS(e){var n=t.useRef(e);return ES((function(){n.current=e})),n}function jS(e){var n=G((0,t.useState)(void 0),2),r=n[0],i=n[1];return ab((function(){if(e){i({width:e.offsetWidth,height:e.offsetHeight});var t=new ResizeObserver((function(t){if(Array.isArray(t)&&t.length){var n,r,o=t[0];if("borderBoxSize"in o){var a=o.borderBoxSize,s=Array.isArray(a)?a[0]:a;n=s.inlineSize,r=s.blockSize}else n=e.offsetWidth,r=e.offsetHeight;i({width:n,height:r})}}));return t.observe(e,{box:"border-box"}),function(){return t.unobserve(e)}}i(void 0)}),[e]),r}var AS=["__scopePopper","virtualRef"],OS=["__scopePopper","side","sideOffset","align","alignOffset","arrowPadding","avoidCollisions","collisionBoundary","collisionPadding","sticky","hideWhenDetached","updatePositionStrategy","onPlaced"],LS="Popper",zS=G(ib(LS),2),DS=zS[0],RS=zS[1],NS=G(DS(LS),2),BS=NS[0],FS=NS[1],US=function(e){var n=e.__scopePopper,r=e.children,i=G((0,t.useState)(null),2),o=i[0],a=i[1];return(0,t.createElement)(BS,{scope:n,anchor:o,onAnchorChange:a},r)},KS="PopperAnchor",VS=(0,t.forwardRef)((function(e,n){var r=e.__scopePopper,i=e.virtualRef,o=gt(e,AS),a=FS(KS,r),s=(0,t.useRef)(null),u=tb(n,s);return(0,t.useEffect)((function(){a.onAnchorChange((null===i||void 0===i?void 0:i.current)||s.current)})),i?null:(0,t.createElement)(wb.div,Zy({},o,{ref:u}))})),WS="PopperContent",HS=G(DS(WS),2),YS=HS[0],XS=(HS[1],(0,t.forwardRef)((function(e,n){var r,i,o,a,s,u,l,c,d=e.__scopePopper,f=e.side,p=void 0===f?"bottom":f,h=e.sideOffset,v=void 0===h?0:h,g=e.align,m=void 0===g?"center":g,y=e.alignOffset,b=void 0===y?0:y,w=e.arrowPadding,x=void 0===w?0:w,k=e.avoidCollisions,S=void 0===k||k,_=e.collisionBoundary,P=void 0===_?[]:_,E=e.collisionPadding,C=void 0===E?0:E,I=e.sticky,T=void 0===I?"partial":I,M=e.hideWhenDetached,j=void 0!==M&&M,A=e.updatePositionStrategy,O=void 0===A?"optimized":A,L=e.onPlaced,D=gt(e,OS),R=FS(WS,d),N=G((0,t.useState)(null),2),B=N[0],F=N[1],U=tb(n,(function(e){return F(e)})),K=G((0,t.useState)(null),2),V=K[0],W=K[1],H=jS(V),Y=null!==(r=null===H||void 0===H?void 0:H.width)&&void 0!==r?r:0,X=null!==(i=null===H||void 0===H?void 0:H.height)&&void 0!==i?i:0,q=p+("center"!==m?"-"+m:""),$="number"===typeof C?C:Ce({top:0,right:0,bottom:0,left:0},C),Q=Array.isArray(P)?P:[P],Z=Q.length>0,J={padding:$,boundary:Q.filter(qS),altBoundary:Z},ee=function(e){void 0===e&&(e={});var n=e,r=n.placement,i=void 0===r?"bottom":r,o=n.strategy,a=void 0===o?"absolute":o,s=n.middleware,u=void 0===s?[]:s,l=n.platform,c=n.elements,d=void 0===c?{}:c,f=d.reference,p=d.floating,h=n.transform,v=void 0===h||h,g=n.whileElementsMounted,m=n.open,y=G(t.useState({x:0,y:0,strategy:a,placement:i,middlewareData:{},isPositioned:!1}),2),b=y[0],w=y[1],x=G(t.useState(u),2),k=x[0],S=x[1];CS(k,u)||S(u);var _=G(t.useState(null),2),P=_[0],E=_[1],C=G(t.useState(null),2),I=C[0],T=C[1],M=t.useCallback((function(e){e!=L.current&&(L.current=e,E(e))}),[E]),j=t.useCallback((function(e){e!==z.current&&(z.current=e,T(e))}),[T]),A=f||P,O=p||I,L=t.useRef(null),z=t.useRef(null),D=t.useRef(b),R=MS(g),N=MS(l),B=t.useCallback((function(){if(L.current&&z.current){var e={placement:i,strategy:a,middleware:k};N.current&&(e.platform=N.current),_S(L.current,z.current,e).then((function(e){var t=Ce(Ce({},e),{},{isPositioned:!0});F.current&&!CS(D.current,t)&&(D.current=t,fb.flushSync((function(){w(t)})))}))}}),[k,i,a,N]);ES((function(){!1===m&&D.current.isPositioned&&(D.current.isPositioned=!1,w((function(e){return Ce(Ce({},e),{},{isPositioned:!1})})))}),[m]);var F=t.useRef(!1);ES((function(){return F.current=!0,function(){F.current=!1}}),[]),ES((function(){if(A&&(L.current=A),O&&(z.current=O),A&&O){if(R.current)return R.current(A,O,B);B()}}),[A,O,B,R]);var U=t.useMemo((function(){return{reference:L,floating:z,setReference:M,setFloating:j}}),[M,j]),K=t.useMemo((function(){return{reference:A,floating:O}}),[A,O]),V=t.useMemo((function(){var e={position:a,left:0,top:0};if(!K.floating)return e;var t=TS(K.floating,b.x),n=TS(K.floating,b.y);return v?Ce(Ce({},e),{},{transform:"translate("+t+"px, "+n+"px)"},IS(K.floating)>=1.5&&{willChange:"transform"}):{position:a,left:t,top:n}}),[a,v,K.floating,b.x,b.y]);return t.useMemo((function(){return Ce(Ce({},b),{},{update:B,refs:U,elements:K,floatingStyles:V})}),[b,B,U,K,V])}({strategy:"fixed",placement:q,whileElementsMounted:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return SS.apply(void 0,t.concat([{animationFrame:"always"===O}]))},elements:{reference:R.anchor},middleware:[Kk({mainAxis:v+X,alignmentAxis:b}),S&&Vk(Ce({mainAxis:!0,crossAxis:!1,limiter:"partial"===T?Wk():void 0},J)),S&&Dk(Ce({},J)),Hk(Ce(Ce({},J),{},{apply:function(e){var t=e.elements,n=e.rects,r=e.availableWidth,i=e.availableHeight,o=n.reference,a=o.width,s=o.height,u=t.floating.style;u.setProperty("--radix-popper-available-width","".concat(r,"px")),u.setProperty("--radix-popper-available-height","".concat(i,"px")),u.setProperty("--radix-popper-anchor-width","".concat(a,"px")),u.setProperty("--radix-popper-anchor-height","".concat(s,"px"))}})),V&&PS({element:V,padding:x}),$S({arrowWidth:Y,arrowHeight:X}),j&&Bk(Ce({strategy:"referenceHidden"},J))]}),te=ee.refs,ne=ee.floatingStyles,re=ee.placement,ie=ee.isPositioned,oe=ee.middlewareData,ae=G(GS(re),2),se=ae[0],ue=ae[1],le=cb(L);ab((function(){ie&&(null===le||void 0===le||le())}),[ie,le]);var ce=null===(o=oe.arrow)||void 0===o?void 0:o.x,de=null===(a=oe.arrow)||void 0===a?void 0:a.y,fe=0!==(null===(s=oe.arrow)||void 0===s?void 0:s.centerOffset),pe=G((0,t.useState)(),2),he=pe[0],ve=pe[1];return ab((function(){B&&ve(window.getComputedStyle(B).zIndex)}),[B]),(0,t.createElement)("div",{ref:te.setFloating,"data-radix-popper-content-wrapper":"",style:Ce(Ce({},ne),{},z({transform:ie?ne.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:he},"--radix-popper-transform-origin",[null===(u=oe.transformOrigin)||void 0===u?void 0:u.x,null===(l=oe.transformOrigin)||void 0===l?void 0:l.y].join(" "))),dir:e.dir},(0,t.createElement)(YS,{scope:d,placedSide:se,onArrowChange:W,arrowX:ce,arrowY:de,shouldHideArrow:fe},(0,t.createElement)(wb.div,Zy({"data-side":se,"data-align":ue},D,{ref:U,style:Ce(Ce({},D.style),{},{animation:ie?void 0:"none",opacity:null!==(c=oe.hide)&&void 0!==c&&c.referenceHidden?0:void 0})}))))})));function qS(e){return null!==e}var $S=function(e){return{name:"transformOrigin",options:e,fn:function(t){var n,r,i,o,a,s=t.placement,u=t.rects,l=t.middlewareData,c=0!==(null===(n=l.arrow)||void 0===n?void 0:n.centerOffset),d=c?0:e.arrowWidth,f=c?0:e.arrowHeight,p=G(GS(s),2),h=p[0],v={start:"0%",center:"50%",end:"100%"}[p[1]],g=(null!==(r=null===(i=l.arrow)||void 0===i?void 0:i.x)&&void 0!==r?r:0)+d/2,m=(null!==(o=null===(a=l.arrow)||void 0===a?void 0:a.y)&&void 0!==o?o:0)+f/2,y="",b="";return"bottom"===h?(y=c?v:"".concat(g,"px"),b="".concat(-f,"px")):"top"===h?(y=c?v:"".concat(g,"px"),b="".concat(u.floating.height+f,"px")):"right"===h?(y="".concat(-f,"px"),b=c?v:"".concat(m,"px")):"left"===h&&(y="".concat(u.floating.width+f,"px"),b=c?v:"".concat(m,"px")),{data:{x:y,y:b}}}}};function GS(e){var t=G(e.split("-"),2),n=t[0],r=t[1];return[n,void 0===r?"center":r]}var QS=US,ZS=VS,JS=XS,e_=["__scopeRovingFocusGroup","orientation","loop","dir","currentTabStopId","defaultCurrentTabStopId","onCurrentTabStopIdChange","onEntryFocus"],t_=["__scopeRovingFocusGroup","focusable","active","tabStopId"],n_="rovingFocusGroup.onEntryFocus",r_={bubbles:!1,cancelable:!0},i_="RovingFocusGroup",o_=G(tk(i_),3),a_=o_[0],s_=o_[1],u_=G(ib(i_,[o_[2]]),2),l_=u_[0],c_=u_[1],d_=G(l_(i_),2),f_=d_[0],p_=d_[1],h_=(0,t.forwardRef)((function(e,n){return(0,t.createElement)(a_.Provider,{scope:e.__scopeRovingFocusGroup},(0,t.createElement)(a_.Slot,{scope:e.__scopeRovingFocusGroup},(0,t.createElement)(v_,Zy({},e,{ref:n}))))})),v_=(0,t.forwardRef)((function(e,n){var r=e.__scopeRovingFocusGroup,i=e.orientation,o=e.loop,a=void 0!==o&&o,s=e.dir,l=e.currentTabStopId,c=e.defaultCurrentTabStopId,d=e.onCurrentTabStopIdChange,f=e.onEntryFocus,p=gt(e,e_),h=(0,t.useRef)(null),v=tb(n,h),g=rk(s),m=G(db({prop:l,defaultProp:c,onChange:d}),2),y=m[0],b=void 0===y?null:y,w=m[1],x=G((0,t.useState)(!1),2),k=x[0],S=x[1],_=cb(f),P=s_(r),E=(0,t.useRef)(!1),C=G((0,t.useState)(0),2),I=C[0],T=C[1];return(0,t.useEffect)((function(){var e=h.current;if(e)return e.addEventListener(n_,_),function(){return e.removeEventListener(n_,_)}}),[_]),(0,t.createElement)(f_,{scope:r,orientation:i,dir:g,loop:a,currentTabStopId:b,onItemFocus:(0,t.useCallback)((function(e){return w(e)}),[w]),onItemShiftTab:(0,t.useCallback)((function(){return S(!0)}),[]),onFocusableItemAdd:(0,t.useCallback)((function(){return T((function(e){return e+1}))}),[]),onFocusableItemRemove:(0,t.useCallback)((function(){return T((function(e){return e-1}))}),[])},(0,t.createElement)(wb.div,Zy({tabIndex:k||0===I?-1:0,"data-orientation":i},p,{ref:v,style:Ce({outline:"none"},e.style),onMouseDown:Jy(e.onMouseDown,(function(){E.current=!0})),onFocus:Jy(e.onFocus,(function(e){var t=!E.current;if(e.target===e.currentTarget&&t&&!k){var n=new CustomEvent(n_,r_);if(e.currentTarget.dispatchEvent(n),!n.defaultPrevented){var r=P().filter((function(e){return e.focusable}));b_([r.find((function(e){return e.active})),r.find((function(e){return e.id===b}))].concat(u(r)).filter(Boolean).map((function(e){return e.ref.current})))}}E.current=!1})),onBlur:Jy(e.onBlur,(function(){return S(!1)}))})))})),g_="RovingFocusGroupItem",m_=(0,t.forwardRef)((function(e,n){var r=e.__scopeRovingFocusGroup,i=e.focusable,o=void 0===i||i,a=e.active,s=void 0!==a&&a,u=e.tabStopId,l=gt(e,t_),c=lb(),d=u||c,f=p_(g_,r),p=f.currentTabStopId===d,h=s_(r),v=f.onFocusableItemAdd,g=f.onFocusableItemRemove;return(0,t.useEffect)((function(){if(o)return v(),function(){return g()}}),[o,v,g]),(0,t.createElement)(a_.ItemSlot,{scope:r,id:d,focusable:o,active:s},(0,t.createElement)(wb.span,Zy({tabIndex:p?0:-1,"data-orientation":f.orientation},l,{ref:n,onMouseDown:Jy(e.onMouseDown,(function(e){o?f.onItemFocus(d):e.preventDefault()})),onFocus:Jy(e.onFocus,(function(){return f.onItemFocus(d)})),onKeyDown:Jy(e.onKeyDown,(function(e){if("Tab"===e.key&&e.shiftKey)f.onItemShiftTab();else if(e.target===e.currentTarget){var t=function(e,t,n){var r=function(e,t){return"rtl"!==t?e:"ArrowLeft"===e?"ArrowRight":"ArrowRight"===e?"ArrowLeft":e}(e.key,n);return"vertical"===t&&["ArrowLeft","ArrowRight"].includes(r)||"horizontal"===t&&["ArrowUp","ArrowDown"].includes(r)?void 0:y_[r]}(e,f.orientation,f.dir);if(void 0!==t){e.preventDefault();var n=h().filter((function(e){return e.focusable})).map((function(e){return e.ref.current}));if("last"===t)n.reverse();else if("prev"===t||"next"===t){"prev"===t&&n.reverse();var r=n.indexOf(e.currentTarget);n=f.loop?function(e,t){return e.map((function(n,r){return e[(t+r)%e.length]}))}(n,r+1):n.slice(r+1)}setTimeout((function(){return b_(n)}))}}}))})))})),y_={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function b_(e){var t,n=document.activeElement,r=J(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i===n)return;if(i.focus(),document.activeElement!==n)return}}catch(hD){r.e(hD)}finally{r.f()}}var w_=h_,x_=m_,k_=["__scopeMenu"],S_=["forceMount"],__=["__scopeMenu","loop","trapFocus","onOpenAutoFocus","onCloseAutoFocus","disableOutsidePointerEvents","onEntryFocus","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss","disableOutsideScroll"],P_=["__scopeMenu"],E_=["disabled","onSelect"],C_=["__scopeMenu","disabled","textValue"],I_=["checked","onCheckedChange"],T_=["__scopeMenu","forceMount"],M_=["forceMount"],j_=["Enter"," "],A_=["ArrowUp","PageDown","End"],O_=[].concat(["ArrowDown","PageUp","Home"],A_),L_={ltr:[].concat(j_,["ArrowRight"]),rtl:[].concat(j_,["ArrowLeft"])},z_={ltr:["ArrowLeft"],rtl:["ArrowRight"]},D_="Menu",R_=G(tk(D_),3),N_=R_[0],B_=R_[1],F_=G(ib(D_,[R_[2],RS,c_]),2),U_=F_[0],K_=F_[1],V_=RS(),W_=c_(),H_=G(U_(D_),2),Y_=H_[0],X_=H_[1],q_=G(U_(D_),2),$_=q_[0],G_=q_[1],Q_=function(e){var n=e.__scopeMenu,r=e.open,i=void 0!==r&&r,o=e.children,a=e.dir,s=e.onOpenChange,u=e.modal,l=void 0===u||u,c=V_(n),d=G((0,t.useState)(null),2),f=d[0],p=d[1],h=(0,t.useRef)(!1),v=cb(s),g=rk(a);return(0,t.useEffect)((function(){var e=function(){h.current=!0,document.addEventListener("pointerdown",t,{capture:!0,once:!0}),document.addEventListener("pointermove",t,{capture:!0,once:!0})},t=function(){return h.current=!1};return document.addEventListener("keydown",e,{capture:!0}),function(){document.removeEventListener("keydown",e,{capture:!0}),document.removeEventListener("pointerdown",t,{capture:!0}),document.removeEventListener("pointermove",t,{capture:!0})}}),[]),(0,t.createElement)(QS,c,(0,t.createElement)(Y_,{scope:n,open:i,onOpenChange:v,content:f,onContentChange:p},(0,t.createElement)($_,{scope:n,onClose:(0,t.useCallback)((function(){return v(!1)}),[v]),isUsingKeyboardRef:h,dir:g,modal:l},o)))},Z_=(0,t.forwardRef)((function(e,n){var r=e.__scopeMenu,i=gt(e,k_),o=V_(r);return(0,t.createElement)(ZS,Zy({},o,i,{ref:n}))})),J_="MenuPortal",eP=G(U_(J_,{forceMount:void 0}),2),tP=eP[0],nP=eP[1],rP=function(e){var n=e.__scopeMenu,r=e.forceMount,i=e.children,o=e.container,a=X_(J_,n);return(0,t.createElement)(tP,{scope:n,forceMount:r},(0,t.createElement)(Xb,{present:r||a.open},(0,t.createElement)(Yb,{asChild:!0,container:o},i)))},iP="MenuContent",oP=G(U_(iP),2),aP=oP[0],sP=oP[1],uP=(0,t.forwardRef)((function(e,n){var r=nP(iP,e.__scopeMenu),i=e.forceMount,o=void 0===i?r.forceMount:i,a=gt(e,S_),s=X_(iP,e.__scopeMenu),u=G_(iP,e.__scopeMenu);return(0,t.createElement)(N_.Provider,{scope:e.__scopeMenu},(0,t.createElement)(Xb,{present:o||s.open},(0,t.createElement)(N_.Slot,{scope:e.__scopeMenu},u.modal?(0,t.createElement)(lP,Zy({},a,{ref:n})):(0,t.createElement)(cP,Zy({},a,{ref:n})))))})),lP=(0,t.forwardRef)((function(e,n){var r=X_(iP,e.__scopeMenu),i=(0,t.useRef)(null),o=tb(n,i);return(0,t.useEffect)((function(){var e=i.current;if(e)return Ww(e)}),[]),(0,t.createElement)(dP,Zy({},e,{ref:o,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Jy(e.onFocusOutside,(function(e){return e.preventDefault()}),{checkForDefaultPrevented:!1}),onDismiss:function(){return r.onOpenChange(!1)}}))})),cP=(0,t.forwardRef)((function(e,n){var r=X_(iP,e.__scopeMenu);return(0,t.createElement)(dP,Zy({},e,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:function(){return r.onOpenChange(!1)}}))})),dP=(0,t.forwardRef)((function(e,n){var r=e.__scopeMenu,i=e.loop,o=void 0!==i&&i,a=e.trapFocus,s=e.onOpenAutoFocus,u=e.onCloseAutoFocus,l=e.disableOutsidePointerEvents,c=e.onEntryFocus,d=e.onEscapeKeyDown,f=e.onPointerDownOutside,p=e.onFocusOutside,h=e.onInteractOutside,v=e.onDismiss,g=e.disableOutsideScroll,m=gt(e,__),y=X_(iP,r),b=G_(iP,r),w=V_(r),x=W_(r),k=B_(r),S=G((0,t.useState)(null),2),_=S[0],P=S[1],E=(0,t.useRef)(null),C=tb(n,E,y.onContentChange),I=(0,t.useRef)(0),T=(0,t.useRef)(""),M=(0,t.useRef)(0),j=(0,t.useRef)(null),A=(0,t.useRef)("right"),O=(0,t.useRef)(0),L=g?Dw:t.Fragment,z=g?{as:vb,allowPinchZoom:!0}:void 0,D=function(e){var t,n,r=T.current+e,i=k().filter((function(e){return!e.disabled})),o=document.activeElement,a=null===(t=i.find((function(e){return e.ref.current===o})))||void 0===t?void 0:t.textValue,s=function(e,t,n){var r=t.length>1&&Array.from(t).every((function(e){return e===t[0]})),i=r?t[0]:t,o=n?e.indexOf(n):-1,a=function(e,t){return e.map((function(n,r){return e[(t+r)%e.length]}))}(e,Math.max(o,0));1===i.length&&(a=a.filter((function(e){return e!==n})));var s=a.find((function(e){return e.toLowerCase().startsWith(i.toLowerCase())}));return s!==n?s:void 0}(i.map((function(e){return e.textValue})),r,a),u=null===(n=i.find((function(e){return e.textValue===s})))||void 0===n?void 0:n.ref.current;!function e(t){T.current=t,window.clearTimeout(I.current),""!==t&&(I.current=window.setTimeout((function(){return e("")}),1e3))}(r),u&&setTimeout((function(){return u.focus()}))};(0,t.useEffect)((function(){return function(){return window.clearTimeout(I.current)}}),[]),Gb();var R=(0,t.useCallback)((function(e){var t,n;return A.current===(null===(t=j.current)||void 0===t?void 0:t.side)&&function(e,t){if(!t)return!1;var n={x:e.clientX,y:e.clientY};return function(e,t){for(var n=e.x,r=e.y,i=!1,o=0,a=t.length-1;o<t.length;a=o++){var s=t[o].x,u=t[o].y,l=t[a].x,c=t[a].y;u>r!==c>r&&n<(l-s)*(r-u)/(c-u)+s&&(i=!i)}return i}(n,t)}(e,null===(n=j.current)||void 0===n?void 0:n.area)}),[]);return(0,t.createElement)(aP,{scope:r,searchRef:T,onItemEnter:(0,t.useCallback)((function(e){R(e)&&e.preventDefault()}),[R]),onItemLeave:(0,t.useCallback)((function(e){var t;R(e)||(null===(t=E.current)||void 0===t||t.focus(),P(null))}),[R]),onTriggerLeave:(0,t.useCallback)((function(e){R(e)&&e.preventDefault()}),[R]),pointerGraceTimerRef:M,onPointerGraceIntentChange:(0,t.useCallback)((function(e){j.current=e}),[])},(0,t.createElement)(L,z,(0,t.createElement)(Nb,{asChild:!0,trapped:a,onMountAutoFocus:Jy(s,(function(e){var t;e.preventDefault(),null===(t=E.current)||void 0===t||t.focus()})),onUnmountAutoFocus:u},(0,t.createElement)(Ib,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:f,onFocusOutside:p,onInteractOutside:h,onDismiss:v},(0,t.createElement)(w_,Zy({asChild:!0},x,{dir:b.dir,orientation:"vertical",loop:o,currentTabStopId:_,onCurrentTabStopIdChange:P,onEntryFocus:Jy(c,(function(e){b.isUsingKeyboardRef.current||e.preventDefault()}))}),(0,t.createElement)(JS,Zy({role:"menu","aria-orientation":"vertical","data-state":LP(y.open),"data-radix-menu-content":"",dir:b.dir},w,m,{ref:C,style:Ce({outline:"none"},m.style),onKeyDown:Jy(m.onKeyDown,(function(e){var t=e.target.closest("[data-radix-menu-content]")===e.currentTarget,n=e.ctrlKey||e.altKey||e.metaKey,r=1===e.key.length;t&&("Tab"===e.key&&e.preventDefault(),!n&&r&&D(e.key));var i=E.current;if(e.target===i&&O_.includes(e.key)){e.preventDefault();var o=k().filter((function(e){return!e.disabled})).map((function(e){return e.ref.current}));A_.includes(e.key)&&o.reverse(),function(e){var t,n=document.activeElement,r=J(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i===n)return;if(i.focus(),document.activeElement!==n)return}}catch(hD){r.e(hD)}finally{r.f()}}(o)}})),onBlur:Jy(e.onBlur,(function(e){e.currentTarget.contains(e.target)||(window.clearTimeout(I.current),T.current="")})),onPointerMove:Jy(e.onPointerMove,RP((function(e){var t=e.target,n=O.current!==e.clientX;if(e.currentTarget.contains(t)&&n){var r=e.clientX>O.current?"right":"left";A.current=r,O.current=e.clientX}})))})))))))})),fP=(0,t.forwardRef)((function(e,n){e.__scopeMenu;var r=gt(e,P_);return(0,t.createElement)(wb.div,Zy({role:"group"},r,{ref:n}))})),pP="MenuItem",hP="menu.itemSelect",vP=(0,t.forwardRef)((function(e,n){var r=e.disabled,i=void 0!==r&&r,o=e.onSelect,a=gt(e,E_),s=(0,t.useRef)(null),u=G_(pP,e.__scopeMenu),l=sP(pP,e.__scopeMenu),c=tb(n,s),d=(0,t.useRef)(!1);return(0,t.createElement)(gP,Zy({},a,{ref:c,disabled:i,onClick:Jy(e.onClick,(function(){var e=s.current;if(!i&&e){var t=new CustomEvent(hP,{bubbles:!0,cancelable:!0});e.addEventListener(hP,(function(e){return null===o||void 0===o?void 0:o(e)}),{once:!0}),xb(e,t),t.defaultPrevented?d.current=!1:u.onClose()}})),onPointerDown:function(t){var n;null===(n=e.onPointerDown)||void 0===n||n.call(e,t),d.current=!0},onPointerUp:Jy(e.onPointerUp,(function(e){var t;d.current||null===(t=e.currentTarget)||void 0===t||t.click()})),onKeyDown:Jy(e.onKeyDown,(function(e){var t=""!==l.searchRef.current;i||t&&" "===e.key||j_.includes(e.key)&&(e.currentTarget.click(),e.preventDefault())}))}))})),gP=(0,t.forwardRef)((function(e,n){var r=e.__scopeMenu,i=e.disabled,o=void 0!==i&&i,a=e.textValue,s=gt(e,C_),u=sP(pP,r),l=W_(r),c=(0,t.useRef)(null),d=tb(n,c),f=G((0,t.useState)(!1),2),p=f[0],h=f[1],v=G((0,t.useState)(""),2),g=v[0],m=v[1];return(0,t.useEffect)((function(){var e,t=c.current;t&&m((null!==(e=t.textContent)&&void 0!==e?e:"").trim())}),[s.children]),(0,t.createElement)(N_.ItemSlot,{scope:r,disabled:o,textValue:null!==a&&void 0!==a?a:g},(0,t.createElement)(x_,Zy({asChild:!0},l,{focusable:!o}),(0,t.createElement)(wb.div,Zy({role:"menuitem","data-highlighted":p?"":void 0,"aria-disabled":o||void 0,"data-disabled":o?"":void 0},s,{ref:d,onPointerMove:Jy(e.onPointerMove,RP((function(e){o?u.onItemLeave(e):(u.onItemEnter(e),e.defaultPrevented||e.currentTarget.focus())}))),onPointerLeave:Jy(e.onPointerLeave,RP((function(e){return u.onItemLeave(e)}))),onFocus:Jy(e.onFocus,(function(){return h(!0)})),onBlur:Jy(e.onBlur,(function(){return h(!1)}))}))))})),mP=(0,t.forwardRef)((function(e,n){var r=e.checked,i=void 0!==r&&r,o=e.onCheckedChange,a=gt(e,I_);return(0,t.createElement)(kP,{scope:e.__scopeMenu,checked:i},(0,t.createElement)(vP,Zy({role:"menuitemcheckbox","aria-checked":zP(i)?"mixed":i},a,{ref:n,"data-state":DP(i),onSelect:Jy(a.onSelect,(function(){return null===o||void 0===o?void 0:o(!!zP(i)||!i)}),{checkForDefaultPrevented:!1})})))})),yP="MenuRadioGroup",bP=G(U_(yP,{value:void 0,onValueChange:function(){}}),2),wP=(bP[0],bP[1],"MenuItemIndicator"),xP=G(U_(wP,{checked:!1}),2),kP=xP[0],SP=xP[1],_P=(0,t.forwardRef)((function(e,n){var r=e.__scopeMenu,i=e.forceMount,o=gt(e,T_),a=SP(wP,r);return(0,t.createElement)(Xb,{present:i||zP(a.checked)||!0===a.checked},(0,t.createElement)(wb.span,Zy({},o,{ref:n,"data-state":DP(a.checked)})))})),PP="MenuSub",EP=G(U_(PP),2),CP=EP[0],IP=EP[1],TP=function(e){var n=e.__scopeMenu,r=e.children,i=e.open,o=void 0!==i&&i,a=e.onOpenChange,s=X_(PP,n),u=V_(n),l=G((0,t.useState)(null),2),c=l[0],d=l[1],f=G((0,t.useState)(null),2),p=f[0],h=f[1],v=cb(a);return(0,t.useEffect)((function(){return!1===s.open&&v(!1),function(){return v(!1)}}),[s.open,v]),(0,t.createElement)(QS,u,(0,t.createElement)(Y_,{scope:n,open:o,onOpenChange:v,content:p,onContentChange:h},(0,t.createElement)(CP,{scope:n,contentId:lb(),triggerId:lb(),trigger:c,onTriggerChange:d},r)))},MP="MenuSubTrigger",jP=(0,t.forwardRef)((function(e,n){var r=X_(MP,e.__scopeMenu),i=G_(MP,e.__scopeMenu),o=IP(MP,e.__scopeMenu),a=sP(MP,e.__scopeMenu),s=(0,t.useRef)(null),u=a.pointerGraceTimerRef,l=a.onPointerGraceIntentChange,c={__scopeMenu:e.__scopeMenu},d=(0,t.useCallback)((function(){s.current&&window.clearTimeout(s.current),s.current=null}),[]);return(0,t.useEffect)((function(){return d}),[d]),(0,t.useEffect)((function(){var e=u.current;return function(){window.clearTimeout(e),l(null)}}),[u,l]),(0,t.createElement)(Z_,Zy({asChild:!0},c),(0,t.createElement)(gP,Zy({id:o.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":o.contentId,"data-state":LP(r.open)},e,{ref:eb(n,o.onTriggerChange),onClick:function(t){var n;null===(n=e.onClick)||void 0===n||n.call(e,t),e.disabled||t.defaultPrevented||(t.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Jy(e.onPointerMove,RP((function(t){a.onItemEnter(t),t.defaultPrevented||e.disabled||r.open||s.current||(a.onPointerGraceIntentChange(null),s.current=window.setTimeout((function(){r.onOpenChange(!0),d()}),100))}))),onPointerLeave:Jy(e.onPointerLeave,RP((function(e){var t;d();var n=null===(t=r.content)||void 0===t?void 0:t.getBoundingClientRect();if(n){var i,o=null===(i=r.content)||void 0===i?void 0:i.dataset.side,s="right"===o,l=s?-5:5,c=n[s?"left":"right"],f=n[s?"right":"left"];a.onPointerGraceIntentChange({area:[{x:e.clientX+l,y:e.clientY},{x:c,y:n.top},{x:f,y:n.top},{x:f,y:n.bottom},{x:c,y:n.bottom}],side:o}),window.clearTimeout(u.current),u.current=window.setTimeout((function(){return a.onPointerGraceIntentChange(null)}),300)}else{if(a.onTriggerLeave(e),e.defaultPrevented)return;a.onPointerGraceIntentChange(null)}}))),onKeyDown:Jy(e.onKeyDown,(function(t){var n,o=""!==a.searchRef.current;e.disabled||o&&" "===t.key||L_[i.dir].includes(t.key)&&(r.onOpenChange(!0),null===(n=r.content)||void 0===n||n.focus(),t.preventDefault())}))})))})),AP="MenuSubContent",OP=(0,t.forwardRef)((function(e,n){var r=nP(iP,e.__scopeMenu),i=e.forceMount,o=void 0===i?r.forceMount:i,a=gt(e,M_),s=X_(iP,e.__scopeMenu),u=G_(iP,e.__scopeMenu),l=IP(AP,e.__scopeMenu),c=(0,t.useRef)(null),d=tb(n,c);return(0,t.createElement)(N_.Provider,{scope:e.__scopeMenu},(0,t.createElement)(Xb,{present:o||s.open},(0,t.createElement)(N_.Slot,{scope:e.__scopeMenu},(0,t.createElement)(dP,Zy({id:l.contentId,"aria-labelledby":l.triggerId},a,{ref:d,align:"start",side:"rtl"===u.dir?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:function(e){var t;u.isUsingKeyboardRef.current&&(null===(t=c.current)||void 0===t||t.focus()),e.preventDefault()},onCloseAutoFocus:function(e){return e.preventDefault()},onFocusOutside:Jy(e.onFocusOutside,(function(e){e.target!==l.trigger&&s.onOpenChange(!1)})),onEscapeKeyDown:Jy(e.onEscapeKeyDown,(function(e){u.onClose(),e.preventDefault()})),onKeyDown:Jy(e.onKeyDown,(function(e){var t,n=e.currentTarget.contains(e.target),r=z_[u.dir].includes(e.key);n&&r&&(s.onOpenChange(!1),null===(t=l.trigger)||void 0===t||t.focus(),e.preventDefault())}))})))))}));function LP(e){return e?"open":"closed"}function zP(e){return"indeterminate"===e}function DP(e){return zP(e)?"indeterminate":e?"checked":"unchecked"}function RP(e){return function(t){return"mouse"===t.pointerType?e(t):void 0}}var NP=Q_,BP=Z_,FP=rP,UP=uP,KP=fP,VP=vP,WP=mP,HP=_P,YP=TP,XP=jP,qP=OP,$P=["__scopeDropdownMenu","disabled"],GP=["__scopeDropdownMenu"],QP=["__scopeDropdownMenu"],ZP=["__scopeDropdownMenu"],JP=["__scopeDropdownMenu"],eE=["__scopeDropdownMenu"],tE=["__scopeDropdownMenu"],nE=["__scopeDropdownMenu"],rE=["__scopeDropdownMenu"],iE="DropdownMenu",oE=G(ib(iE,[K_]),2),aE=oE[0],sE=(oE[1],K_()),uE=G(aE(iE),2),lE=uE[0],cE=uE[1],dE=function(e){var n=e.__scopeDropdownMenu,r=e.children,i=e.dir,o=e.open,a=e.defaultOpen,s=e.onOpenChange,u=e.modal,l=void 0===u||u,c=sE(n),d=(0,t.useRef)(null),f=G(db({prop:o,defaultProp:a,onChange:s}),2),p=f[0],h=void 0!==p&&p,v=f[1];return(0,t.createElement)(lE,{scope:n,triggerId:lb(),triggerRef:d,contentId:lb(),open:h,onOpenChange:v,onOpenToggle:(0,t.useCallback)((function(){return v((function(e){return!e}))}),[v]),modal:l},(0,t.createElement)(NP,Zy({},c,{open:h,onOpenChange:v,dir:i,modal:l}),r))},fE="DropdownMenuTrigger",pE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=e.disabled,o=void 0!==i&&i,a=gt(e,$P),s=cE(fE,r),u=sE(r);return(0,t.createElement)(BP,Zy({asChild:!0},u),(0,t.createElement)(wb.button,Zy({type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":o?"":void 0,disabled:o},a,{ref:eb(n,s.triggerRef),onPointerDown:Jy(e.onPointerDown,(function(e){o||0!==e.button||!1!==e.ctrlKey||(s.onOpenToggle(),s.open||e.preventDefault())})),onKeyDown:Jy(e.onKeyDown,(function(e){o||(["Enter"," "].includes(e.key)&&s.onOpenToggle(),"ArrowDown"===e.key&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(e.key)&&e.preventDefault())}))})))})),hE=function(e){var n=e.__scopeDropdownMenu,r=gt(e,GP),i=sE(n);return(0,t.createElement)(FP,Zy({},i,r))},vE="DropdownMenuContent",gE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,QP),o=cE(vE,r),a=sE(r),s=(0,t.useRef)(!1);return(0,t.createElement)(UP,Zy({id:o.contentId,"aria-labelledby":o.triggerId},a,i,{ref:n,onCloseAutoFocus:Jy(e.onCloseAutoFocus,(function(e){var t;s.current||null===(t=o.triggerRef.current)||void 0===t||t.focus(),s.current=!1,e.preventDefault()})),onInteractOutside:Jy(e.onInteractOutside,(function(e){var t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey,r=2===t.button||n;o.modal&&!r||(s.current=!0)})),style:Ce(Ce({},e.style),{},{"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))})),mE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,ZP),o=sE(r);return(0,t.createElement)(KP,Zy({},o,i,{ref:n}))})),yE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,JP),o=sE(r);return(0,t.createElement)(VP,Zy({},o,i,{ref:n}))})),bE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,eE),o=sE(r);return(0,t.createElement)(WP,Zy({},o,i,{ref:n}))})),wE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,tE),o=sE(r);return(0,t.createElement)(HP,Zy({},o,i,{ref:n}))})),xE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,nE),o=sE(r);return(0,t.createElement)(XP,Zy({},o,i,{ref:n}))})),kE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,rE),o=sE(r);return(0,t.createElement)(qP,Zy({},o,i,{ref:n,style:Ce(Ce({},e.style),{},{"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))})),SE=dE,_E=pE,PE=hE,EE=gE,CE=mE,IE=yE,TE=bE,ME=wE,jE=function(e){var n=e.__scopeDropdownMenu,r=e.children,i=e.open,o=e.onOpenChange,a=e.defaultOpen,s=sE(n),u=G(db({prop:i,defaultProp:a,onChange:o}),2),l=u[0],c=void 0!==l&&l,d=u[1];return(0,t.createElement)(YP,Zy({},s,{open:c,onOpenChange:d}),r)},AE=xE,OE=kE,LE=function(){},zE=t.createContext({});function DE(e){var t=e.onEvent,n=e.children;return(0,za.jsx)(zE.Provider,{value:null!==t&&void 0!==t?t:LE,children:n})}function RE(){return t.useContext(zE)}function NE(e,n){var r=Va(),i=(0,t.useRef)(!1),o=RE(),a=(0,t.useCallback)((function(t){i.current=t,r.batch((function(){t?(r.complete(),r.addOpenMenu(e)):(r.deleteOpenMenu(e),r.openMenus.forEach((function(t){t.startsWith(e)&&r.deleteOpenMenu(t)}))),null===n||void 0===n||n(t)}))}),[r,e,n]);return(0,t.useEffect)((function(){return i.current&&(o("open-menu",{source:"unknown",id:e}),r.addOpenMenu(e)),function(){i.current&&(r.deleteOpenMenu(e),r.openMenus.forEach((function(t){t.startsWith(e)&&(o("close-menu",{source:"unknown",id:e}),r.deleteOpenMenu(t))})),i.current=!1)}}),[r,e,o]),[_e("is menu open",(function(){return r.openMenus.includes(e)}),[r,e]),a]}var BE=["noClose"],FE=["children","onSelect"],UE=["children","onSelect"];function KE(e){var t=e.id,n=e.children,r=e.modal,i=void 0!==r&&r,o=G(NE(t),2),a=o[0],s=o[1];return(0,za.jsx)(SE,{open:a,dir:"ltr",modal:i,onOpenChange:s,children:n})}function VE(e){var t=e.children,n=e["data-testid"];return(0,za.jsx)(_E,{dir:"ltr","data-testid":n,asChild:!0,children:t})}function WE(e){var t=e.side,n=void 0===t?"bottom":t,r=e.align,i=void 0===r?"start":r,o=e.sideOffset,a=void 0===o?8:o,s=e.alignOffset,u=void 0===s?8:s,l=e.children,c=Su();return(0,za.jsx)(PE,{dir:"ltr",container:c,children:(0,za.jsx)(EE,{className:"tlui-menu",align:i,sideOffset:a,side:n,alignOffset:u,collisionPadding:4,children:l})})}function HE(e){var t=e.id,n=e.children,r=G(NE(t),2),i=r[0],o=r[1];return(0,za.jsx)(jE,{open:i,onOpenChange:o,children:n})}function YE(e){var t=e.label,n=e["data-testid"],r=e["data-direction"];return(0,za.jsx)(AE,{dir:"ltr","data-direction":r,"data-testid":n,asChild:!0,children:(0,za.jsx)(qx,{className:"tlui-menu__button tlui-menu__submenu__trigger",label:t,icon:"chevron-right"})})}function XE(e){var t=e.alignOffset,n=void 0===t?0:t,r=e.sideOffset,i=void 0===r?5:r,o=e.children,a=Su();return(0,za.jsx)(PE,{container:a,dir:"ltr",children:(0,za.jsx)(OE,{className:"tlui-menu tlui-menu__submenu__content",alignOffset:n,sideOffset:i,collisionPadding:4,children:o})})}function qE(e){var t=e.children,n=e.size,r=void 0===n?"medium":n;return(0,za.jsx)(CE,{dir:"ltr",className:"tlui-menu__group","data-size":r,children:t})}function $E(e){var t=e.noClose,n=gt(e,BE);return(0,za.jsx)(IE,{dir:"ltr",asChild:!0,onClick:t||void 0!==n.isChecked?uu:void 0,children:(0,za.jsx)(qx,Ce({className:"tlui-menu__button"},n))})}function GE(e){var t=e.children,n=e.onSelect,r=gt(e,FE);return(0,za.jsxs)(TE,Ce(Ce({dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:function(e){null===n||void 0===n||n(e),uu(e)}},r),{},{children:[(0,za.jsx)("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:"scale(".concat(r.checked?1:.5,")"),opacity:r.checked?1:.5},children:(0,za.jsx)(Ux,{small:!0,icon:r.checked?"check":"checkbox-empty"})}),t]}))}function QE(e){var t=e.children,n=e.onSelect,r=gt(e,UE);return(0,za.jsxs)(TE,Ce(Ce({dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:function(e){null===n||void 0===n||n(e),uu(e)}},r),{},{children:[(0,za.jsx)(ME,{dir:"ltr",className:"tlui-menu__checkbox-item__check",children:(0,za.jsx)(Ux,{icon:"check"})}),t]}))}var ZE=(0,t.forwardRef)((function(e,n){return(0,t.createElement)(wb.span,Zy({},e,{ref:n,style:Ce({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"},e.style)}))})),JE=["__scopeToast","hotkey","label"],eC=["__scopeToast","onFocusFromOutsideViewport"],tC=["forceMount","open","defaultOpen","onOpenChange"],nC=["__scopeToast","type","duration","open","onClose","onEscapeKeyDown","onPause","onResume","onSwipeStart","onSwipeMove","onSwipeCancel","onSwipeEnd"],rC=["__scopeToast","children"],iC=["__scopeToast"],oC=["__scopeToast"],aC=["altText"],sC=["__scopeToast"],uC=["__scopeToast","altText"],lC="ToastProvider",cC=G(tk("Toast"),3),dC=cC[0],fC=cC[1],pC=G(ib("Toast",[cC[2]]),2),hC=pC[0],vC=(pC[1],G(hC(lC),2)),gC=vC[0],mC=vC[1],yC=function(e){var n=e.__scopeToast,r=e.label,i=void 0===r?"Notification":r,o=e.duration,a=void 0===o?5e3:o,s=e.swipeDirection,u=void 0===s?"right":s,l=e.swipeThreshold,c=void 0===l?50:l,d=e.children,f=G((0,t.useState)(null),2),p=f[0],h=f[1],v=G((0,t.useState)(0),2),g=v[0],m=v[1],y=(0,t.useRef)(!1),b=(0,t.useRef)(!1);return(0,t.createElement)(dC.Provider,{scope:n},(0,t.createElement)(gC,{scope:n,label:i,duration:a,swipeDirection:u,swipeThreshold:c,toastCount:g,viewport:p,onViewportChange:h,onToastAdd:(0,t.useCallback)((function(){return m((function(e){return e+1}))}),[]),onToastRemove:(0,t.useCallback)((function(){return m((function(e){return e-1}))}),[]),isFocusedToastEscapeKeyDownRef:y,isClosePausedRef:b},d))};yC.propTypes={label:function(e){if(e.label&&"string"===typeof e.label&&!e.label.trim()){var t="Invalid prop `label` supplied to `".concat(lC,"`. Expected non-empty `string`.");return new Error(t)}return null}};var bC="ToastViewport",wC=["F8"],xC="toast.viewportPause",kC="toast.viewportResume",SC=(0,t.forwardRef)((function(e,n){var r=e.__scopeToast,i=e.hotkey,o=void 0===i?wC:i,a=e.label,s=void 0===a?"Notifications ({hotkey})":a,l=gt(e,JE),c=mC(bC,r),d=fC(r),f=(0,t.useRef)(null),p=(0,t.useRef)(null),h=(0,t.useRef)(null),v=(0,t.useRef)(null),g=tb(n,v,c.onViewportChange),m=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),y=c.toastCount>0;(0,t.useEffect)((function(){var e=function(e){var t;o.every((function(t){return e[t]||e.code===t}))&&(null===(t=v.current)||void 0===t||t.focus())};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[o]),(0,t.useEffect)((function(){var e=f.current,t=v.current;if(y&&e&&t){var n=function(){if(!c.isClosePausedRef.current){var e=new CustomEvent(xC);t.dispatchEvent(e),c.isClosePausedRef.current=!0}},r=function(){if(c.isClosePausedRef.current){var e=new CustomEvent(kC);t.dispatchEvent(e),c.isClosePausedRef.current=!1}},i=function(t){!e.contains(t.relatedTarget)&&r()},o=function(){e.contains(document.activeElement)||r()};return e.addEventListener("focusin",n),e.addEventListener("focusout",i),e.addEventListener("pointermove",n),e.addEventListener("pointerleave",o),window.addEventListener("blur",n),window.addEventListener("focus",r),function(){e.removeEventListener("focusin",n),e.removeEventListener("focusout",i),e.removeEventListener("pointermove",n),e.removeEventListener("pointerleave",o),window.removeEventListener("blur",n),window.removeEventListener("focus",r)}}}),[y,c.isClosePausedRef]);var b=(0,t.useCallback)((function(e){var t=e.tabbingDirection,n=d().map((function(e){var n=e.ref.current,r=[n].concat(u(function(e){var t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:function(e){var t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}(n)));return"forwards"===t?r:r.reverse()}));return("forwards"===t?n.reverse():n).flat()}),[d]);return(0,t.useEffect)((function(){var e=v.current;if(e){var t=function(t){var n=t.altKey||t.ctrlKey||t.metaKey;if("Tab"===t.key&&!n){var r,i=document.activeElement,o=t.shiftKey;if(t.target===e&&o)return void(null===(r=p.current)||void 0===r||r.focus());var a,s,u=b({tabbingDirection:o?"backwards":"forwards"}),l=u.findIndex((function(e){return e===i}));if(VC(u.slice(l+1)))t.preventDefault();else o?null===(a=p.current)||void 0===a||a.focus():null===(s=h.current)||void 0===s||s.focus()}};return e.addEventListener("keydown",t),function(){return e.removeEventListener("keydown",t)}}}),[d,b]),(0,t.createElement)(Ob,{ref:f,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:y?void 0:"none"}},y&&(0,t.createElement)(PC,{ref:p,onFocusFromOutsideViewport:function(){VC(b({tabbingDirection:"forwards"}))}}),(0,t.createElement)(dC.Slot,{scope:r},(0,t.createElement)(wb.ol,Zy({tabIndex:-1},l,{ref:g}))),y&&(0,t.createElement)(PC,{ref:h,onFocusFromOutsideViewport:function(){VC(b({tabbingDirection:"backwards"}))}}))})),_C="ToastFocusProxy",PC=(0,t.forwardRef)((function(e,n){var r=e.__scopeToast,i=e.onFocusFromOutsideViewport,o=gt(e,eC),a=mC(_C,r);return(0,t.createElement)(ZE,Zy({"aria-hidden":!0,tabIndex:0},o,{ref:n,style:{position:"fixed"},onFocus:function(e){var t,n=e.relatedTarget;!(null!==(t=a.viewport)&&void 0!==t&&t.contains(n))&&i()}}))})),EC="Toast",CC=(0,t.forwardRef)((function(e,n){var r=e.forceMount,i=e.open,o=e.defaultOpen,a=e.onOpenChange,s=gt(e,tC),u=G(db({prop:i,defaultProp:o,onChange:a}),2),l=u[0],c=void 0===l||l,d=u[1];return(0,t.createElement)(Xb,{present:r||c},(0,t.createElement)(jC,Zy({open:c},s,{ref:n,onClose:function(){return d(!1)},onPause:cb(e.onPause),onResume:cb(e.onResume),onSwipeStart:Jy(e.onSwipeStart,(function(e){e.currentTarget.setAttribute("data-swipe","start")})),onSwipeMove:Jy(e.onSwipeMove,(function(e){var t=e.detail.delta,n=t.x,r=t.y;e.currentTarget.setAttribute("data-swipe","move"),e.currentTarget.style.setProperty("--radix-toast-swipe-move-x","".concat(n,"px")),e.currentTarget.style.setProperty("--radix-toast-swipe-move-y","".concat(r,"px"))})),onSwipeCancel:Jy(e.onSwipeCancel,(function(e){e.currentTarget.setAttribute("data-swipe","cancel"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")})),onSwipeEnd:Jy(e.onSwipeEnd,(function(e){var t=e.detail.delta,n=t.x,r=t.y;e.currentTarget.setAttribute("data-swipe","end"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.setProperty("--radix-toast-swipe-end-x","".concat(n,"px")),e.currentTarget.style.setProperty("--radix-toast-swipe-end-y","".concat(r,"px")),d(!1)}))})))})),IC=G(hC(EC,{onClose:function(){}}),2),TC=IC[0],MC=IC[1],jC=(0,t.forwardRef)((function(e,n){var r=e.__scopeToast,i=e.type,o=void 0===i?"foreground":i,a=e.duration,s=e.open,u=e.onClose,l=e.onEscapeKeyDown,c=e.onPause,d=e.onResume,f=e.onSwipeStart,p=e.onSwipeMove,h=e.onSwipeCancel,v=e.onSwipeEnd,g=gt(e,nC),m=mC(EC,r),y=G((0,t.useState)(null),2),b=y[0],w=y[1],x=tb(n,(function(e){return w(e)})),k=(0,t.useRef)(null),S=(0,t.useRef)(null),_=a||m.duration,P=(0,t.useRef)(0),E=(0,t.useRef)(_),C=(0,t.useRef)(0),I=m.onToastAdd,T=m.onToastRemove,M=cb((function(){var e;(null===b||void 0===b?void 0:b.contains(document.activeElement))&&(null===(e=m.viewport)||void 0===e||e.focus()),u()})),j=(0,t.useCallback)((function(e){e&&e!==1/0&&(window.clearTimeout(C.current),P.current=(new Date).getTime(),C.current=window.setTimeout(M,e))}),[M]);(0,t.useEffect)((function(){var e=m.viewport;if(e){var t=function(){j(E.current),null===d||void 0===d||d()},n=function(){var e=(new Date).getTime()-P.current;E.current=E.current-e,window.clearTimeout(C.current),null===c||void 0===c||c()};return e.addEventListener(xC,n),e.addEventListener(kC,t),function(){e.removeEventListener(xC,n),e.removeEventListener(kC,t)}}}),[m.viewport,_,c,d,j]),(0,t.useEffect)((function(){s&&!m.isClosePausedRef.current&&j(_)}),[s,_,m.isClosePausedRef,j]),(0,t.useEffect)((function(){return I(),function(){return T()}}),[I,T]);var A=(0,t.useMemo)((function(){return b?FC(b):null}),[b]);return m.viewport?(0,t.createElement)(t.Fragment,null,A&&(0,t.createElement)(AC,{__scopeToast:r,role:"status","aria-live":"foreground"===o?"assertive":"polite","aria-atomic":!0},A),(0,t.createElement)(TC,{scope:r,onClose:M},(0,fb.createPortal)((0,t.createElement)(dC.ItemSlot,{scope:r},(0,t.createElement)(Ab,{asChild:!0,onEscapeKeyDown:Jy(l,(function(){m.isFocusedToastEscapeKeyDownRef.current||M(),m.isFocusedToastEscapeKeyDownRef.current=!1}))},(0,t.createElement)(wb.li,Zy({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":m.swipeDirection},g,{ref:x,style:Ce({userSelect:"none",touchAction:"none"},e.style),onKeyDown:Jy(e.onKeyDown,(function(e){"Escape"===e.key&&(null===l||void 0===l||l(e.nativeEvent),e.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,M()))})),onPointerDown:Jy(e.onPointerDown,(function(e){0===e.button&&(k.current={x:e.clientX,y:e.clientY})})),onPointerMove:Jy(e.onPointerMove,(function(e){if(k.current){var t=e.clientX-k.current.x,n=e.clientY-k.current.y,r=Boolean(S.current),i=["left","right"].includes(m.swipeDirection),o=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,a=i?o(0,t):0,s=i?0:o(0,n),u="touch"===e.pointerType?10:2,l={x:a,y:s},c={originalEvent:e,delta:l};r?(S.current=l,UC("toast.swipeMove",p,c,{discrete:!1})):KC(l,m.swipeDirection,u)?(S.current=l,UC("toast.swipeStart",f,c,{discrete:!1}),e.target.setPointerCapture(e.pointerId)):(Math.abs(t)>u||Math.abs(n)>u)&&(k.current=null)}})),onPointerUp:Jy(e.onPointerUp,(function(e){var t=S.current,n=e.target;if(n.hasPointerCapture(e.pointerId)&&n.releasePointerCapture(e.pointerId),S.current=null,k.current=null,t){var r=e.currentTarget,i={originalEvent:e,delta:t};KC(t,m.swipeDirection,m.swipeThreshold)?UC("toast.swipeEnd",v,i,{discrete:!0}):UC("toast.swipeCancel",h,i,{discrete:!0}),r.addEventListener("click",(function(e){return e.preventDefault()}),{once:!0})}}))})))),m.viewport))):null}));jC.propTypes={type:function(e){if(e.type&&!["foreground","background"].includes(e.type)){var t="Invalid prop `type` supplied to `".concat(EC,"`. Expected `foreground | background`.");return new Error(t)}return null}};var AC=function(e){var n=e.__scopeToast,r=e.children,i=gt(e,rC),o=mC(EC,n),a=G((0,t.useState)(!1),2),s=a[0],u=a[1],l=G((0,t.useState)(!1),2),c=l[0],d=l[1];return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=cb(e);ab((function(){var e=0,n=0;return e=window.requestAnimationFrame((function(){return n=window.requestAnimationFrame(t)})),function(){window.cancelAnimationFrame(e),window.cancelAnimationFrame(n)}}),[t])}((function(){return u(!0)})),(0,t.useEffect)((function(){var e=window.setTimeout((function(){return d(!0)}),1e3);return function(){return window.clearTimeout(e)}}),[]),c?null:(0,t.createElement)(Yb,{asChild:!0},(0,t.createElement)(ZE,i,s&&(0,t.createElement)(t.Fragment,null,o.label," ",r)))},OC=(0,t.forwardRef)((function(e,n){e.__scopeToast;var r=gt(e,iC);return(0,t.createElement)(wb.div,Zy({},r,{ref:n}))})),LC=(0,t.forwardRef)((function(e,n){e.__scopeToast;var r=gt(e,oC);return(0,t.createElement)(wb.div,Zy({},r,{ref:n}))})),zC="ToastAction",DC=(0,t.forwardRef)((function(e,n){var r=e.altText,i=gt(e,aC);return r?(0,t.createElement)(BC,{altText:r,asChild:!0},(0,t.createElement)(NC,Zy({},i,{ref:n}))):null}));DC.propTypes={altText:function(e){return e.altText?null:new Error("Missing prop `altText` expected on `".concat(zC,"`"))}};var RC="ToastClose",NC=(0,t.forwardRef)((function(e,n){var r=e.__scopeToast,i=gt(e,sC),o=MC(RC,r);return(0,t.createElement)(BC,{asChild:!0},(0,t.createElement)(wb.button,Zy({type:"button"},i,{ref:n,onClick:Jy(e.onClick,o.onClose)})))})),BC=(0,t.forwardRef)((function(e,n){e.__scopeToast;var r=e.altText,i=gt(e,uC);return(0,t.createElement)(wb.div,Zy({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0},i,{ref:n}))}));function FC(e){var t=[];return Array.from(e.childNodes).forEach((function(e){if(e.nodeType===e.TEXT_NODE&&e.textContent&&t.push(e.textContent),function(e){return e.nodeType===e.ELEMENT_NODE}(e)){var n=e.ariaHidden||e.hidden||"none"===e.style.display,r=""===e.dataset.radixToastAnnounceExclude;if(!n)if(r){var i=e.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push.apply(t,u(FC(e)))}})),t}function UC(e,t,n,r){var i=r.discrete,o=n.originalEvent.currentTarget,a=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),i?xb(o,a):o.dispatchEvent(a)}var KC=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.abs(e.x),i=Math.abs(e.y),o=r>i;return"left"===t||"right"===t?o&&r>n:!o&&i>n};function VC(e){var t=document.activeElement;return e.some((function(e){return e===t||(e.focus(),document.activeElement!==t)}))}var WC=CC,HC=OC,YC=LC,XC=DC,qC=NC,$C="2.0.0-alpha.14",GC=Ce(Ce({},Ra),{},{icons:Object.fromEntries(["align-bottom-center","align-bottom-left","align-bottom-right","align-bottom","align-center-center","align-center-horizontal","align-center-left","align-center-right","align-center-vertical","align-left","align-right","align-top-center","align-top-left","align-top-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","aspect-ratio","avatar","blob","bring-forward","bring-to-front","check","checkbox-checked","checkbox-empty","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","code","collab","color","comment","cross-2","cross","dash-dashed","dash-dotted","dash-draw","dash-solid","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","file","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-diamond","geo-ellipse","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","hidden","image","info-circle","leading","link","lock-small","lock","menu","minus","mixed","pack","page","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","ruler","search","send-backward","send-to-back","settings-horizontal","settings-vertical-1","settings-vertical","share-1","share-2","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","stretch-horizontal","stretch-vertical","text-align-center","text-align-justify","text-align-left","text-align-right","tool-arrow","tool-embed","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-text","trash","triangle-down","triangle-up","twitter","undo","ungroup","unlock-small","unlock","vertical-align-center","vertical-align-end","vertical-align-start","visible","warning-triangle","zoom-in","zoom-out"].map((function(e){return[e,"https://unpkg.com/@tldraw/assets@".concat($C,"/icons/icon/").concat(e,".svg")]}))),translations:Object.fromEntries(ja.map((function(e){return[e.locale,"https://unpkg.com/@tldraw/assets@".concat($C,"/translations/").concat(e.locale,".json")]}))),embedIcons:Object.fromEntries(Do.map((function(e){return[e.type,"https://unpkg.com/@tldraw/assets@".concat($C,"/embed-icons/").concat(e.type,".png")]})))});function QC(e){return e?{fonts:Object.assign(Ce({},GC.fonts),Ce({},null===e||void 0===e?void 0:e.fonts)),icons:Object.assign(Ce({},GC.icons),Ce({},null===e||void 0===e?void 0:e.icons)),embedIcons:Object.assign(Ce({},GC.embedIcons),Ce({},null===e||void 0===e?void 0:e.embedIcons)),translations:Object.assign(Ce({},GC.translations),Ce({},null===e||void 0===e?void 0:e.translations))}:GC}var ZC=t.forwardRef((function(e,n){var r=e.className,i=e.label,o=e.icon,a=e.iconLeft,s=e.autoselect,u=void 0!==s&&s,l=e.autofocus,c=void 0!==l&&l,d=e.defaultValue,f=e.placeholder,p=e.onComplete,h=e.onValueChange,v=e.onCancel,g=e.onBlur,m=e.shouldManuallyMaintainScrollPositionWhenFocused,y=void 0!==m&&m,b=e.children,w=e.value,x=t.useRef(null);t.useImperativeHandle(n,(function(){return x.current}));var k=Nx(),S=t.useRef(null!==d&&void 0!==d?d:""),_=t.useRef(null!==d&&void 0!==d?d:""),P=G(t.useState(!1),2),E=P[0],C=P[1],I=t.useCallback((function(e){C(!0);var t=e.currentTarget;_.current=t.value,requestAnimationFrame((function(){u&&t.select()}))}),[u]),T=t.useCallback((function(e){var t=e.currentTarget.value;_.current=t,null===h||void 0===h||h(t)}),[h]),M=t.useCallback((function(e){switch(e.key){case"Enter":e.currentTarget.blur(),e.stopPropagation(),null===p||void 0===p||p(e.currentTarget.value);break;case"Escape":e.currentTarget.value=S.current,e.currentTarget.blur(),e.stopPropagation(),null===v||void 0===v||v(e.currentTarget.value)}}),[p,v]),j=t.useCallback((function(e){C(!1);var t=e.currentTarget.value;null===g||void 0===g||g(t)}),[g]);return t.useEffect((function(){var e=window.visualViewport;if(E&&y&&e){var t=function(){var e;null===(e=x.current)||void 0===e||e.scrollIntoView({block:"center"})};return e.addEventListener("resize",t),e.addEventListener("scroll",t),requestAnimationFrame((function(){var e;null===(e=x.current)||void 0===e||e.scrollIntoView({block:"center"})})),function(){e.removeEventListener("resize",t),e.removeEventListener("scroll",t)}}}),[E,y]),(0,za.jsxs)("div",{draggable:!1,className:"tlui-input__wrapper",children:[b,i&&(0,za.jsx)("label",{children:k(i)}),a&&(0,za.jsx)(Ux,{icon:a,className:"tlui-icon-left",small:!0}),(0,za.jsx)("input",{ref:x,className:Ua("tlui-input",r),type:"text",defaultValue:d,onKeyUp:M,onChange:T,onFocus:I,onBlur:j,autoFocus:c,placeholder:f,value:w}),o&&(0,za.jsx)(Ux,{icon:o,small:!!i})]})}));function JC(e){return uf(e)?{isValid:!0,hasProtocol:!0}:uf("https://"+e)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}var eI=ke((function(e){var t=e.onClose,n=Va().onlySelectedShape;return n&&"url"in n.props&&"string"===typeof n.props.url?(0,za.jsx)(tI,{onClose:t,selectedShape:n}):null})),tI=ke((function(e){var n=e.onClose,r=e.selectedShape,i=Va(),o=Nx(),a=(0,t.useRef)(null);(0,t.useEffect)((function(){requestAnimationFrame((function(){var e;return null===(e=a.current)||void 0===e?void 0:e.focus()}))}),[]);var s=(0,t.useRef)(r.props.url),u=G((0,t.useState)((function(){var e=JC(r.props.url),t=!0===e.isValid?e.hasProtocol?r.props.url:"https://"+r.props.url:"https://";return{actual:t,safe:t,valid:!0}})),2),l=u[0],c=u[1],d=(0,t.useCallback)((function(e){var t=e.replace(/https?:\/\/(https?:\/\/)/,(function(e,t){return t})),n=JC(t),r=!0===n.isValid?n.hasProtocol?t:"https://"+t:"https://";c({actual:t,safe:r,valid:n.isValid})}),[]),f=(0,t.useCallback)((function(){var e=i.onlySelectedShape;e&&(i.updateShapes([{id:e.id,type:e.type,props:{url:""}}]),n())}),[i,n]),p=(0,t.useCallback)((function(){var e=i.onlySelectedShape;e&&(e&&"url"in e.props&&e.props.url!==l.safe&&i.updateShapes([{id:e.id,type:e.type,props:{url:l.safe}}]),n())}),[i,n,l]),h=(0,t.useCallback)((function(){n()}),[n]);if(!r)return n(),null;var v=s.current&&!l.valid;return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsxs)($x,{children:[(0,za.jsx)(Gx,{children:o("edit-link-dialog.title")}),(0,za.jsx)(Qx,{})]}),(0,za.jsx)(Zx,{children:(0,za.jsxs)("div",{className:"tlui-edit-link-dialog",children:[(0,za.jsx)(ZC,{ref:a,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autofocus:!0,value:l.actual,onValueChange:d,onComplete:p,onCancel:h}),(0,za.jsx)("div",{children:l.valid?o("edit-link-dialog.detail"):o("edit-link-dialog.invalid-url")})]})}),(0,za.jsxs)(Jx,{className:"tlui-dialog__footer__actions",children:[(0,za.jsx)(qx,{onClick:h,onTouchEnd:h,children:o("edit-link-dialog.cancel")}),v?(0,za.jsx)(qx,{type:"danger",onTouchEnd:f,onClick:f,children:o("edit-link-dialog.clear")}):(0,za.jsx)(qx,{type:"primary",disabled:!l.valid,onTouchEnd:p,onClick:p,children:o("edit-link-dialog.save")})]})]})})),nI=ke((function(e){var n=e.onClose,r=Va(),i=Nx(),o=Mx(),a=G((0,t.useState)(null),2),s=a[0],u=a[1],l=G((0,t.useState)(""),2),c=l[0],d=l[1],f=G((0,t.useState)(null),2),p=f[0],h=f[1],v=G((0,t.useState)(!1),2),g=v[0],m=v[1],y=(0,t.useRef)(-1);return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsxs)($x,{children:[(0,za.jsx)(Gx,{children:s?"".concat(i("embed-dialog.title")," \u2014 ").concat(s.title):i("embed-dialog.title")}),(0,za.jsx)(Qx,{})]}),s?(0,za.jsxs)(za.Fragment,{children:[(0,za.jsxs)(Zx,{className:"tlui-embed-dialog__enter",children:[(0,za.jsx)(ZC,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autofocus:!0,onValueChange:function(e){d(e);var t=Fc(e);h(t&&t.definition.type===s.type?t:null),m(!1),clearTimeout(y.current),y.current=setTimeout((function(){return m(!t)}),320)}}),""===c?(0,za.jsxs)("div",{className:"tlui-embed-dialog__instruction",children:[(0,za.jsx)("span",{children:i("embed-dialog.instruction")})," ",s.instructionLink&&(0,za.jsxs)("a",{target:"_blank",rel:"noopener noreferrer",href:s.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",(0,za.jsx)(Ux,{icon:"external-link",small:!0})]})]}):(0,za.jsx)("div",{className:"tlui-embed-dialog__warning",children:g?i("embed-dialog.invalid-url"):"\xa0"})]}),(0,za.jsxs)(Jx,{className:"tlui-dialog__footer__actions",children:[(0,za.jsx)(qx,{onClick:function(){u(null),h(null),d("")},label:"embed-dialog.back"}),(0,za.jsx)("div",{className:"tlui-embed__spacer"}),(0,za.jsx)(qx,{label:"embed-dialog.cancel",onClick:n}),(0,za.jsx)(qx,{type:"primary",disabled:!p,label:"embed-dialog.create",onClick:function(){p&&(r.putExternalContent({type:"embed",url:c,point:r.viewportPageCenter,embed:p.definition}),n())}})]})]}):(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(Zx,{className:"tlui-embed-dialog__list",children:Do.map((function(e){return(0,za.jsxs)("button",{className:"tlui-embed-dialog__item",onClick:function(){return u(e)},children:[(0,za.jsx)("div",{className:"tlui-embed-dialog__item__image",children:(0,za.jsx)("div",{className:"tlui-embed-dialog__item__image__img",style:{backgroundImage:"url(".concat(o.embedIcons[e.type],")")}})}),(0,za.jsx)("div",{className:"tlui-embed-dialog__item__title",children:e.title})]},e.type)}))}),(0,za.jsx)("div",{className:"tlui-dialog__scrim"})]})]})})),rI=n(4235);function iI(e,t,n){return oI.apply(this,arguments)}function oI(){return oI=Fa(Na().mark((function e(t,n,r){var i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,T,M,j;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n.elements,o=n.files,a={shapes:[],rootShapeIds:[],assets:[],schema:t.store.schema.serialize()},s=new Map,u=new Map,l=t.currentPageId,c=new Map,d=[],f=new Set,i.forEach((function(e){if(c.set(e.id,Wi()),null!==e.boundElements){var t,n=J(e.boundElements);try{for(n.s();!(t=n.n()).done;){var r=t.value;"text"===r.type&&f.add(r.id)}}catch(hD){n.e(hD)}finally{n.f()}}})),p="a1",h=J(i),e.prev=11,g=Na().mark((function e(){var t,n,r,h,g,m,y,b,w,x,k,S,_,P,E,T,M,j,A,O,L,z,D,R,N,B,F,U,K,V,W,H,Y,X,q,$,Q,Z,ee,te;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=v.value,!f.has(t.id)){e.next=3;break}return e.abrupt("return",1);case 3:n=c.get(t.id),r={id:n,typeName:"shape",parentId:l,index:p,x:t.x,y:t.y,rotation:0,isLocked:t.locked,opacity:aI(t.opacity),meta:{}},0!==t.angle&&u.set(n,t.angle),t.groupIds&&t.groupIds.length>0?s.has(t.groupIds[0])?null===(h=s.get(t.groupIds[0]))||void 0===h||h.push(n):s.set(t.groupIds[0],[n]):d.push(n),e.t0=t.type,e.next="rectangle"===e.t0||"ellipse"===e.t0||"diamond"===e.t0?10:"freedraw"===e.t0?32:"line"===e.t0?34:"arrow"===e.t0?39:"text"===e.t0?63:"image"===e.t0?66:72;break;case 10:if(b="",w="middle",null===t.boundElements){e.next=29;break}x=J(t.boundElements),e.prev=14,S=Na().mark((function e(){var t,n;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"text"===(t=k.value).type&&(n=i.find((function(e){return e.id===t.id})))&&(b=n.text,w=hI[n.textAlign]);case 2:case"end":return e.stop()}}),e)})),x.s();case 17:if((k=x.n()).done){e.next=21;break}return e.delegateYield(S(),"t1",19);case 19:e.next=17;break;case 21:e.next=26;break;case 23:e.prev=23,e.t2=e.catch(14),x.e(e.t2);case 26:return e.prev=26,x.f(),e.finish(26);case 29:return _="transparent"===t.backgroundColor?t.strokeColor:t.backgroundColor,a.shapes.push(Ce(Ce({},r),{},{type:"geo",props:{geo:t.type,url:null!==(g=t.link)&&void 0!==g?g:"",w:t.width,h:t.height,size:null!==(m=sI[t.strokeWidth])&&void 0!==m?m:"draw",color:null!==(y=dI[_])&&void 0!==y?y:"black",text:b,align:w,dash:mI(t),fill:yI(t)}})),e.abrupt("break",72);case 32:return a.shapes.push(Ce(Ce({},r),{},{type:"draw",props:{dash:mI(t),size:sI[t.strokeWidth],color:null!==(P=dI[t.strokeColor])&&void 0!==P?P:"black",segments:[{type:"free",points:t.points.map((function(e){var t=G(e,3),n=t[0],r=t[1],i=t[2];return{x:n,y:r,z:void 0===i?.5:i}}))}]}})),e.abrupt("break",72);case 34:return T=t.points[0],M=t.points[t.points.length-1],j=I(t.points.length),a.shapes.push(Ce(Ce({},r),{},{type:"line",props:{dash:mI(t),size:sI[t.strokeWidth],color:null!==(E=dI[t.strokeColor])&&void 0!==E?E:"black",spline:t.roundness?"cubic":"line",handles:Ce({start:{id:"start",type:"vertex",index:j[0],x:T[0],y:T[1]},end:{id:"end",type:"vertex",index:j[j.length-1],x:M[0],y:M[1]}},Object.fromEntries(t.points.slice(1,-1).map((function(e,t){var n=G(e,2),r=n[0],i=n[1],o=of();return[o,{id:o,type:"vertex",index:j[t+1],x:r,y:i}]}))))}})),e.abrupt("break",72);case 39:if(N="",null===t.boundElements){e.next=57;break}B=J(t.boundElements),e.prev=42,U=Na().mark((function e(){var t,n;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"text"===(t=F.value).type&&(n=i.find((function(e){return e.id===t.id})))&&(N=n.text);case 2:case"end":return e.stop()}}),e)})),B.s();case 45:if((F=B.n()).done){e.next=49;break}return e.delegateYield(U(),"t3",47);case 47:e.next=45;break;case 49:e.next=54;break;case 51:e.prev=51,e.t4=e.catch(42),B.e(e.t4);case 54:return e.prev=54,B.f(),e.finish(54);case 57:return K=t.points[0],V=t.points[t.points.length-1],W=c.get(null===(A=t.startBinding)||void 0===A?void 0:A.elementId),H=c.get(null===(O=t.endBinding)||void 0===O?void 0:O.elementId),a.shapes.push(Ce(Ce({},r),{},{type:"arrow",props:{text:N,bend:gI(t,K,V),dash:mI(t),size:null!==(L=sI[t.strokeWidth])&&void 0!==L?L:"m",color:null!==(z=dI[t.strokeColor])&&void 0!==z?z:"black",start:W?{type:"binding",boundShapeId:W,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:K[0],y:K[1]},end:H?{type:"binding",boundShapeId:H,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:V[0],y:V[1]},arrowheadEnd:null!==(D=vI[t.endArrowhead])&&void 0!==D?D:"none",arrowheadStart:null!==(R=vI[t.startArrowhead])&&void 0!==R?R:"none"}})),e.abrupt("break",72);case 63:return q=lI(t.fontSize),$=q.size,Q=q.scale,a.shapes.push(Ce(Ce({},r),{},{type:"text",props:{size:$,scale:Q,font:null!==(Y=cI[t.fontFamily])&&void 0!==Y?Y:"draw",color:null!==(X=dI[t.strokeColor])&&void 0!==X?X:"black",text:t.text,align:hI[t.textAlign]}})),e.abrupt("break",72);case 66:if(ee=o[t.fileId]){e.next=69;break}return e.abrupt("break",72);case 69:te=Mi.createId(),a.assets.push({id:te,typeName:"asset",type:"image",props:{w:t.width,h:t.height,name:null!==(Z=t.id)&&void 0!==Z?Z:"Untitled",isAnimated:!1,mimeType:ee.mimeType,src:ee.dataURL},meta:{}}),a.shapes.push(Ce(Ce({},r),{},{type:"image",props:{w:t.width,h:t.height,assetId:te}}));case 72:p=C(p);case 73:case"end":return e.stop()}}),e,null,[[14,23,26,29],[42,51,54,57]])})),h.s();case 14:if((v=h.n()).done){e.next=20;break}return e.delegateYield(g(),"t0",16);case 16:if(!e.t0){e.next=18;break}return e.abrupt("continue",18);case 18:e.next=14;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(11),h.e(e.t1);case 25:return e.prev=25,h.f(),e.finish(25);case 28:m=null!==r&&void 0!==r?r:t.inputs.shiftKey?t.inputs.currentPagePoint:void 0,t.mark("paste"),t.putContent(a,{point:m,select:!1,preserveIds:!0}),y=J(s.values());try{for(y.s();!(b=y.n()).done;)(w=b.value).length>1&&(t.groupShapes(w),null!==(x=t.getShapeById(w[0]))&&void 0!==x&&x.parentId&&Vi(x.parentId)&&d.push(x.parentId))}catch(hD){y.e(hD)}finally{y.f()}k=J(u);try{for(k.s();!(S=k.n()).done;)_=G(S.value,2),P=_[0],E=_[1],t.select(P),t.rotateShapesBy([P],E)}catch(hD){k.e(hD)}finally{k.f()}T=Te(d.map((function(e){return t.getShapeById(e)}))),M=ks.Common(T.map((function(e){return t.getPageBounds(e)}))),j=t.viewportPageBounds.center,t.updateShapes(T.map((function(e){var t,n,r=(null!==(t=e.x)&&void 0!==t?t:0)-(M.x+M.w/2),i=(null!==(n=e.y)&&void 0!==n?n:0)-(M.y+M.h/2);return{id:e.id,type:e.type,x:j.x+r,y:j.y+i}}))),t.setSelectedIds(d);case 40:case"end":return e.stop()}}),e,null,[[11,22,25,28]])}))),oI.apply(this,arguments)}var aI=function(e){var t=e/100;return t<.2?.1:t<.4?.25:t<.6?.5:t<.8?.75:1},sI={1:"s",2:"m",3:"l",4:"xl"},uI={16:"s",20:"m",28:"l",36:"xl"};function lI(e){var t=uI[e];return t?{size:t,scale:1}:e<16?{size:"s",scale:e/16}:e>36?{size:"xl",scale:e/36}:{size:"m",scale:1}}var cI={1:"draw",2:"sans",3:"mono"},dI={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},fI={solid:"draw",dashed:"dashed",dotted:"dotted"},pI={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},hI={left:"start",center:"middle",right:"end"},vI={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function gI(e,t,n){var r=0;if(e.points.length>2){var i=new Xa(t[0],t[1]),o=new Xa(n[0],n[1]),a=new Xa(e.points[1][0],e.points[1][1]),s=Xa.Sub(o,i),u=Xa.Per(s),l=Xa.Med(o,i),c=Xa.Sub(l,u),d=Xa.Add(l,u),f=Xa.NearestPointOnLineSegment(c,d,a,!1);r=Xa.Dist(f,l),Xa.Clockwise(f,o,l)&&(r*=-1)}return r}var mI=function(e){var t,n=null!==(t=fI[e.strokeStyle])&&void 0!==t?t:"draw";return"draw"===n&&0===e.roughness&&(n="solid"),n},yI=function(e){var t;return"transparent"===e.backgroundColor?"none":null!==(t=pI[e.fillStyle])&&void 0!==t?t:"solid"};function bI(e,t,n){return wI.apply(this,arguments)}function wI(){return wI=Fa(Na().mark((function e(t,n,r){var i,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map(function(){var e=Fa(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return e.next=4,e.sent.blob();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return i=e.sent,o=i.map((function(e){return new File([e],"tldrawFile",{type:e.type})})),t.mark("paste"),e.next=7,t.putExternalContent({type:"files",files:o,point:r,ignoreParent:!1});case 7:n.forEach((function(e){return URL.revokeObjectURL(e)}));case 8:case"end":return e.stop()}}),e)}))),wI.apply(this,arguments)}function xI(e,t,n){var r=null!==n&&void 0!==n?n:e.inputs.shiftKey?e.inputs.currentPagePoint:void 0;e.mark("paste"),e.putContent(t,{point:r,select:!0})}function kI(e,t,n){return SI.apply(this,arguments)}function SI(){return(SI=Fa(Na().mark((function e(t,n,r){var i,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(n);case 3:if(o=e.sent,null===(i=o.headers.get("content-type"))||void 0===i||!i.match(/^image\//)){e.next=8;break}return t.mark("paste"),bI(t,[n]),e.abrupt("return");case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),"Failed to fetch"!==e.t0.message&&console.error(e.t0);case 13:return t.mark("paste"),e.next=16,t.putExternalContent({type:"url",point:r,url:n});case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function _I(){var e=Va();return _e("editor.isFocused",(function(){return e.isFocused}),[e])}var PI=["input","select","textarea"];function EI(e){var t=document.activeElement;return e.isMenuOpen||t&&(t.getAttribute("contenteditable")||PI.indexOf(t.tagName.toLowerCase())>-1)}function CI(e){return II.apply(this,arguments)}function II(){return(II=Fa(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.addEventListener("loadend",(function(){var t=r.result;e(t)})),r.addEventListener("error",(function(){n(r.error)})),r.readAsText(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function TI(e){var t=document.implementation.createHTMLDocument("");return t.documentElement.innerHTML=e.trim(),t.body.textContent||t.body.innerText||""}var MI=function(e){return e.types.find((function(e){return e.match(/^image\//)}))},jI=function(e,t,n){var r=function(e){var t,n=e.split(/[\n\s]/),r=J(n);try{for(r.s();!(t=r.n()).done;){var i=t.value;try{var o=new URL(i);if("http:"!==o.protocol&&"https:"!==o.protocol)return}catch(ej){return}}}catch(hD){r.e(hD)}finally{r.f()}return Ec(n)}(t);if(r){var i,o=J(r);try{for(o.s();!(i=o.n()).done;){kI(e,i.value,n)}}catch(hD){o.e(hD)}finally{o.f()}}else!function(e){try{var t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(ej){return!1}}(t)?/^<svg/.test(t)?(e.mark("paste"),e.putExternalContent({type:"svg-text",text:t,point:n})):(e.mark("paste"),e.putExternalContent({type:"text",text:t,point:n})):kI(e,t,n)},AI=function(){var e=Fa(Na().mark((function e(t,n,r){var i,o,a,s;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===t.editingId){e.next=2;break}return e.abrupt("return");case 2:if(n){e.next=4;break}throw Error("No clipboard data");case 4:i=[],o=Na().mark((function e(){var t;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s[a],e.t0=t.kind,e.next="file"===e.t0?4:"string"===e.t0?6:8;break;case 4:return i.push({type:"file",source:new Promise((function(e){return e(t.getAsFile())}))}),e.abrupt("break",8);case 6:return"text/html"===t.type?i.push({type:"html",source:new Promise((function(e){return t.getAsString(e)}))}):"text/plain"===t.type?i.push({type:"text",source:new Promise((function(e){return t.getAsString(e)}))}):i.push({type:t.type,source:new Promise((function(e){return t.getAsString(e)}))}),e.abrupt("break",8);case 8:case"end":return e.stop()}}),e)})),a=0,s=Object.values(n.items);case 7:if(!(a<s.length)){e.next=12;break}return e.delegateYield(o(),"t0",9);case 9:a++,e.next=7;break;case 12:LI(t,i,r);case 13:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),OI=function(){var e=Fa(Na().mark((function e(t,n,r){var i,o,a,s;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],o=J(n),e.prev=2,s=Na().mark((function e(){var t,n,r,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.value,MI(t)){n=J(t.types);try{for(n.s();!(r=n.n()).done;)(o=r.value).match(/^image\//)&&i.push({type:"blob",source:t.getType(o)})}catch(hD){n.e(hD)}finally{n.f()}}t.types.includes("text/html")&&i.push({type:"html",source:new Promise((function(e){return t.getType("text/html").then((function(t){return CI(t).then(e)}))}))}),t.types.includes("text/uri-list")&&i.push({type:"url",source:new Promise((function(e){return t.getType("text/uri-list").then((function(t){return CI(t).then(e)}))}))}),t.types.includes("text/plain")&&i.push({type:"text",source:new Promise((function(e){return t.getType("text/plain").then((function(t){return CI(t).then(e)}))}))});case 5:case"end":return e.stop()}}),e)})),o.s();case 5:if((a=o.n()).done){e.next=9;break}return e.delegateYield(s(),"t0",7);case 7:e.next=5;break;case 9:e.next=14;break;case 11:e.prev=11,e.t1=e.catch(2),o.e(e.t1);case 14:return e.prev=14,o.f(),e.finish(14);case 17:return e.next=19,LI(t,i,r);case 19:return e.abrupt("return",e.sent);case 20:case"end":return e.stop()}}),e,null,[[2,11,14,17]])})));return function(t,n,r){return e.apply(this,arguments)}}();function LI(e,t,n){return zI.apply(this,arguments)}function zI(){return zI=Fa(Na().mark((function e(t,n,r){var i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.filter((function(e){return("file"===e.type||"blob"===e.type)&&null!==e.source})),!i.length){e.next=9;break}return e.next=4,Promise.all(i.map((function(e){return e.source})));case 4:return o=e.sent,a=o.filter(Boolean).map((function(e){return URL.createObjectURL(e)})),e.next=8,bI(t,a,r);case 8:return e.abrupt("return",e.sent);case 9:return e.next=11,Promise.all(n.filter((function(e){return"file"!==e.type})).map((function(e){return new Promise((function(t){var n=e;"file"!==n.type?n.source.then((function(e){var r,i=null===(r=e.match(/<tldraw[^>]*>(.*)<\/tldraw>/))||void 0===r?void 0:r[1];if(i)try{var o=(0,rI.decompressFromBase64)(i);if(null===o)return void t({type:"error",data:o,reason:"found tldraw data comment but could not parse base64"});var a=JSON.parse(o);return"application/tldraw"!==a.type&&t({type:"error",data:a,reason:"found tldraw data comment but JSON was of a different type: ".concat(a.type)}),"string"===typeof a.data?void t({type:"error",data:a,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"}):void t({type:"tldraw",data:a.data})}catch(ej){return void t({type:"error",data:i,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"})}else{if("html"===n.type)return void t({type:"text",data:e,subtype:"html"});if("url"===n.type)return void t({type:"text",data:e,subtype:"url"});try{var s=JSON.parse(e);return"excalidraw/clipboard"===s.type?void t({type:"excalidraw",data:s}):void t({type:"text",data:e,subtype:"json"})}catch(ej){return void t({type:"text",data:e,subtype:"text"})}}t({type:"error",data:e,reason:"unhandled case"})})):t({type:"error",data:null,reason:"unexpected file"})}))})));case 11:s=e.sent,u=J(s),e.prev=13,u.s();case 15:if((l=u.n()).done){e.next=22;break}if("tldraw"!==(c=l.value).type){e.next=20;break}return xI(t,c.data,r),e.abrupt("return");case 20:e.next=15;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(13),u.e(e.t0);case 27:return e.prev=27,u.f(),e.finish(27);case 30:d=J(s),e.prev=31,d.s();case 33:if((f=d.n()).done){e.next=40;break}if("excalidraw"!==(p=f.value).type){e.next=38;break}return iI(t,p.data,r),e.abrupt("return");case 38:e.next=33;break;case 40:e.next=45;break;case 42:e.prev=42,e.t1=e.catch(31),d.e(e.t1);case 45:return e.prev=45,d.f(),e.finish(45);case 48:h=J(s),e.prev=49,h.s();case 51:if((v=h.n()).done){e.next=66;break}if("text"!==(g=v.value).type||"html"!==g.subtype){e.next=64;break}if(m=(new DOMParser).parseFromString(g.data,"text/html"),y=m.querySelector("body"),!(y&&1===Array.from(y.children).filter((function(e){return 1===e.nodeType})).length&&y.firstElementChild&&"A"===y.firstElementChild.tagName&&y.firstElementChild.hasAttribute("href")&&""!==y.firstElementChild.getAttribute("href"))){e.next=61;break}return b=y.firstElementChild.getAttribute("href"),jI(t,b,r),e.abrupt("return");case 61:if(s.some((function(e){return"text"===e.type&&"html"!==e.subtype}))||!g.data.trim()){e.next=64;break}return jI(t,TI(g.data),r),e.abrupt("return");case 64:e.next=51;break;case 66:e.next=71;break;case 68:e.prev=68,e.t2=e.catch(49),h.e(e.t2);case 71:return e.prev=71,h.f(),e.finish(71);case 74:w=J(s),e.prev=75,w.s();case 77:if((x=w.n()).done){e.next=84;break}if("text"!==(k=x.value).type||"url"!==k.subtype){e.next=82;break}return kI(t,k.data,r),e.abrupt("return");case 82:e.next=77;break;case 84:e.next=89;break;case 86:e.prev=86,e.t3=e.catch(75),w.e(e.t3);case 89:return e.prev=89,w.f(),e.finish(89);case 92:S=J(s),e.prev=93,S.s();case 95:if((_=S.n()).done){e.next=102;break}if("text"!==(P=_.value).type||"text"!==P.subtype||!P.data.trim()){e.next=100;break}return jI(t,P.data,r),e.abrupt("return");case 100:e.next=95;break;case 102:e.next=107;break;case 104:e.prev=104,e.t4=e.catch(93),S.e(e.t4);case 107:return e.prev=107,S.f(),e.finish(107);case 110:case"end":return e.stop()}}),e,null,[[13,24,27,30],[31,42,45,48],[49,68,71,74],[75,86,89,92],[93,104,107,110]])}))),zI.apply(this,arguments)}var DI=function(e){var t=e.getContent();if(t){var n=(0,rI.compressToBase64)(JSON.stringify({type:"application/tldraw",kind:"content",data:t}));if("undefined"!==typeof navigator){var r,i=t.shapes.map((function(t){return e.isShapeOfType(t,gd)||e.isShapeOfType(t,vh)||e.isShapeOfType(t,op)?t.props.text:e.isShapeOfType(t,vp)||e.isShapeOfType(t,Wc)?t.props.url:null})).filter(rt);if(null!==(r=navigator.clipboard)&&void 0!==r&&r.write){var o=new Blob(["<tldraw>".concat(n,"</tldraw>")],{type:"text/html"}),a=i.join(" ");""===a&&(a=" "),navigator.clipboard.write([new ClipboardItem({"text/html":o,"text/plain":new Blob([a],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText("<tldraw>".concat(n,"</tldraw>"))}}else navigator&&navigator.clipboard&&navigator.clipboard.writeText("")};var RI=(0,t.createContext)({});function NI(e){var n=e.children,r=G((0,t.useState)([]),2),i=r[0],o=r[1],a=(0,t.useCallback)((function(e){var t,n=null!==(t=e.id)&&void 0!==t?t:of();return o((function(t){return[].concat(u(t.filter((function(t){return t.id!==e.id}))),[Ce(Ce({},e),{},{id:n})])})),n}),[]),s=(0,t.useCallback)((function(e){return o((function(t){return t.filter((function(t){return t.id!==e}))})),e}),[]),l=(0,t.useCallback)((function(){o((function(){return[]}))}),[]);return(0,za.jsx)(RI.Provider,{value:{toasts:i,addToast:a,removeToast:s,clearToasts:l},children:n})}function BI(){var e=(0,t.useContext)(RI);if(!e)throw new Error("useToasts must be used within a ToastsProvider");return e}function FI(){var e=Va(),n=BI().addToast,r=Nx();return(0,t.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.selectedIds,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"svg";if(0===t.length&&(t=u(e.currentPageShapeIds)),0!==t.length)switch(i){case"svg":window.navigator.clipboard&&(window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":VI(e,t)})]):YI(Fa(Na().mark((function n(){return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=Wy,n.next=3,UI(e,t);case 3:return n.t1=n.sent,n.abrupt("return",(0,n.t0)(n.t1));case 5:case"end":return n.stop()}}),n)})))));break;case"jpeg":case"png":var o="jpeg"===i?"image/jpeg":"image/png",a=function(e,t,n){return HI.apply(this,arguments)}(e,t,i).then((function(e){if(e){if(window.navigator.clipboard)return e;throw new Error("Copy not supported")}throw n({id:"copy-fail",icon:"warning-triangle",title:r("toast.error.copy-fail.title"),description:r("toast.error.copy-fail.desc")}),new Error("Copy not possible")}));window.navigator.clipboard.write([new ClipboardItem(z({},o,a))]).catch((function(e){e.toString().match(/^TypeError: DOMString not supported/)||console.error(e),a.then((function(e){window.navigator.clipboard.write([new ClipboardItem(z({},o,e))])}))}));break;case"json":var s=e.getContent(t);if(window.navigator.clipboard){var l=JSON.stringify(s);window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([l],{type:"text/plain"})})]):YI(Fa(Na().mark((function e(){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l);case 1:case"end":return e.stop()}}),e)}))))}break;default:throw new Error("Copy type ".concat(i," not supported."))}}),[e,n,r])}function UI(e,t){return KI.apply(this,arguments)}function KI(){return(KI=Fa(Na().mark((function e(t,n){var r;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getSvg(n,{scale:1,background:t.instanceState.exportBackground});case 2:if(r=e.sent){e.next=5;break}throw new Error("Could not construct SVG.");case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function VI(e,t){return WI.apply(this,arguments)}function WI(){return(WI=Fa(Na().mark((function e(t,n){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Blob,e.t1=Wy,e.next=4,UI(t,n);case 4:return e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.t4=[e.t3],e.t5={type:"text/plain"},e.abrupt("return",new e.t0(e.t4,e.t5));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function HI(){return(HI=Fa(Na().mark((function e(t,n,r){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Hy,e.next=3,UI(t,n);case 3:return e.t1=e.sent,e.t2={type:r,quality:1,scale:2},e.next=7,(0,e.t0)(e.t1,e.t2);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function YI(e){return XI.apply(this,arguments)}function XI(){return(XI=Fa(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator&&navigator.clipboard){e.next=2;break}return e.abrupt("return");case 2:return e.t0=navigator.clipboard,e.next=5,t();case 5:e.t1=e.sent,e.t0.writeText.call(e.t0,e.t1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var qI=(0,t.createContext)({});function $I(e){var n=e.children,r=Va(),i=RE(),o=G((0,t.useState)([]),2),a=o[0],s=o[1],l=(0,t.useCallback)((function(e){var t,n=null!==(t=e.id)&&void 0!==t?t:of();return s((function(t){return[].concat(u(t.filter((function(t){return t.id!==e.id}))),[Ce(Ce({},e),{},{id:n})])})),i("open-menu",{source:"dialog",id:n}),r.addOpenMenu(n),n}),[r,i]),c=(0,t.useCallback)((function(e,t){return s((function(n){return n.map((function(n){return n.id===e?Ce(Ce({},n),t):n}))})),i("open-menu",{source:"dialog",id:e}),r.addOpenMenu(e),e}),[r,i]),d=(0,t.useCallback)((function(e){return s((function(t){return t.filter((function(t){var n;return t.id!==e||(null===(n=t.onClose)||void 0===n||n.call(t),!1)}))})),i("close-menu",{source:"dialog",id:e}),r.deleteOpenMenu(e),e}),[r,i]),f=(0,t.useCallback)((function(){s((function(e){return e.forEach((function(e){var t;null===(t=e.onClose)||void 0===t||t.call(e),i("close-menu",{source:"dialog",id:e.id}),r.deleteOpenMenu(e.id)})),[]}))}),[r,i]);return(0,za.jsx)(qI.Provider,{value:{dialogs:a,addDialog:l,removeDialog:d,clearDialogs:f,updateDialog:c},children:n})}function GI(){var e=(0,t.useContext)(qI);if(!e)throw new Error("useDialogs must be used within a DialogsProvider");return e}function QI(){var e=Va(),n=(0,t.useRef)();return(0,t.useEffect)((function(){var t=window.document.createElement("input");function r(e){return i.apply(this,arguments)}function i(){return i=Fa(Na().mark((function n(r){var i;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((i=r.target.files)&&0!==i.length){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,e.putExternalContent({type:"files",files:Array.from(i),point:e.viewportPageBounds.center,ignoreParent:!1});case 5:t.value="";case 6:case"end":return n.stop()}}),n)}))),i.apply(this,arguments)}return t.type="file",t.accept=Ev,t.multiple=!0,n.current=t,t.addEventListener("change",r),function(){n.current=void 0,t.removeEventListener("change",r)}}),[e]),(0,t.useCallback)((function(){var e;null===(e=n.current)||void 0===e||e.click()}),[n])}var ZI=t.createContext({});function JI(e){var n=e.overrides,r=e.children,i=Va(),o=GI(),a=o.addDialog,s=o.clearDialogs,l=BI().clearToasts,c=QI(),d=function(){var e=Va(),n=(0,t.useRef)(null),r=(0,t.useRef)(null);return(0,t.useCallback)(function(){var t=Fa(Na().mark((function t(){var i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f=function(){e.isChromeForIos?(l(),window.print()):e.isSafari?(l(),document.execCommand("print",!1)):window.print()},d=function(e,t,n){try{i.innerHTML+='<div class="'.concat(s,'__item">\n        <div class="').concat(s,'__item__header">\n          ').concat(e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),'\n        </div>\n        <div class="').concat(s,'__item__main">\n          ').concat(n.outerHTML,'\n        </div>\n        <div class="').concat(s,"__item__footer ").concat(s,"__item__footer__").concat(t?"":"hide",'">\n          ').concat(null!==t&&void 0!==t?t:"","\n        </div>\n      </div>")}catch(ej){console.error(ej)}},i=document.createElement("div"),o=document.createElement("style"),(a=function(e,t){e&&(e.innerHTML=""),t&&document.head.contains(t)&&document.head.removeChild(t),e&&document.body.contains(e)&&document.body.removeChild(e)})(n.current,r.current),n.current=i,r.current=o,s="tl-print-surface-".concat(of()),i.className=s,u=!1,o.innerHTML="\n\t\t\t.".concat(s," {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\n\t\t\t.").concat(s," svg {\n\t\t\t\tmax-width: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tdisplay: block;\n\t\t\t}\n\n\t\t\t@media print {\t\t\t\t  \n\t\t\t\thtml, body {\n\t\t\t\t\tmin-height: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tmargin: 0;\n\t\t\t\t}\n\n\t\t\t\tbody {\n\t\t\t\t\tposition: relative;\n\t\t\t\t}\n\n\t\t\t\tbody > * {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t.").concat(s," {\n\t\t\t\t\tdisplay: block !important;\n\t\t\t\t\tbackground: white;\n\t\t\t\t\tmin-height: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tmax-width: 100%;\n\t\t\t\t}\n\n\t\t\t\t.").concat(s,"__item {\n\t\t\t\t\tpadding: 10mm;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tmin-height: 100%;\n\t\t\t\t\tflex-direction: column;\n\t\t\t\t\tpage-break-after: always;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\toverflow: hidden;\n\t\t\t\t\theight: 100%;\n\t\t\t\t}\n\n\t\t\t\t.").concat(s,"__item__main {\n\t\t\t\t\tflex: 1;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tmax-height: 100%;\n\t\t\t\t}\n\n\t\t\t\t.").concat(s,"__item__header {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t.").concat(s,"__item__footer {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t\ttext-align: right;\n\t\t\t\t}\n\n\t\t\t\t.").concat(s,"__item__footer__hide {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t").concat("","\n\t\t\t}\n\n\t\t"),l=function(){document.head.appendChild(o),document.body.appendChild(i)},c=function(){e.once("change-history",(function(){a(i,o)}))},window.addEventListener("beforeprint",l),window.addEventListener("afterprint",c),p=e.pages,h=e.currentPageId,v=e.selectedIds,g={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"},!(e.selectedIds.length>0)){t.next=27;break}return t.next=23,e.getSvg(v,g);case 23:(m=t.sent)&&(y=p.find((function(e){return e.id===h})),d("tldraw \u2014 ".concat(null===y||void 0===y?void 0:y.name),null,m),f()),t.next=46;break;case 27:if(!u){t.next=41;break}b=0;case 29:if(!(b<p.length)){t.next=38;break}return w=p[b],t.next=33,e.getSvg(e.getSortedChildIds(w.id),g);case 33:(x=t.sent)&&d("tldraw \u2014 ".concat(w.name),"".concat(b,"/").concat(p.length),x);case 35:b++,t.next=29;break;case 38:f(),t.next=46;break;case 41:return k=e.currentPage,t.next=44,e.getSvg(e.getSortedChildIds(k.id),g);case 44:(S=t.sent)&&(d("tldraw \u2014 ".concat(k.name),null,S),f());case 46:window.removeEventListener("beforeprint",l),window.removeEventListener("afterprint",c);case 48:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),[e])}(),f=function(){var e=Va(),n=RE(),r=(0,t.useCallback)((function(t){0!==e.selectedIds.length&&(DI(e),n("copy",{source:t}))}),[e,n]),i=(0,t.useCallback)((function(t){0!==e.selectedIds.length&&(DI(e),e.deleteShapes(),n("cut",{source:t}))}),[e,n]),o=(0,t.useCallback)(function(){var t=Fa(Na().mark((function t(r,i,a){return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===e.editingId&&!EI(e)){t.next=2;break}return t.abrupt("return");case 2:Array.isArray(r)&&r[0]instanceof ClipboardItem?(OI(e,r,a),n("paste",{source:"menu"})):navigator.clipboard.read().then((function(e){o(e,i,a)}));case 3:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),[e,n]);return{copy:r,cut:i,paste:o}}(),p=f.cut,h=f.copy,v=f.paste,g=FI(),m=function(){var e=Va(),n=BI().addToast,r=Nx();return(0,t.useCallback)(function(){var t=Fa(Na().mark((function t(){var i,o,a,s,l,c,d,f,p,h,v=arguments;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=v.length>0&&void 0!==v[0]?v[0]:e.selectedIds,o=v.length>1&&void 0!==v[1]?v[1]:"png",0===i.length&&(i=u(e.currentPageShapeIds)),0!==i.length){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,e.getSvg(i,{scale:1,background:e.instanceState.exportBackground});case 7:if(a=t.sent){t.next=10;break}throw new Error("Could not construct SVG.");case 10:s="shapes",1===i.length&&(l=e.getShapeById(i[0]),s=e.isShapeOfType(l,qp)?null!==(c=l.props.name)&&void 0!==c?c:"frame":l.id.replace(/:/,"_")),t.t0=o,t.next="svg"===t.t0?15:"webp"===t.t0||"png"===t.t0?20:"json"===t.t0?30:35;break;case 15:return t.next=17,Xy(a);case 17:return Gy(t.sent,"".concat(s||"shapes",".svg")),t.abrupt("return");case 20:return t.next=22,Hy(a,{type:o,quality:1,scale:2});case 22:if(d=t.sent){t.next=26;break}return n({id:"export-fail",title:r("toast.error.export-fail.title"),description:r("toast.error.export-fail.desc")}),t.abrupt("return");case 26:return Gy(f=URL.createObjectURL(d),"".concat(s||"shapes",".").concat(o)),URL.revokeObjectURL(f),t.abrupt("return");case 30:return p=e.getContent(i),Gy(h=URL.createObjectURL(new Blob([JSON.stringify(p,null,4)],{type:"application/json"})),"".concat(s||"shapes",".json")),URL.revokeObjectURL(h),t.abrupt("return");case 35:throw new Error("Export type ".concat(o," not supported."));case 36:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),[e,n,r])}(),y=RE(),b=t.useMemo((function(){var e=function(e){return Object.fromEntries(e.map((function(e){return[e.id,e]})))}([{id:"edit-link",label:"action.edit-link",icon:"link",readonlyOk:!1,onSelect:function(e){y("edit-link",{source:e}),i.mark("edit-link"),a({component:eI})}},{id:"insert-embed",label:"action.insert-embed",readonlyOk:!1,kbd:"$i",onSelect:function(e){y("insert-embed",{source:e}),a({component:nI})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",readonlyOk:!1,onSelect:function(e){y("insert-media",{source:e}),c()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",readonlyOk:!1,onSelect:function(e){y("undo",{source:e}),i.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",readonlyOk:!1,onSelect:function(e){y("redo",{source:e}),i.redo()}},{id:"export-as-svg",label:"action.export-as-svg",menuLabel:"action.export-as-svg.short",contextMenuLabel:"action.export-as-svg.short",readonlyOk:!0,onSelect:function(e){y("export-as",{format:"svg",source:e}),m(i.selectedIds,"svg")}},{id:"export-as-png",label:"action.export-as-png",menuLabel:"action.export-as-png.short",contextMenuLabel:"action.export-as-png.short",readonlyOk:!0,onSelect:function(e){y("export-as",{format:"png",source:e}),m(i.selectedIds,"png")}},{id:"export-as-json",label:"action.export-as-json",menuLabel:"action.export-as-json.short",contextMenuLabel:"action.export-as-json.short",readonlyOk:!0,onSelect:function(e){y("export-as",{format:"json",source:e}),m(i.selectedIds,"json")}},{id:"copy-as-svg",label:"action.copy-as-svg",menuLabel:"action.copy-as-svg.short",contextMenuLabel:"action.copy-as-svg.short",kbd:"$!c",readonlyOk:!0,onSelect:function(e){y("copy-as",{format:"svg",source:e}),g(i.selectedIds,"svg")}},{id:"copy-as-png",label:"action.copy-as-png",menuLabel:"action.copy-as-png.short",contextMenuLabel:"action.copy-as-png.short",readonlyOk:!0,onSelect:function(e){y("copy-as",{format:"png",source:e}),g(i.selectedIds,"png")}},{id:"copy-as-json",label:"action.copy-as-json",menuLabel:"action.copy-as-json.short",contextMenuLabel:"action.copy-as-json.short",readonlyOk:!0,onSelect:function(e){y("copy-as",{format:"json",source:e}),g(i.selectedIds,"json")}},{id:"toggle-auto-size",label:"action.toggle-auto-size",readonlyOk:!1,onSelect:function(e){y("toggle-auto-size",{source:e}),i.mark(),i.updateShapes(i.selectedShapes.filter((function(e){return i.isShapeOfType(e,gd)&&!1===e.props.autoSize})).map((function(e){return{id:e.id,type:e.type,props:Ce(Ce({},e.props),{},{w:8,autoSize:!0})}})))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect:function(e){y("open-embed-link",{source:e});var t=i.selectedIds,n="No embed shapes selected";if(1===t.length){var r=i.getShapeById(t[0]);r&&i.isShapeOfType(r,Wc)?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_blank";Wa.openWindow(e,t)}(r.props.url,"_blank"):console.error(n)}else console.error(n)}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",readonlyOk:!1,onSelect:function(e){y("convert-to-bookmark",{source:e});var t,n=[],r=[],o=J(i.selectedShapes);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(a&&i.isShapeOfType(a,Wc)&&a.props.url){var s=new Xa(a.x,a.y);s.rot(-a.rotation),s.add(new Xa(a.props.w/2-150,a.props.h/2-160)),s.rot(a.rotation),n.push({id:Wi(),type:"bookmark",rotation:a.rotation,x:s.x,y:s.y,props:{url:a.props.url,opacity:"1"}}),r.push(a.id)}}}catch(hD){o.e(hD)}finally{o.f()}i.mark("convert shapes to bookmark"),i.deleteShapes(r),i.createShapes(n)}},{id:"convert-to-embed",label:"action.convert-to-embed",readonlyOk:!1,onSelect:function(e){y("convert-to-embed",{source:e});var t,n=[],r=[],o=J(Te(i.selectedIds.map((function(e){return i.getShapeById(e)}))));try{for(o.s();!(t=o.n()).done;){var a=t.value;if(i.isShapeOfType(a,vp)){var s=a.props.url,u=Fc(a.props.url);if(u&&u.definition){var l=u.definition,c=l.width,d=l.height,f=new Xa(a.x,a.y);f.rot(-a.rotation),f.add(new Xa(a.props.w/2-c/2,a.props.h/2-d/2)),f.rot(a.rotation);var p={id:Wi(),type:"embed",x:f.x,y:f.y,rotation:a.rotation,props:{url:s,w:c,h:d}};n.push(p),r.push(a.id)}}}}catch(hD){o.e(hD)}finally{o.f()}i.mark("convert shapes to embed"),i.deleteShapes(r),i.createShapes(n)}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",readonlyOk:!1,onSelect:function(e){if("select"===i.currentToolId){y("duplicate-shapes",{source:e});var t=i.selectedIds,n=ks.Common(Te(t.map((function(e){return i.getPageBoundsById(e)})))),r=i.canMoveCamera?{x:n.width+10,y:0}:{x:16/i.zoomLevel,y:16/i.zoomLevel};i.mark("duplicate shapes"),i.duplicateShapes(t,r)}}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",readonlyOk:!1,onSelect:function(e){y("ungroup-shapes",{source:e}),i.mark("ungroup"),i.ungroupShapes(i.selectedIds)}},{id:"group",label:"action.group",kbd:"$g",icon:"group",readonlyOk:!1,onSelect:function(e){y("group-shapes",{source:e});var t=i.onlySelectedShape;t&&i.isShapeOfType(t,Hp)?(i.mark("ungroup"),i.ungroupShapes(i.selectedIds)):(i.mark("group"),i.groupShapes(i.selectedIds))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",readonlyOk:!1,onSelect:function(e){y("align-shapes",{operation:"left",source:e}),i.mark("align left"),i.alignShapes("left",i.selectedIds)}},{id:"align-center-horizontal",label:"action.align-center-horizontal",contextMenuLabel:"action.align-center-horizontal.short",kbd:"?H",icon:"align-center-horizontal",readonlyOk:!1,onSelect:function(e){y("align-shapes",{operation:"center-horizontal",source:e}),i.mark("align center horizontal"),i.alignShapes("center-horizontal",i.selectedIds)}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",readonlyOk:!1,onSelect:function(e){y("align-shapes",{operation:"right",source:e}),i.mark("align right"),i.alignShapes("right",i.selectedIds)}},{id:"align-center-vertical",label:"action.align-center-vertical",contextMenuLabel:"action.align-center-vertical.short",kbd:"?V",icon:"align-center-vertical",readonlyOk:!1,onSelect:function(e){y("align-shapes",{operation:"center-vertical",source:e}),i.mark("align center vertical"),i.alignShapes("center-vertical",i.selectedIds)}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",readonlyOk:!1,onSelect:function(e){y("align-shapes",{operation:"top",source:e}),i.mark("align top"),i.alignShapes("top",i.selectedIds)}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",readonlyOk:!1,onSelect:function(e){y("align-shapes",{operation:"bottom",source:e}),i.mark("align bottom"),i.alignShapes("bottom",i.selectedIds)}},{id:"distribute-horizontal",label:"action.distribute-horizontal",contextMenuLabel:"action.distribute-horizontal.short",icon:"distribute-horizontal",kbd:"?!h",readonlyOk:!1,onSelect:function(e){y("distribute-shapes",{operation:"horizontal",source:e}),i.mark("distribute horizontal"),i.distributeShapes("horizontal",i.selectedIds)}},{id:"distribute-vertical",label:"action.distribute-vertical",contextMenuLabel:"action.distribute-vertical.short",icon:"distribute-vertical",kbd:"?!V",readonlyOk:!1,onSelect:function(e){y("distribute-shapes",{operation:"vertical",source:e}),i.mark("distribute vertical"),i.distributeShapes("vertical",i.selectedIds)}},{id:"stretch-horizontal",label:"action.stretch-horizontal",contextMenuLabel:"action.stretch-horizontal.short",icon:"stretch-horizontal",readonlyOk:!1,onSelect:function(e){y("stretch-shapes",{operation:"horizontal",source:e}),i.mark("stretch horizontal"),i.stretchShapes("horizontal",i.selectedIds)}},{id:"stretch-vertical",label:"action.stretch-vertical",contextMenuLabel:"action.stretch-vertical.short",icon:"stretch-vertical",readonlyOk:!1,onSelect:function(e){y("stretch-shapes",{operation:"vertical",source:e}),i.mark("stretch vertical"),i.stretchShapes("vertical",i.selectedIds)}},{id:"flip-horizontal",label:"action.flip-horizontal",contextMenuLabel:"action.flip-horizontal.short",kbd:"!h",readonlyOk:!1,onSelect:function(e){y("flip-shapes",{operation:"horizontal",source:e}),i.mark("flip horizontal"),i.flipShapes("horizontal",i.selectedIds)}},{id:"flip-vertical",label:"action.flip-vertical",contextMenuLabel:"action.flip-vertical.short",kbd:"!v",readonlyOk:!1,onSelect:function(e){y("flip-shapes",{operation:"vertical",source:e}),i.mark("flip vertical"),i.flipShapes("vertical",i.selectedIds)}},{id:"pack",label:"action.pack",icon:"pack",readonlyOk:!1,onSelect:function(e){y("pack-shapes",{source:e}),i.mark("pack"),i.packShapes(i.selectedIds)}},{id:"stack-vertical",label:"action.stack-vertical",contextMenuLabel:"action.stack-vertical.short",icon:"stack-vertical",readonlyOk:!1,onSelect:function(e){y("stack-shapes",{operation:"vertical",source:e}),i.mark("stack-vertical"),i.stackShapes("vertical",i.selectedIds)}},{id:"stack-horizontal",label:"action.stack-horizontal",contextMenuLabel:"action.stack-horizontal.short",icon:"stack-horizontal",readonlyOk:!1,onSelect:function(e){y("stack-shapes",{operation:"horizontal",source:e}),i.mark("stack-horizontal"),i.stackShapes("horizontal",i.selectedIds)}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",readonlyOk:!1,onSelect:function(e){y("reorder-shapes",{operation:"toFront",source:e}),i.mark("bring to front"),i.bringToFront()}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",readonlyOk:!1,onSelect:function(e){y("reorder-shapes",{operation:"forward",source:e}),i.mark("bring forward"),i.bringForward()}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",readonlyOk:!1,onSelect:function(e){y("reorder-shapes",{operation:"backward",source:e}),i.mark("send backward"),i.sendBackward()}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",readonlyOk:!1,onSelect:function(e){y("reorder-shapes",{operation:"toBack",source:e}),i.mark("send to back"),i.sendToBack()}},{id:"cut",label:"action.cut",kbd:"$x",readonlyOk:!1,onSelect:function(e){i.mark("cut"),p(e)}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect:function(e){h(e)}},{id:"paste",label:"action.paste",kbd:"$v",readonlyOk:!1,onSelect:function(e){var t;null===(t=navigator.clipboard)||void 0===t||t.read().then((function(t){v(t,e,"context-menu"===e?i.inputs.currentPagePoint:void 0)}))}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect:function(e){y("select-all-shapes",{source:e}),"select"!==i.currentToolId&&(i.cancel(),i.setSelectedTool("select")),i.mark("select all kbd"),i.selectAll()}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect:function(e){y("select-none-shapes",{source:e}),i.mark("select none"),i.selectNone()}},{id:"delete",label:"action.delete",kbd:"\u232b,del,backspace",icon:"trash",readonlyOk:!1,onSelect:function(e){"select"===i.currentToolId&&(y("delete-shapes",{source:e}),i.mark("delete"),i.deleteShapes())}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",readonlyOk:!1,onSelect:function(e){if(0!==i.selectedIds.length){y("rotate-cw",{source:e}),i.mark("rotate-cw");var t=i.selectionRotation%(Ga/2),n=ns(t,0)||ns(t,Ga/2);i.rotateShapesBy(i.selectedIds,Ga/2-(n?0:t))}}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",readonlyOk:!1,onSelect:function(e){if(0!==i.selectedIds.length){y("rotate-ccw",{source:e}),i.mark("rotate-ccw");var t=i.selectionRotation%(Ga/2),n=ns(t,0);i.rotateShapesBy(i.selectedIds,n?-Ga/2:-t)}}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect:function(e){y("zoom-in",{source:e}),i.zoomIn(i.viewportScreenCenter,{duration:Au})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect:function(e){y("zoom-out",{source:e}),i.zoomOut(i.viewportScreenCenter,{duration:Au})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect:function(e){y("reset-zoom",{source:e}),i.resetZoom(i.viewportScreenCenter,{duration:Au})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect:function(e){y("zoom-to-fit",{source:e}),i.zoomToFit({duration:Au})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect:function(e){y("zoom-to-selection",{source:e}),i.zoomToSelection({duration:Au})}},{id:"toggle-snap-mode",label:"action.toggle-snap-mode",menuLabel:"action.toggle-snap-mode.menu",readonlyOk:!1,onSelect:function(e){y("toggle-snap-mode",{source:e}),i.setSnapMode(!i.isSnapMode)},checkbox:!0},{id:"toggle-dark-mode",label:"action.toggle-dark-mode",menuLabel:"action.toggle-dark-mode.menu",kbd:"$/",readonlyOk:!0,onSelect:function(e){y("toggle-dark-mode",{source:e}),i.setDarkMode(!i.isDarkMode)},checkbox:!0},{id:"toggle-reduce-motion",label:"action.toggle-reduce-motion",menuLabel:"action.toggle-reduce-motion.menu",readonlyOk:!0,onSelect:function(e){y("toggle-reduce-motion",{source:e}),i.setAnimationSpeed(0===i.animationSpeed?1:0)},checkbox:!0},{id:"toggle-transparent",label:"action.toggle-transparent",menuLabel:"action.toggle-transparent.menu",contextMenuLabel:"action.toggle-transparent.context-menu",readonlyOk:!0,onSelect:function(e){y("toggle-transparent",{source:e}),i.updateInstanceState({exportBackground:!i.instanceState.exportBackground},!0)},checkbox:!0},{id:"toggle-tool-lock",label:"action.toggle-tool-lock",menuLabel:"action.toggle-tool-lock.menu",readonlyOk:!1,kbd:"q",onSelect:function(e){y("toggle-tool-lock",{source:e}),i.setToolLocked(!i.isToolLocked)},checkbox:!0},{id:"toggle-focus-mode",label:"action.toggle-focus-mode",menuLabel:"action.toggle-focus-mode.menu",readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect:function(e){requestAnimationFrame((function(){i.batch((function(){y("toggle-focus-mode",{source:e}),s(),l(),i.setFocusMode(!i.isFocusMode)}))}))}},{id:"toggle-grid",label:"action.toggle-grid",menuLabel:"action.toggle-grid.menu",readonlyOk:!0,kbd:"$'",onSelect:function(e){y("toggle-grid-mode",{source:e}),i.setGridMode(!i.isGridMode)},checkbox:!0},{id:"toggle-debug-mode",label:"action.toggle-debug-mode",menuLabel:"action.toggle-debug-mode.menu",readonlyOk:!0,onSelect:function(e){y("toggle-debug-mode",{source:e}),i.updateInstanceState({isDebugMode:!i.instanceState.isDebugMode},!0)},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect:function(e){y("print",{source:e}),d()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect:function(e){y("exit-pen-mode",{source:e}),i.setPenMode(!1)}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect:function(e){y("stop-following",{source:e}),i.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect:function(e){y("zoom-to-content",{source:e}),i.zoomToContent()}},{id:"toggle-lock",label:"action.toggle-lock",readonlyOk:!1,kbd:"!l",onSelect:function(e){y("toggle-lock",{source:e}),i.toggleLock()}}]);return n?n(i,e,void 0):e}),[y,n,i,a,c,m,g,p,h,v,s,l,d]);return(0,za.jsx)(ZI.Provider,{value:b,children:r})}function eT(){var e=t.useContext(ZI);if(!e)throw new Error("useTools must be used within a ToolProvider");return e}function tT(e){return e.filter((function(e){return void 0!==e&&null!==e&&!1!==e}))}function nT(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=tT(n);return 0===i.length?null:{id:e,type:"group",checkbox:i.every((function(e){return"item"===e.type&&e.actionItem.checkbox})),disabled:i.every((function(e){return e.disabled})),readonlyOk:i.some((function(e){return e.readonlyOk})),children:i}}function rT(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=tT(r);return 0===o.length?null:{id:e,type:"submenu",label:t,children:o,disabled:o.every((function(e){return e.disabled})),readonlyOk:o.some((function(e){return e.readonlyOk}))}}function iT(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.readonlyOk,r=void 0===n||n,i=t.disabled;return{id:e,type:"custom",disabled:void 0!==i&&i,readonlyOk:r}}function oT(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)throw Error("No action item provided to menuItem");if(!e.label)throw Error("Trying to create menu item for action item that doesn't have a label");var n=t.checked,r=void 0!==n&&n,i=t.disabled,o=void 0!==i&&i;return{id:e.id,type:"item",actionItem:e,disabled:o,checked:r,readonlyOk:e.readonlyOk}}function aT(e){return e.selectedIds.map((function(t){return e.getShapeById(t)})).filter((function(t){return!!t&&((!e.isShapeOfType(t,op)||"binding"!==t.props.start.type)&&(!e.isShapeOfType(t,op)||"binding"!==t.props.end.type))}))}var sT=function(){var e=Va();return _e("threeStackableItems",(function(){return aT(e).length>2}),[e])},uT=function(){var e=Va();return _e("allowGroup",(function(){return aT(e).length>1}),[e])},lT=function(){var e=Va();return _e("allowUngroup",(function(){return e.selectedIds.some((function(t){var n;return"group"===(null===(n=e.getShapeById(t))||void 0===n?void 0:n.type)}))}),[])};var cT="undefined"!==typeof window&&"navigator"in window&&Boolean(navigator.clipboard)&&Boolean(navigator.clipboard.read),dT=[0,380,420,460,580,640,840,1023],fT=t.createContext(0);function pT(e){var t=e.children,n=Va(),r=_e("breakpoint",(function(){for(var e=n.viewportScreenBounds.width,t=dT,r=0;r<t.length-1;r++)if(e>t[r]&&e<=t[r+1])return r;return t.length}),[n]);return(0,za.jsx)(fT.Provider,{value:r,children:t})}function hT(){var e=(0,t.useContext)(fT),n=new URL(window.location.href).searchParams.get("layout");return"desktop"===n?e=7:"mobile"===n&&(e=1),e}function vT(){var e=Va();return _e("hasLinkShapeSelected",(function(){var t=e.selectedShapes;return 1===t.length&&"url"in t[0].props&&"embed"!==t[0].type}),[e])}var gT=t.createContext({}),mT=ke((function(e){var n=e.overrides,r=e.children,i=Va(),o=eT(),a=i.selectedIds.length,s=a>0,u=a>1,l=a>2,c=sT(),d=uT(),f=lT(),p=vT(),h=hT(),v=1===i.zoomLevel,g=(0,t.useMemo)((function(){var e=[oT(o["align-left"],{disabled:!u}),oT(o["align-center-horizontal"],{disabled:!u}),oT(o["align-right"],{disabled:!u}),oT(o["stretch-horizontal"],{disabled:!u}),oT(o["align-top"],{disabled:!u}),oT(o["align-center-vertical"],{disabled:!u}),oT(o["align-bottom"],{disabled:!u}),oT(o["stretch-vertical"],{disabled:!u}),oT(o["distribute-horizontal"],{disabled:!l}),oT(o["distribute-vertical"],{disabled:!l}),oT(o["stack-horizontal"],{disabled:!c}),oT(o["stack-vertical"],{disabled:!c}),oT(o["send-to-back"],{disabled:!s}),oT(o["send-backward"],{disabled:!s}),oT(o["bring-forward"],{disabled:!s}),oT(o["bring-to-front"],{disabled:!s}),h<5?oT(o["zoom-to-100"],{disabled:!!v}):oT(o["rotate-ccw"],{disabled:!s}),oT(o["rotate-cw"],{disabled:!s}),oT(o["edit-link"],{disabled:!p}),d?oT(o.group,{disabled:!u}):f?oT(o.ungroup):oT(o.group,{disabled:!u})];return n?n(i,e,{actions:o,oneSelected:s,twoSelected:u,threeSelected:l}):e}),[i,v,d,n,o,s,u,l,c,f,p,h]);return(0,za.jsx)(gT.Provider,{value:g,children:r})}));function yT(){var e=Va();return _e("showAutoSizeToggle",(function(){var t=e.selectedShapes;return 1===t.length&&e.isShapeOfType(t[0],gd)&&!1===t[0].props.autoSize}),[e])}var bT=t.createContext({}),wT=ke((function(e){var n,r=e.overrides,i=e.children,o=Va(),a=eT(),s=yT(),u=function(){var e=Va();return _e("onlyFlippableShape",(function(){var t=e.selectedShapes;return 1===t.length&&t.every((function(t){return e.isShapeOfType(t,Hp)||e.isShapeOfType(t,op)||e.isShapeOfType(t,Fh)||e.isShapeOfType(t,Cp)}))}),[e])}(),l=o.selectedIds.length,c=l>0,d=_e("oneEmbedSelected",(function(){return 1===o.selectedIds.length&&o.selectedIds.some((function(e){var t=o.getShapeById(e);return t&&o.isShapeOfType(t,Wc)&&t.props.url}))}),[]),f=_e("oneEmbeddableBookmarkSelected",(function(){return 1===o.selectedIds.length&&o.selectedIds.some((function(e){var t=o.getShapeById(e);return t&&o.isShapeOfType(t,vp)&&t.props.url&&Fc(t.props.url)}))}),[]),p=l>1,h=l>2,v=sT(),g=_e("atLeastOneShapeOnPage",(function(){return o.currentPageShapeIds.size>0}),[]),m=_e("isTransparentBg",(function(){return o.instanceState.exportBackground}),[]),y=uT(),b=lT(),w=Boolean(null===(n=window.navigator.clipboard)||void 0===n?void 0:n.write),x=vT(),k=o.onlySelectedShape,S=k&&o.isShapeOrAncestorLocked(k),_=(0,t.useMemo)((function(){var e=tT([nT("selection",d&&oT(a["open-embed-link"]),d&&!S&&oT(a["convert-to-bookmark"]),f&&oT(a["convert-to-embed"]),s&&oT(a["toggle-auto-size"]),x&&!S&&oT(a["edit-link"]),c&&!S&&oT(a.duplicate),y&&!S&&oT(a.group),b&&!S&&oT(a.ungroup),c&&oT(a["toggle-lock"])),nT("modify",(p||u)&&rT("arrange","context-menu.arrange",p&&nT("align",oT(a["align-left"]),oT(a["align-center-horizontal"]),oT(a["align-right"]),oT(a["align-top"]),oT(a["align-center-vertical"]),oT(a["align-bottom"])),h&&nT("distribute",oT(a["distribute-horizontal"]),oT(a["distribute-vertical"])),p&&nT("stretch",oT(a["stretch-horizontal"]),oT(a["stretch-vertical"])),u&&!S&&nT("flip",oT(a["flip-horizontal"]),oT(a["flip-vertical"])),p&&nT("order",oT(a.pack,{disabled:!p}),v&&oT(a["stack-vertical"]),v&&oT(a["stack-horizontal"]))),c&&!S&&rT("reorder","context-menu.reorder",nT("reorder",oT(a["bring-to-front"]),oT(a["bring-forward"]),oT(a["send-backward"]),oT(a["send-to-back"]))),c&&!S&&iT("MOVE_TO_PAGE_MENU",{readonlyOk:!1})),nT("clipboard-group",c&&!S&&oT(a.cut),c&&oT(a.copy),cT&&oT(a.paste)),g&&nT("conversions",rT("copy-as","context-menu.copy-as",nT("copy-as-group",oT(a["copy-as-svg"]),w&&oT(a["copy-as-png"]),oT(a["copy-as-json"])),nT("export-bg",oT(a["toggle-transparent"],{checked:!m}))),rT("export-as","context-menu.export-as",nT("export-as-group",oT(a["export-as-svg"]),oT(a["export-as-png"]),oT(a["export-as-json"])),nT("export-bg,",oT(a["toggle-transparent"],{checked:!m})))),g&&nT("set-selection-group",oT(a["select-all"]),c&&oT(a["select-none"])),c&&!S&&nT("delete-group",oT(a.delete))]);return r&&(e=r(o,e,{actions:a,oneSelected:c,twoSelected:p,threeSelected:h,showAutoSizeToggle:s,showUngroup:b,onlyFlippableShapeSelected:u})),e}),[o,r,a,c,p,h,s,u,g,v,y,b,w,x,d,f,m,S]);return(0,za.jsx)(bT.Provider,{value:_,children:i})}));function xT(){var e=t.useContext(bT);if(!e)throw new Error("useContextMenuSchema must be used inside of a TLUiContextMenuSchemaProvider.");return e}var kT=t.createContext({});function ST(e){var n=e.overrides,r=e.children,i=Va(),o=RE(),a=GI().addDialog,s=QI(),l=_e(eu.highlighterTool),c=t.useMemo((function(){var e=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect:function(e){i.setSelectedTool("select"),o("select-tool",{source:e,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect:function(e){i.setSelectedTool("hand"),o("select-tool",{source:e,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",readonlyOk:!1,onSelect:function(e){i.setSelectedTool("eraser"),o("select-tool",{source:e,id:"eraser"})}},{id:"draw",label:"tool.draw",readonlyOk:!1,icon:"tool-pencil",kbd:"d,b,x",onSelect:function(e){i.setSelectedTool("draw"),o("select-tool",{source:e,id:"draw"})}}].concat(u(u(Go.values).map((function(e){return{id:e,label:"tool.".concat(e),readonlyOk:!1,meta:{geo:e},kbd:"rectangle"===e?"r":"ellipse"===e?"o":void 0,icon:"geo-"+e,onSelect:function(t){i.batch((function(){i.updateInstanceState({stylesForNextShape:Ce(Ce({},i.instanceState.stylesForNextShape),{},z({},Go.id,e))},!0),i.setSelectedTool("geo"),o("select-tool",{source:t,id:"geo-".concat(e)})}))}}}))),[{id:"arrow",label:"tool.arrow",readonlyOk:!1,icon:"tool-arrow",kbd:"a",onSelect:function(e){i.setSelectedTool("arrow"),o("select-tool",{source:e,id:"arrow"})}},{id:"line",label:"tool.line",readonlyOk:!1,icon:"tool-line",kbd:"l",onSelect:function(e){i.setSelectedTool("line"),o("select-tool",{source:e,id:"line"})}},{id:"frame",label:"tool.frame",readonlyOk:!1,icon:"tool-frame",kbd:"f",onSelect:function(e){i.setSelectedTool("frame"),o("select-tool",{source:e,id:"frame"})}},{id:"text",label:"tool.text",readonlyOk:!1,icon:"tool-text",kbd:"t",onSelect:function(e){i.setSelectedTool("text"),o("select-tool",{source:e,id:"text"})}},{id:"asset",label:"tool.asset",readonlyOk:!1,icon:"tool-media",kbd:"$u",onSelect:function(e){s(),o("select-tool",{source:e,id:"media"})}},{id:"note",label:"tool.note",readonlyOk:!1,icon:"tool-note",kbd:"n",onSelect:function(e){i.setSelectedTool("note"),o("select-tool",{source:e,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect:function(e){i.setSelectedTool("laser"),o("select-tool",{source:e,id:"laser"})}},{id:"embed",label:"tool.embed",readonlyOk:!1,icon:"tool-embed",onSelect:function(e){a({component:nI}),o("select-tool",{source:e,id:"embed"})}}]);l&&e.push({id:"highlight",label:"tool.highlight",readonlyOk:!0,icon:"tool-highlight",kbd:"!d",onSelect:function(e){i.setSelectedTool("highlight"),o("select-tool",{source:e,id:"highlight"})}});var t=Object.fromEntries(e.map((function(e){return[e.id,e]})));return n?n(i,t,{insertMedia:s}):t}),[l,n,i,o,s,a]);return(0,za.jsx)(kT.Provider,{value:c,children:r})}function _T(){var e=t.useContext(kT);if(!e)throw new Error("useTools must be used within a ToolProvider");return e}var PT=t.createContext({}),ET=ke((function(e){var n=e.overrides,r=e.children,i=Va(),o=_T(),a=eT(),s=(0,t.useMemo)((function(){var e=Te([nT("shortcuts-dialog.tools",oT(a["toggle-tool-lock"]),oT(o.select),oT(o.draw),oT(o.eraser),oT(o.hand),oT(o.rectangle),oT(o.ellipse),oT(o.arrow),oT(o.line),oT(o.text),oT(o.frame),oT(o.note),oT(o.laser)),nT("shortcuts-dialog.file",oT(a["insert-media"]),oT(a.print)),nT("shortcuts-dialog.preferences",oT(a["toggle-dark-mode"]),oT(a["toggle-focus-mode"]),oT(a["toggle-grid"])),nT("shortcuts-dialog.edit",oT(a.undo),oT(a.redo),oT(a.cut),oT(a.copy),oT(a.paste),oT(a["select-all"]),oT(a.delete),oT(a.duplicate),oT(a["export-as-svg"]),oT(a["export-as-png"])),nT("shortcuts-dialog.view",oT(a["zoom-in"]),oT(a["zoom-out"]),oT(a["zoom-to-100"]),oT(a["zoom-to-fit"]),oT(a["zoom-to-selection"])),nT("shortcuts-dialog.transform",oT(a["bring-to-front"]),oT(a["bring-forward"]),oT(a["send-backward"]),oT(a["send-to-back"]),oT(a.group),oT(a.ungroup),oT(a["flip-horizontal"]),oT(a["flip-vertical"]),oT(a["align-top"]),oT(a["align-center-vertical"]),oT(a["align-bottom"]),oT(a["align-left"]),oT(a["align-center-horizontal"]),oT(a["align-right"]))]);return n?n(i,e,{tools:o,actions:a}):e}),[i,n,a,o]);return(0,za.jsx)(PT.Provider,{value:s,children:r})}));function CT(){var e=Va();return _e("isReadOnlyMode",(function(){return e.isReadOnly}),[e])}var IT=function(){var e=Nx(),n=CT(),r=function(){var e=t.useContext(PT);if(!e)throw new Error("Shortcuts must be used inside of a ShortcutsProvider.");return e}();return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsxs)($x,{className:"tlui-shortcuts-dialog__header",children:[(0,za.jsx)(Gx,{children:e("shortcuts-dialog.title")}),(0,za.jsx)(Qx,{})]}),(0,za.jsx)(Zx,{className:"tlui-shortcuts-dialog__body",children:r.map((function t(r){if(n&&!r.readonlyOk)return null;switch(r.type){case"group":return(0,za.jsxs)("div",{className:"tlui-shortcuts-dialog__group",children:[(0,za.jsx)("h2",{className:"tlui-shortcuts-dialog__group__title",children:e(r.id)}),(0,za.jsx)("div",{className:"tlui-shortcuts-dialog__group__content",children:r.children.filter((function(e){return"item"===e.type&&e.actionItem.kbd})).map(t)})]},r.id);case"item":var i=r.actionItem,o=i.id,a=i.label,s=i.shortcutsLabel,u=i.kbd;return(0,za.jsxs)("div",{className:"tlui-shortcuts-dialog__key-pair",children:[(0,za.jsx)("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:e(null!==s&&void 0!==s?s:a)}),(0,za.jsx)("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:(0,za.jsx)(Yx,{children:u})})]},o)}}))}),(0,za.jsx)("div",{className:"tlui-dialog__scrim"})]})};function TT(){var e=Va();return{languages:ja,currentLanguage:e.locale}}var MT=t.createContext({}),jT=ke((function(e){var n=e.overrides,r=e.children,i=Va(),o=eT(),a=i.selectedIds.length,s=a>0,u=a>1,l=a>2,c=TT(),d=c.languages,f=c.currentLanguage,p=GI().addDialog,h=(0,t.useMemo)((function(){var e=Te([nT("top",iT("LANGUAGE_MENU",{readonlyOk:!0}),oT({id:"keyboard-shortcuts",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect:function(){p({component:IT})}}))]);return n?n(i,e,{actions:o,currentLanguage:f,languages:d,oneSelected:s,twoSelected:u,threeSelected:l}):e}),[i,n,d,o,s,u,l,f,p]);return(0,za.jsx)(MT.Provider,{value:h,children:r})}));function AT(){var e=Va();return _e("useCanRedo",(function(){return e.canRedo}),[e])}function OT(){var e=Va();return _e("useCanUndo",(function(){return e.canUndo}),[e])}var LT=t.createContext({});function zT(e){var n,r=e.overrides,i=e.children,o=Va(),a=eT(),s=hT()<5,u=_e("isDarkMode",(function(){return o.isDarkMode}),[o]),l=_e("animationSpeed",(function(){return o.animationSpeed}),[o]),c=_e("isGridMode",(function(){return o.isGridMode}),[o]),d=_e("isSnapMode",(function(){return o.isSnapMode}),[o]),f=_e("isToolLock",(function(){return o.instanceState.isToolLocked}),[o]),p=_e("isFocusMode",(function(){return o.instanceState.isFocusMode}),[o]),h=_e("isDebugMode",(function(){return o.instanceState.isDebugMode}),[o]),v=_e("exportBackground",(function(){return o.instanceState.exportBackground}),[o]),g=_e("emptyPage",(function(){return 0===o.currentPageShapeIds.size}),[o]),m=_e("selectedCount",(function(){return o.selectedIds.length}),[o]),y=0===m,b=m>0,w=m>1,x=m>2,k=Boolean(null===(n=window.navigator.clipboard)||void 0===n?void 0:n.write),S=vT(),_=yT(),P=uT(),E=lT(),C=OT(),I=AT(),T=_e("isZoomedTo100",(function(){return 1===o.zoomLevel}),[o]),M=(0,t.useMemo)((function(){var e=Te([nT("menu",rT("file","menu.file",nT("print",oT(a.print,{disabled:g}))),rT("edit","menu.edit",nT("undo-actions",oT(a.undo,{disabled:!C}),oT(a.redo,{disabled:!I})),nT("clipboard-actions",oT(a.cut,{disabled:y}),oT(a.copy,{disabled:y}),oT(a.paste,{disabled:!cT})),nT("conversions",rT("copy-as","menu.copy-as",nT("copy-as-group",oT(a["copy-as-svg"],{disabled:g}),oT(a["copy-as-png"],{disabled:g||!k}),oT(a["copy-as-json"],{disabled:g})),nT("export-bg",oT(a["toggle-transparent"],{checked:!v}))),rT("export-as","menu.export-as",nT("export-as-group",oT(a["export-as-svg"],{disabled:g}),oT(a["export-as-png"],{disabled:g}),oT(a["export-as-json"],{disabled:g})),nT("export-bg",oT(a["toggle-transparent"],{checked:!v})))),nT("set-selection-group",oT(a["select-all"],{disabled:g}),oT(a["select-none"],{disabled:!b})),nT("selection",_&&oT(a["toggle-auto-size"]),S&&oT(a["edit-link"]),oT(a.duplicate,{disabled:!b}),P&&oT(a.group),E&&oT(a.ungroup)),nT("delete-group",oT(a.delete,{disabled:!b}))),rT("view","menu.view",nT("view-actions",oT(a["zoom-in"]),oT(a["zoom-out"]),oT(a["zoom-to-100"],{disabled:T}),oT(a["zoom-to-fit"],{disabled:g}),oT(a["zoom-to-selection"],{disabled:g||!b})))),nT("extras",oT(a["insert-embed"]),oT(a["insert-media"])),nT("preferences",rT("preferences","menu.preferences",nT("preferences-actions",oT(a["toggle-snap-mode"],{checked:d}),oT(a["toggle-tool-lock"],{checked:f}),oT(a["toggle-grid"],{checked:c}),oT(a["toggle-dark-mode"],{checked:u}),oT(a["toggle-focus-mode"],{checked:p}),oT(a["toggle-reduce-motion"],{checked:0===l}),oT(a["toggle-debug-mode"],{checked:h}))),s&&iT("LANGUAGE_MENU",{readonlyOk:!0}))]);return r?r(o,e,{actions:a,noneSelected:y,oneSelected:b,twoSelected:w,threeSelected:x}):e}),[o,r,a,b,w,x,g,s,P,E,S,k,_,y,C,I,l,u,c,d,f,p,v,h,T]);return(0,za.jsx)(LT.Provider,{value:M,children:i})}function DT(e){return{id:e.id,type:"item",readonlyOk:e.readonlyOk,toolItem:e}}var RT=t.createContext([]);function NT(e){var n=e.overrides,r=e.children,i=Va(),o=_T(),a=_e(eu.highlighterTool),s=t.useMemo((function(){var e=Te([DT(o.select),DT(o.hand),DT(o.draw),DT(o.eraser),DT(o.arrow),DT(o.text),DT(o.note),DT(o.asset),DT(o.rectangle),DT(o.ellipse),DT(o.diamond),DT(o.triangle),DT(o.trapezoid),DT(o.rhombus),DT(o.pentagon),DT(o.hexagon),DT(o.star),DT(o.oval),DT(o["x-box"]),DT(o["check-box"]),DT(o["arrow-left"]),DT(o["arrow-up"]),DT(o["arrow-down"]),DT(o["arrow-right"]),DT(o.frame),DT(o.line),a?DT(o.highlight):null,DT(o.laser)]);return n?n(i,e,{tools:o}):e}),[i,a,n,o]);return(0,za.jsx)(RT.Provider,{value:s,children:r})}function BT(e){return(0,t.useMemo)((function(){return e}),e)}function FT(e){var n=BT(null==e?[]:Array.isArray(e)?e:[e]);return(0,t.useMemo)((function(){var e,t={},r=J(n);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(i.translations){var o,a=J(Xe(i.translations));try{for(a.s();!(o=a.n()).done;){var s=G(o.value,2),u=s[0],l=s[1],c=t[u];c||(c=t[u]={}),Object.assign(c,l)}}catch(hD){a.e(hD)}finally{a.f()}}}}catch(hD){r.e(hD)}finally{r.f()}return t}),[n])}function UT(e){var n=function(){var e=BI(),n=e.addToast,r=e.removeToast,i=e.clearToasts,o=GI(),a=o.addDialog,s=o.clearDialogs,u=o.removeDialog,l=o.updateDialog,c=hT()<5,d=Nx();return(0,t.useMemo)((function(){return{addToast:n,removeToast:r,clearToasts:i,addDialog:a,clearDialogs:s,removeDialog:u,updateDialog:l,msg:d,isMobile:c}}),[a,n,s,i,d,u,r,l,c])}(),r=BT(null==e?[]:Array.isArray(e)?e:[e]);return(0,t.useMemo)((function(){return function(e,t){var n,r={},i=J(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.translations){var a,s=J(Xe(o.translations));try{for(s.s();!(a=s.n()).done;){var u=G(a.value,2),l=u[0],c=u[1],d=r[l];d||(d=r[l]={}),Object.assign(d,c)}}catch(hD){s.e(hD)}finally{s.f()}}}}catch(hD){i.e(hD)}finally{i.f()}return{actionsMenu:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.actionsMenu&&(r=s.actionsMenu(n,r,Ce(Ce({},t),i)))}}catch(hD){a.e(hD)}finally{a.f()}return r},actions:function(n,r){var i,o=J(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.actions&&(r=a.actions(n,r,t))}}catch(hD){o.e(hD)}finally{o.f()}return r},contextMenu:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.contextMenu&&(r=s.contextMenu(n,r,Ce(Ce({},t),i)))}}catch(hD){a.e(hD)}finally{a.f()}return r},helpMenu:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.helpMenu&&(r=s.helpMenu(n,r,Ce(Ce({},t),i)))}}catch(hD){a.e(hD)}finally{a.f()}return r},menu:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.menu&&(r=s.menu(n,r,Ce(Ce({},t),i)))}}catch(hD){a.e(hD)}finally{a.f()}return r},toolbar:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.toolbar&&(r=s.toolbar(n,r,Ce(Ce({},t),i)))}}catch(hD){a.e(hD)}finally{a.f()}return r},keyboardShortcutsMenu:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.keyboardShortcutsMenu&&(r=s.keyboardShortcutsMenu(n,r,Ce(Ce({},t),i)))}}catch(hD){a.e(hD)}finally{a.f()}return r},tools:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.tools&&(r=s.tools(n,r,Ce(Ce({},t),i)))}}catch(hD){a.e(hD)}finally{a.f()}return r},translations:r}}(r,n)}),[r,n])}function KT(e){var t=e.overrides,n=e.assetUrls,r=e.onUiEvent,i=e.children;return(0,za.jsx)(Tx,{assetUrls:QC(n),children:(0,za.jsx)(Rx,{overrides:FT(t),children:(0,za.jsx)(DE,{onEvent:r,children:(0,za.jsx)(NI,{children:(0,za.jsx)($I,{children:(0,za.jsx)(pT,{children:(0,za.jsx)(VT,{overrides:t,children:i})})})})})})})}function VT(e){var t=e.overrides,n=e.children,r=UT(t);return(0,za.jsx)(JI,{overrides:r.actions,children:(0,za.jsx)(ST,{overrides:r.tools,children:(0,za.jsx)(NT,{overrides:r.toolbar,children:(0,za.jsx)(mT,{overrides:r.actionsMenu,children:(0,za.jsx)(ET,{overrides:r.keyboardShortcutsMenu,children:(0,za.jsx)(wT,{overrides:r.contextMenu,children:(0,za.jsx)(jT,{overrides:r.helpMenu,children:(0,za.jsx)(zT,{overrides:r.menu,children:n})})})})})})})})}function WT(){var e=Va(),n=eT()["back-to-content"],r=G((0,t.useState)(!1),2),i=r[0],o=r[1];return(0,t.useEffect)((function(){var t=!1,n=setInterval((function(){var n=e.renderingShapes.filter((function(e){return e.isInViewport})),r=0===n.length&&e.shapesArray.length>0;t!==r&&(o(r),t=r)}),1e3);return function(){clearInterval(n)}}),[e]),i?(0,za.jsx)(qx,{iconLeft:n.icon,label:n.label,onClick:function(){n.onSelect("helper-buttons"),o(!1)}}):null}var HT=0;var YT=t.memo((function(e){var t=e.renderDebugMenuItems,n=Nx();return(0,za.jsxs)("div",{className:"tlui-debug-panel",children:[(0,za.jsx)(XT,{}),(0,za.jsx)(qT,{}),(0,za.jsxs)(KE,{id:"debug",children:[(0,za.jsx)(VE,{children:(0,za.jsx)(qx,{icon:"dots-horizontal",title:n("debug-panel.more")})}),(0,za.jsx)(WE,{side:"top",align:"end",alignOffset:0,children:(0,za.jsx)($T,{renderDebugMenuItems:t})})]})]})})),XT=ke((function(){var e=Va();return(0,za.jsx)("div",{className:"tlui-debug-panel__current-state",children:e.root.path.value})})),qT=function(){var e=Va(),t=_e("rendering shapes count",(function(){return e.renderingShapes.length}),[e]);return(0,za.jsxs)("div",{children:[t," Shapes"]})},$T=ke((function(e){var n=e.renderDebugMenuItems,r=Va(),i=BI().addToast,o=GI().addDialog,a=G(t.useState(!1),2),s=a[0],l=a[1];return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsxs)(qE,{children:[(0,za.jsx)($E,{onClick:function(){i({id:of(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!"})},children:(0,za.jsx)("span",{children:"Show toast"})}),(0,za.jsx)($E,{onClick:function(){o({component:function(e){var t=e.onClose;return(0,za.jsx)(JT,{displayDontShowAgain:!0,onCancel:function(){t()},onContinue:function(){t()}})},onClose:function(){}})},children:(0,za.jsx)("span",{children:"Show dialog"})}),(0,za.jsx)($E,{onClick:function(){return function(e,t){for(var n=Array(t),r=Math.floor(Math.sqrt(t)),i=0;i<t;i++)HT++,n[i]={id:Wi("box"+HT),type:"geo",x:i%r*132,y:132*Math.floor(i/r)};e.batch((function(){e.createShapes(n).setSelectedIds(n.map((function(e){return e.id})))}))}(r,100)},children:(0,za.jsx)("span",{children:"Create 100 shapes"})}),(0,za.jsx)($E,{onClick:function(){function e(t){var n=t.children,r=0;if(!n.length)return 0;for(var i=0,o=u(n);i<o.length;i++){r++,r+=e(o[i])}return r}var t,n=r.selectedShapes,i=0===n.length?r.renderingShapes:n,o=i.map((function(e){return document.getElementById(e.id).parentElement})),a=o.length,s=J(o);try{for(s.s();!(t=s.n()).done;){a+=e(t.value)}}catch(hD){s.e(hD)}finally{s.f()}window.alert("Shapes ".concat(i.length,", DOM nodes:").concat(a))},children:(0,za.jsx)("span",{children:"Count shapes and nodes"})}),function(){if(s)throw Error("oh no!")}(),(0,za.jsx)($E,{onClick:function(){l(!0)},children:(0,za.jsx)("span",{children:"Throw error"})}),(0,za.jsx)($E,{onClick:function(){Ha()},children:(0,za.jsx)("span",{children:"Hard reset"})})]}),(0,za.jsxs)(qE,{children:[(0,za.jsx)(GT,{label:"Read-only",value:r.isReadOnly,onChange:function(e){return r.setReadOnly(e)}}),(0,za.jsx)(QT,{flag:tu.debugSvg}),(0,za.jsx)(QT,{flag:tu.forceSrgb}),(0,za.jsx)(QT,{flag:tu.debugCursors,onChange:function(e){if(e){var t=ZT.map((function(e,t){return{id:Wi(),type:"geo",x:t%5*175,y:175*Math.floor(t/5),props:{text:e,w:150,h:150,fill:"semi"}}}));r.createShapes(t)}}})]}),(0,za.jsx)(qE,{children:Object.values(eu).map((function(e){return(0,za.jsx)(QT,{flag:e},e.name)}))}),null===n||void 0===n?void 0:n()]})}));function GT(e){var t=e.label,n=e.value,r=e.onChange;return(0,za.jsx)(GE,{title:t,checked:n,onSelect:function(){return r(!n)},children:t})}var QT=ke((function(e){var t=e.flag,n=e.onChange;return(0,za.jsx)(GT,{label:t.name.replace(/([a-z0-9])([A-Z])/g,(function(e){return"".concat(e[0]," ").concat(e[1].toLowerCase())})).replace(/^[a-z]/,(function(e){return e.toUpperCase()})),value:t.value,onChange:function(e){t.set(e),null===n||void 0===n||n(e)}})})),ZT=["none","default","pointer","cross","move","grab","grabbing","text","ew-resize","ns-resize","nesw-resize","nwse-resize","nwse-rotate","nesw-rotate","senw-rotate","swne-rotate","zoom-in","zoom-out"];function JT(e){var n=e.title,r=void 0===n?"title":n,i=e.body,o=void 0===i?"hello hello hello":i,a=e.cancel,s=void 0===a?"Cancel":a,u=e.confirm,l=void 0===u?"Continue":u,c=e.displayDontShowAgain,d=void 0!==c&&c,f=e.onCancel,p=e.onContinue,h=G(t.useState(!1),2),v=h[0],g=h[1];return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsxs)($x,{children:[(0,za.jsx)(Gx,{children:r}),(0,za.jsx)(Qx,{})]}),(0,za.jsx)(Zx,{style:{maxWidth:350},children:o}),(0,za.jsxs)(Jx,{className:"tlui-dialog__footer__actions",children:[d&&(0,za.jsx)(qx,{onClick:function(){return g(!v)},iconLeft:v?"checkbox-checked":"checkbox-empty",style:{marginRight:"auto"},children:"Don't show again"}),(0,za.jsx)(qx,{onClick:f,children:s}),(0,za.jsx)(qx,{type:"primary",onClick:function(){var e=Fa(Na().mark((function e(){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",p());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),children:l})]})]})}var eM=function(e){var n=e.id,r=e.component,i=e.onClose,o=GI().removeDialog,a=Su(),s=(0,t.useCallback)((function(e){if(!e){if(i)try{i()}catch(hD){console.warn(hD)}o(n)}}),[n,i,o]);return(0,za.jsx)(_x,{onOpenChange:s,defaultOpen:!0,children:(0,za.jsx)(Px,{container:a,children:(0,za.jsx)(Ex,{dir:"ltr",className:"tlui-dialog__overlay",children:(0,za.jsx)(Cx,{dir:"ltr",className:"tlui-dialog__content",children:(0,za.jsx)(r,{onClose:function(){return s(!1)}})})})})})};var tM=t.memo((function(){var e=GI().dialogs;return(0,za.jsx)(za.Fragment,{children:e.map((function(e){return(0,za.jsx)(eM,Ce({},e),e.id)}))})}));function nM(){var e=Va(),t=_e("follow",(function(){return e.instanceState.followingUserId}),[e]);return t?(0,za.jsx)(rM,{userId:t}):null}function rM(e){var t=Ic(e.userId);return t?(0,za.jsx)("div",{className:"tlui-following",style:{borderColor:t.color}}):null}function iM(){var e=Va(),n=TT(),r=n.languages,i=n.currentLanguage,o=(0,t.useCallback)((function(t){return e.setLocale(t)}),[e]);return(0,za.jsxs)(HE,{id:"help menu language",children:[(0,za.jsx)(YE,{label:"menu.language","data-direction":"left"}),(0,za.jsx)(XE,{sideOffset:-4,children:(0,za.jsx)(qE,{children:r.map((function(e){var t=e.locale,n=e.label;return(0,za.jsx)(QE,{title:t,checked:t===i,onSelect:function(){return o(t)},children:(0,za.jsx)("span",{children:n})},t)}))})})]})}var oM=t.memo((function(){var e=Su(),t=Nx(),n=G(NE("help menu"),2),r=n[0],i=n[1];return(0,za.jsx)("div",{className:"tlui-help-menu",children:(0,za.jsxs)(SE,{dir:"ltr",open:r,onOpenChange:i,modal:!1,children:[(0,za.jsx)(_E,{className:"tlui-button tlui-help-menu__button",dir:"ltr",title:t("help-menu.title"),children:(0,za.jsx)(Ux,{icon:"question-mark"})}),(0,za.jsx)(PE,{container:e,dir:"ltr",children:(0,za.jsx)(EE,{className:"tlui-menu",side:"top",sideOffset:8,align:"end",alignOffset:0,collisionPadding:4,children:(0,za.jsx)(aM,{})})})]})})}));function aM(){var e=function(){var e=t.useContext(MT);if(!e)throw new Error("useHelpMenuSchema must be used inside of a helpTLUiMenuSchemaProvider.");return e}(),n=CT();return(0,za.jsx)(za.Fragment,{children:e.map((function e(t){if(n&&!t.readonlyOk)return null;switch(t.type){case"custom":if("LANGUAGE_MENU"===t.id)return(0,za.jsx)(iM,{},"item");break;case"group":return(0,za.jsx)(qE,{size:"small",children:t.children.map(e)},t.id);case"submenu":return(0,za.jsxs)(HE,{id:"help menu ".concat(t.id),children:[(0,za.jsx)(YE,{label:t.label}),(0,za.jsx)(XE,{children:t.children.map(e)})]},t.id);case"item":var r=t.actionItem,i=r.id,o=r.kbd,a=r.label,s=r.onSelect,u=r.icon;return(0,za.jsx)($E,{kbd:o,label:a,onClick:function(){return s("help-menu")},iconLeft:u},i)}}))})}function sM(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).checkForDefaultPrevented,r=void 0===n||n;return function(n){if(null===e||void 0===e||e(n),!1===r||!n.defaultPrevented)return null===t||void 0===t?void 0:t(n)}}function uM(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.forEach((function(t){return function(e,t){"function"===typeof e?e(t):null!==e&&void 0!==e&&(e.current=t)}(t,e)}))}}function lM(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0,t.useCallback)(uM.apply(void 0,n),n)}var cM=["scope","children"];function dM(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];var i=function(){var n=r.map((function(e){return(0,t.createContext)(e)}));return function(r){var i=(null===r||void 0===r?void 0:r[e])||n;return(0,t.useMemo)((function(){return z({},"__scope".concat(e),Ce(Ce({},r),{},z({},e,i)))}),[r,i])}};return i.scopeName=e,[function(n,i){var o=(0,t.createContext)(i),a=r.length;function s(n){var r=n.scope,i=n.children,s=gt(n,cM),u=(null===r||void 0===r?void 0:r[e][a])||o,l=(0,t.useMemo)((function(){return s}),Object.values(s));return(0,t.createElement)(u.Provider,{value:l},i)}return r=[].concat(u(r),[i]),s.displayName=n+"Provider",[s,function(r,s){var u=(null===s||void 0===s?void 0:s[e][a])||o,l=(0,t.useContext)(u);if(l)return l;if(void 0!==i)return i;throw new Error("`".concat(r,"` must be used within `").concat(n,"`"))}]},fM.apply(void 0,[i].concat(u(n)))]}function fM(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0];if(1===n.length)return i;var o=function(){var e=n.map((function(e){return{useScope:e(),scopeName:e.scopeName}}));return function(n){var r=e.reduce((function(e,t){var r=t.useScope,i=t.scopeName,o=r(n)["__scope".concat(i)];return Ce(Ce({},e),o)}),{});return(0,t.useMemo)((function(){return z({},"__scope".concat(i.scopeName),r)}),[r])}};return o.scopeName=i.scopeName,o}var pM=["children"],hM=["children"],vM=(0,t.forwardRef)((function(e,n){var r=e.children,i=gt(e,pM),o=t.Children.toArray(r),a=o.find(yM);if(a){var s=a.props.children,u=o.map((function(e){return e===a?t.Children.count(s)>1?t.Children.only(null):(0,t.isValidElement)(s)?s.props.children:null:e}));return(0,t.createElement)(gM,Zy({},i,{ref:n}),(0,t.isValidElement)(s)?(0,t.cloneElement)(s,void 0,u):null)}return(0,t.createElement)(gM,Zy({},i,{ref:n}),r)}));vM.displayName="Slot";var gM=(0,t.forwardRef)((function(e,n){var r=e.children,i=gt(e,hM);return(0,t.isValidElement)(r)?(0,t.cloneElement)(r,Ce(Ce({},function(e,t){var n=Ce({},t),r=function(){var r=e[i],o=t[i];/^on[A-Z]/.test(i)?r&&o?n[i]=function(){o.apply(void 0,arguments),r.apply(void 0,arguments)}:r&&(n[i]=r):"style"===i?n[i]=Ce(Ce({},r),o):"className"===i&&(n[i]=[r,o].filter(Boolean).join(" "))};for(var i in t)r();return Ce(Ce({},e),n)}(i,r.props)),{},{ref:uM(n,r.ref)})):t.Children.count(r)>1?t.Children.only(null):null}));gM.displayName="SlotClone";var mM=function(e){var n=e.children;return(0,t.createElement)(t.Fragment,null,n)};function yM(e){return(0,t.isValidElement)(e)&&e.type===mM}var bM=["asChild"],wM=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((function(e,n){var r=(0,t.forwardRef)((function(e,r){var i=e.asChild,o=gt(e,bM),a=i?vM:n;return(0,t.useEffect)((function(){window[Symbol.for("radix-ui")]=!0}),[]),(0,t.createElement)(a,Zy({},o,{ref:r}))}));return r.displayName="Primitive.".concat(n),Ce(Ce({},e),{},z({},n,r))}),{});function xM(e){var n=(0,t.useRef)(e);return(0,t.useEffect)((function(){n.current=e})),(0,t.useMemo)((function(){return function(){for(var e,t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return null===(t=n.current)||void 0===t?void 0:(e=t).call.apply(e,[n].concat(i))}}),[])}var kM,SM=["disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss"],_M="dismissableLayer.update",PM="dismissableLayer.pointerDownOutside",EM="dismissableLayer.focusOutside",CM=(0,t.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),IM=(0,t.forwardRef)((function(e,n){var r,i=e.disableOutsidePointerEvents,o=void 0!==i&&i,a=e.onEscapeKeyDown,s=e.onPointerDownOutside,l=e.onFocusOutside,c=e.onInteractOutside,d=e.onDismiss,f=gt(e,SM),p=(0,t.useContext)(CM),h=G((0,t.useState)(null),2),v=h[0],g=h[1],m=null!==(r=null===v||void 0===v?void 0:v.ownerDocument)&&void 0!==r?r:null===globalThis||void 0===globalThis?void 0:globalThis.document,y=G((0,t.useState)({}),2)[1],b=lM(n,(function(e){return g(e)})),w=Array.from(p.layers),x=G(u(p.layersWithOutsidePointerEventsDisabled).slice(-1),1)[0],k=w.indexOf(x),S=v?w.indexOf(v):-1,_=p.layersWithOutsidePointerEventsDisabled.size>0,P=S>=k,E=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,r=xM(e),i=(0,t.useRef)(!1),o=(0,t.useRef)((function(){}));return(0,t.useEffect)((function(){var e=function(e){if(e.target&&!i.current){var t=function(){MM(PM,r,a,{discrete:!0})},a={originalEvent:e};"touch"===e.pointerType?(n.removeEventListener("click",o.current),o.current=t,n.addEventListener("click",o.current,{once:!0})):t()}i.current=!1},t=window.setTimeout((function(){n.addEventListener("pointerdown",e)}),0);return function(){window.clearTimeout(t),n.removeEventListener("pointerdown",e),n.removeEventListener("click",o.current)}}),[n,r]),{onPointerDownCapture:function(){return i.current=!0}}}((function(e){var t=e.target,n=u(p.branches).some((function(e){return e.contains(t)}));P&&!n&&(null===s||void 0===s||s(e),null===c||void 0===c||c(e),e.defaultPrevented||null===d||void 0===d||d())}),m),C=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,r=xM(e),i=(0,t.useRef)(!1);return(0,t.useEffect)((function(){var e=function(e){e.target&&!i.current&&MM(EM,r,{originalEvent:e},{discrete:!1})};return n.addEventListener("focusin",e),function(){return n.removeEventListener("focusin",e)}}),[n,r]),{onFocusCapture:function(){return i.current=!0},onBlurCapture:function(){return i.current=!1}}}((function(e){var t=e.target;u(p.branches).some((function(e){return e.contains(t)}))||(null===l||void 0===l||l(e),null===c||void 0===c||c(e),e.defaultPrevented||null===d||void 0===d||d())}),m);return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,r=xM(e);(0,t.useEffect)((function(){var e=function(e){"Escape"===e.key&&r(e)};return n.addEventListener("keydown",e),function(){return n.removeEventListener("keydown",e)}}),[r,n])}((function(e){S===p.layers.size-1&&(null===a||void 0===a||a(e),!e.defaultPrevented&&d&&(e.preventDefault(),d()))}),m),(0,t.useEffect)((function(){if(v)return o&&(0===p.layersWithOutsidePointerEventsDisabled.size&&(kM=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(v)),p.layers.add(v),TM(),function(){o&&1===p.layersWithOutsidePointerEventsDisabled.size&&(m.body.style.pointerEvents=kM)}}),[v,m,o,p]),(0,t.useEffect)((function(){return function(){v&&(p.layers.delete(v),p.layersWithOutsidePointerEventsDisabled.delete(v),TM())}}),[v,p]),(0,t.useEffect)((function(){var e=function(){return y({})};return document.addEventListener(_M,e),function(){return document.removeEventListener(_M,e)}}),[]),(0,t.createElement)(wM.div,Zy({},f,{ref:b,style:Ce({pointerEvents:_?P?"auto":"none":void 0},e.style),onFocusCapture:sM(e.onFocusCapture,C.onFocusCapture),onBlurCapture:sM(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:sM(e.onPointerDownCapture,E.onPointerDownCapture)}))}));function TM(){var e=new CustomEvent(_M);document.dispatchEvent(e)}function MM(e,t,n,r){var i=r.discrete,o=n.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),i?function(e,t){e&&(0,fb.flushSync)((function(){return e.dispatchEvent(t)}))}(o,a):o.dispatchEvent(a)}var jM=0;function AM(){(0,t.useEffect)((function(){var e,t,n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(e=n[0])&&void 0!==e?e:OM()),document.body.insertAdjacentElement("beforeend",null!==(t=n[1])&&void 0!==t?t:OM()),jM++,function(){1===jM&&document.querySelectorAll("[data-radix-focus-guard]").forEach((function(e){return e.remove()})),jM--}}),[])}function OM(){var e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var LM=["loop","trapped","onMountAutoFocus","onUnmountAutoFocus"],zM="focusScope.autoFocusOnMount",DM="focusScope.autoFocusOnUnmount",RM={bubbles:!1,cancelable:!0},NM=(0,t.forwardRef)((function(e,n){var r=e.loop,i=void 0!==r&&r,o=e.trapped,a=void 0!==o&&o,s=e.onMountAutoFocus,u=e.onUnmountAutoFocus,l=gt(e,LM),c=G((0,t.useState)(null),2),d=c[0],f=c[1],p=xM(s),h=xM(u),v=(0,t.useRef)(null),g=lM(n,(function(e){return f(e)})),m=(0,t.useRef)({paused:!1,pause:function(){this.paused=!0},resume:function(){this.paused=!1}}).current;(0,t.useEffect)((function(){if(a){var e=function(e){if(!m.paused&&d){var t=e.target;d.contains(t)?v.current=t:KM(v.current,{select:!0})}},t=function(e){!m.paused&&d&&(d.contains(e.relatedTarget)||KM(v.current,{select:!0}))};return document.addEventListener("focusin",e),document.addEventListener("focusout",t),function(){document.removeEventListener("focusin",e),document.removeEventListener("focusout",t)}}}),[a,d,m.paused]),(0,t.useEffect)((function(){if(d){VM.add(m);var e=document.activeElement;if(!d.contains(e)){var t=new CustomEvent(zM,RM);d.addEventListener(zM,p),d.dispatchEvent(t),t.defaultPrevented||(!function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.select,i=void 0!==r&&r,o=document.activeElement,a=J(e);try{for(a.s();!(t=a.n()).done;){if(KM(t.value,{select:i}),document.activeElement!==o)return}}catch(hD){a.e(hD)}finally{a.f()}}((n=BM(d),n.filter((function(e){return"A"!==e.tagName}))),{select:!0}),document.activeElement===e&&KM(d))}return function(){d.removeEventListener(zM,p),setTimeout((function(){var t=new CustomEvent(DM,RM);d.addEventListener(DM,h),d.dispatchEvent(t),t.defaultPrevented||KM(null!==e&&void 0!==e?e:document.body,{select:!0}),d.removeEventListener(DM,h),VM.remove(m)}),0)}}var n}),[d,p,h,m]);var y=(0,t.useCallback)((function(e){if((i||a)&&!m.paused){var t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,n=document.activeElement;if(t&&n){var r=e.currentTarget,o=function(e){var t=BM(e),n=FM(t,e),r=FM(t.reverse(),e);return[n,r]}(r),s=G(o,2),u=s[0],l=s[1];u&&l?e.shiftKey||n!==l?e.shiftKey&&n===u&&(e.preventDefault(),i&&KM(l,{select:!0})):(e.preventDefault(),i&&KM(u,{select:!0})):n===r&&e.preventDefault()}}}),[i,a,m.paused]);return(0,t.createElement)(wM.div,Zy({tabIndex:-1},l,{ref:g,onKeyDown:y}))}));function BM(e){for(var t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:function(e){var t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});n.nextNode();)t.push(n.currentNode);return t}function FM(e,t){var n,r=J(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!UM(i,{upTo:t}))return i}}catch(hD){r.e(hD)}finally{r.f()}}function UM(e,t){var n=t.upTo;if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==n&&e===n)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function KM(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).select,n=void 0!==t&&t;if(e&&e.focus){var r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&n&&e.select()}}var VM=function(){var e=[];return{add:function(t){var n=e[0];t!==n&&(null===n||void 0===n||n.pause()),(e=WM(e,t)).unshift(t)},remove:function(t){var n;null===(n=(e=WM(e,t))[0])||void 0===n||n.resume()}}}();function WM(e,t){var n=u(e),r=n.indexOf(t);return-1!==r&&n.splice(r,1),n}var HM=Boolean(null===globalThis||void 0===globalThis?void 0:globalThis.document)?t.useLayoutEffect:function(){},YM=r["useId".toString()]||function(){},XM=0;function qM(e){var n=G(t.useState(YM()),2),r=n[0],i=n[1];return HM((function(){e||i((function(e){return null!==e&&void 0!==e?e:String(XM++)}))}),[e]),e||(r?"radix-".concat(r):"")}var $M=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","flipAlignment"],GM=["strategy"],QM=["mainAxis","crossAxis","limiter"],ZM=["apply"];function JM(e){return e.split("-")[0]}function ej(e){return e.split("-")[1]}function tj(e){return["top","bottom"].includes(JM(e))?"x":"y"}function nj(e){return"y"===e?"height":"width"}function rj(e,t,n){var r,i=e.reference,o=e.floating,a=i.x+i.width/2-o.width/2,s=i.y+i.height/2-o.height/2,u=tj(t),l=nj(u),c=i[l]/2-o[l]/2,d="x"===u;switch(JM(t)){case"top":r={x:a,y:i.y-o.height};break;case"bottom":r={x:a,y:i.y+i.height};break;case"right":r={x:i.x+i.width,y:s};break;case"left":r={x:i.x-o.width,y:s};break;default:r={x:i.x,y:i.y}}switch(ej(t)){case"start":r[u]-=c*(n&&d?-1:1);break;case"end":r[u]+=c*(n&&d?-1:1)}return r}var ij=function(){var e=Fa(Na().mark((function e(t,n,r){var i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.placement,o=void 0===i?"bottom":i,a=r.strategy,s=void 0===a?"absolute":a,u=r.middleware,l=void 0===u?[]:u,c=r.platform,e.next=9,null==c.isRTL?void 0:c.isRTL(n);case 9:return d=e.sent,e.next=12,c.getElementRects({reference:t,floating:n,strategy:s});case 12:f=e.sent,p=rj(f,o,d),h=p.x,v=p.y,g=o,m={},y=0,b=0;case 20:if(!(b<l.length)){e.next=55;break}return x=l[b],k=x.name,S=x.fn,e.next=26,S({x:h,y:v,initialPlacement:o,placement:g,strategy:s,middlewareData:m,rects:f,platform:c,elements:{reference:t,floating:n}});case 26:if(_=e.sent,P=_.x,E=_.y,C=_.data,I=_.reset,h=null!=P?P:h,v=null!=E?E:v,m=Ce(Ce({},m),{},z({},k,Ce(Ce({},m[k]),C))),e.t0=I&&y<=50,!e.t0){e.next=52;break}if(y++,e.t1="object"==typeof I,!e.t1){e.next=51;break}if(I.placement&&(g=I.placement),e.t2=I.rects,!e.t2){e.next=50;break}if(!0!==I.rects){e.next=48;break}return e.next=45,c.getElementRects({reference:t,floating:n,strategy:s});case 45:e.t3=e.sent,e.next=49;break;case 48:e.t3=I.rects;case 49:f=e.t3;case 50:w=rj(f,g,d),h=w.x,v=w.y;case 51:b=-1;case 52:b++,e.next=20;break;case 55:return e.abrupt("return",{x:h,y:v,placement:g,strategy:s,middlewareData:m});case 56:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function oj(e){return"number"!=typeof e?function(e){return Ce({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function aj(e){return Ce(Ce({},e),{},{top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height})}function sj(e,t){return uj.apply(this,arguments)}function uj(){return uj=Fa(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),i=t.x,o=t.y,a=t.platform,s=t.rects,u=t.elements,l=t.strategy,d=(c=n).boundary,f=void 0===d?"clippingAncestors":d,p=c.rootBoundary,h=void 0===p?"viewport":p,v=c.elementContext,g=void 0===v?"floating":v,m=c.altBoundary,y=void 0!==m&&m,b=c.padding,w=oj(void 0===b?0:b),x=u[y?"floating"===g?"reference":"floating":g],e.t0=aj,e.t1=a,e.next=24,null==a.isElement?void 0:a.isElement(x);case 24:if(e.t3=r=e.sent,e.t2=null==e.t3,e.t2){e.next=28;break}e.t2=r;case 28:if(!e.t2){e.next=32;break}e.t4=x,e.next=38;break;case 32:if(e.t5=x.contextElement,e.t5){e.next=37;break}return e.next=36,null==a.getDocumentElement?void 0:a.getDocumentElement(u.floating);case 36:e.t5=e.sent;case 37:e.t4=e.t5;case 38:return e.t6=e.t4,e.t7=f,e.t8=h,e.t9=l,e.t10={element:e.t6,boundary:e.t7,rootBoundary:e.t8,strategy:e.t9},e.next=45,e.t1.getClippingRect.call(e.t1,e.t10);case 45:if(e.t11=e.sent,k=(0,e.t0)(e.t11),e.t12=aj,!a.convertOffsetParentRelativeRectToViewportRelativeRect){e.next=61;break}return e.t14=a,e.t15="floating"===g?Ce(Ce({},s.floating),{},{x:i,y:o}):s.reference,e.next=53,null==a.getOffsetParent?void 0:a.getOffsetParent(u.floating);case 53:return e.t16=e.sent,e.t17=l,e.t18={rect:e.t15,offsetParent:e.t16,strategy:e.t17},e.next=58,e.t14.convertOffsetParentRelativeRectToViewportRelativeRect.call(e.t14,e.t18);case 58:e.t13=e.sent,e.next=62;break;case 61:e.t13=s[g];case 62:return e.t19=e.t13,S=(0,e.t12)(e.t19),e.abrupt("return",{top:k.top-S.top+w.top,bottom:S.bottom-k.bottom+w.bottom,left:k.left-S.left+w.left,right:S.right-k.right+w.right});case 65:case"end":return e.stop()}}),e)}))),uj.apply(this,arguments)}var lj=Math.min,cj=Math.max;function dj(e,t,n){return cj(e,lj(t,n))}var fj=function(e){return{name:"arrow",options:e,fn:function(t){return Fa(Na().mark((function n(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T,M,j;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=(o=null!=e?e:{}).element,s=o.padding,u=void 0===s?0:s,l=t.x,c=t.y,d=t.placement,f=t.rects,p=t.platform,null!=a){n.next=3;break}return n.abrupt("return",{});case 3:return h=oj(u),v={x:l,y:c},g=tj(d),m=ej(d),y=nj(g),n.next=10,p.getDimensions(a);case 10:return b=n.sent,w="y"===g?"top":"left",x="y"===g?"bottom":"right",k=f.reference[y]+f.reference[g]-v[g]-f.floating[y],S=v[g]-f.reference[g],n.next=17,null==p.getOffsetParent?void 0:p.getOffsetParent(a);case 17:return _=n.sent,0===(P=_?"y"===g?_.clientHeight||0:_.clientWidth||0:0)&&(P=f.floating[y]),E=k/2-S/2,C=h[w],I=P-b[y]-h[x],T=P/2-b[y]/2+E,M=dj(C,T,I),j=("start"===m?h[w]:h[x])>0&&T!==M&&f.reference[y]<=f.floating[y],n.abrupt("return",(z(i={},g,v[g]-(j?T<C?C-T:I-T:0)),z(i,"data",(z(r={},g,M),z(r,"centerOffset",T-M),r)),i));case 22:case"end":return n.stop()}}),n)})))()}}},pj={left:"right",right:"left",bottom:"top",top:"bottom"};function hj(e){return e.replace(/left|right|bottom|top/g,(function(e){return pj[e]}))}function vj(e,t,n){void 0===n&&(n=!1);var r=ej(e),i=tj(e),o=nj(i),a="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[o]>t.floating[o]&&(a=hj(a)),{main:a,cross:hj(a)}}var gj={start:"end",end:"start"};function mj(e){return e.replace(/start|end/g,(function(e){return gj[e]}))}var yj=["top","right","bottom","left"],bj=(yj.reduce((function(e,t){return e.concat(t,t+"-start",t+"-end")}),[]),function(e){return void 0===e&&(e={}),{name:"flip",options:e,fn:function(t){return Fa(Na().mark((function n(){var r,i,o,a,s,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T,M,j,A,O,L,z,D,R;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.placement,o=t.middlewareData,a=t.rects,s=t.initialPlacement,l=t.platform,c=t.elements,f=(d=e).mainAxis,p=void 0===f||f,h=d.crossAxis,v=void 0===h||h,g=d.fallbackPlacements,m=d.fallbackStrategy,y=void 0===m?"bestFit":m,b=d.flipAlignment,w=void 0===b||b,x=gt(d,$M),k=JM(i),S=g||(k!==s&&w?function(e){var t=hj(e);return[mj(e),t,mj(t)]}(s):[hj(s)]),_=[s].concat(u(S)),n.next=22,sj(t,x);case 22:if(P=n.sent,E=[],C=(null==(r=o.flip)?void 0:r.overflows)||[],p&&E.push(P[k]),!v){n.next=36;break}return n.t0=vj,n.t1=i,n.t2=a,n.next=31,null==l.isRTL?void 0:l.isRTL(c.floating);case 31:n.t3=n.sent,I=(0,n.t0)(n.t1,n.t2,n.t3),T=I.main,M=I.cross,E.push(P[T],P[M]);case 36:if(C=[].concat(u(C),[{placement:i,overflows:E}]),E.every((function(e){return e<=0}))){n.next=50;break}if(O=(null!=(j=null==(A=o.flip)?void 0:A.index)?j:0)+1,!(L=_[O])){n.next=40;break}return n.abrupt("return",{data:{index:O,overflows:C},reset:{placement:L}});case 40:z="bottom",n.t4=y,n.next="bestFit"===n.t4?44:"initialPlacement"===n.t4?47:48;break;case 44:return R=null==(D=C.map((function(e){return[e,e.overflows.filter((function(e){return e>0})).reduce((function(e,t){return e+t}),0)]})).sort((function(e,t){return e[1]-t[1]}))[0])?void 0:D[0].placement,R&&(z=R),n.abrupt("break",48);case 47:z=s;case 48:if(i===z){n.next=50;break}return n.abrupt("return",{reset:{placement:z}});case 50:return n.abrupt("return",{});case 51:case"end":return n.stop()}}),n)})))()}}});function wj(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function xj(e){return yj.some((function(t){return e[t]>=0}))}var kj=function(e){var t=void 0===e?{}:e,n=t.strategy,r=void 0===n?"referenceHidden":n,i=gt(t,GM);return{name:"hide",fn:function(e){return Fa(Na().mark((function t(){var n,o,a;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.rects,t.t0=r,t.next="referenceHidden"===t.t0?4:"escaped"===t.t0?11:18;break;case 4:return t.t1=wj,t.next=7,sj(e,Ce(Ce({},i),{},{elementContext:"reference"}));case 7:return t.t2=t.sent,t.t3=n.reference,o=(0,t.t1)(t.t2,t.t3),t.abrupt("return",{data:{referenceHiddenOffsets:o,referenceHidden:xj(o)}});case 11:return t.t4=wj,t.next=14,sj(e,Ce(Ce({},i),{},{altBoundary:!0}));case 14:return t.t5=t.sent,t.t6=n.floating,a=(0,t.t4)(t.t5,t.t6),t.abrupt("return",{data:{escapedOffsets:a,escaped:xj(a)}});case 18:return t.abrupt("return",{});case 19:case"end":return t.stop()}}),t)})))()}}},Sj=function(e){return void 0===e&&(e=0),{name:"offset",options:e,fn:function(t){return Fa(Na().mark((function n(){var r,i,o;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.x,i=t.y,n.next=4,function(){var e=Fa(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f,p,h,v,g;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.placement,i=t.platform,o=t.elements,e.next=5,null==i.isRTL?void 0:i.isRTL(o.floating);case 5:return a=e.sent,s=JM(r),u=ej(r),l="x"===tj(r),c=["left","top"].includes(s)?-1:1,d=a&&l?-1:1,f="function"==typeof n?n(t):n,p="number"==typeof f?{mainAxis:f,crossAxis:0,alignmentAxis:null}:Ce({mainAxis:0,crossAxis:0,alignmentAxis:null},f),h=p.mainAxis,v=p.crossAxis,g=p.alignmentAxis,e.abrupt("return",(u&&"number"==typeof g&&(v="end"===u?-1*g:g),l?{x:v*d,y:h*c}:{x:h*c,y:v*d}));case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,e);case 4:return o=n.sent,n.abrupt("return",{x:r+o.x,y:i+o.y,data:o});case 6:case"end":return n.stop()}}),n)})))()}}};function _j(e){return"x"===e?"y":"x"}var Pj=function(e){return void 0===e&&(e={}),{name:"shift",options:e,fn:function(t){return Fa(Na().mark((function n(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.x,o=t.y,a=t.placement,u=(s=e).mainAxis,l=void 0===u||u,c=s.crossAxis,d=void 0!==c&&c,f=s.limiter,p=void 0===f?{fn:function(e){return{x:e.x,y:e.y}}}:f,h=gt(s,QM),v={x:i,y:o},n.next=14,sj(t,h);case 14:return g=n.sent,m=tj(JM(a)),y=_j(m),b=v[m],w=v[y],l&&(x="y"===m?"bottom":"right",b=dj(b+g["y"===m?"top":"left"],b,b-g[x])),d&&(k="y"===y?"bottom":"right",w=dj(w+g["y"===y?"top":"left"],w,w-g[k])),S=p.fn(Ce(Ce({},t),{},(z(r={},m,b),z(r,y,w),r))),n.abrupt("return",Ce(Ce({},S),{},{data:{x:S.x-i,y:S.y-o}}));case 22:case"end":return n.stop()}}),n)})))()}}},Ej=function(e){return void 0===e&&(e={}),{options:e,fn:function(t){var n,r=t.x,i=t.y,o=t.placement,a=t.rects,s=t.middlewareData,u=e,l=u.offset,c=void 0===l?0:l,d=u.mainAxis,f=void 0===d||d,p=u.crossAxis,h=void 0===p||p,v={x:r,y:i},g=tj(o),m=_j(g),y=v[g],b=v[m],w="function"==typeof c?c(Ce(Ce({},a),{},{placement:o})):c,x="number"==typeof w?{mainAxis:w,crossAxis:0}:Ce({mainAxis:0,crossAxis:0},w);if(f){var k="y"===g?"height":"width",S=a.reference[g]-a.floating[k]+x.mainAxis,_=a.reference[g]+a.reference[k]-x.mainAxis;y<S?y=S:y>_&&(y=_)}if(h){var P,E,C,I,T="y"===g?"width":"height",M=["top","left"].includes(JM(o)),j=a.reference[m]-a.floating[T]+(M&&null!=(P=null==(E=s.offset)?void 0:E[m])?P:0)+(M?0:x.crossAxis),A=a.reference[m]+a.reference[T]+(M?0:null!=(C=null==(I=s.offset)?void 0:I[m])?C:0)-(M?x.crossAxis:0);b<j?b=j:b>A&&(b=A)}return z(n={},g,y),z(n,m,b),n}}},Cj=function(e){return void 0===e&&(e={}),{name:"size",options:e,fn:function(t){return Fa(Na().mark((function n(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.placement,i=t.rects,o=t.platform,a=t.elements,u=(s=e).apply,l=gt(s,ZM),n.next=9,sj(t,l);case 9:if(c=n.sent,d=JM(r),f=ej(r),"top"!==d&&"bottom"!==d){n.next=31;break}return p=d,n.t0=f,n.next=17,null==o.isRTL?void 0:o.isRTL(a.floating);case 17:if(!n.sent){n.next=21;break}n.t1="start",n.next=22;break;case 21:n.t1="end";case 22:if(n.t2=n.t1,n.t0!==n.t2){n.next=27;break}n.t3="left",n.next=28;break;case 27:n.t3="right";case 28:h=n.t3,n.next=32;break;case 31:h=d,p="end"===f?"top":"bottom";case 32:return v=cj(c.left,0),g=cj(c.right,0),m=cj(c.top,0),y=cj(c.bottom,0),b={availableHeight:i.floating.height-(["left","right"].includes(r)?2*(0!==m||0!==y?m+y:cj(c.top,c.bottom)):c[p]),availableWidth:i.floating.width-(["top","bottom"].includes(r)?2*(0!==v||0!==g?v+g:cj(c.left,c.right)):c[h])},n.next=39,o.getDimensions(a.floating);case 39:return w=n.sent,null==u||u(Ce(Ce({},t),b)),n.next=43,o.getDimensions(a.floating);case 43:return x=n.sent,n.abrupt("return",w.width!==x.width||w.height!==x.height?{reset:{rects:!0}}:{});case 45:case"end":return n.stop()}}),n)})))()}}};function Ij(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function Tj(e){if(null==e)return window;if(!Ij(e)){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Mj(e){return Tj(e).getComputedStyle(e)}function jj(e){return Ij(e)?"":e?(e.nodeName||"").toLowerCase():""}function Aj(){var e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function Oj(e){return e instanceof Tj(e).HTMLElement}function Lj(e){return e instanceof Tj(e).Element}function zj(e){return"undefined"!=typeof ShadowRoot&&(e instanceof Tj(e).ShadowRoot||e instanceof ShadowRoot)}function Dj(e){var t=Mj(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function Rj(e){return["table","td","th"].includes(jj(e))}function Nj(e){var t=/firefox/i.test(Aj()),n=Mj(e);return"none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||["transform","perspective"].includes(n.willChange)||t&&"filter"===n.willChange||t&&!!n.filter&&"none"!==n.filter}function Bj(){return!/^((?!chrome|android).)*safari/i.test(Aj())}var Fj=Math.min,Uj=Math.max,Kj=Math.round;function Vj(e,t,n){var r,i,o,a;void 0===t&&(t=!1),void 0===n&&(n=!1);var s=e.getBoundingClientRect(),u=1,l=1;t&&Oj(e)&&(u=e.offsetWidth>0&&Kj(s.width)/e.offsetWidth||1,l=e.offsetHeight>0&&Kj(s.height)/e.offsetHeight||1);var c=Lj(e)?Tj(e):window,d=!Bj()&&n,f=(s.left+(d&&null!=(r=null==(i=c.visualViewport)?void 0:i.offsetLeft)?r:0))/u,p=(s.top+(d&&null!=(o=null==(a=c.visualViewport)?void 0:a.offsetTop)?o:0))/l,h=s.width/u,v=s.height/l;return{width:h,height:v,top:p,right:f+h,bottom:p+v,left:f,x:f,y:p}}function Wj(e){return(t=e,(t instanceof Tj(t).Node?e.ownerDocument:e.document)||window.document).documentElement;var t}function Hj(e){return Lj(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Yj(e){return Vj(Wj(e)).left+Hj(e).scrollLeft}function Xj(e,t,n){var r=Oj(t),i=Wj(t),o=Vj(e,r&&function(e){var t=Vj(e);return Kj(t.width)!==e.offsetWidth||Kj(t.height)!==e.offsetHeight}(t),"fixed"===n),a={scrollLeft:0,scrollTop:0},s={x:0,y:0};if(r||!r&&"fixed"!==n)if(("body"!==jj(t)||Dj(i))&&(a=Hj(t)),Oj(t)){var u=Vj(t,!0);s.x=u.x+t.clientLeft,s.y=u.y+t.clientTop}else i&&(s.x=Yj(i));return{x:o.left+a.scrollLeft-s.x,y:o.top+a.scrollTop-s.y,width:o.width,height:o.height}}function qj(e){return"html"===jj(e)?e:e.assignedSlot||e.parentNode||(zj(e)?e.host:null)||Wj(e)}function $j(e){return Oj(e)&&"fixed"!==getComputedStyle(e).position?e.offsetParent:null}function Gj(e){for(var t=Tj(e),n=$j(e);n&&Rj(n)&&"static"===getComputedStyle(n).position;)n=$j(n);return n&&("html"===jj(n)||"body"===jj(n)&&"static"===getComputedStyle(n).position&&!Nj(n))?t:n||function(e){var t=qj(e);for(zj(t)&&(t=t.host);Oj(t)&&!["html","body"].includes(jj(t));){if(Nj(t))return t;t=t.parentNode}return null}(e)||t}function Qj(e){if(Oj(e))return{width:e.offsetWidth,height:e.offsetHeight};var t=Vj(e);return{width:t.width,height:t.height}}function Zj(e){var t=qj(e);return["html","body","#document"].includes(jj(t))?e.ownerDocument.body:Oj(t)&&Dj(t)?t:Zj(t)}function Jj(e,t){var n;void 0===t&&(t=[]);var r=Zj(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),o=Tj(r),a=i?[o].concat(o.visualViewport||[],Dj(r)?r:[]):r,s=t.concat(a);return i?s:s.concat(Jj(a))}function eA(e,t,n){return"viewport"===t?aj(function(e,t){var n=Tj(e),r=Wj(e),i=n.visualViewport,o=r.clientWidth,a=r.clientHeight,s=0,u=0;if(i){o=i.width,a=i.height;var l=Bj();(l||!l&&"fixed"===t)&&(s=i.offsetLeft,u=i.offsetTop)}return{width:o,height:a,x:s,y:u}}(e,n)):Lj(t)?function(e,t){var n=Vj(e,!1,"fixed"===t),r=n.top+e.clientTop,i=n.left+e.clientLeft;return{top:r,left:i,x:i,y:r,right:i+e.clientWidth,bottom:r+e.clientHeight,width:e.clientWidth,height:e.clientHeight}}(t,n):aj(function(e){var t,n=Wj(e),r=Hj(e),i=null==(t=e.ownerDocument)?void 0:t.body,o=Uj(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),a=Uj(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),s=-r.scrollLeft+Yj(e),u=-r.scrollTop;return"rtl"===Mj(i||n).direction&&(s+=Uj(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:a,x:s,y:u}}(Wj(e)))}var tA={getClippingRect:function(e){var t=e.element,n=e.boundary,r=e.rootBoundary,i=e.strategy,o=[].concat(u("clippingAncestors"===n?function(e){var t=Jj(e),n=["absolute","fixed"].includes(Mj(e).position)&&Oj(e)?Gj(e):e;return Lj(n)?t.filter((function(e){return Lj(e)&&function(e,t){var n=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&zj(n)){var r=t;do{if(r&&e===r)return!0;r=r.parentNode||r.host}while(r)}return!1}(e,n)&&"body"!==jj(e)})):[]}(t):[].concat(n)),[r]),a=o[0],s=o.reduce((function(e,n){var r=eA(t,n,i);return e.top=Uj(r.top,e.top),e.right=Fj(r.right,e.right),e.bottom=Fj(r.bottom,e.bottom),e.left=Uj(r.left,e.left),e}),eA(t,a,i));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){var t=e.rect,n=e.offsetParent,r=e.strategy,i=Oj(n),o=Wj(n);if(n===o)return t;var a={scrollLeft:0,scrollTop:0},s={x:0,y:0};if((i||!i&&"fixed"!==r)&&(("body"!==jj(n)||Dj(o))&&(a=Hj(n)),Oj(n))){var u=Vj(n,!0);s.x=u.x+n.clientLeft,s.y=u.y+n.clientTop}return Ce(Ce({},t),{},{x:t.x-a.scrollLeft+s.x,y:t.y-a.scrollTop+s.y})},isElement:Lj,getDimensions:Qj,getOffsetParent:Gj,getDocumentElement:Wj,getElementRects:function(e){var t=e.reference,n=e.floating,r=e.strategy;return{reference:Xj(t,Gj(n),r),floating:Ce(Ce({},Qj(n)),{},{x:0,y:0})}},getClientRects:function(e){return Array.from(e.getClientRects())},isRTL:function(e){return"rtl"===Mj(e).direction}};function nA(e,t,n,r){void 0===r&&(r={});var i=r,o=i.ancestorScroll,a=void 0===o||o,s=i.ancestorResize,l=void 0===s||s,c=i.elementResize,d=void 0===c||c,f=i.animationFrame,p=void 0!==f&&f,h=a&&!p,v=l&&!p,g=h||v?[].concat(u(Lj(e)?Jj(e):[]),u(Jj(t))):[];g.forEach((function(e){h&&e.addEventListener("scroll",n,{passive:!0}),v&&e.addEventListener("resize",n)}));var m,y=null;if(d){var b=!0;y=new ResizeObserver((function(){b||n(),b=!1})),Lj(e)&&!p&&y.observe(e),y.observe(t)}var w=p?Vj(e):null;return p&&function t(){var r=Vj(e);!w||r.x===w.x&&r.y===w.y&&r.width===w.width&&r.height===w.height||n(),w=r,m=requestAnimationFrame(t)}(),n(),function(){var e;g.forEach((function(e){h&&e.removeEventListener("scroll",n),v&&e.removeEventListener("resize",n)})),null==(e=y)||e.disconnect(),y=null,p&&cancelAnimationFrame(m)}}var rA="undefined"!==typeof document?t.useLayoutEffect:t.useEffect;function iA(e,t){if(e===t)return!0;if(typeof e!==typeof t)return!1;if("function"===typeof e&&e.toString()===t.toString())return!0;var n,r,i;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((n=e.length)!=t.length)return!1;for(r=n;0!==r--;)if(!iA(e[r],t[r]))return!1;return!0}if((n=(i=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(r=n;0!==r--;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;for(r=n;0!==r--;){var o=i[r];if(("_owner"!==o||!e.$$typeof)&&!iA(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function oA(e){var n=void 0===e?{}:e,r=n.middleware,i=n.placement,o=void 0===i?"bottom":i,a=n.strategy,s=void 0===a?"absolute":a,u=n.whileElementsMounted,l=t.useRef(null),c=t.useRef(null),d=function(e){var n=t.useRef(e);return rA((function(){n.current=e})),n}(u),f=t.useRef(null),p=G(t.useState({x:null,y:null,strategy:s,placement:o,middlewareData:{}}),2),h=p[0],v=p[1],g=G(t.useState(r),2),m=g[0],y=g[1];iA(null==m?void 0:m.map((function(e){return e.options})),null==r?void 0:r.map((function(e){return e.options})))||y(r);var b=t.useCallback((function(){l.current&&c.current&&function(e,t,n){return ij(e,t,Ce({platform:tA},n))}(l.current,c.current,{middleware:m,placement:o,strategy:s}).then((function(e){w.current&&fb.flushSync((function(){v(e)}))}))}),[m,o,s]);rA((function(){w.current&&b()}),[b]);var w=t.useRef(!1);rA((function(){return w.current=!0,function(){w.current=!1}}),[]);var x=t.useCallback((function(){if("function"===typeof f.current&&(f.current(),f.current=null),l.current&&c.current)if(d.current){var e=d.current(l.current,c.current,b);f.current=e}else b()}),[b,d]),k=t.useCallback((function(e){l.current=e,x()}),[x]),S=t.useCallback((function(e){c.current=e,x()}),[x]),_=t.useMemo((function(){return{reference:l,floating:c}}),[]);return t.useMemo((function(){return Ce(Ce({},h),{},{update:b,refs:_,reference:k,floating:S})}),[h,b,_,k,S])}var aA=function(e){var t=e.element,n=e.padding;return{name:"arrow",options:e,fn:function(e){return r=t,Object.prototype.hasOwnProperty.call(r,"current")?null!=t.current?fj({element:t.current,padding:n}).fn(e):{}:t?fj({element:t,padding:n}).fn(e):{};var r}}};var sA=["__scopePopper","virtualRef"],uA=["__scopePopper","side","sideOffset","align","alignOffset","arrowPadding","collisionBoundary","collisionPadding","sticky","hideWhenDetached","avoidCollisions","onPlaced"],lA="Popper",cA=G(dM(lA),2),dA=cA[0],fA=cA[1],pA=G(dA(lA),2),hA=pA[0],vA=pA[1],gA=function(e){var n=e.__scopePopper,r=e.children,i=G((0,t.useState)(null),2),o=i[0],a=i[1];return(0,t.createElement)(hA,{scope:n,anchor:o,onAnchorChange:a},r)},mA="PopperAnchor",yA=(0,t.forwardRef)((function(e,n){var r=e.__scopePopper,i=e.virtualRef,o=gt(e,sA),a=vA(mA,r),s=(0,t.useRef)(null),u=lM(n,s);return(0,t.useEffect)((function(){a.onAnchorChange((null===i||void 0===i?void 0:i.current)||s.current)})),i?null:(0,t.createElement)(wM.div,Zy({},o,{ref:u}))})),bA="PopperContent",wA=G(dA(bA),2),xA=wA[0],kA=(wA[1],G(dA(bA,{hasParent:!1,positionUpdateFns:new Set}),2)),SA=kA[0],_A=kA[1],PA=(0,t.forwardRef)((function(e,n){var r,i,o,a,s,u,l,c,d=e.__scopePopper,f=e.side,p=void 0===f?"bottom":f,h=e.sideOffset,v=void 0===h?0:h,g=e.align,m=void 0===g?"center":g,y=e.alignOffset,b=void 0===y?0:y,w=e.arrowPadding,x=void 0===w?0:w,k=e.collisionBoundary,S=void 0===k?[]:k,_=e.collisionPadding,P=void 0===_?0:_,E=e.sticky,C=void 0===E?"partial":E,I=e.hideWhenDetached,T=void 0!==I&&I,M=e.avoidCollisions,j=void 0===M||M,A=e.onPlaced,O=gt(e,uA),L=vA(bA,d),D=G((0,t.useState)(null),2),R=D[0],N=D[1],B=lM(n,(function(e){return N(e)})),F=G((0,t.useState)(null),2),U=F[0],K=F[1],V=function(e){var n=G((0,t.useState)(void 0),2),r=n[0],i=n[1];return HM((function(){if(e){i({width:e.offsetWidth,height:e.offsetHeight});var t=new ResizeObserver((function(t){if(Array.isArray(t)&&t.length){var n,r,o=t[0];if("borderBoxSize"in o){var a=o.borderBoxSize,s=Array.isArray(a)?a[0]:a;n=s.inlineSize,r=s.blockSize}else n=e.offsetWidth,r=e.offsetHeight;i({width:n,height:r})}}));return t.observe(e,{box:"border-box"}),function(){return t.unobserve(e)}}i(void 0)}),[e]),r}(U),W=null!==(r=null===V||void 0===V?void 0:V.width)&&void 0!==r?r:0,H=null!==(i=null===V||void 0===V?void 0:V.height)&&void 0!==i?i:0,Y=p+("center"!==m?"-"+m:""),X="number"===typeof P?P:Ce({top:0,right:0,bottom:0,left:0},P),q=Array.isArray(S)?S:[S],$=q.length>0,Q={padding:X,boundary:q.filter(CA),altBoundary:$},Z=oA({strategy:"fixed",placement:Y,whileElementsMounted:nA,middleware:[Sj({mainAxis:v+H,alignmentAxis:b}),j?Pj(Ce({mainAxis:!0,crossAxis:!1,limiter:"partial"===C?Ej():void 0},Q)):void 0,j?bj(Ce({},Q)):void 0,Cj(Ce(Ce({},Q),{},{apply:function(e){var t=e.elements,n=e.rects,r=e.availableWidth,i=e.availableHeight,o=n.reference,a=o.width,s=o.height,u=t.floating.style;u.setProperty("--radix-popper-available-width","".concat(r,"px")),u.setProperty("--radix-popper-available-height","".concat(i,"px")),u.setProperty("--radix-popper-anchor-width","".concat(a,"px")),u.setProperty("--radix-popper-anchor-height","".concat(s,"px"))}})),U?aA({element:U,padding:x}):void 0,IA({arrowWidth:W,arrowHeight:H}),T?kj({strategy:"referenceHidden"}):void 0].filter(EA)}),J=Z.reference,ee=Z.floating,te=Z.strategy,ne=Z.x,re=Z.y,ie=Z.placement,oe=Z.middlewareData,ae=Z.update;HM((function(){J(L.anchor)}),[J,L.anchor]);var se=null!==ne&&null!==re,ue=G(TA(ie),2),le=ue[0],ce=ue[1],de=xM(A);HM((function(){se&&(null===de||void 0===de||de())}),[se,de]);var fe=null===(o=oe.arrow)||void 0===o?void 0:o.x,pe=null===(a=oe.arrow)||void 0===a?void 0:a.y,he=0!==(null===(s=oe.arrow)||void 0===s?void 0:s.centerOffset),ve=G((0,t.useState)(),2),ge=ve[0],me=ve[1];HM((function(){R&&me(window.getComputedStyle(R).zIndex)}),[R]);var ye=_A(bA,d),be=ye.hasParent,we=ye.positionUpdateFns,xe=!be;(0,t.useLayoutEffect)((function(){if(!xe)return we.add(ae),function(){we.delete(ae)}}),[xe,we,ae]),HM((function(){xe&&se&&Array.from(we).reverse().forEach((function(e){return requestAnimationFrame(e)}))}),[xe,se,we]);var ke=Ce(Ce({"data-side":le,"data-align":ce},O),{},{ref:B,style:Ce(Ce({},O.style),{},{animation:se?void 0:"none",opacity:null!==(u=oe.hide)&&void 0!==u&&u.referenceHidden?0:void 0})});return(0,t.createElement)("div",{ref:ee,"data-radix-popper-content-wrapper":"",style:z({position:te,left:0,top:0,transform:se?"translate3d(".concat(Math.round(ne),"px, ").concat(Math.round(re),"px, 0)"):"translate3d(0, -200%, 0)",minWidth:"max-content",zIndex:ge},"--radix-popper-transform-origin",[null===(l=oe.transformOrigin)||void 0===l?void 0:l.x,null===(c=oe.transformOrigin)||void 0===c?void 0:c.y].join(" ")),dir:e.dir},(0,t.createElement)(xA,{scope:d,placedSide:le,onArrowChange:K,arrowX:fe,arrowY:pe,shouldHideArrow:he},xe?(0,t.createElement)(SA,{scope:d,hasParent:!0,positionUpdateFns:we},(0,t.createElement)(wM.div,ke)):(0,t.createElement)(wM.div,ke)))}));function EA(e){return void 0!==e}function CA(e){return null!==e}var IA=function(e){return{name:"transformOrigin",options:e,fn:function(t){var n,r,i,o,a,s=t.placement,u=t.rects,l=t.middlewareData,c=0!==(null===(n=l.arrow)||void 0===n?void 0:n.centerOffset),d=c?0:e.arrowWidth,f=c?0:e.arrowHeight,p=G(TA(s),2),h=p[0],v={start:"0%",center:"50%",end:"100%"}[p[1]],g=(null!==(r=null===(i=l.arrow)||void 0===i?void 0:i.x)&&void 0!==r?r:0)+d/2,m=(null!==(o=null===(a=l.arrow)||void 0===a?void 0:a.y)&&void 0!==o?o:0)+f/2,y="",b="";return"bottom"===h?(y=c?v:"".concat(g,"px"),b="".concat(-f,"px")):"top"===h?(y=c?v:"".concat(g,"px"),b="".concat(u.floating.height+f,"px")):"right"===h?(y="".concat(-f,"px"),b=c?v:"".concat(m,"px")):"left"===h&&(y="".concat(u.floating.width+f,"px"),b=c?v:"".concat(m,"px")),{data:{x:y,y:b}}}}};function TA(e){var t=G(e.split("-"),2),n=t[0],r=t[1];return[n,void 0===r?"center":r]}var MA=gA,jA=yA,AA=PA,OA=["container"],LA=(0,t.forwardRef)((function(e,n){var r,i=e.container,o=void 0===i?null===globalThis||void 0===globalThis||null===(r=globalThis.document)||void 0===r?void 0:r.body:i,a=gt(e,OA);return o?fb.createPortal((0,t.createElement)(wM.div,Zy({},a,{ref:n})),o):null}));var zA=function(e){var n=e.present,r=e.children,i=function(e){var n=G((0,t.useState)(),2),r=n[0],i=n[1],o=(0,t.useRef)({}),a=(0,t.useRef)(e),s=(0,t.useRef)("none"),u=e?"mounted":"unmounted",l=function(e,n){return(0,t.useReducer)((function(e,t){var r=n[e][t];return null!==r&&void 0!==r?r:e}),e)}(u,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),c=G(l,2),d=c[0],f=c[1];return(0,t.useEffect)((function(){var e=DA(o.current);s.current="mounted"===d?e:"none"}),[d]),HM((function(){var t=o.current,n=a.current;if(n!==e){var r=s.current,i=DA(t);if(e)f("MOUNT");else if("none"===i||"none"===(null===t||void 0===t?void 0:t.display))f("UNMOUNT");else{f(n&&r!==i?"ANIMATION_OUT":"UNMOUNT")}a.current=e}}),[e,f]),HM((function(){if(r){var e=function(e){var t=DA(o.current).includes(e.animationName);e.target===r&&t&&(0,fb.flushSync)((function(){return f("ANIMATION_END")}))},t=function(e){e.target===r&&(s.current=DA(o.current))};return r.addEventListener("animationstart",t),r.addEventListener("animationcancel",e),r.addEventListener("animationend",e),function(){r.removeEventListener("animationstart",t),r.removeEventListener("animationcancel",e),r.removeEventListener("animationend",e)}}f("ANIMATION_END")}),[r,f]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:(0,t.useCallback)((function(e){e&&(o.current=getComputedStyle(e)),i(e)}),[])}}(n),o="function"===typeof r?r({present:i.isPresent}):t.Children.only(r),a=lM(i.ref,o.ref);return"function"===typeof r||i.isPresent?(0,t.cloneElement)(o,{ref:a}):null};function DA(e){return(null===e||void 0===e?void 0:e.animationName)||"none"}function RA(e){var n=e.prop,r=e.defaultProp,i=e.onChange,o=void 0===i?function(){}:i,a=function(e){var n=e.defaultProp,r=e.onChange,i=(0,t.useState)(n),o=G(i,1)[0],a=(0,t.useRef)(o),s=xM(r);return(0,t.useEffect)((function(){a.current!==o&&(s(o),a.current=o)}),[o,a,s]),i}({defaultProp:r,onChange:o}),s=G(a,2),u=s[0],l=s[1],c=void 0!==n,d=c?n:u,f=xM(o);return[d,(0,t.useCallback)((function(e){if(c){var t="function"===typeof e?e(n):e;t!==n&&f(t)}else l(e)}),[c,n,l,f])]}zA.displayName="Presence";var NA=["__scopePopover"],BA=["forceMount"],FA=["__scopePopover","trapFocus","onOpenAutoFocus","onCloseAutoFocus","disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside"],UA="Popover",KA=G(dM(UA,[fA]),2),VA=KA[0],WA=(KA[1],fA()),HA=G(VA(UA),2),YA=HA[0],XA=HA[1],qA=function(e){var n=e.__scopePopover,r=e.children,i=e.open,o=e.defaultOpen,a=e.onOpenChange,s=e.modal,u=void 0!==s&&s,l=WA(n),c=(0,t.useRef)(null),d=G((0,t.useState)(!1),2),f=d[0],p=d[1],h=G(RA({prop:i,defaultProp:o,onChange:a}),2),v=h[0],g=void 0!==v&&v,m=h[1];return(0,t.createElement)(MA,l,(0,t.createElement)(YA,{scope:n,contentId:qM(),triggerRef:c,open:g,onOpenChange:m,onOpenToggle:(0,t.useCallback)((function(){return m((function(e){return!e}))}),[m]),hasCustomAnchor:f,onCustomAnchorAdd:(0,t.useCallback)((function(){return p(!0)}),[]),onCustomAnchorRemove:(0,t.useCallback)((function(){return p(!1)}),[]),modal:u},r))},$A="PopoverTrigger",GA=(0,t.forwardRef)((function(e,n){var r=e.__scopePopover,i=gt(e,NA),o=XA($A,r),a=WA(r),s=lM(n,o.triggerRef),u=(0,t.createElement)(wM.button,Zy({type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":sO(o.open)},i,{ref:s,onClick:sM(e.onClick,o.onOpenToggle)}));return o.hasCustomAnchor?u:(0,t.createElement)(jA,Zy({asChild:!0},a),u)})),QA="PopoverPortal",ZA=G(VA(QA,{forceMount:void 0}),2),JA=ZA[0],eO=ZA[1],tO=function(e){var n=e.__scopePopover,r=e.forceMount,i=e.children,o=e.container,a=XA(QA,n);return(0,t.createElement)(JA,{scope:n,forceMount:r},(0,t.createElement)(zA,{present:r||a.open},(0,t.createElement)(LA,{asChild:!0,container:o},i)))},nO="PopoverContent",rO=(0,t.forwardRef)((function(e,n){var r=eO(nO,e.__scopePopover),i=e.forceMount,o=void 0===i?r.forceMount:i,a=gt(e,BA),s=XA(nO,e.__scopePopover);return(0,t.createElement)(zA,{present:o||s.open},s.modal?(0,t.createElement)(iO,Zy({},a,{ref:n})):(0,t.createElement)(oO,Zy({},a,{ref:n})))})),iO=(0,t.forwardRef)((function(e,n){var r=XA(nO,e.__scopePopover),i=(0,t.useRef)(null),o=lM(n,i),a=(0,t.useRef)(!1);return(0,t.useEffect)((function(){var e=i.current;if(e)return Ww(e)}),[]),(0,t.createElement)(Dw,{as:vM,allowPinchZoom:!0},(0,t.createElement)(aO,Zy({},e,{ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:sM(e.onCloseAutoFocus,(function(e){var t;e.preventDefault(),a.current||null===(t=r.triggerRef.current)||void 0===t||t.focus()})),onPointerDownOutside:sM(e.onPointerDownOutside,(function(e){var t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey,r=2===t.button||n;a.current=r}),{checkForDefaultPrevented:!1}),onFocusOutside:sM(e.onFocusOutside,(function(e){return e.preventDefault()}),{checkForDefaultPrevented:!1})})))})),oO=(0,t.forwardRef)((function(e,n){var r=XA(nO,e.__scopePopover),i=(0,t.useRef)(!1),o=(0,t.useRef)(!1);return(0,t.createElement)(aO,Zy({},e,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:function(t){var n,a;(null===(n=e.onCloseAutoFocus)||void 0===n||n.call(e,t),t.defaultPrevented)||(i.current||null===(a=r.triggerRef.current)||void 0===a||a.focus(),t.preventDefault());i.current=!1,o.current=!1},onInteractOutside:function(t){var n,a;null===(n=e.onInteractOutside)||void 0===n||n.call(e,t),t.defaultPrevented||(i.current=!0,"pointerdown"===t.detail.originalEvent.type&&(o.current=!0));var s=t.target;(null===(a=r.triggerRef.current)||void 0===a?void 0:a.contains(s))&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&o.current&&t.preventDefault()}}))})),aO=(0,t.forwardRef)((function(e,n){var r=e.__scopePopover,i=e.trapFocus,o=e.onOpenAutoFocus,a=e.onCloseAutoFocus,s=e.disableOutsidePointerEvents,u=e.onEscapeKeyDown,l=e.onPointerDownOutside,c=e.onFocusOutside,d=e.onInteractOutside,f=gt(e,FA),p=XA(nO,r),h=WA(r);return AM(),(0,t.createElement)(NM,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:o,onUnmountAutoFocus:a},(0,t.createElement)(IM,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:d,onEscapeKeyDown:u,onPointerDownOutside:l,onFocusOutside:c,onDismiss:function(){return p.onOpenChange(!1)}},(0,t.createElement)(AA,Zy({"data-state":sO(p.open),role:"dialog",id:p.contentId},h,f,{ref:n,style:Ce(Ce({},f.style),{},{"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"})}))))}));function sO(e){return e?"open":"closed"}var uO=qA,lO=GA,cO=tO,dO=rO,fO=function(e){var t=e.id,n=e.children,r=G(NE(t,e.onOpenChange),2),i=r[0],o=r[1];return(0,za.jsx)(uO,{onOpenChange:o,open:i,children:(0,za.jsx)("div",{className:"tlui-popover",children:n})})},pO=function(e){var t=e.children,n=e.disabled,r=e["data-testid"];return(0,za.jsx)(lO,{"data-testid":r,disabled:n,asChild:!0,dir:"ltr",children:t})},hO=function(e){var t=e.side,n=e.children,r=e.align,i=void 0===r?"center":r,o=e.sideOffset,a=void 0===o?8:o,s=e.alignOffset,u=void 0===s?0:s,l=Su();return(0,za.jsx)(cO,{dir:"ltr",container:l,children:(0,za.jsx)(dO,{className:"tlui-popover__content",side:t,sideOffset:a,align:i,alignOffset:u,dir:"ltr",children:n})})},vO=(0,t.memo)((function(){var e=Nx(),n=Su(),r=function(){var e=t.useContext(gT);if(!e)throw new Error("useActionsMenuSchema must be used inside of a ActionsMenuSchemaProvider.");return e}(),i=CT();return(0,za.jsxs)(fO,{id:"actions menu",children:[(0,za.jsx)(pO,{children:(0,za.jsx)(qx,{className:"tlui-menu__trigger","data-testid":"main.action-menu",icon:"dots-vertical",title:e("actions-menu.title"),smallIcon:!0})}),(0,za.jsx)(cO,{dir:"ltr",container:n,children:(0,za.jsx)(dO,{className:"tlui-popover__content",side:"bottom",dir:"ltr",sideOffset:6,children:(0,za.jsx)("div",{className:"tlui-actions-menu tlui-button-grid__four",children:r.map((function(t){if(i&&!t.readonlyOk)return null;if("item"===t.type){var n=t.actionItem,r=n.id,o=n.icon,a=n.label,s=n.kbd,u=n.onSelect;return(0,za.jsx)(qx,{className:"tlui-button-grid__button","data-testid":"menu-item.".concat(t.id),icon:o,title:a?s?"".concat(e(a)," ").concat(Hx(s)):"".concat(e(a)):s?"".concat(Hx(s)):"",onClick:function(){return u("actions-menu")},disabled:t.disabled},r)}}))})})})]})})),gO=ke((function(){var e=Va(),t=eT(),n=Nx(),r=t.duplicate,i=e.selectedIds.length<=0;return(0,za.jsx)(qx,{icon:r.icon,onClick:function(){return r.onSelect("quick-actions")},disabled:i,title:"".concat(n(r.label)," ").concat(Hx(r.kbd)),smallIcon:!0})})),mO=t.memo((function(){var e=Nx();return(0,za.jsxs)(KE,{id:"main menu",children:[(0,za.jsx)(VE,{children:(0,za.jsx)(qx,{className:"tlui-menu__trigger","data-testid":"main.menu",title:e("menu.title"),icon:"menu"})}),(0,za.jsx)(WE,{alignOffset:0,sideOffset:6,children:(0,za.jsx)(yO,{})})]})}));function yO(){var e=Va(),n=Nx(),r=function(){var e=t.useContext(LT);if(!e)throw new Error("useMenuSchema must be used inside of a TLUiMenuSchemaProvider.");return e}(),i=hT(),o=CT();function a(e,t,r,s){switch(t.type){case"custom":return o&&!t.readonlyOk?null:"LANGUAGE_MENU"===t.id?(0,za.jsx)(iM,{},"item"):null;case"group":return o&&!t.readonlyOk?null:(0,za.jsx)(qE,{size:s<=1?"medium":i<3||"submenu"===(null===r||void 0===r?void 0:r.type)&&s>2?"tiny":"medium",children:t.children.map((function(n){return a(e,n,t,s+1)}))},t.id);case"submenu":return o&&!t.readonlyOk?null:(0,za.jsxs)(HE,{id:"main menu ".concat(r?r.id+" ":"").concat(t.id),children:[(0,za.jsx)(YE,{label:t.label,"data-testid":"menu-item.".concat(t.id)}),(0,za.jsx)(XE,{sideOffset:-4,alignOffset:-1,children:t.children.map((function(n){return a(e,n,t,s+1)}))})]},t.id);case"item":if(o&&!t.readonlyOk)return null;var u=t.actionItem,l=u.id,c=u.checkbox,d=u.menuLabel,f=u.label,p=u.onSelect,h=u.kbd,v=null!==d&&void 0!==d?d:f,g=v?n(v):void 0;return c?(0,za.jsxs)(GE,{onSelect:function(){return p("menu")},title:g||"",checked:t.checked,disabled:t.disabled,children:[g&&(0,za.jsx)("span",{children:g}),h&&(0,za.jsx)(Yx,{children:h})]},l):(0,za.jsx)($E,{"data-testid":"menu-item.".concat(t.id),kbd:h,label:v,onClick:function(){return p("menu")},disabled:t.disabled},l)}}return(0,za.jsx)(za.Fragment,{children:r.map((function(t){return a(e,t,null,0)}))})}var bO=function(e){var n=e.name,r=e.id,i=e.isCurrentPage,o=Va(),a=(0,t.useRef)(null),s=(0,t.useCallback)((function(e){o.renamePage(r,e||"New Page",!0)}),[o,r]),u=(0,t.useCallback)((function(e){o.mark("rename page"),o.renamePage(r,e||"New Page",!1)}),[o,r]);return(0,za.jsx)(ZC,{className:"tlui-page-menu__item__input",ref:function(e){return a.current=e},defaultValue:n,onValueChange:s,onComplete:u,onCancel:u,shouldManuallyMaintainScrollPositionWhenFocused:!0,autofocus:i,autoselect:!0})},wO=function(e,t,n,r){var i,o=e.pages,a=n>r?o[r-1]:o[r],s=n>r?o[r]:o[r+1];(i=a&&!s?C(a.index):!a&&s?function(e){return S(void 0,e,1)[0]}(o[0].index):E(a.index,s.index))!==o[n].index&&(e.mark("moving page"),e.updatePage({id:t,index:i}))},xO=ke((function(e){var n=e.index,r=e.listSize,i=e.item,o=e.onRename,a=Va(),s=Nx(),u=a.pages,l=(0,t.useCallback)((function(){a.mark("creating page");var e=Dn.createId();a.duplicatePage(i.id,e)}),[a,i]),c=(0,t.useCallback)((function(){wO(a,i.id,n,n-1)}),[a,i,n]),d=(0,t.useCallback)((function(){wO(a,i.id,n,n+1)}),[a,i,n]),f=(0,t.useCallback)((function(){a.mark("deleting page"),a.deletePage(i.id)}),[a,i]);return(0,za.jsxs)(KE,{id:"page item submenu ".concat(n),children:[(0,za.jsx)(VE,{children:(0,za.jsx)(qx,{title:s("page-menu.submenu.title"),icon:"dots-vertical"})}),(0,za.jsxs)(WE,{alignOffset:0,children:[(0,za.jsxs)(qE,{children:[o&&(0,za.jsx)(IE,{dir:"ltr",onSelect:o,asChild:!0,children:(0,za.jsx)(qx,{className:"tlui-menu__button",label:"page-menu.submenu.rename"})}),(0,za.jsx)(IE,{dir:"ltr",onSelect:l,disabled:u.length>=40,asChild:!0,children:(0,za.jsx)(qx,{className:"tlui-menu__button",label:"page-menu.submenu.duplicate-page"})}),n>0&&(0,za.jsx)(IE,{dir:"ltr",onSelect:c,asChild:!0,children:(0,za.jsx)(qx,{className:"tlui-menu__button",label:"page-menu.submenu.move-up"})}),n<r-1&&(0,za.jsx)(IE,{dir:"ltr",onSelect:d,asChild:!0,children:(0,za.jsx)(qx,{className:"tlui-menu__button",label:"page-menu.submenu.move-down"})})]}),r>1&&(0,za.jsx)(qE,{children:(0,za.jsx)(IE,{dir:"ltr",onSelect:f,asChild:!0,children:(0,za.jsx)(qx,{className:"tlui-menu__button",label:"page-menu.submenu.delete"})})})]})]})})),kO=function(){var e=Va(),n=Nx(),r=hT(),i=G(NE("page-menu",(0,t.useCallback)((function(){return g(!1)}),[])),2),o=i[0],a=i[1],s=r<5?36:40,u=(0,t.useRef)(null),l=_e("pages",(function(){return e.pages}),[e]),c=_e("currentPage",(function(){return e.currentPage}),[e]),d=_e("isReadonlyMode",(function(){return e.isReadOnly}),[e]),f=_e("maxPageCountReached",(function(){return e.pages.length>=40}),[e]),p=_e("isCoarsePointer",(function(){return e.isCoarsePointer}),[e]),h=G((0,t.useState)(!1),2),v=h[0],g=h[1],m=(0,t.useCallback)((function(){d||g((function(e){return!e}))}),[d]),y=(0,t.useRef)({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),b=(0,t.useState)(Object.fromEntries(l.map((function(e,t){return[e.id,{y:t*s,offsetY:0,isSelected:!1}]})))),w=G(b,2),x=w[0],k=w[1];(0,t.useLayoutEffect)((function(){k(Object.fromEntries(l.map((function(e,t){return[e.id,{y:t*s,offsetY:0,isSelected:!1}]}))))}),[s,l]),(0,t.useEffect)((function(){o&&requestAnimationFrame((function(){var e=document.querySelector('[data-testid="page-menu-item-'.concat(c.id,'"]'));if(e){var t=u.current;if(!t)return;var n=e.offsetTop;n<t.scrollTop&&t.scrollTo({top:n});var r=n+s;r>t.scrollTop+t.offsetHeight&&t.scrollTo({top:r-t.offsetHeight})}}))}),[s,c,o]);var S=(0,t.useCallback)((function(e){var t=e.clientY,n=e.currentTarget.dataset,r=n.id,i=n.index;if(r&&i){var o=y.current;e.currentTarget.setPointerCapture(e.pointerId),o.status="pointing",o.pointing={id:r,index:+i};var a=x[r].y;o.startY=t,o.startIndex=Math.max(0,Math.min(Math.round(a/s),l.length-1))}}),[s,l.length,x]),_=(0,t.useCallback)((function(e){var t=y.current;if("pointing"===t.status){var n=e.clientY-t.startY;Math.abs(n)>5&&(t.status="dragging")}if("dragging"===t.status){var r=e.clientY-t.startY,i=x[t.pointing.id],o=t.startIndex,a=t.pointing,u=i.y+r,c=Math.max(0,Math.min(Math.round(u/s),l.length-1)),d=Ce({},x);if(d[a.id]={y:i.y,offsetY:r,isSelected:!0},c!==t.dragIndex){t.dragIndex=c;for(var f=0;f<l.length;f++){var p=l[f];if(p.id!==t.pointing.id){var h=d[p.id].y;c===o?h=f*s:c<o?h=c<=f&&f<o?(f+1)*s:f*s:c>o&&(h=c>=f&&f>o?(f-1)*s:f*s),h!==d[p.id].y&&(d[p.id]={y:h,offsetY:0,isSelected:!0})}}}k(d)}}),[s,l,x]),P=(0,t.useCallback)((function(t){var n=y.current;if("dragging"===n.status){var r=n.pointing,i=r.id,o=r.index;wO(e,i,o,n.dragIndex)}t.currentTarget.releasePointerCapture(t.pointerId),n.status="idle"}),[e]),E=(0,t.useCallback)((function(e){var t=y.current;"Escape"===e.key&&("dragging"===t.status&&k(Object.fromEntries(l.map((function(e,t){return[e.id,{y:t*s,offsetY:0,isSelected:!1}]})))),t.status="idle")}),[s,l]),C=(0,t.useCallback)((function(){if(!d){e.mark("creating page");var t=Dn.createId();e.createPage(n("page-menu.new-page-initial-name"),t),g(!0)}}),[e,n,d]);return(0,za.jsxs)(fO,{id:"page menu",onOpenChange:a,open:o,children:[(0,za.jsx)(pO,{children:(0,za.jsx)(qx,{className:"tlui-page-menu__trigger tlui-menu__trigger","data-testid":"main.page-menu",icon:"chevron-down",title:c.name,children:(0,za.jsx)("div",{className:"tlui-page-menu__name",children:c.name})})}),(0,za.jsx)(hO,{side:"bottom",align:"start",sideOffset:6,children:(0,za.jsxs)("div",{className:"tlui-page-menu__wrapper",children:[(0,za.jsxs)("div",{className:"tlui-page-menu__header",children:[(0,za.jsx)("div",{className:"tlui-page-menu__header__title",children:n("page-menu.title")}),!d&&(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(qx,{"data-testid":"page-menu.edit",title:n(v?"page-menu.edit-done":"page-menu.edit-start"),icon:v?"check":"edit",onClick:m}),(0,za.jsx)(qx,{"data-testid":"page-menu.create",icon:"plus",title:n(f?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:f,onClick:C})]})]}),(0,za.jsx)("div",{className:"tlui-page-menu__list tlui-menu__group",style:{height:s*l.length+4},ref:u,children:l.map((function(t,i){var o,a=null!==(o=x[t.id])&&void 0!==o?o:{position:40*i,offsetY:0};return v?(0,za.jsxs)("div",{"data-testid":"page-menu-item-".concat(t.id),className:"tlui-page_menu__item__sortable",style:{zIndex:t.id===c.id?888:i,transform:"translate(0px, ".concat(a.y+a.offsetY,"px)")},children:[(0,za.jsx)(qx,{tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",icon:"drag-handle-dots",onPointerDown:S,onPointerUp:P,onPointerMove:_,onKeyDown:E,"data-id":t.id,"data-index":i}),r<5&&p?(0,za.jsx)(qx,{className:"tlui-page-menu__item__button",onClick:function(){var n=window.prompt("Rename page",t.name);n&&n!==t.name&&e.renamePage(t.id,n)},onDoubleClick:m,isChecked:t.id===c.id,children:(0,za.jsx)("span",{children:t.name})}):(0,za.jsx)("div",{id:"page-menu-item-".concat(t.id),"data-testid":"page-menu-item-".concat(t.id),className:"tlui-page_menu__item__sortable__title",style:{height:s},children:(0,za.jsx)(bO,{id:t.id,name:t.name,isCurrentPage:t.id===c.id})}),!d&&(0,za.jsx)("div",{className:"tlui-page_menu__item__submenu","data-isediting":v,children:(0,za.jsx)(xO,{index:i,item:t,listSize:l.length})})]},t.id+"_editing"):(0,za.jsxs)("div",{"data-testid":"page-menu-item-".concat(t.id),className:"tlui-page-menu__item",children:[(0,za.jsxs)(qx,{className:"tlui-page-menu__item__button tlui-page-menu__item__button__checkbox",onClick:function(){return e.setCurrentPageId(t.id)},onDoubleClick:m,isChecked:t.id===c.id,title:n("page-menu.go-to-page"),children:[(0,za.jsx)("div",{className:"tlui-page-menu__item__button__check",children:t.id===c.id&&(0,za.jsx)(Ux,{icon:"check"})}),(0,za.jsx)("span",{children:t.name})]}),!d&&(0,za.jsx)("div",{className:"tlui-page_menu__item__submenu",children:(0,za.jsx)(xO,{index:i,item:t,listSize:l.length,onRename:function(){if(e.isIos){var n=window.prompt("Rename page",t.name);n&&n!==t.name&&e.renamePage(t.id,n)}else g(!0),e.setCurrentPageId(t.id)}})})]},t.id)}))})]})})]})},SO=(0,t.memo)((function(){var e=Nx(),t=AT(),n=eT().redo;return(0,za.jsx)(qx,{"data-testid":"main.redo",icon:n.icon,title:"".concat(e(n.label)," ").concat(Hx(n.kbd)),disabled:!t,onClick:function(){return n.onSelect("quick-actions")},smallIcon:!0})})),_O=ke((function(){var e=Va(),t=eT(),n=Nx(),r=t.delete;if(CT())return null;var i=e.selectedIds.length<=0;return(0,za.jsx)(qx,{icon:r.icon,onClick:function(){return r.onSelect("quick-actions")},disabled:i,title:"".concat(n(r.label)," ").concat(Hx(r.kbd)),smallIcon:!0})})),PO=(0,t.memo)((function(){var e=Nx(),t=OT(),n=eT().undo;return(0,za.jsx)(qx,{"data-testid":"main.undo",icon:n.icon,title:"".concat(e(n.label)," ").concat(Hx(n.kbd)),disabled:!t,onClick:function(){return n.onSelect("quick-actions")},smallIcon:!0})})),EO=ke((function(){var e=Va(),t=hT(),n=!CT()&&!e.isInAny("hand","zoom","eraser");return(0,za.jsx)("div",{className:"tlui-menu-zone",children:(0,za.jsxs)("div",{className:"tlui-menu-zone__controls",children:[(0,za.jsx)(mO,{}),(0,za.jsx)("div",{className:"tlui-menu-zone__divider"}),(0,za.jsx)(kO,{}),t>=6&&n&&(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)("div",{className:"tlui-menu-zone__divider"}),(0,za.jsx)(PO,{}),(0,za.jsx)(SO,{}),(0,za.jsx)(_O,{}),(0,za.jsx)(gO,{}),(0,za.jsx)(vO,{})]})]})})}));var CO=function(){function e(t,n){var r=this;M(this,e),z(this,"colors",{shapeFill:"rgba(144, 144, 144, .1)",selectFill:"#2f80ed",viewportFill:"rgba(144, 144, 144, .1)"}),z(this,"id",of()),z(this,"cvs",null),z(this,"pageBounds",[]),z(this,"collaborators",[]),z(this,"canvasScreenBounds",new ks),z(this,"canvasPageBounds",new ks),z(this,"contentPageBounds",new ks),z(this,"contentScreenBounds",new ks),z(this,"originPagePoint",new Xa),z(this,"originPageCenter",new Xa),z(this,"isInViewport",!1),z(this,"debug",!1),z(this,"updateContentScreenBounds",(function(){var e=r.contentScreenBounds,t=r.contentPageBounds,n=r.canvasScreenBounds,i=e.x,o=e.y,a=e.w,s=e.h;if(t.w>t.h){var u=n.w/(t.w/t.h);u>n.h?(i=(n.w-n.w*(n.h/u))/2,o=0,a=n.w*(n.h/u),s=n.h):(i=0,o=(n.h-u)/2,a=n.w,s=u)}else if(t.w<t.h){var l=n.h/(t.h/t.w);i=(n.w-l)/2,o=0,a=l,s=n.h}else i=n.h/2,o=0,a=n.h,s=n.h;e.set(i,o,a,s)})),z(this,"updateCanvasPageBounds",(function(){var e=r.canvasPageBounds,t=r.canvasScreenBounds,n=r.contentPageBounds,i=r.contentScreenBounds;e.set(0,0,n.width/(i.width/t.width),n.height/(i.height/t.height)),e.center=n.center})),z(this,"getScreenPoint",(function(e,t){var n=r.canvasScreenBounds;return{x:(e-n.minX)*r.dpr,y:(t-n.minY)*r.dpr}})),z(this,"getPagePoint",(function(e,t){var n=r.contentPageBounds,i=r.contentScreenBounds,o=r.canvasPageBounds,a=r.getScreenPoint(e,t),s=a.x,u=a.y;return{x:o.minX+s*n.width/i.width,y:o.minY+u*n.height/i.height,z:1}})),z(this,"minimapScreenPointToPagePoint",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=r.editor.viewportPageBounds,a=r.getPagePoint(e,t),s=a.x,u=a.y;if(i){var l,c,d,f,p=r.editor.allShapesCommonBounds,h=o,v=(null!==(l=null===p||void 0===p?void 0:p.minX)&&void 0!==l?l:0)-h.width/2,g=(null!==(c=null===p||void 0===p?void 0:p.maxX)&&void 0!==c?c:0)+h.width/2,m=(null!==(d=null===p||void 0===p?void 0:p.minY)&&void 0!==d?d:0)-h.height/2,y=(null!==(f=null===p||void 0===p?void 0:p.maxY)&&void 0!==f?f:0)+h.height/2,b=Math.max(0,v+h.width-s),w=Math.max(0,-(g-h.width-s)),x=Math.max(0,m+h.height-u),k=Math.max(0,-(y-h.height-u)),S=Math.max(0,b-w),_=Math.max(0,w-b),P=Math.max(0,x-k),E=Math.max(0,k-x);S&&S>_?s+=S/2:_&&(s-=_/2),P&&P>E?u+=P/2:E&&(u-=E/2),s=es(s,v,g),u=es(u,m,y)}if(n){var C=r.originPagePoint;Math.abs(s-C.x)>Math.abs(u-C.y)?u=C.y:s=C.x}return{x:s,y:u}})),z(this,"render",(function(){var t=r.cvs,n=r.pageBounds;r.updateCanvasPageBounds();var i=r.editor,o=r.canvasScreenBounds,a=r.canvasPageBounds,s=r.contentPageBounds,u=r.contentScreenBounds,l=o.width,c=o.height,d=i.viewportPageBounds,f=i.selectedIds;if(t&&n){var p=t.getContext("2d");if(!p)throw new Error("Minimap (shapes): Could not get context");p.resetTransform(),p.globalAlpha=1,p.clearRect(0,0,l,c);var h=u.width/s.width,v=u.height/s.height;p.translate((l-u.width)/2,(c-u.height)/2),p.scale(h,v),p.translate(-s.minX,-s.minY);for(var g,m=8/h,y=8/h,b=1/h,w=1/h,x=m/4,k=y/4,S=new Path2D,_=new Path2D,P=r.colors,E=P.shapeFill,C=P.selectFill,I=P.viewportFill,T=0,M=n.length;T<M;T++)g=n[T],e.roundedRect(f.includes(g.id)?_:S,g.minX,g.minY,g.width,g.height,es(m,b,g.width/x),es(y,w,g.height/k));if(p.fillStyle=E,p.fill(S),p.fillStyle=C,p.fill(_),r.debug){var j=ks.Common(n),A=j.minX,O=j.minY,L=j.width,z=j.height;p.strokeStyle="green",p.lineWidth=2/h,p.strokeRect(A+1/h,O+1/v,L-2/h,z-2/v)}var D=i.brush;if(D){var R=D.x,N=D.y,B=D.w,F=D.h;p.beginPath(),e.sharpRect(p,R,N,B,F),p.closePath(),p.fillStyle=I,p.fill()}var U=d.minX,K=d.minY,V=d.width,W=d.height;p.beginPath();var H=12/h,Y=12/h;e.roundedRect(p,U,K,V,W,Math.min(V/4,H),Math.min(W/4,Y)),p.closePath(),p.fillStyle=I,p.fill(),r.debug&&(p.strokeStyle="orange",p.strokeRect(U+1/h,K+1/v,V-2/h,W-2/v));for(var X,q=2.5/h,$=2.5/v,G=i.currentPageId,Q=0;Q<r.collaborators.length;Q++)(X=r.collaborators[Q]).currentPageId===G&&(p.beginPath(),p.ellipse(es(X.cursor.x,a.minX+q,a.maxX-q),es(X.cursor.y,a.minY+$,a.maxY-$),5/h,5/v,0,0,Qa),p.fillStyle=X.color,p.fill());if(r.debug){p.lineWidth=2/h;var Z=s.minX,J=s.minY,ee=s.width,te=s.height;p.strokeStyle="red",p.strokeRect(Z+1/h,J+1/v,ee-2/h,te-2/v);var ne=a.minX,re=a.minY,ie=a.width,oe=a.height;p.strokeStyle="blue",p.strokeRect(ne+1/h,re+1/v,ie-2/h,oe-2/v)}}})),this.editor=t,this.dpr=n}return L(e,[{key:"setDpr",value:function(e){this.dpr=+e.toFixed(2)}}],[{key:"roundedRect",value:function(e,t,n,r,i,o,a){o<1&&a<1?e.rect(t,n,r,i):(e.moveTo(t+o,n),e.lineTo(t+r-o,n),e.quadraticCurveTo(t+r,n,t+r,n+a),e.lineTo(t+r,n+i-a),e.quadraticCurveTo(t+r,n+i,t+r-o,n+i),e.lineTo(t+o,n+i),e.quadraticCurveTo(t,n+i,t,n+i-a),e.lineTo(t,n+a),e.quadraticCurveTo(t,n,t+o,n))}},{key:"sharpRect",value:function(e,t,n,r,i,o,a){e.rect(t,n,r,i)}}]),e}(),IO=ke((function(e){var n=e.shapeFill,r=e.selectFill,i=e.viewportFill,o=Va(),a=t.useRef(null),s=Su(),u=t.useRef(!1),l=t.useMemo((function(){return new CO(o,o.devicePixelRatio)}),[o]),c=o.isDarkMode;t.useEffect((function(){var e=requestAnimationFrame((function(){var e=getComputedStyle(s);l.colors={shapeFill:e.getPropertyValue(n).trim(),selectFill:e.getPropertyValue(r).trim(),viewportFill:e.getPropertyValue(i).trim()},l.render()}));return function(){cancelAnimationFrame(e)}}),[s,r,n,i,l,c]);var d=t.useCallback((function(e){if(o.currentPageShapeIds.size){var t=l.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!1),n=t.x,r=t.y,i=l.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!0);l.originPagePoint.setTo(i),l.originPageCenter.setTo(o.viewportPageBounds.center),o.centerOnPoint(n,r,{duration:Au})}}),[o,l]),f=t.useCallback((function(e){if(e.currentTarget.setPointerCapture(e.pointerId),o.currentPageShapeIds.size){u.current=!0,l.isInViewport=!1;var t=l.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!1),n=t.x,r=t.y,i=l.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!0),a=o.viewportPageBounds;l.originPagePoint.setTo(i),l.originPageCenter.setTo(a.center),l.isInViewport=a.containsPoint(i),l.isInViewport||o.centerOnPoint(n,r,{duration:Au})}}),[o,l]),p=t.useCallback((function(e){if(u.current){var t=l.minimapScreenPointToPagePoint(e.clientX,e.clientY,e.shiftKey,!0),n=t.x,r=t.y;if(l.isInViewport){var i=Xa.Sub({x:n,y:r},l.originPagePoint),a=Xa.Add(l.originPageCenter,i);return void o.centerOnPoint(a.x,a.y)}o.centerOnPoint(n,r)}var s=l.getPagePoint(e.clientX,e.clientY),c=o.pageToScreen(s.x,s.y),d=Ce(Ce({type:"pointer",target:"canvas",name:"pointer_move"},function(e){return e.isKilled=!0,{point:{x:e.clientX,y:e.clientY,z:e.pressure},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:e.pointerId,button:e.button,isPen:"pen"===e.pointerType}}(e)),{},{point:c,isPen:o.isPenMode});o.dispatch(d)}),[o,l]),h=t.useCallback((function(e){u.current=!1}),[]),v=t.useCallback((function(e){var t=xc(e);o.dispatch({type:"wheel",name:"wheel",delta:t,shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey})}),[o]);Se("update dpr",(function(){var e=o.devicePixelRatio;l.setDpr(e);var t=a.current,n=t.getBoundingClientRect(),r=n.width*e,i=n.height*e;t.width=r,t.height=i,l.canvasScreenBounds.set(n.x,n.y,r,i),l.cvs=a.current}),[o,l]);var g=t.useMemo((function(){return o.store.query.records("instance_presence")}),[o]);return Se("minimap render when pagebounds or collaborators changes",(function(){o.devicePixelRatio;var e=o.viewportPageBounds,t=o.allShapesCommonBounds;l.contentPageBounds=t?ks.Expand(t,e):e,l.updateContentScreenBounds();var n=[];o.currentPageShapeIds.forEach((function(e){var t=o.getPageBoundsById(e),r=o.getPageMaskById(e);if(r){var i=qs(r,t.corners);if(!i)return;t=ks.FromPoints(i)}t&&(t.id=e,n.push(t))})),l.pageBounds=n,l.collaborators=g.value,l.render()}),[o,l]),(0,za.jsx)("div",{className:"tlui-minimap",children:(0,za.jsx)("canvas",{ref:a,className:"tlui-minimap__canvas",onDoubleClick:d,onPointerMove:p,onPointerDown:f,onPointerUp:h,onWheel:v})})}));var TO=ke((function(){var e=Va(),n=Nx(),r=hT(),i=e.zoomLevel,o=e.currentPageShapeIds.size>0,a=e.selectedIds.length>0,s=1===e.zoomLevel,u=t.useCallback((function(){e.resetZoom(e.viewportScreenCenter,{duration:Au})}),[e]);return(0,za.jsxs)(KE,{id:"zoom",children:[(0,za.jsx)(VE,{children:(0,za.jsx)(qx,{title:"".concat(n("navigation-zone.zoom")),"data-testid":"minimap.zoom-menu",className:r<5?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:u,icon:r<4?"zoom-in":void 0,children:r<4?null:(0,za.jsxs)("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(100*i),"%"]})})}),(0,za.jsx)(WE,{side:"top",align:"start",alignOffset:0,children:(0,za.jsxs)(qE,{children:[(0,za.jsx)(MO,{action:"zoom-in","data-testid":"minimap.zoom-menu.zoom-in",noClose:!0}),(0,za.jsx)(MO,{action:"zoom-out","data-testid":"minimap.zoom-menu.zoom-out",noClose:!0}),(0,za.jsx)(MO,{action:"zoom-to-100","data-testid":"minimap.zoom-menu.zoom-to-100",noClose:!0,disabled:s}),(0,za.jsx)(MO,{action:"zoom-to-fit",disabled:!o,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0}),(0,za.jsx)(MO,{action:"zoom-to-selection",disabled:!a,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})]})})]})}));function MO(e){var t=e.action,n=e.disabled,r=void 0!==n&&n,i=e.noClose,o=void 0!==i&&i,a=eT();return(0,za.jsx)($E,{label:a[t].label,kbd:a[t].kbd,"data-testid":e["data-testid"],onClick:function(){return a[t].onSelect("zoom-menu")},noClose:o,disabled:r})}var jO=(0,t.memo)((function(){var e=eT(),n=Nx(),r=hT(),i=function(e,n){var r=G(t.useState(n),2),i=r[0],o=r[1];t.useLayoutEffect((function(){var t=localStorage.getItem(e);if(t)try{o(JSON.parse(t))}catch(ej){console.error("Could not restore value ".concat(e," from local storage."))}}),[e]);var a=t.useCallback((function(t){o((function(n){var r="function"===typeof t?t(n):t;return localStorage.setItem(e,JSON.stringify(r)),r}))}),[e]);return[i,a]}("minimap",!0),o=G(i,2),a=o[0],s=o[1],u=(0,t.useCallback)((function(){s((function(e){return!e}))}),[s]);return r<4?null:(0,za.jsxs)("div",{className:"tlui-navigation-zone",children:[(0,za.jsx)("div",{className:"tlui-navigation-zone__controls",children:r<6?(0,za.jsx)(TO,{}):a?(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(TO,{}),(0,za.jsx)(qx,{title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle","data-testid":"minimap.toggle",onClick:u,icon:a?"chevrons-ne":"chevrons-sw"})]}):(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(qx,{icon:"minus","data-testid":"minimap.zoom-out",title:"".concat(n(e["zoom-out"].label)," ").concat(Hx(e["zoom-out"].kbd)),onClick:function(){return e["zoom-out"].onSelect("navigation-zone")}}),(0,za.jsx)(TO,{}),(0,za.jsx)(qx,{icon:"plus","data-testid":"minimap.zoom-in",title:"".concat(n(e["zoom-in"].label)," ").concat(Hx(e["zoom-in"].kbd)),onClick:function(){return e["zoom-in"].onSelect("navigation-zone")}}),(0,za.jsx)(qx,{title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle",onClick:u,icon:a?"chevrons-ne":"chevrons-sw"})]})}),r>=6&&!a&&(0,za.jsx)(IO,{viewportFill:"--color-muted-1",selectFill:"--color-selected",shapeFill:"--color-text-3"})]})})),AO=ke((function(){var e=Va().isPenMode,t=eT();if(!e)return null;var n=t["exit-pen-mode"];return(0,za.jsx)(qx,{label:n.label,iconLeft:n.icon,onClick:function(){return n.onSelect("helper-buttons")}})})),OO=ke((function(){var e=Va(),t=eT();if(!e.instanceState.followingUserId)return null;var n=t["stop-following"];return(0,za.jsx)(qx,{label:n.label,iconLeft:n.icon,onClick:function(){return n.onSelect("people-menu")}})}));var LO=t.memo((function(e){var n=e.uiType,r=e.items,i=e.title,o=e.style,a=e.value,s=e.columns,u=void 0===s?es(r.length,2,4):s,l=e.onValueChange,c=Va(),d=Nx(),f=(0,t.useRef)(!1),p=t.useMemo((function(){var e=function e(){f.current=!1,window.removeEventListener("pointerup",e)};return{handleButtonClick:function(e){var t=e.currentTarget.dataset.id;"shared"===a.type&&a.value===t||(c.mark("point picker item"),l(o,t,!1))},handleButtonPointerDown:function(t){var n=t.currentTarget.dataset.id;c.mark("point picker item"),l(o,n,!0),f.current=!0,window.addEventListener("pointerup",e)},handleButtonPointerEnter:function(e){if(f.current){var t=e.currentTarget.dataset.id;l(o,t,!0)}},handleButtonPointerUp:function(e){var t=e.currentTarget.dataset.id;l(o,t,!1)}}}),[a,c,l,o]),h=p.handleButtonClick,v=p.handleButtonPointerDown,g=p.handleButtonPointerEnter,m=p.handleButtonPointerUp,y=_e("theme",(function(){return eo(c)}),[c]);return(0,za.jsx)("div",{className:Ua("tlui-button-grid",{"tlui-button-grid__two":2===u,"tlui-button-grid__three":3===u,"tlui-button-grid__four":4===u}),children:r.map((function(e){return(0,za.jsx)(qx,{"data-id":e.value,"data-testid":"style.".concat(n,".").concat(e.value),"aria-label":e.value,"data-state":"shared"===a.type&&a.value===e.value?"hinted":void 0,title:i+" \u2014 "+d("".concat(n,"-style.").concat(e.value)),className:Ua("tlui-button-grid__button"),style:o===oo?{color:y[e.value].solid}:void 0,onPointerEnter:g,onPointerDown:v,onPointerUp:m,onClick:h,icon:e.icon},e.value)}))})}));function zO(e,t){var n=G(t,2),r=n[0],i=n[1];return Math.min(i,Math.max(r,e))}var DO=["name","min","max","step","orientation","disabled","minStepsBetweenThumbs","defaultValue","value","onValueChange","onValueCommit","inverted"],RO=["min","max","dir","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"],NO=["min","max","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"],BO=["__scopeSlider","onSlideStart","onSlideMove","onSlideEnd","onHomeKeyDown","onEndKeyDown","onStepKeyDown"],FO=["__scopeSlider"],UO=["__scopeSlider"],KO=["__scopeSlider","index"],VO=["value"],WO=["PageUp","PageDown"],HO=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],YO={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},XO="Slider",qO=G(tk(XO),3),$O=qO[0],GO=qO[1],QO=qO[2],ZO=G(ib(XO,[QO]),2),JO=ZO[0],eL=(ZO[1],G(JO(XO),2)),tL=eL[0],nL=eL[1],rL=(0,t.forwardRef)((function(e,n){var r=e.name,i=e.min,o=void 0===i?0:i,a=e.max,s=void 0===a?100:a,l=e.step,c=void 0===l?1:l,d=e.orientation,f=void 0===d?"horizontal":d,p=e.disabled,h=void 0!==p&&p,v=e.minStepsBetweenThumbs,g=void 0===v?0:v,m=e.defaultValue,y=void 0===m?[o]:m,b=e.value,w=e.onValueChange,x=void 0===w?function(){}:w,k=e.onValueCommit,S=void 0===k?function(){}:k,_=e.inverted,P=void 0!==_&&_,E=gt(e,DO),C=G((0,t.useState)(null),2),I=C[0],T=C[1],M=tb(n,(function(e){return T(e)})),j=(0,t.useRef)(new Set),A=(0,t.useRef)(0),O="horizontal"===f,L=!I||Boolean(I.closest("form")),z=O?sL:uL,D=G(db({prop:b,defaultProp:y,onChange:function(e){var t;null===(t=u(j.current)[A.current])||void 0===t||t.focus(),x(e)}}),2),R=D[0],N=void 0===R?[]:R,B=D[1],F=(0,t.useRef)(N);function U(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{commit:!1}).commit,r=function(e){return(String(e).split(".")[1]||"").length}(c),i=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}(Math.round((e-o)/c)*c+o,r),a=zO(i,[o,s]);B((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=u(e);return r[n]=t,r.sort((function(e,t){return e-t}))}(e,a,t);if(function(e,t){if(t>0){var n=function(e){return e.slice(0,-1).map((function(t,n){return e[n+1]-t}))}(e);return Math.min.apply(Math,u(n))>=t}return!0}(r,g*c)){A.current=r.indexOf(a);var i=String(r)!==String(e);return i&&n&&S(r),i?r:e}return e}))}return(0,t.createElement)(tL,{scope:e.__scopeSlider,disabled:h,min:o,max:s,valueIndexToChangeRef:A,thumbs:j.current,values:N,orientation:f},(0,t.createElement)($O.Provider,{scope:e.__scopeSlider},(0,t.createElement)($O.Slot,{scope:e.__scopeSlider},(0,t.createElement)(z,Zy({"aria-disabled":h,"data-disabled":h?"":void 0},E,{ref:M,onPointerDown:Jy(E.onPointerDown,(function(){h||(F.current=N)})),min:o,max:s,inverted:P,onSlideStart:h?void 0:function(e){var t=function(e,t){if(1===e.length)return 0;var n=e.map((function(e){return Math.abs(e-t)})),r=Math.min.apply(Math,u(n));return n.indexOf(r)}(N,e);U(e,t)},onSlideMove:h?void 0:function(e){U(e,A.current)},onSlideEnd:h?void 0:function(){var e=F.current[A.current];N[A.current]!==e&&S(N)},onHomeKeyDown:function(){return!h&&U(o,0,{commit:!0})},onEndKeyDown:function(){return!h&&U(s,N.length-1,{commit:!0})},onStepKeyDown:function(e){var t=e.event,n=e.direction;if(!h){var r=WO.includes(t.key)||t.shiftKey&&HO.includes(t.key)?10:1,i=A.current;U(N[i]+c*r*n,i,{commit:!0})}}})))),L&&N.map((function(e,n){return(0,t.createElement)(mL,{key:n,name:r?r+(N.length>1?"[]":""):void 0,value:e})})))})),iL=G(JO(XO,{startEdge:"left",endEdge:"right",size:"width",direction:1}),2),oL=iL[0],aL=iL[1],sL=(0,t.forwardRef)((function(e,n){var r=e.min,i=e.max,o=e.dir,a=e.inverted,s=e.onSlideStart,u=e.onSlideMove,l=e.onSlideEnd,c=e.onStepKeyDown,d=gt(e,RO),f=G((0,t.useState)(null),2),p=f[0],h=f[1],v=tb(n,(function(e){return h(e)})),g=(0,t.useRef)(),m=rk(o),y="ltr"===m,b=y&&!a||!y&&a;function w(e){var t=g.current||p.getBoundingClientRect(),n=bL([0,t.width],b?[r,i]:[i,r]);return g.current=t,n(e-t.left)}return(0,t.createElement)(oL,{scope:e.__scopeSlider,startEdge:b?"left":"right",endEdge:b?"right":"left",direction:b?1:-1,size:"width"},(0,t.createElement)(lL,Zy({dir:m,"data-orientation":"horizontal"},d,{ref:v,style:Ce(Ce({},d.style),{},z({},"--radix-slider-thumb-transform","translateX(-50%)")),onSlideStart:function(e){var t=w(e.clientX);null===s||void 0===s||s(t)},onSlideMove:function(e){var t=w(e.clientX);null===u||void 0===u||u(t)},onSlideEnd:function(){g.current=void 0,null===l||void 0===l||l()},onStepKeyDown:function(e){var t=YO[b?"from-left":"from-right"].includes(e.key);null===c||void 0===c||c({event:e,direction:t?-1:1})}})))})),uL=(0,t.forwardRef)((function(e,n){var r=e.min,i=e.max,o=e.inverted,a=e.onSlideStart,s=e.onSlideMove,u=e.onSlideEnd,l=e.onStepKeyDown,c=gt(e,NO),d=(0,t.useRef)(null),f=tb(n,d),p=(0,t.useRef)(),h=!o;function v(e){var t=p.current||d.current.getBoundingClientRect(),n=bL([0,t.height],h?[i,r]:[r,i]);return p.current=t,n(e-t.top)}return(0,t.createElement)(oL,{scope:e.__scopeSlider,startEdge:h?"bottom":"top",endEdge:h?"top":"bottom",size:"height",direction:h?1:-1},(0,t.createElement)(lL,Zy({"data-orientation":"vertical"},c,{ref:f,style:Ce(Ce({},c.style),{},z({},"--radix-slider-thumb-transform","translateY(50%)")),onSlideStart:function(e){var t=v(e.clientY);null===a||void 0===a||a(t)},onSlideMove:function(e){var t=v(e.clientY);null===s||void 0===s||s(t)},onSlideEnd:function(){p.current=void 0,null===u||void 0===u||u()},onStepKeyDown:function(e){var t=YO[h?"from-bottom":"from-top"].includes(e.key);null===l||void 0===l||l({event:e,direction:t?-1:1})}})))})),lL=(0,t.forwardRef)((function(e,n){var r=e.__scopeSlider,i=e.onSlideStart,o=e.onSlideMove,a=e.onSlideEnd,s=e.onHomeKeyDown,u=e.onEndKeyDown,l=e.onStepKeyDown,c=gt(e,BO),d=nL(XO,r);return(0,t.createElement)(wb.span,Zy({},c,{ref:n,onKeyDown:Jy(e.onKeyDown,(function(e){"Home"===e.key?(s(e),e.preventDefault()):"End"===e.key?(u(e),e.preventDefault()):WO.concat(HO).includes(e.key)&&(l(e),e.preventDefault())})),onPointerDown:Jy(e.onPointerDown,(function(e){var t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),d.thumbs.has(t)?t.focus():i(e)})),onPointerMove:Jy(e.onPointerMove,(function(e){e.target.hasPointerCapture(e.pointerId)&&o(e)})),onPointerUp:Jy(e.onPointerUp,(function(e){var t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),a(e))}))}))})),cL="SliderTrack",dL=(0,t.forwardRef)((function(e,n){var r=e.__scopeSlider,i=gt(e,FO),o=nL(cL,r);return(0,t.createElement)(wb.span,Zy({"data-disabled":o.disabled?"":void 0,"data-orientation":o.orientation},i,{ref:n}))})),fL="SliderRange",pL=(0,t.forwardRef)((function(e,n){var r,i=e.__scopeSlider,o=gt(e,UO),a=nL(fL,i),s=aL(fL,i),l=tb(n,(0,t.useRef)(null)),c=a.values.length,d=a.values.map((function(e){return yL(e,a.min,a.max)})),f=c>1?Math.min.apply(Math,u(d)):0,p=100-Math.max.apply(Math,u(d));return(0,t.createElement)(wb.span,Zy({"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0},o,{ref:l,style:Ce(Ce({},e.style),{},(r={},z(r,s.startEdge,f+"%"),z(r,s.endEdge,p+"%"),r))}))})),hL="SliderThumb",vL=(0,t.forwardRef)((function(e,n){var r=GO(e.__scopeSlider),i=G((0,t.useState)(null),2),o=i[0],a=i[1],s=tb(n,(function(e){return a(e)})),u=(0,t.useMemo)((function(){return o?r().findIndex((function(e){return e.ref.current===o})):-1}),[r,o]);return(0,t.createElement)(gL,Zy({},e,{ref:s,index:u}))})),gL=(0,t.forwardRef)((function(e,n){var r=e.__scopeSlider,i=e.index,o=gt(e,KO),a=nL(hL,r),s=aL(hL,r),u=G((0,t.useState)(null),2),l=u[0],c=u[1],d=tb(n,(function(e){return c(e)})),f=jS(l),p=a.values[i],h=void 0===p?0:yL(p,a.min,a.max),v=function(e,t){return t>2?"Value ".concat(e+1," of ").concat(t):2===t?["Minimum","Maximum"][e]:void 0}(i,a.values.length),g=null===f||void 0===f?void 0:f[s.size],m=g?function(e,t,n){var r=e/2,i=bL([0,50],[0,r]);return(r-i(t)*n)*n}(g,h,s.direction):0;return(0,t.useEffect)((function(){if(l)return a.thumbs.add(l),function(){a.thumbs.delete(l)}}),[l,a.thumbs]),(0,t.createElement)("span",{style:z({transform:"var(--radix-slider-thumb-transform)",position:"absolute"},s.startEdge,"calc(".concat(h,"% + ").concat(m,"px)"))},(0,t.createElement)($O.ItemSlot,{scope:e.__scopeSlider},(0,t.createElement)(wb.span,Zy({role:"slider","aria-label":e["aria-label"]||v,"aria-valuemin":a.min,"aria-valuenow":p,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0},o,{ref:d,style:void 0===p?{display:"none"}:e.style,onFocus:Jy(e.onFocus,(function(){a.valueIndexToChangeRef.current=i}))}))))})),mL=function(e){var n=e.value,r=gt(e,VO),i=(0,t.useRef)(null),o=function(e){var n=(0,t.useRef)({value:e,previous:e});return(0,t.useMemo)((function(){return n.current.value!==e&&(n.current.previous=n.current.value,n.current.value=e),n.current.previous}),[e])}(n);return(0,t.useEffect)((function(){var e=i.current,t=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(t,"value").set;if(o!==n&&r){var a=new Event("input",{bubbles:!0});r.call(e,n),e.dispatchEvent(a)}}),[o,n]),(0,t.createElement)("input",Zy({style:{display:"none"}},r,{ref:i,defaultValue:n}))};function yL(e,t,n){return zO(100/(n-t)*(e-t),[0,100])}function bL(e,t){return function(n){if(e[0]===e[1]||t[0]===t[1])return t[0];var r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}var wL=rL,xL=dL,kL=pL,SL=vL,_L=(0,t.memo)((function(e){var n=e.title,r=e.steps,i=e.value,o=e.label,a=e.onValueChange,s=Va(),u=Nx(),l=(0,t.useCallback)((function(e){a(e[0],!0)}),[a]),c=(0,t.useCallback)((function(){s.mark("click slider")}),[s]),d=(0,t.useCallback)((function(){i&&a(i,!1)}),[i,a]);return(0,za.jsx)("div",{className:"tlui-slider__container",children:(0,za.jsxs)(wL,{"data-testid":e["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:r,step:1,value:i?[i]:void 0,onPointerDown:c,onValueChange:l,onPointerUp:d,title:n+" \u2014 "+u(o),children:[(0,za.jsx)(xL,{className:"tlui-slider__track",dir:"ltr",children:null!==i&&(0,za.jsx)(kL,{className:"tlui-slider__range",dir:"ltr"})}),null!==i&&(0,za.jsx)(SL,{className:"tlui-slider__thumb",dir:"ltr"})]})})})),PL=t.memo((function(e){var n=e.label,r=e.uiTypeA,i=e.uiTypeB,o=e.labelA,a=e.labelB,s=e.itemsA,u=e.itemsB,l=e.styleA,c=e.styleB,d=e.valueA,f=e.valueB,p=e.onValueChange,h=Nx(),v=t.useMemo((function(){var e,t;return null!==(e=null===(t=s.find((function(e){return"shared"===d.type&&d.value===e.value})))||void 0===t?void 0:t.icon)&&void 0!==e?e:"mixed"}),[s,d]),g=t.useMemo((function(){var e,t;return null!==(e=null===(t=u.find((function(e){return"shared"===f.type&&f.value===e.value})))||void 0===t?void 0:t.icon)&&void 0!==e?e:"mixed"}),[u,f]);return void 0===d&&void 0===f?null:(0,za.jsxs)("div",{className:"tlui-style-panel__double-select-picker",children:[(0,za.jsx)("div",{title:h(n),className:"tlui-style-panel__double-select-picker-label",children:h(n)}),(0,za.jsxs)(KE,{id:"style panel ".concat(r," A"),children:[(0,za.jsx)(_E,{asChild:!0,children:(0,za.jsx)(qx,{"data-testid":"style.".concat(r),title:h(o)+" \u2014 "+h(null===d?"style-panel.mixed":"".concat(r,"-style.").concat(d)),icon:v,invertIcon:!0,smallIcon:!0})}),(0,za.jsx)(WE,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:(0,za.jsx)("div",{className:Ua("tlui-button-grid",{"tlui-button-grid__two":s.length<4,"tlui-button-grid__four":s.length>=4}),children:s.map((function(e){return(0,za.jsx)($E,{className:"tlui-button-grid__button",title:h(o)+" \u2014 "+h("".concat(r,"-style.").concat(e.value)),"data-testid":"style.".concat(r,".").concat(e.value),icon:e.icon,onClick:function(){return p(l,e.value,!1)},invertIcon:!0},e.value)}))})})]}),(0,za.jsxs)(KE,{id:"style panel ".concat(i),children:[(0,za.jsx)(_E,{asChild:!0,children:(0,za.jsx)(qx,{"data-testid":"style.".concat(i),title:h(a)+" \u2014 "+h(null===f?"style-panel.mixed":"".concat(i,"-style.").concat(f)),icon:g,smallIcon:!0})}),(0,za.jsx)(WE,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:(0,za.jsx)("div",{className:Ua("tlui-button-grid",{"tlui-button-grid__two":s.length<4,"tlui-button-grid__four":s.length>=4}),children:u.map((function(e){return(0,za.jsx)($E,{className:"tlui-button-grid__button",title:h(a)+" \u2014 "+h("".concat(i,"-style.").concat(e.value)),"data-testid":"style.".concat(i,".").concat(e.value),icon:e.icon,onClick:function(){return p(c,e.value,!1)}},e.value)}))})})]})]})})),EL=t.memo((function(e){var n=e.id,r=e.label,i=e.uiType,o=e.style,a=e.items,s=e.value,u=e.onValueChange,l=Nx(),c=t.useMemo((function(){var e;return null===(e=a.find((function(e){return"shared"===s.type&&e.value===s.value})))||void 0===e?void 0:e.icon}),[a,s]);return(0,za.jsxs)(KE,{id:"style panel ".concat(n),children:[(0,za.jsx)(_E,{asChild:!0,children:(0,za.jsx)(qx,{"data-testid":"style.".concat(i),title:"mixed"===s.type?l("style-panel.mixed"):l("".concat(i,"-style.").concat(s.value)),label:r,icon:null!==c&&void 0!==c?c:"mixed"})}),(0,za.jsx)(WE,{side:"left",align:"center",alignOffset:0,children:(0,za.jsx)("div",{className:Ua("tlui-button-grid",{"tlui-button-grid__two":a.length<3,"tlui-button-grid__three":3==a.length,"tlui-button-grid__four":a.length>=4}),children:a.map((function(e){return(0,za.jsx)($E,{className:"tlui-button-grid__button","data-testid":"style.".concat(i,".").concat(e.value),title:l("".concat(i,"-style.").concat(e.value)),icon:e.icon,onClick:function(){return u(o,e.value,!1)}},e.value)}))})})]})})),CL={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],horizontalAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-center"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"star",icon:"geo-star"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]},IL=[oo,so,uo,fo];var TL=function(e){var n=e.isMobile,r=Va(),i=_e("getRelevantStyles",(function(){return function(e){var t,n=new fv(e.sharedStyles),r=e.selectedIds.length>0||!(null===(t=e.root.current.value)||void 0===t||!t.shapeType);if(0===n.size&&e.isIn("select")&&0===e.selectedIds.length)for(var i=0,o=IL;i<o.length;i++){var a=o[i];n.applyValue(a,e.getStyleForNextShape(a))}return 0!==n.size||r?{styles:n,opacity:e.sharedOpacity}:null}(r)}),[r]),o=(0,t.useCallback)((function(){n||(r.isChangingStyle=!1)}),[r,n]);if(!i)return null;var a=i.styles,s=i.opacity,u=a.get(Go),l=a.get(go),c=a.get(vo),d=void 0===u,f=void 0===l&&void 0===c,p=void 0===a.get(ha),h=void 0===a.get(lo);return(0,za.jsxs)("div",{className:"tlui-style-panel","data-ismobile":n,onPointerLeave:o,children:[(0,za.jsx)(AL,{styles:a,opacity:s}),!h&&(0,za.jsx)(OL,{styles:a}),!(d&&f&&p)&&(0,za.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[(0,za.jsx)(LL,{styles:a}),(0,za.jsx)(DL,{styles:a}),(0,za.jsx)(zL,{styles:a})]})]})};function ML(){var e=Va();return t.useMemo((function(){return function(t,n,r){e.setStyle(t,n,r),e.isChangingStyle=!0}}),[e])}var jL=[.1,.25,.5,.75,1];function AL(e){var n=e.styles,r=e.opacity,i=Va(),o=Nx(),a=ML(),s=t.useCallback((function(e,t){var n=jL[e];i.setOpacity(n,t),i.isChangingStyle=!0}),[i]),u=n.get(oo),l=n.get(uo),c=n.get(so),d=n.get(fo),f=void 0!==l||void 0!==c||void 0!==d,p="mixed"===r.type?-1:jL.indexOf(je(jL,(function(e){return Math.abs(e-r.value)})));return(0,za.jsxs)(za.Fragment,{children:[(0,za.jsxs)("div",{className:"tlui-style-panel__section__common","aria-label":"style panel styles",children:[void 0===u?null:(0,za.jsx)(LO,{title:o("style-panel.color"),uiType:"color",style:oo,items:CL.color,value:u,onValueChange:a}),void 0===r?null:(0,za.jsx)(_L,{"data-testid":"style.opacity",value:p>=0?p:jL.length-1,label:"mixed"===r.type?"style-panel.mixed":"opacity-style.".concat(r),onValueChange:s,steps:jL.length-1,title:o("style-panel.opacity")})]}),f&&(0,za.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[void 0===l?null:(0,za.jsx)(LO,{title:o("style-panel.fill"),uiType:"fill",style:uo,items:CL.fill,value:l,onValueChange:a}),void 0===c?null:(0,za.jsx)(LO,{title:o("style-panel.dash"),uiType:"dash",style:so,items:CL.dash,value:c,onValueChange:a}),void 0===d?null:(0,za.jsx)(LO,{title:o("style-panel.size"),uiType:"size",style:fo,items:CL.size,value:d,onValueChange:a})]})]})}function OL(e){var t=e.styles,n=Nx(),r=ML(),i=t.get(lo),o=t.get(Ho),a=t.get(Yo);return void 0===i&&void 0===o?null:(0,za.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[void 0===i?null:(0,za.jsx)(LO,{title:n("style-panel.font"),uiType:"font",style:lo,items:CL.font,value:i,onValueChange:r}),void 0===o?null:(0,za.jsxs)("div",{className:"tlui-style-panel__row",children:[(0,za.jsx)(LO,{title:n("style-panel.align"),uiType:"align",style:Ho,items:CL.horizontalAlign,value:o,onValueChange:r}),void 0===a?(0,za.jsx)(qx,{title:n("style-panel.vertical-align"),"data-testid":"vertical-align",icon:"vertical-align-center",disabled:!0}):(0,za.jsx)(EL,{id:"geo-vertical-alignment",uiType:"verticalAlign",style:Yo,items:CL.verticalAlign,value:a,onValueChange:r})]})]})}function LL(e){var t=e.styles,n=ML(),r=t.get(Go);return void 0===r?null:(0,za.jsx)(EL,{id:"geo",label:"style-panel.geo",uiType:"geo",style:Go,items:CL.geo,value:r,onValueChange:n})}function zL(e){var t=e.styles,n=ML(),r=t.get(ha);return void 0===r?null:(0,za.jsx)(EL,{id:"spline",label:"style-panel.spline",uiType:"spline",style:ha,items:CL.spline,value:r,onValueChange:n})}function DL(e){var t=e.styles,n=ML(),r=t.get(go),i=t.get(vo);return r&&i?(0,za.jsx)(PL,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:vo,itemsA:CL.arrowheadStart,valueA:i,uiTypeB:"arrowheadEnd",styleB:go,itemsB:CL.arrowheadEnd,valueB:r,onValueChange:n,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"}):null}function RL(e){var t,n,r=e.toast,i=BI().removeToast,o=Nx(),a=r.actions&&r.actions.length>0;return(0,za.jsxs)(WC,{onOpenChange:function(e){e||i(r.id)},className:"tlui-toast__container",duration:r.keepOpen?1/0:5e3,children:[r.icon&&(0,za.jsx)("div",{className:"tlui-toast__icon",children:(0,za.jsx)(Ux,{icon:r.icon})}),(0,za.jsxs)("div",{className:"tlui-toast__main",children:[(0,za.jsxs)("div",{className:"tlui-toast__content",children:[(0,za.jsx)(HC,{className:"tlui-toast__title",children:r.title}),(0,za.jsx)(YC,{className:"tlui-toast__description",children:r.description})]}),r.actions&&(0,za.jsxs)("div",{className:"tlui-toast__actions",children:[r.actions.map((function(e,t){return(0,za.jsx)(XC,{altText:e.label,asChild:!0,onClick:e.onClick,children:(0,za.jsx)(qx,{className:"warn"===e.type?"tlui-button__warning":"tlui-button__primary",children:e.label})},t)})),a&&(0,za.jsx)(qC,{asChild:!0,children:(0,za.jsx)(qx,{className:"tlui-toast__close",style:{marginLeft:"auto"},children:null!==(t=r.closeLabel)&&void 0!==t?t:o("toast.close")})})]})]}),!a&&(0,za.jsx)(qC,{asChild:!0,children:(0,za.jsx)(qx,{className:"tlui-toast__close",children:null!==(n=r.closeLabel)&&void 0!==n?n:o("toast.close")})})]})}var NL=t.memo((function(){var e=BI().toasts;return(0,za.jsx)(za.Fragment,{children:e.map((function(e){return(0,za.jsx)(RL,{toast:e},e.id)}))})}));function BL(){var e=BI().toasts,n=G(t.useState(!1),2),r=n[0],i=n[1];return t.useEffect((function(){var t=!1;return e.length?i(!0):setTimeout((function(){t||i(!1)}),1e3),function(){t=!0}}),[e.length,i]),r?(0,za.jsx)(SC,{className:"tlui-toast__viewport"}):null}function FL(){var e=Va(),n=Nx(),r=_e("current color",(function(){var t=e.sharedStyles.get(oo);return t?"mixed"===t.type?null:eo(e)[t.value].solid:"var(--color-muted-1)"}),[e]),i=_e("isHandOrEraserToolActive",(function(){return e.isInAny("hand","zoom","eraser","laser")}),[e]),o=(0,t.useCallback)((function(t){t||(e.isChangingStyle=!1)}),[e]);return(0,za.jsxs)(fO,{id:"style menu",onOpenChange:o,children:[(0,za.jsx)(pO,{disabled:i,children:(0,za.jsx)(qx,{className:"tlui-toolbar__tools__button tlui-toolbar__styles__button","data-testid":"mobile.styles",style:{color:null!==r&&void 0!==r?r:"var(--color-text)"},title:n("style-panel.title"),children:(0,za.jsx)(Ux,{icon:r?"blob":"mixed"})})}),(0,za.jsx)(hO,{side:"top",align:"end",children:(0,za.jsx)(TL,{isMobile:!0})})]})}var UL=["select","hand","draw","eraser","text","zoom","laser","highlight"];function KL(e){var t=e.activeToolId,n=Va(),r=hT(),i=Nx(),o=_e("is tool locked",(function(){return n.instanceState.isToolLocked}),[n]);return!t||UL.includes(t)?null:(0,za.jsx)(qx,{title:i("action.toggle-tool-lock"),className:Ua("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":r<5}),icon:o?"lock":"unlock",onClick:function(){return n.updateInstanceState({isToolLocked:!o})},smallIcon:!0})}var VL=(0,t.memo)((function(){var e=Va(),n=Nx(),r=hT(),i=t.useRef(void 0),o=CT(),a=function(){var e=t.useContext(RT);if(!e)throw new Error("useToolbarSchema must be used within a ToolbarSchemaProvider");return e}(),s=a.find((function(e){return"laser"===e.toolItem.id})),u=_e("current tool id",(function(){return e.currentToolId}),[e]),l="hand"===u,c=_e("geo",(function(){return e.sharedStyles.getAsKnownValue(Go)}),[e]),d=!o,f=!(o||l),p=function(e){return e.label?"".concat(n(e.label)," ").concat(e.kbd?Hx(e.kbd):""):""},h=a.find((function(e){return YL(e.toolItem,u,c)})),v=t.useMemo((function(){for(var e,t=[],n=[],o=Math.min(8,5+r),s=4;s<a.length;s++){var u=a[s];s<o?t.push(u):(u===h&&(e=u),n.push(u))}return e||(i.current||(i.current=n[0]),e=i.current,n.includes(e)||(e=n[0])),i.current=e,n.length<=2&&(t.push.apply(t,n),n.length=0),{itemsInPanel:t,itemsInDropdown:n,dropdownFirstItem:e}}),[a,h,r]),g=v.itemsInPanel,m=v.itemsInDropdown,y=v.dropdownFirstItem;return(0,za.jsx)("div",{className:"tlui-toolbar",children:(0,za.jsxs)("div",{className:"tlui-toolbar__inner",children:[(0,za.jsxs)("div",{className:"tlui-toolbar__left",children:[!o&&(0,za.jsxs)("div",{className:Ua("tlui-toolbar__extras",{"tlui-toolbar__extras__hidden":!f}),children:[r<6&&(0,za.jsxs)("div",{className:"tlui-toolbar__extras__controls",children:[(0,za.jsx)(PO,{}),(0,za.jsx)(SO,{}),(0,za.jsx)(_O,{}),(0,za.jsx)(gO,{}),(0,za.jsx)(vO,{})]}),(0,za.jsx)(KL,{activeToolId:u})]}),(0,za.jsxs)("div",{className:Ua("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":r<5}),children:[a.slice(0,2).map((function(e){var t=e.toolItem;return(0,za.jsx)(HL,{item:t,title:p(t),isSelected:YL(t,u,c)},t.id)})),o&&s&&(0,za.jsx)(HL,{item:s.toolItem,title:p(s.toolItem),isSelected:YL(s.toolItem,u,c)},s.toolItem.id),d&&(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)("div",{className:"tlui-toolbar__divider"}),a.slice(2,4).map((function(e){var t=e.toolItem;return(0,za.jsx)(HL,{item:t,title:p(t),isSelected:YL(t,u,c)},t.id)})),(0,za.jsx)("div",{className:"tlui-toolbar__divider"}),g.map((function(e){var t=e.toolItem;return(0,za.jsx)(HL,{item:t,title:p(t),isSelected:YL(t,u,c)},t.id)})),m.length?(0,za.jsxs)(za.Fragment,{children:[(0,za.jsx)(HL,{item:y.toolItem,title:p(y.toolItem),isSelected:YL(y.toolItem,u,c)},y.toolItem.id),(0,za.jsxs)(KE,{id:"toolbar overflow",modal:!1,children:[(0,za.jsx)(VE,{children:(0,za.jsx)(qx,{className:"tlui-toolbar__tools__button tlui-toolbar__overflow",icon:"chevron-up","data-testid":"tools.more",title:n("tool-panel.more")})}),(0,za.jsx)(WE,{side:"top",align:"center",children:(0,za.jsx)(WL,{toolbarItems:m})})]})]}):null]})]})]}),r<5&&!o&&(0,za.jsx)("div",{className:"tlui-toolbar__tools",children:(0,za.jsx)(FL,{})})]})})})),WL=ke((function(e){var t=e.toolbarItems,n=Nx();return(0,za.jsx)("div",{className:"tlui-button-grid__four tlui-button-grid__reverse",children:t.map((function(e){var t,r=e.toolItem,i=r.id,o=r.meta,a=r.kbd,s=r.label,u=r.onSelect,l=r.icon;return(0,za.jsx)($E,{className:"tlui-button-grid__button","data-testid":"tools.".concat(i),"data-tool":i,"data-geo":null!==(t=null===o||void 0===o?void 0:o.geo)&&void 0!==t?t:"","aria-label":s,onClick:function(){return u("toolbar")},title:s?"".concat(n(s)," ").concat(a?Hx(a):""):"",icon:l},i)}))})}));function HL(e){var t,n,r=e.item,i=e.title,o=e.isSelected;return(0,za.jsx)(qx,{className:"tlui-toolbar__tools__button","data-testid":"tools.".concat(r.id),"data-tool":r.id,"data-geo":null!==(t=null===(n=r.meta)||void 0===n?void 0:n.geo)&&void 0!==t?t:"","aria-label":r.label,title:i,icon:r.icon,"data-state":o?"selected":void 0,onClick:function(){return r.onSelect("toolbar")},onTouchStart:function(e){uu(e),r.onSelect("toolbar")}})}var YL=function(e,t,n){var r,i;return null!==(r=e.meta)&&void 0!==r&&r.geo?"geo"===t&&n===(null===(i=e.meta)||void 0===i?void 0:i.geo):t===e.id};var XL="undefined"!==typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function qL(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on".concat(t),(function(){n(window.event)}))}function $L(e,t){for(var n=t.slice(0,t.length-1),r=0;r<n.length;r++)n[r]=e[n[r].toLowerCase()];return n}function GL(e){"string"!==typeof e&&(e="");for(var t=(e=e.replace(/\s/g,"")).split(","),n=t.lastIndexOf("");n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}for(var QL={backspace:8,"\u232b":8,tab:9,clear:12,enter:13,"\u21a9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21ea":20,",":188,".":190,"/":191,"`":192,"-":XL?173:189,"=":XL?61:187,";":XL?59:186,"'":222,"[":219,"]":221,"\\":220},ZL={"\u21e7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,command:91},JL={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},ez={16:!1,18:!1,17:!1,91:!1},tz={},nz=1;nz<20;nz++)QL["f".concat(nz)]=111+nz;var rz=[],iz=!1,oz="all",az=[],sz=function(e){return QL[e.toLowerCase()]||ZL[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)};function uz(e){oz=e||"all"}function lz(){return oz||"all"}var cz=function(e){var t=e.key,n=e.scope,r=e.method,i=e.splitKey,o=void 0===i?"+":i;GL(t).forEach((function(e){var t=e.split(o),i=t.length,a=t[i-1],s="*"===a?"*":sz(a);if(tz[s]){n||(n=lz());var u=i>1?$L(ZL,t):[];tz[s]=tz[s].filter((function(e){return!((!r||e.method===r)&&e.scope===n&&function(e,t){for(var n=e.length>=t.length?e:t,r=e.length>=t.length?t:e,i=!0,o=0;o<n.length;o++)-1===r.indexOf(n[o])&&(i=!1);return i}(e.mods,u))}))}}))};function dz(e,t,n,r){var i;if(t.element===r&&(t.scope===n||"all"===t.scope)){for(var o in i=t.mods.length>0,ez)Object.prototype.hasOwnProperty.call(ez,o)&&(!ez[o]&&t.mods.indexOf(+o)>-1||ez[o]&&-1===t.mods.indexOf(+o))&&(i=!1);(0!==t.mods.length||ez[16]||ez[18]||ez[17]||ez[91])&&!i&&"*"!==t.shortcut||(t.keys=[],t.keys=t.keys.concat(rz),!1===t.method(e,t)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}function fz(e,t){var n=tz["*"],r=e.keyCode||e.which||e.charCode;if(pz.filter.call(this,e)){if(93!==r&&224!==r||(r=91),-1===rz.indexOf(r)&&229!==r&&rz.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach((function(t){var n=JL[t];e[t]&&-1===rz.indexOf(n)?rz.push(n):!e[t]&&rz.indexOf(n)>-1?rz.splice(rz.indexOf(n),1):"metaKey"===t&&e[t]&&3===rz.length&&(e.ctrlKey||e.shiftKey||e.altKey||(rz=rz.slice(rz.indexOf(n))))})),r in ez){for(var i in ez[r]=!0,ZL)ZL[i]===r&&(pz[i]=!0);if(!n)return}for(var o in ez)Object.prototype.hasOwnProperty.call(ez,o)&&(ez[o]=e[JL[o]]);e.getModifierState&&(!e.altKey||e.ctrlKey)&&e.getModifierState("AltGraph")&&(-1===rz.indexOf(17)&&rz.push(17),-1===rz.indexOf(18)&&rz.push(18),ez[17]=!0,ez[18]=!0);var a=lz();if(n)for(var s=0;s<n.length;s++)n[s].scope===a&&("keydown"===e.type&&n[s].keydown||"keyup"===e.type&&n[s].keyup)&&dz(e,n[s],a,t);if(r in tz)for(var u=0;u<tz[r].length;u++)if(("keydown"===e.type&&tz[r][u].keydown||"keyup"===e.type&&tz[r][u].keyup)&&tz[r][u].key){for(var l=tz[r][u],c=l.splitKey,d=l.key.split(c),f=[],p=0;p<d.length;p++)f.push(sz(d[p]));f.sort().join("")===rz.sort().join("")&&dz(e,l,a,t)}}}function pz(e,t,n){rz=[];var r=GL(e),i=[],o="all",a=document,s=0,u=!1,l=!0,c="+",d=!1;for(void 0===n&&"function"===typeof t&&(n=t),"[object Object]"===Object.prototype.toString.call(t)&&(t.scope&&(o=t.scope),t.element&&(a=t.element),t.keyup&&(u=t.keyup),void 0!==t.keydown&&(l=t.keydown),void 0!==t.capture&&(d=t.capture),"string"===typeof t.splitKey&&(c=t.splitKey)),"string"===typeof t&&(o=t);s<r.length;s++)i=[],(e=r[s].split(c)).length>1&&(i=$L(ZL,e)),(e="*"===(e=e[e.length-1])?"*":sz(e))in tz||(tz[e]=[]),tz[e].push({keyup:u,keydown:l,scope:o,mods:i,shortcut:r[s],method:n,key:r[s],splitKey:c,element:a});"undefined"!==typeof a&&!function(e){return az.indexOf(e)>-1}(a)&&window&&(az.push(a),qL(a,"keydown",(function(e){fz(e,a)}),d),iz||(iz=!0,qL(window,"focus",(function(){rz=[]}),d)),qL(a,"keyup",(function(e){fz(e,a),function(e){var t=e.keyCode||e.which||e.charCode,n=rz.indexOf(t);if(n>=0&&rz.splice(n,1),e.key&&"meta"===e.key.toLowerCase()&&rz.splice(0,rz.length),93!==t&&224!==t||(t=91),t in ez)for(var r in ez[t]=!1,ZL)ZL[r]===t&&(pz[r]=!1)}(e)}),d))}var hz={getPressedKeyString:function(){return rz.map((function(e){return function(e){return Object.keys(QL).find((function(t){return QL[t]===e}))}(e)||function(e){return Object.keys(ZL).find((function(t){return ZL[t]===e}))}(e)||String.fromCharCode(e)}))},setScope:uz,getScope:lz,deleteScope:function(e,t){var n,r;for(var i in e||(e=lz()),tz)if(Object.prototype.hasOwnProperty.call(tz,i))for(n=tz[i],r=0;r<n.length;)n[r].scope===e?n.splice(r,1):r++;lz()===e&&uz(t||"all")},getPressedKeyCodes:function(){return rz.slice(0)},getAllKeyCodes:function(){var e=[];return Object.keys(tz).forEach((function(t){tz[t].forEach((function(t){var n=t.key,r=t.scope,i=t.mods,o=t.shortcut;e.push({scope:r,shortcut:o,mods:i,keys:n.split("+").map((function(e){return sz(e)}))})}))})),e},isPressed:function(e){return"string"===typeof e&&(e=sz(e)),-1!==rz.indexOf(e)},filter:function(e){var t=e.target||e.srcElement,n=t.tagName,r=!0;return!t.isContentEditable&&("INPUT"!==n&&"TEXTAREA"!==n&&"SELECT"!==n||t.readOnly)||(r=!1),r},trigger:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";Object.keys(tz).forEach((function(n){tz[n].filter((function(n){return n.scope===t&&n.shortcut===e})).forEach((function(e){e&&e.method&&e.method()}))}))},unbind:function(e){if("undefined"===typeof e)Object.keys(tz).forEach((function(e){return delete tz[e]}));else if(Array.isArray(e))e.forEach((function(e){e.key&&cz(e)}));else if("object"===typeof e)e.key&&cz(e);else if("string"===typeof e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0],o=n[1];"function"===typeof i&&(o=i,i=""),cz({key:e,scope:i,method:o,splitKey:"+"})}},keyMap:QL,modifier:ZL,modifierMap:JL};for(var vz in hz)Object.prototype.hasOwnProperty.call(hz,vz)&&(pz[vz]=hz[vz]);if("undefined"!==typeof window){var gz=window.hotkeys;pz.noConflict=function(e){return e&&window.hotkeys===pz&&(window.hotkeys=gz),pz},window.hotkeys=pz}var mz=["copy","cut","paste","asset"];function yz(e){return function(e){"string"!==typeof e&&(e="");for(var t=(e=e.replace(/\s/g,"")).split(","),n=t.lastIndexOf("");n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}(e).map((function(e){var t=e.split("");return 1===t.length?t[0]:"!"===t[0]?"shift+".concat(t[1]):"?"===t[0]?"alt+".concat(t[1]):"$"===t[0]?"!"===t[1]?"cmd+shift+".concat(t[2],",ctrl+shift+").concat(t[2]):"?"===t[1]?"cmd+\u2325+".concat(t[2],",ctrl+alt+").concat(t[2]):"cmd+".concat(t[1],",ctrl+").concat(t[1]):e})).join(",")}var bz=["shareZone","topZone","renderDebugMenuItems","children","hideUi"],wz=["children","hideUi"],xz=t.memo((function(e){var t=e.shareZone,n=e.topZone,r=e.renderDebugMenuItems,i=e.children,o=e.hideUi,a=gt(e,bz);return(0,za.jsx)(KT,Ce(Ce({},a),{},{children:(0,za.jsx)(kz,{hideUi:o,shareZone:t,topZone:n,renderDebugMenuItems:r,children:i})}))})),kz=t.memo((function(e){var t=e.children,n=e.hideUi,r=gt(e,wz);return(0,za.jsxs)(za.Fragment,{children:[t,n?null:(0,za.jsx)(Sz,Ce({},r))]})})),Sz=t.memo((function(e){var n=e.shareZone,r=e.topZone,i=e.renderDebugMenuItems,o=Va(),a=Nx(),s=hT(),u=_e("isReadOnlyMode",(function(){return o.isReadOnly}),[o]),l=_e("focus",(function(){return o.instanceState.isFocusMode}),[o]),c=_e("debug",(function(){return o.instanceState.isDebugMode}),[o]);!function(){var e=Va(),n=_I(),r=CT(),i=eT(),o=_T();(0,t.useEffect)((function(){if(n){for(var t=e.getContainer(),a=function(n,r){pz(n,{element:t,scope:e.store.id},r)},s=function(){return e.isMenuOpen||null!==e.editingId||e.crashingError},u=function(){var e=c[l];return e.kbd?r&&!e.readonlyOk||mz.includes(e.id)?0:void a(yz(e.kbd),(function(t){s()||(uu(t),e.onSelect("kbd"))})):0},l=0,c=Object.values(i);l<c.length;l++)u();for(var d=function(){var t=p[f];return!t.kbd||!t.readonlyOk&&e.isReadOnly||mz.includes(t.id)?0:void a(yz(t.kbd),(function(e){s()||(uu(e),t.onSelect("kbd"))}))},f=0,p=Object.values(o);f<p.length;f++)d();return pz.setScope(e.store.id),function(){pz.deleteScope(e.store.id)}}}),[i,o,r,e,n])}(),function(){var e=Va(),n=RE(),r=_I();(0,t.useEffect)((function(){if(r){var t=function(){0===e.selectedIds.length||null!==e.editingId||EI(e)||(DI(e),n("copy",{source:"kbd"}))},i=!1,o=function(e){1===e.button&&(i=!0,requestAnimationFrame((function(){i=!1})))},a=function(t){i?t.stopPropagation():null!==e.editingId||EI(e)||(t.clipboardData&&!e.inputs.shiftKey?AI(e,t.clipboardData):navigator.clipboard.read().then((function(t){Array.isArray(t)&&t[0]instanceof ClipboardItem&&OI(e,t,e.inputs.currentPagePoint)})),n("paste",{source:"kbd"}))};return document.addEventListener("copy",t),document.addEventListener("cut",s),document.addEventListener("paste",a),document.addEventListener("pointerup",o),function(){document.removeEventListener("copy",t),document.removeEventListener("cut",s),document.removeEventListener("paste",a),document.removeEventListener("pointerup",o)}}function s(){0===e.selectedIds.length||null!==e.editingId||EI(e)||(DI(e),e.deleteShapes(),n("cut",{source:"kbd"}))}}),[e,n,r])}(),function(){var e=Va(),n=BI().addToast;(0,t.useEffect)((function(){function t(e){var t=e.name,r=e.count;n({title:"Maximum Shapes Reached",description:"You've reached the maximum number of shapes allowed on ".concat(t," (").concat(r,"). Please delete some shapes or move to a different page to continue.")})}return e.addListener("max-shapes",t),function(){e.removeListener("max-shapes",t)}}),[e,n])}();var d=eT()["toggle-focus-mode"];return(0,za.jsx)(yC,{children:(0,za.jsxs)("main",{className:Ua("tlui-layout",{"tlui-layout__mobile":s<5}),children:[l?(0,za.jsx)("div",{className:"tlui-layout__top",children:(0,za.jsx)(qx,{className:"tlui-focus-button",title:"".concat(a("focus-mode.toggle-focus-mode")),icon:"dot",onClick:function(){return d.onSelect("menu")}})}):(0,za.jsxs)(za.Fragment,{children:[(0,za.jsxs)("div",{className:"tlui-layout__top",children:[(0,za.jsxs)("div",{className:"tlui-layout__top__left",children:[(0,za.jsx)(EO,{}),(0,za.jsxs)("div",{className:"tlui-helper-buttons",children:[(0,za.jsx)(AO,{}),(0,za.jsx)(WT,{}),(0,za.jsx)(OO,{})]})]}),(0,za.jsx)("div",{className:"tlui-layout__top__center",children:r}),(0,za.jsxs)("div",{className:"tlui-layout__top__right",children:[n,s>=5&&!u&&(0,za.jsx)("div",{className:"tlui-style-panel__wrapper",children:(0,za.jsx)(TL,{})})]})]}),(0,za.jsxs)("div",{className:"tlui-layout__bottom",children:[(0,za.jsxs)("div",{className:"tlui-layout__bottom__main",children:[(0,za.jsx)(jO,{}),(0,za.jsx)(VL,{}),s>=4&&(0,za.jsx)(oM,{})]}),c&&(0,za.jsx)(YT,{renderDebugMenuItems:null!==i&&void 0!==i?i:null})]})]}),(0,za.jsx)(NL,{}),(0,za.jsx)(tM,{}),(0,za.jsx)(BL,{}),(0,za.jsx)(nM,{})]})})})),_z=["__scopeContextMenu","disabled"],Pz=["__scopeContextMenu"],Ez=["__scopeContextMenu"],Cz=["__scopeContextMenu"],Iz=["__scopeContextMenu"],Tz=["__scopeContextMenu"],Mz=["__scopeContextMenu"],jz=["__scopeContextMenu"],Az="ContextMenu",Oz=G(ib(Az,[K_]),2),Lz=Oz[0],zz=(Oz[1],K_()),Dz=G(Lz(Az),2),Rz=Dz[0],Nz=Dz[1],Bz=function(e){var n=e.__scopeContextMenu,r=e.children,i=e.onOpenChange,o=e.dir,a=e.modal,s=void 0===a||a,u=G((0,t.useState)(!1),2),l=u[0],c=u[1],d=zz(n),f=cb(i),p=(0,t.useCallback)((function(e){c(e),f(e)}),[f]);return(0,t.createElement)(Rz,{scope:n,open:l,onOpenChange:p,modal:s},(0,t.createElement)(NP,Zy({},d,{dir:o,open:l,onOpenChange:p,modal:s}),r))},Fz="ContextMenuTrigger",Uz=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=e.disabled,o=void 0!==i&&i,a=gt(e,_z),s=Nz(Fz,r),u=zz(r),l=(0,t.useRef)({x:0,y:0}),c=(0,t.useRef)({getBoundingClientRect:function(){return DOMRect.fromRect(Ce({width:0,height:0},l.current))}}),d=(0,t.useRef)(0),f=(0,t.useCallback)((function(){return window.clearTimeout(d.current)}),[]),p=function(e){l.current={x:e.clientX,y:e.clientY},s.onOpenChange(!0)};return(0,t.useEffect)((function(){return f}),[f]),(0,t.useEffect)((function(){o&&f()}),[o,f]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(BP,Zy({},u,{virtualRef:c})),(0,t.createElement)(wb.span,Zy({"data-state":s.open?"open":"closed","data-disabled":o?"":void 0},a,{ref:n,style:Ce({WebkitTouchCallout:"none"},e.style),onContextMenu:o?e.onContextMenu:Jy(e.onContextMenu,(function(e){f(),p(e),e.preventDefault()})),onPointerDown:o?e.onPointerDown:Jy(e.onPointerDown,Qz((function(e){f(),d.current=window.setTimeout((function(){return p(e)}),700)}))),onPointerMove:o?e.onPointerMove:Jy(e.onPointerMove,Qz(f)),onPointerCancel:o?e.onPointerCancel:Jy(e.onPointerCancel,Qz(f)),onPointerUp:o?e.onPointerUp:Jy(e.onPointerUp,Qz(f))})))})),Kz=function(e){var n=e.__scopeContextMenu,r=gt(e,Pz),i=zz(n);return(0,t.createElement)(FP,Zy({},i,r))},Vz="ContextMenuContent",Wz=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=gt(e,Ez),o=Nz(Vz,r),a=zz(r),s=(0,t.useRef)(!1);return(0,t.createElement)(UP,Zy({},a,i,{ref:n,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:function(t){var n;null===(n=e.onCloseAutoFocus)||void 0===n||n.call(e,t),!t.defaultPrevented&&s.current&&t.preventDefault(),s.current=!1},onInteractOutside:function(t){var n;null===(n=e.onInteractOutside)||void 0===n||n.call(e,t),t.defaultPrevented||o.modal||(s.current=!0)},style:Ce(Ce({},e.style),{},{"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))})),Hz=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=gt(e,Cz),o=zz(r);return(0,t.createElement)(KP,Zy({},o,i,{ref:n}))})),Yz=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=gt(e,Iz),o=zz(r);return(0,t.createElement)(VP,Zy({},o,i,{ref:n}))})),Xz=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=gt(e,Tz),o=zz(r);return(0,t.createElement)(WP,Zy({},o,i,{ref:n}))})),qz=function(e){var n=e.__scopeContextMenu,r=e.children,i=e.onOpenChange,o=e.open,a=e.defaultOpen,s=zz(n),u=G(db({prop:o,defaultProp:a,onChange:i}),2),l=u[0],c=u[1];return(0,t.createElement)(YP,Zy({},s,{open:l,onOpenChange:c}),r)},$z=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=gt(e,Mz),o=zz(r);return(0,t.createElement)(XP,Zy({},o,i,{ref:n}))})),Gz=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=gt(e,jz),o=zz(r);return(0,t.createElement)(qP,Zy({},o,i,{ref:n,style:Ce(Ce({},e.style),{},{"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))}));function Qz(e){return function(t){return"mouse"!==t.pointerType?e(t):void 0}}var Zz=Bz,Jz=Uz,eD=Kz,tD=Wz,nD=Hz,rD=Yz,iD=Xz,oD=qz,aD=$z,sD=Gz,uD=ke((function(){var e=Va(),t=Su(),n=e.pages,r=e.currentPageId,i=Nx(),o=BI().addToast;return(0,za.jsxs)(oD,{children:[(0,za.jsx)(aD,{dir:"ltr",asChild:!0,children:(0,za.jsx)(qx,{className:"tlui-menu__button",label:"context-menu.move-to-page","data-testid":"menu-item.move-to-page",icon:"chevron-right"})}),(0,za.jsx)(eD,{container:t,dir:"ltr",children:(0,za.jsxs)(sD,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:[(0,za.jsx)(nD,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.pages",children:n.map((function(t){return(0,za.jsx)(rD,{disabled:r===t.id,onSelect:function(){e.mark("move_shapes_to_page"),e.moveShapesToPage(e.selectedIds,t.id);var n=e.getPageById(t.id);n&&o({title:"Changed Page",description:"Moved to ".concat(n.name,"."),actions:[{label:"Go Back",type:"primary",onClick:function(){e.mark("change-page"),e.setCurrentPageId(r)}}]})},asChild:!0,children:(0,za.jsx)(qx,{title:t.name,className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:(0,za.jsx)("span",{children:t.name})})},t.id)}))},"pages"),(0,za.jsx)(nD,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.new-page",children:(0,za.jsx)(rD,{onSelect:function(){e.mark("move_shapes_to_page");var t=Dn.createId(),n=e.selectedIds,r=e.currentPageId;e.batch((function(){e.createPage("Page 1",t),e.setCurrentPageId(r),e.moveShapesToPage(n,t)}))},asChild:!0,children:(0,za.jsx)(qx,{title:i("context.pages.new-page"),className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:i("context.pages.new-page")})},"new-page")},"new-page")]})})]})})),lD=function(e){var n=e.children,r=Va(),i=xT(),o=(0,t.useCallback)((function(e){if(e){if(r.isCoarsePointer){var t=r.selectedShapes,n=r.inputs.currentPagePoint,i=r.getShapesAtPoint(n);if(!r.selectedShapes.length||!i.some((function(e){return t.includes(e)}))){var o=i.filter((function(e){return r.isShapeOrAncestorLocked(e)}));o.length&&r.select.apply(r,u(o.map((function(e){return e.id}))))}}}else{var a=r.onlySelectedShape;a&&r.isShapeOrAncestorLocked(a)&&r.setSelectedIds([])}}),[r]),a=G(NE("context menu",o),2),s=(a[0],a[1]),l=CT(),c=0===i.length||l&&i.every((function(e){return!e.readonlyOk})),d=!_e("isSelectToolActive",(function(){return"select"===r.currentToolId}),[r])||c;return(0,za.jsxs)(Zz,{dir:"ltr",onOpenChange:s,children:[(0,za.jsx)(Jz,{onContextMenu:d?uu:void 0,dir:"ltr",disabled:d,children:n}),(0,za.jsx)(cD,{})]})};function cD(){var e=Va(),n=Nx(),r=xT(),i=G(NE("context menu sub"),2),o=(i[0],i[1]),a=CT(),s=hT(),u=Su(),l=G((0,t.useState)(!1),2),c=l[0],d=l[1];function f(e,t,r,i){if(a&&!t.readonlyOk)return null;switch(t.type){case"custom":if("MOVE_TO_PAGE_MENU"===t.id)return(0,za.jsx)(uD,{},t.id);break;case"group":return(0,za.jsx)(nD,{dir:"ltr",className:Ua("tlui-menu__group",{"tlui-menu__group__small":"submenu"===(null===r||void 0===r?void 0:r.type)}),"data-testid":"menu-item.".concat(t.id),children:t.children.map((function(n){return f(e,n,t,i+1)}))},t.id);case"submenu":return(0,za.jsxs)(oD,{onOpenChange:o,children:[(0,za.jsx)(aD,{dir:"ltr",disabled:t.disabled,asChild:!0,children:(0,za.jsx)(qx,{className:"tlui-menu__button",label:t.label,"data-testid":"menu-item.".concat(t.id),icon:"chevron-right"})}),(0,za.jsx)(eD,{container:u,dir:"ltr",children:(0,za.jsx)(sD,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:t.children.map((function(n){return f(e,n,t,i+1)}))})})]},t.id);case"item":if(a&&!t.readonlyOk)return null;var l=t.actionItem,p=l.id,h=l.checkbox,v=l.contextMenuLabel,g=l.label,m=l.onSelect,y=l.kbd,b=l.icon,w=null!==v&&void 0!==v?v:g,x=w?n(w):void 0;return h?(0,za.jsxs)(iD,{className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",dir:"ltr",disabled:t.disabled,onSelect:function(e){m("context-menu"),uu(e)},title:x||void 0,checked:t.checked,children:[(0,za.jsx)("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:"scale(".concat(t.checked?1:.5,")"),opacity:t.checked?1:.5},children:(0,za.jsx)(Ux,{small:!0,icon:t.checked?"check":"checkbox-empty"})}),x&&(0,za.jsx)("span",{children:x}),y&&(0,za.jsx)(Yx,{children:y})]},p):(0,za.jsx)(rD,{dir:"ltr",asChild:!0,children:(0,za.jsx)(qx,{className:"tlui-menu__button","data-testid":"menu-item.".concat(p),kbd:y,label:w,disabled:t.disabled,iconLeft:s<3&&i>2?b:void 0,onClick:function(){c?d(!1):m("context-menu")}})},p)}}return(0,za.jsx)(eD,{dir:"ltr",container:u,children:(0,za.jsx)(tD,{className:"tlui-menu scrollable",alignOffset:-4,collisionPadding:4,onContextMenu:uu,children:r.map((function(t){return f(e,t,null,0)}))})})}var dD=["children"];function fD(e){var n=e.children,r=gt(e,dD),i=Ce(Ce({},r),{},{shapes:(0,t.useMemo)((function(){var e;return[].concat(u(uv),u(null!==(e=r.shapes)&&void 0!==e?e:[]))}),[r.shapes]),tools:(0,t.useMemo)((function(){var e;return[].concat(u(ky),u(null!==(e=r.tools)&&void 0!==e?e:[]))}),[r.tools])});return(0,za.jsx)(ry,Ce(Ce({},i),{},{children:(0,za.jsxs)(xz,Ce(Ce({},i),{},{children:[(0,za.jsx)(lD,{children:(0,za.jsx)(Rd,{})}),n]}))}))}var pD=function(){return(0,za.jsx)("div",{style:{position:"fixed",inset:0,paddingBottom:"40px",paddingRight:"20px"},children:(0,za.jsx)(fD,{})})};i.createRoot(document.getElementById("root")).render((0,za.jsx)(t.StrictMode,{children:(0,za.jsx)(pD,{})}))}()}();
//# sourceMappingURL=main.d20280f3.js.map